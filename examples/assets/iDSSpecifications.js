import{l as y,c as f,a as g,b as C,z as m,C as u}from"./index-BET5fVdQ.js";import{C as I,W as S,S as v,a as M,O as F,F as b,I as k,b as O,c as U}from"./index-B31d80Z1.js";const n=new I,L=n.get(S),a=L.create();a.scene=new v(n);a.scene.setup();a.scene.three.background=null;const P=document.getElementById("container");a.renderer=new M(n,P);a.camera=new F(n);await a.camera.controls.setLookAt(78,20,-2.2,26,-4,25);n.init();const R="https://thatopen.github.io/engine_fragment/resources/worker.mjs",D=await fetch(R),x=await D.blob(),j=new File([x],"worker.mjs",{type:"text/javascript"}),E=URL.createObjectURL(j),s=n.get(b);s.init(E);a.camera.controls.addEventListener("update",()=>s.core.update());a.onCameraChanged.add(e=>{for(const[,o]of s.list)o.useCamera(e.three);s.core.update(!0)});s.list.onItemSet.add(({value:e})=>{e.useCamera(a.camera.three),a.scene.three.add(e.object),s.core.update(!0)});s.core.models.materials.list.onItemSet.add(({value:e})=>{"isLodMaterial"in e&&e.isLodMaterial||(e.polygonOffset=!0,e.polygonOffsetUnits=1,e.polygonOffsetFactor=Math.random())});const H=["https://thatopen.github.io/engine_components/resources/frags/school_arq.frag"];await Promise.all(H.map(async e=>{var r;const o=(r=e.split("/").pop())==null?void 0:r.split(".").shift();if(!o)return null;const t=await(await fetch(e)).arrayBuffer();return s.core.load(t,{modelId:o})}));const h=n.get(k),d=h.create("Sample",["IFC4"]);d.description="All doors must have FireRating specified in Pset_DoorCommon";const _=new O(n,{type:"simple",parameter:"IFCDOOR"}),z=new U(n,{type:"simple",parameter:"Pset_DoorCommon"},{type:"simple",parameter:"FireRating"});d.applicability.add(_);d.requirements.add(z);const p=new Map,B=e=>{const i=[...e.get(b).core.models.materials.list.values()];for(const t of i){if(t.userData.customId)continue;let r;"color"in t?r=t.color.getHex():r=t.lodColor.getHex(),p.set(t,{color:r,transparent:t.transparent,opacity:t.opacity}),t.transparent=!0,t.opacity=.05,t.needsUpdate=!0,"color"in t?t.color.setColorName("white"):t.lodColor.setColorName("white")}},N=()=>{for(const[e,o]of p){const{color:i,transparent:t,opacity:r}=o;e.transparent=t,e.opacity=r,"color"in e?e.color.setHex(i):e.lodColor.setHex(i),e.needsUpdate=!0}p.clear()},w=()=>{p.size?N():B(n)},q=async()=>{const e=await d.test([/arq/]),{fail:o,pass:i}=h.getModelIdMap(e),t=[s.resetHighlight()];t.push(s.highlight({customId:"green",color:new u("green"),renderedFaces:m.ONE,opacity:1,transparent:!1},i)),t.push(s.highlight({customId:"red",color:new u("red"),renderedFaces:m.ONE,opacity:1,transparent:!1},o)),t.push(s.core.update(!0)),await Promise.all(t),w()};y.init();const c=f.create(()=>g`
    <bim-panel active label="IDS Specifications Tutorial" class="options-menu">
      <bim-panel-section label="General">
        <bim-button label="Toogle Ghost" @click=${w}></bim-button>
      </bim-panel-section>
      <bim-panel-section label="Specification">
        <bim-button label="Review Model" @click=${async({target:o})=>{o.loading=!0,await q(),o.loading=!1}}></bim-button>
      </bim-panel-section>
    </bim-panel>
  `);document.body.append(c);const A=f.create(()=>g`
      <bim-button class="phone-menu-toggler" icon="solar:settings-bold"
        @click="${()=>{c.classList.contains("options-menu-visible")?c.classList.remove("options-menu-visible"):c.classList.add("options-menu-visible")}}">
      </bim-button>
    `);document.body.append(A);const l=new C;l.showPanel(2);document.body.append(l.dom);l.dom.style.left="0px";l.dom.style.zIndex="unset";a.renderer.onBeforeUpdate.add(()=>l.begin());a.renderer.onAfterUpdate.add(()=>l.end());
