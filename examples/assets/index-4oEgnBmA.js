import{t as Jt,V as B,h as Wt,w as We,T as ls,S as Vi,x as vt,a as st,C as Dt,E as Yi,D as No,A as Ja,W as ks,v as ke,P as Hn,aC as tc,z as ec,aD as ne,c as ft,aE as sc,y as Wn,aq as Di,Y as Is,s as Me,J as ic,e as Hs,at as bi,a_ as Sr,a$ as nc,b1 as rc,br as oc,ax as _o,N as zi,b as Es,Q as qs,X as ze,Z as Or,_ as Po,$ as zs,a0 as Xe,a1 as ac,d as Ws,a2 as ue,i as fs,a3 as Qs,a4 as _e,a5 as cc,a6 as Gi,a7 as Xn,a8 as Zn,a9 as $n,aa as jn,ab as qn,ac as ki,ad as Qn,ae as Kn,af as Jn,ag as tr,ah as er,ai as sr,aj as ir,ak as Lo,B as xt,al as lc,am as hc,an as uc,ao as ps,ap as fc,I as nr,aP as rr,aQ as or,aB as ar,aF as Qi,K as Bt,O as xi,j as Pi,aJ as dc,L as wo,aK as Ic,aL as Ec,aM as pc,aN as Cc,aO as Tc,aw as mc,k as Ie,aR as $e,aS as gc,aT as Rc,aU as yr,aV as Nr,ba as _r,bb as Ac,H as Pr,aG as ei,az as Fe,aH as Fc,aI as As,r as Sc,bc as Oc,bd as yc,be as Nc,bf as _c,ay as Pc,bk as Lc}from"./web-ifc-api-r1ed24cU.js";var wc=Object.defineProperty,Mc=(c,t,e)=>t in c?wc(c,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):c[t]=e,p=(c,t,e)=>(Mc(c,typeof t!="symbol"?t+"":t,e),e);const Mo=0,vc=1,Dc=2,Lr=2,Ki=1.25,wr=1,Li=6*4+4+4,Hi=65535,bc=Math.pow(2,-24),Ji=Symbol("SKIP_GENERATION");function xc(c){return c.index?c.index.count:c.attributes.position.count}function Ts(c){return xc(c)/3}function Uc(c,t=ArrayBuffer){return c>65535?new Uint32Array(new t(4*c)):new Uint16Array(new t(2*c))}function Bc(c,t){if(!c.index){const e=c.attributes.position.count,s=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,i=Uc(e,s);c.setIndex(new Ws(i,1));for(let n=0;n<e;n++)i[n]=n}}function vo(c){const t=Ts(c),e=c.drawRange,s=e.start/3,i=(e.start+e.count)/3,n=Math.max(0,s),r=Math.min(t,i)-n;return[{offset:Math.floor(n),count:Math.floor(r)}]}function Do(c){if(!c.groups||!c.groups.length)return vo(c);const t=[],e=new Set,s=c.drawRange,i=s.start/3,n=(s.start+s.count)/3;for(const o of c.groups){const a=o.start/3,l=(o.start+o.count)/3;e.add(Math.max(i,a)),e.add(Math.min(n,l))}const r=Array.from(e.values()).sort((o,a)=>o-a);for(let o=0;o<r.length-1;o++){const a=r[o],l=r[o+1];t.push({offset:Math.floor(a),count:Math.floor(l-a)})}return t}function Vc(c){if(c.groups.length===0)return!1;const t=Ts(c),e=Do(c).sort((n,r)=>n.offset-r.offset),s=e[e.length-1];s.count=Math.min(t-s.offset,s.count);let i=0;return e.forEach(({count:n})=>i+=n),t!==i}function Ot(c,t,e){return e.min.x=t[c],e.min.y=t[c+1],e.min.z=t[c+2],e.max.x=t[c+3],e.max.y=t[c+4],e.max.z=t[c+5],e}function Yc(c){c[0]=c[1]=c[2]=1/0,c[3]=c[4]=c[5]=-1/0}function Mr(c){let t=-1,e=-1/0;for(let s=0;s<3;s++){const i=c[s+3]-c[s];i>e&&(e=i,t=s)}return t}function vr(c,t){t.set(c)}function Dr(c,t,e){let s,i;for(let n=0;n<3;n++){const r=n+3;s=c[n],i=t[n],e[n]=s<i?s:i,s=c[r],i=t[r],e[r]=s>i?s:i}}function si(c,t,e){for(let s=0;s<3;s++){const i=t[c+2*s],n=t[c+2*s+1],r=i-n,o=i+n;r<e[s]&&(e[s]=r),o>e[s+3]&&(e[s+3]=o)}}function Fs(c){const t=c[3]-c[0],e=c[4]-c[1],s=c[5]-c[2];return 2*(t*e+e*s+s*t)}function tn(c,t,e,s,i=null){let n=1/0,r=1/0,o=1/0,a=-1/0,l=-1/0,h=-1/0,d=1/0,u=1/0,f=1/0,I=-1/0,E=-1/0,m=-1/0;const C=i!==null;for(let g=t*6,S=(t+e)*6;g<S;g+=6){const T=c[g+0],F=c[g+1],y=T-F,N=T+F;y<n&&(n=y),N>a&&(a=N),C&&T<d&&(d=T),C&&T>I&&(I=T);const w=c[g+2],P=c[g+3],M=w-P,x=w+P;M<r&&(r=M),x>l&&(l=x),C&&w<u&&(u=w),C&&w>E&&(E=w);const O=c[g+4],v=c[g+5],R=O-v,D=O+v;R<o&&(o=R),D>h&&(h=D),C&&O<f&&(f=O),C&&O>m&&(m=O)}s[0]=n,s[1]=r,s[2]=o,s[3]=a,s[4]=l,s[5]=h,C&&(i[0]=d,i[1]=u,i[2]=f,i[3]=I,i[4]=E,i[5]=m)}function zc(c,t,e,s){let i=1/0,n=1/0,r=1/0,o=-1/0,a=-1/0,l=-1/0;for(let h=t*6,d=(t+e)*6;h<d;h+=6){const u=c[h+0];u<i&&(i=u),u>o&&(o=u);const f=c[h+2];f<n&&(n=f),f>a&&(a=f);const I=c[h+4];I<r&&(r=I),I>l&&(l=I)}s[0]=i,s[1]=n,s[2]=r,s[3]=o,s[4]=a,s[5]=l}function Gc(c,t){Yc(t);const e=c.attributes.position,s=c.index?c.index.array:null,i=Ts(c),n=new Float32Array(i*6),r=e.normalized,o=e.array,a=e.offset||0;let l=3;e.isInterleavedBufferAttribute&&(l=e.data.stride);const h=["getX","getY","getZ"];for(let d=0;d<i;d++){const u=d*3,f=d*6;let I=u+0,E=u+1,m=u+2;s&&(I=s[I],E=s[E],m=s[m]),r||(I=I*l+a,E=E*l+a,m=m*l+a);for(let C=0;C<3;C++){let g,S,T;r?(g=e[h[C]](I),S=e[h[C]](E),T=e[h[C]](m)):(g=o[I+C],S=o[E+C],T=o[m+C]);let F=g;S<F&&(F=S),T<F&&(F=T);let y=g;S>y&&(y=S),T>y&&(y=T);const N=(y-F)/2,w=C*2;n[f+w+0]=F+N,n[f+w+1]=N+(Math.abs(F)+N)*bc,F<t[C]&&(t[C]=F),y>t[C+3]&&(t[C+3]=y)}}return n}const Ee=32,kc=(c,t)=>c.candidate-t.candidate,Se=new Array(Ee).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),ii=new Float32Array(6);function Hc(c,t,e,s,i,n){let r=-1,o=0;if(n===Mo)r=Mr(t),r!==-1&&(o=(t[r]+t[r+3])/2);else if(n===vc)r=Mr(c),r!==-1&&(o=Wc(e,s,i,r));else if(n===Dc){const a=Fs(c);let l=Ki*i;const h=s*6,d=(s+i)*6;for(let u=0;u<3;u++){const f=t[u],m=(t[u+3]-f)/Ee;if(i<Ee/4){const C=[...Se];C.length=i;let g=0;for(let T=h;T<d;T+=6,g++){const F=C[g];F.candidate=e[T+2*u],F.count=0;const{bounds:y,leftCacheBounds:N,rightCacheBounds:w}=F;for(let P=0;P<3;P++)w[P]=1/0,w[P+3]=-1/0,N[P]=1/0,N[P+3]=-1/0,y[P]=1/0,y[P+3]=-1/0;si(T,e,y)}C.sort(kc);let S=i;for(let T=0;T<S;T++){const F=C[T];for(;T+1<S&&C[T+1].candidate===F.candidate;)C.splice(T+1,1),S--}for(let T=h;T<d;T+=6){const F=e[T+2*u];for(let y=0;y<S;y++){const N=C[y];F>=N.candidate?si(T,e,N.rightCacheBounds):(si(T,e,N.leftCacheBounds),N.count++)}}for(let T=0;T<S;T++){const F=C[T],y=F.count,N=i-F.count,w=F.leftCacheBounds,P=F.rightCacheBounds;let M=0;y!==0&&(M=Fs(w)/a);let x=0;N!==0&&(x=Fs(P)/a);const O=wr+Ki*(M*y+x*N);O<l&&(r=u,l=O,o=F.candidate)}}else{for(let S=0;S<Ee;S++){const T=Se[S];T.count=0,T.candidate=f+m+S*m;const F=T.bounds;for(let y=0;y<3;y++)F[y]=1/0,F[y+3]=-1/0}for(let S=h;S<d;S+=6){let y=~~((e[S+2*u]-f)/m);y>=Ee&&(y=Ee-1);const N=Se[y];N.count++,si(S,e,N.bounds)}const C=Se[Ee-1];vr(C.bounds,C.rightCacheBounds);for(let S=Ee-2;S>=0;S--){const T=Se[S],F=Se[S+1];Dr(T.bounds,F.rightCacheBounds,T.rightCacheBounds)}let g=0;for(let S=0;S<Ee-1;S++){const T=Se[S],F=T.count,y=T.bounds,w=Se[S+1].rightCacheBounds;F!==0&&(g===0?vr(y,ii):Dr(y,ii,ii)),g+=F;let P=0,M=0;g!==0&&(P=Fs(ii)/a);const x=i-g;x!==0&&(M=Fs(w)/a);const O=wr+Ki*(P*g+M*x);O<l&&(r=u,l=O,o=T.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${n} used.`);return{axis:r,pos:o}}function Wc(c,t,e,s){let i=0;for(let n=t,r=t+e;n<r;n++)i+=c[n*6+s*2];return i/e}class ni{constructor(){}}function Xc(c,t,e,s,i,n){let r=s,o=s+i-1;const a=n.pos,l=n.axis*2;for(;;){for(;r<=o&&e[r*6+l]<a;)r++;for(;r<=o&&e[o*6+l]>=a;)o--;if(r<o){for(let h=0;h<3;h++){let d=t[r*3+h];t[r*3+h]=t[o*3+h],t[o*3+h]=d}for(let h=0;h<6;h++){let d=e[r*6+h];e[r*6+h]=e[o*6+h],e[o*6+h]=d}r++,o--}else return r}}function Zc(c,t,e,s,i,n){let r=s,o=s+i-1;const a=n.pos,l=n.axis*2;for(;;){for(;r<=o&&e[r*6+l]<a;)r++;for(;r<=o&&e[o*6+l]>=a;)o--;if(r<o){let h=c[r];c[r]=c[o],c[o]=h;for(let d=0;d<6;d++){let u=e[r*6+d];e[r*6+d]=e[o*6+d],e[o*6+d]=u}r++,o--}else return r}}function $c(c,t){const e=(c.index?c.index.count:c.attributes.position.count)/3,s=e>2**16,i=s?4:2,n=t?new SharedArrayBuffer(e*i):new ArrayBuffer(e*i),r=s?new Uint32Array(n):new Uint16Array(n);for(let o=0,a=r.length;o<a;o++)r[o]=o;return r}function jc(c,t){const e=c.geometry,s=e.index?e.index.array:null,i=t.maxDepth,n=t.verbose,r=t.maxLeafTris,o=t.strategy,a=t.onProgress,l=Ts(e),h=c._indirectBuffer;let d=!1;const u=new Float32Array(6),f=new Float32Array(6),I=Gc(e,u),E=t.indirect?Zc:Xc,m=[],C=t.indirect?vo(e):Do(e);if(C.length===1){const T=C[0],F=new ni;F.boundingData=u,zc(I,T.offset,T.count,f),S(F,T.offset,T.count,f),m.push(F)}else for(let T of C){const F=new ni;F.boundingData=new Float32Array(6),tn(I,T.offset,T.count,F.boundingData,f),S(F,T.offset,T.count,f),m.push(F)}return m;function g(T){a&&a(T/l)}function S(T,F,y,N=null,w=0){if(!d&&w>=i&&(d=!0,n&&(console.warn(`MeshBVH: Max depth of ${i} reached when generating BVH. Consider increasing maxDepth.`),console.warn(e))),y<=r||w>=i)return g(F+y),T.offset=F,T.count=y,T;const P=Hc(T.boundingData,N,I,F,y,o);if(P.axis===-1)return g(F+y),T.offset=F,T.count=y,T;const M=E(h,s,I,F,y,P);if(M===F||M===F+y)g(F+y),T.offset=F,T.count=y;else{T.splitAxis=P.axis;const x=new ni,O=F,v=M-F;T.left=x,x.boundingData=new Float32Array(6),tn(I,O,v,x.boundingData,f),S(x,O,v,f,w+1);const R=new ni,D=M,X=y-v;T.right=R,R.boundingData=new Float32Array(6),tn(I,D,X,R.boundingData,f),S(R,D,X,f,w+1)}return T}}function qc(c,t){const e=c.geometry;t.indirect&&(c._indirectBuffer=$c(e,t.useSharedArrayBuffer),Vc(e)&&!t.verbose&&console.warn('MeshBVH: Provided geometry contains groups that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),c._indirectBuffer||Bc(e,t);const s=jc(c,t);let i,n,r;const o=[],a=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let d=0;d<s.length;d++){const u=s[d];let f=l(u);const I=new a(Li*f);i=new Float32Array(I),n=new Uint32Array(I),r=new Uint16Array(I),h(0,u),o.push(I)}c._roots=o;return;function l(d){return d.count?1:1+l(d.left)+l(d.right)}function h(d,u){const f=d/4,I=d/2,E=!!u.count,m=u.boundingData;for(let C=0;C<6;C++)i[f+C]=m[C];if(E){const C=u.offset,g=u.count;return n[f+6]=C,r[I+14]=g,r[I+15]=Hi,d+Li}else{const C=u.left,g=u.right,S=u.splitAxis;let T;if(T=h(d+Li,C),T/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return n[f+6]=T/4,T=h(T,g),n[f+7]=S,T}}}class Re{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(t,e){let s=1/0,i=-1/0;for(let n=0,r=t.length;n<r;n++){const a=t[n][e];s=a<s?a:s,i=a>i?a:i}this.min=s,this.max=i}setFromPoints(t,e){let s=1/0,i=-1/0;for(let n=0,r=e.length;n<r;n++){const o=e[n],a=t.dot(o);s=a<s?a:s,i=a>i?a:i}this.min=s,this.max=i}isSeparated(t){return this.min>t.max||t.min>this.max}}Re.prototype.setFromBox=function(){const c=new B;return function(e,s){const i=s.min,n=s.max;let r=1/0,o=-1/0;for(let a=0;a<=1;a++)for(let l=0;l<=1;l++)for(let h=0;h<=1;h++){c.x=i.x*a+n.x*(1-a),c.y=i.y*l+n.y*(1-l),c.z=i.z*h+n.z*(1-h);const d=e.dot(c);r=Math.min(d,r),o=Math.max(d,o)}this.min=r,this.max=o}}();const Qc=function(){const c=new B,t=new B,e=new B;return function(i,n,r){const o=i.start,a=c,l=n.start,h=t;e.subVectors(o,l),c.subVectors(i.end,i.start),t.subVectors(n.end,n.start);const d=e.dot(h),u=h.dot(a),f=h.dot(h),I=e.dot(a),m=a.dot(a)*f-u*u;let C,g;m!==0?C=(d*u-I*f)/m:C=0,g=(d+C*u)/f,r.x=C,r.y=g}}(),cr=function(){const c=new Wt,t=new B,e=new B;return function(i,n,r,o){Qc(i,n,c);let a=c.x,l=c.y;if(a>=0&&a<=1&&l>=0&&l<=1){i.at(a,r),n.at(l,o);return}else if(a>=0&&a<=1){l<0?n.at(0,o):n.at(1,o),i.closestPointToPoint(o,!0,r);return}else if(l>=0&&l<=1){a<0?i.at(0,r):i.at(1,r),n.closestPointToPoint(r,!0,o);return}else{let h;a<0?h=i.start:h=i.end;let d;l<0?d=n.start:d=n.end;const u=t,f=e;if(i.closestPointToPoint(d,!0,t),n.closestPointToPoint(h,!0,e),u.distanceToSquared(d)<=f.distanceToSquared(h)){r.copy(u),o.copy(d);return}else{r.copy(h),o.copy(f);return}}}}(),Kc=function(){const c=new B,t=new B,e=new We,s=new Jt;return function(n,r){const{radius:o,center:a}=n,{a:l,b:h,c:d}=r;if(s.start=l,s.end=h,s.closestPointToPoint(a,!0,c).distanceTo(a)<=o||(s.start=l,s.end=d,s.closestPointToPoint(a,!0,c).distanceTo(a)<=o)||(s.start=h,s.end=d,s.closestPointToPoint(a,!0,c).distanceTo(a)<=o))return!0;const E=r.getPlane(e);if(Math.abs(E.distanceToPoint(a))<=o){const C=E.projectPoint(a,t);if(r.containsPoint(C))return!0}return!1}}(),Jc=1e-15;function en(c){return Math.abs(c)<Jc}class re extends ls{constructor(...t){super(...t),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new B),this.satBounds=new Array(4).fill().map(()=>new Re),this.points=[this.a,this.b,this.c],this.sphere=new Vi,this.plane=new We,this.needsUpdate=!0}intersectsSphere(t){return Kc(t,this)}update(){const t=this.a,e=this.b,s=this.c,i=this.points,n=this.satAxes,r=this.satBounds,o=n[0],a=r[0];this.getNormal(o),a.setFromPoints(o,i);const l=n[1],h=r[1];l.subVectors(t,e),h.setFromPoints(l,i);const d=n[2],u=r[2];d.subVectors(e,s),u.setFromPoints(d,i);const f=n[3],I=r[3];f.subVectors(s,t),I.setFromPoints(f,i),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(o,t),this.needsUpdate=!1}}re.prototype.closestPointToSegment=function(){const c=new B,t=new B,e=new Jt;return function(i,n=null,r=null){const{start:o,end:a}=i,l=this.points;let h,d=1/0;for(let u=0;u<3;u++){const f=(u+1)%3;e.start.copy(l[u]),e.end.copy(l[f]),cr(e,i,c,t),h=c.distanceToSquared(t),h<d&&(d=h,n&&n.copy(c),r&&r.copy(t))}return this.closestPointToPoint(o,c),h=o.distanceToSquared(c),h<d&&(d=h,n&&n.copy(c),r&&r.copy(o)),this.closestPointToPoint(a,c),h=a.distanceToSquared(c),h<d&&(d=h,n&&n.copy(c),r&&r.copy(a)),Math.sqrt(d)}}();re.prototype.intersectsTriangle=function(){const c=new re,t=new Array(3),e=new Array(3),s=new Re,i=new Re,n=new B,r=new B,o=new B,a=new B,l=new B,h=new Jt,d=new Jt,u=new Jt,f=new B;function I(E,m,C){const g=E.points;let S=0,T=-1;for(let F=0;F<3;F++){const{start:y,end:N}=h;y.copy(g[F]),N.copy(g[(F+1)%3]),h.delta(r);const w=en(m.distanceToPoint(y));if(en(m.normal.dot(r))&&w){C.copy(h),S=2;break}const P=m.intersectLine(h,f);if(!P&&w&&f.copy(y),(P||w)&&!en(f.distanceTo(N))){if(S<=1)(S===1?C.start:C.end).copy(f),w&&(T=S);else if(S>=2){(T===1?C.start:C.end).copy(f),S=2;break}if(S++,S===2&&T===-1)break}}return S}return function(m,C=null,g=!1){this.needsUpdate&&this.update(),m.isExtendedTriangle?m.needsUpdate&&m.update():(c.copy(m),c.update(),m=c);const S=this.plane,T=m.plane;if(Math.abs(S.normal.dot(T.normal))>1-1e-10){const F=this.satBounds,y=this.satAxes;e[0]=m.a,e[1]=m.b,e[2]=m.c;for(let P=0;P<4;P++){const M=F[P],x=y[P];if(s.setFromPoints(x,e),M.isSeparated(s))return!1}const N=m.satBounds,w=m.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let P=0;P<4;P++){const M=N[P],x=w[P];if(s.setFromPoints(x,t),M.isSeparated(s))return!1}for(let P=0;P<4;P++){const M=y[P];for(let x=0;x<4;x++){const O=w[x];if(n.crossVectors(M,O),s.setFromPoints(n,t),i.setFromPoints(n,e),s.isSeparated(i))return!1}}return C&&(g||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),C.start.set(0,0,0),C.end.set(0,0,0)),!0}else{const F=I(this,T,d);if(F===1&&m.containsPoint(d.end))return C&&(C.start.copy(d.end),C.end.copy(d.end)),!0;if(F!==2)return!1;const y=I(m,S,u);if(y===1&&this.containsPoint(u.end))return C&&(C.start.copy(u.end),C.end.copy(u.end)),!0;if(y!==2)return!1;if(d.delta(o),u.delta(a),o.dot(a)<0){let v=u.start;u.start=u.end,u.end=v}const N=d.start.dot(o),w=d.end.dot(o),P=u.start.dot(o),M=u.end.dot(o),x=w<P,O=N<M;return N!==M&&P!==w&&x===O?!1:(C&&(l.subVectors(d.start,u.start),l.dot(o)>0?C.start.copy(d.start):C.start.copy(u.start),l.subVectors(d.end,u.end),l.dot(o)<0?C.end.copy(d.end):C.end.copy(u.end)),!0)}}}();re.prototype.distanceToPoint=function(){const c=new B;return function(e){return this.closestPointToPoint(e,c),e.distanceTo(c)}}();re.prototype.distanceToTriangle=function(){const c=new B,t=new B,e=["a","b","c"],s=new Jt,i=new Jt;return function(r,o=null,a=null){const l=o||a?s:null;if(this.intersectsTriangle(r,l))return(o||a)&&(o&&l.getCenter(o),a&&l.getCenter(a)),0;let h=1/0;for(let d=0;d<3;d++){let u;const f=e[d],I=r[f];this.closestPointToPoint(I,c),u=I.distanceToSquared(c),u<h&&(h=u,o&&o.copy(c),a&&a.copy(I));const E=this[f];r.closestPointToPoint(E,c),u=E.distanceToSquared(c),u<h&&(h=u,o&&o.copy(E),a&&a.copy(c))}for(let d=0;d<3;d++){const u=e[d],f=e[(d+1)%3];s.set(this[u],this[f]);for(let I=0;I<3;I++){const E=e[I],m=e[(I+1)%3];i.set(r[E],r[m]),cr(s,i,c,t);const C=c.distanceToSquared(t);C<h&&(h=C,o&&o.copy(c),a&&a.copy(t))}}return Math.sqrt(h)}}();class zt{constructor(t,e,s){this.isOrientedBox=!0,this.min=new B,this.max=new B,this.matrix=new ft,this.invMatrix=new ft,this.points=new Array(8).fill().map(()=>new B),this.satAxes=new Array(3).fill().map(()=>new B),this.satBounds=new Array(3).fill().map(()=>new Re),this.alignedSatBounds=new Array(3).fill().map(()=>new Re),this.needsUpdate=!1,t&&this.min.copy(t),e&&this.max.copy(e),s&&this.matrix.copy(s)}set(t,e,s){this.min.copy(t),this.max.copy(e),this.matrix.copy(s),this.needsUpdate=!0}copy(t){this.min.copy(t.min),this.max.copy(t.max),this.matrix.copy(t.matrix),this.needsUpdate=!0}}zt.prototype.update=function(){return function(){const t=this.matrix,e=this.min,s=this.max,i=this.points;for(let l=0;l<=1;l++)for(let h=0;h<=1;h++)for(let d=0;d<=1;d++){const u=1*l|2*h|4*d,f=i[u];f.x=l?s.x:e.x,f.y=h?s.y:e.y,f.z=d?s.z:e.z,f.applyMatrix4(t)}const n=this.satBounds,r=this.satAxes,o=i[0];for(let l=0;l<3;l++){const h=r[l],d=n[l],u=1<<l,f=i[u];h.subVectors(o,f),d.setFromPoints(h,i)}const a=this.alignedSatBounds;a[0].setFromPointsField(i,"x"),a[1].setFromPointsField(i,"y"),a[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();zt.prototype.intersectsBox=function(){const c=new Re;return function(e){this.needsUpdate&&this.update();const s=e.min,i=e.max,n=this.satBounds,r=this.satAxes,o=this.alignedSatBounds;if(c.min=s.x,c.max=i.x,o[0].isSeparated(c)||(c.min=s.y,c.max=i.y,o[1].isSeparated(c))||(c.min=s.z,c.max=i.z,o[2].isSeparated(c)))return!1;for(let a=0;a<3;a++){const l=r[a],h=n[a];if(c.setFromBox(l,e),h.isSeparated(c))return!1}return!0}}();zt.prototype.intersectsTriangle=function(){const c=new re,t=new Array(3),e=new Re,s=new Re,i=new B;return function(r){this.needsUpdate&&this.update(),r.isExtendedTriangle?r.needsUpdate&&r.update():(c.copy(r),c.update(),r=c);const o=this.satBounds,a=this.satAxes;t[0]=r.a,t[1]=r.b,t[2]=r.c;for(let u=0;u<3;u++){const f=o[u],I=a[u];if(e.setFromPoints(I,t),f.isSeparated(e))return!1}const l=r.satBounds,h=r.satAxes,d=this.points;for(let u=0;u<3;u++){const f=l[u],I=h[u];if(e.setFromPoints(I,d),f.isSeparated(e))return!1}for(let u=0;u<3;u++){const f=a[u];for(let I=0;I<4;I++){const E=h[I];if(i.crossVectors(f,E),e.setFromPoints(i,t),s.setFromPoints(i,d),e.isSeparated(s))return!1}}return!0}}();zt.prototype.closestPointToPoint=function(){return function(t,e){return this.needsUpdate&&this.update(),e.copy(t).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),e}}();zt.prototype.distanceToPoint=function(){const c=new B;return function(e){return this.closestPointToPoint(e,c),e.distanceTo(c)}}();zt.prototype.distanceToBox=function(){const c=["x","y","z"],t=new Array(12).fill().map(()=>new Jt),e=new Array(12).fill().map(()=>new Jt),s=new B,i=new B;return function(r,o=0,a=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(r))return(a||l)&&(r.getCenter(i),this.closestPointToPoint(i,s),r.closestPointToPoint(s,i),a&&a.copy(s),l&&l.copy(i)),0;const h=o*o,d=r.min,u=r.max,f=this.points;let I=1/0;for(let m=0;m<8;m++){const C=f[m];i.copy(C).clamp(d,u);const g=C.distanceToSquared(i);if(g<I&&(I=g,a&&a.copy(C),l&&l.copy(i),g<h))return Math.sqrt(g)}let E=0;for(let m=0;m<3;m++)for(let C=0;C<=1;C++)for(let g=0;g<=1;g++){const S=(m+1)%3,T=(m+2)%3,F=C<<S|g<<T,y=1<<m|C<<S|g<<T,N=f[F],w=f[y];t[E].set(N,w);const M=c[m],x=c[S],O=c[T],v=e[E],R=v.start,D=v.end;R[M]=d[M],R[x]=C?d[x]:u[x],R[O]=g?d[O]:u[x],D[M]=u[M],D[x]=C?d[x]:u[x],D[O]=g?d[O]:u[x],E++}for(let m=0;m<=1;m++)for(let C=0;C<=1;C++)for(let g=0;g<=1;g++){i.x=m?u.x:d.x,i.y=C?u.y:d.y,i.z=g?u.z:d.z,this.closestPointToPoint(i,s);const S=i.distanceToSquared(s);if(S<I&&(I=S,a&&a.copy(s),l&&l.copy(i),S<h))return Math.sqrt(S)}for(let m=0;m<12;m++){const C=t[m];for(let g=0;g<12;g++){const S=e[g];cr(C,S,s,i);const T=s.distanceToSquared(i);if(T<I&&(I=T,a&&a.copy(s),l&&l.copy(i),T<h))return Math.sqrt(T)}}return Math.sqrt(I)}}();class lr{constructor(t){this._getNewPrimitive=t,this._primitives=[]}getPrimitive(){const t=this._primitives;return t.length===0?this._getNewPrimitive():t.pop()}releasePrimitive(t){this._primitives.push(t)}}class tl extends lr{constructor(){super(()=>new re)}}const jt=new tl;function kt(c,t){return t[c+15]===65535}function Ht(c,t){return t[c+6]}function qt(c,t){return t[c+14]}function Qt(c){return c+8}function Kt(c,t){return t[c+6]}function bo(c,t){return t[c+7]}class el{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;const t=[];let e=null;this.setBuffer=s=>{e&&t.push(e),e=s,this.float32Array=new Float32Array(s),this.uint16Array=new Uint16Array(s),this.uint32Array=new Uint32Array(s)},this.clearBuffer=()=>{e=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,t.length!==0&&this.setBuffer(t.pop())}}}const At=new el;let Le,hs;const je=[],ri=new lr(()=>new vt);function sl(c,t,e,s,i,n){Le=ri.getPrimitive(),hs=ri.getPrimitive(),je.push(Le,hs),At.setBuffer(c._roots[t]);const r=Rn(0,c.geometry,e,s,i,n);At.clearBuffer(),ri.releasePrimitive(Le),ri.releasePrimitive(hs),je.pop(),je.pop();const o=je.length;return o>0&&(hs=je[o-1],Le=je[o-2]),r}function Rn(c,t,e,s,i=null,n=0,r=0){const{float32Array:o,uint16Array:a,uint32Array:l}=At;let h=c*2;if(kt(h,a)){const u=Ht(c,l),f=qt(h,a);return Ot(c,o,Le),s(u,f,!1,r,n+c,Le)}else{let u=function(O){const{uint16Array:v,uint32Array:R}=At;let D=O*2;for(;!kt(D,v);)O=Qt(O),D=O*2;return Ht(O,R)},f=function(O){const{uint16Array:v,uint32Array:R}=At;let D=O*2;for(;!kt(D,v);)O=Kt(O,R),D=O*2;return Ht(O,R)+qt(D,v)};const I=Qt(c),E=Kt(c,l);let m=I,C=E,g,S,T,F;if(i&&(T=Le,F=hs,Ot(m,o,T),Ot(C,o,F),g=i(T),S=i(F),S<g)){m=E,C=I;const O=g;g=S,S=O,T=F}T||(T=Le,Ot(m,o,T));const y=kt(m*2,a),N=e(T,y,g,r+1,n+m);let w;if(N===Lr){const O=u(m),R=f(m)-O;w=s(O,R,!0,r+1,n+m,T)}else w=N&&Rn(m,t,e,s,i,n,r+1);if(w)return!0;F=hs,Ot(C,o,F);const P=kt(C*2,a),M=e(F,P,S,r+1,n+C);let x;if(M===Lr){const O=u(C),R=f(C)-O;x=s(O,R,!0,r+1,n+C,F)}else x=M&&Rn(C,t,e,s,i,n,r+1);return!!x}}const Ss=new B,sn=new B;function il(c,t,e={},s=0,i=1/0){const n=s*s,r=i*i;let o=1/0,a=null;if(c.shapecast({boundsTraverseOrder:h=>(Ss.copy(t).clamp(h.min,h.max),Ss.distanceToSquared(t)),intersectsBounds:(h,d,u)=>u<o&&u<r,intersectsTriangle:(h,d)=>{h.closestPointToPoint(t,Ss);const u=t.distanceToSquared(Ss);return u<o&&(sn.copy(Ss),o=u,a=d),u<n}}),o===1/0)return null;const l=Math.sqrt(o);return e.point?e.point.copy(sn):e.point=sn.clone(),e.distance=l,e.faceIndex=a,e}const qe=new B,Qe=new B,Ke=new B,oi=new Wt,ai=new Wt,ci=new Wt,br=new B,xr=new B,Ur=new B,li=new B;function nl(c,t,e,s,i,n){let r;return n===Lc?r=c.intersectTriangle(s,e,t,!0,i):r=c.intersectTriangle(t,e,s,n!==qs,i),r===null?null:{distance:c.origin.distanceTo(i),point:i.clone()}}function rl(c,t,e,s,i,n,r,o,a){qe.fromBufferAttribute(t,n),Qe.fromBufferAttribute(t,r),Ke.fromBufferAttribute(t,o);const l=nl(c,qe,Qe,Ke,li,a);if(l){s&&(oi.fromBufferAttribute(s,n),ai.fromBufferAttribute(s,r),ci.fromBufferAttribute(s,o),l.uv=ls.getInterpolation(li,qe,Qe,Ke,oi,ai,ci,new Wt)),i&&(oi.fromBufferAttribute(i,n),ai.fromBufferAttribute(i,r),ci.fromBufferAttribute(i,o),l.uv1=ls.getInterpolation(li,qe,Qe,Ke,oi,ai,ci,new Wt)),e&&(br.fromBufferAttribute(e,n),xr.fromBufferAttribute(e,r),Ur.fromBufferAttribute(e,o),l.normal=ls.getInterpolation(li,qe,Qe,Ke,br,xr,Ur,new B),l.normal.dot(c.direction)>0&&l.normal.multiplyScalar(-1));const h={a:n,b:r,c:o,normal:new B,materialIndex:0};ls.getNormal(qe,Qe,Ke,h.normal),l.face=h,l.faceIndex=n}return l}function Wi(c,t,e,s,i){const n=s*3;let r=n+0,o=n+1,a=n+2;const l=c.index;c.index&&(r=l.getX(r),o=l.getX(o),a=l.getX(a));const{position:h,normal:d,uv:u,uv1:f}=c.attributes,I=rl(e,h,d,u,f,r,o,a,t);return I?(I.faceIndex=s,i&&i.push(I),I):null}function wt(c,t,e,s){const i=c.a,n=c.b,r=c.c;let o=t,a=t+1,l=t+2;e&&(o=e.getX(o),a=e.getX(a),l=e.getX(l)),i.x=s.getX(o),i.y=s.getY(o),i.z=s.getZ(o),n.x=s.getX(a),n.y=s.getY(a),n.z=s.getZ(a),r.x=s.getX(l),r.y=s.getY(l),r.z=s.getZ(l)}function ol(c,t,e,s,i,n){const{geometry:r,_indirectBuffer:o}=c;for(let a=s,l=s+i;a<l;a++)Wi(r,t,e,a,n)}function al(c,t,e,s,i){const{geometry:n,_indirectBuffer:r}=c;let o=1/0,a=null;for(let l=s,h=s+i;l<h;l++){let d;d=Wi(n,t,e,l),d&&d.distance<o&&(a=d,o=d.distance)}return a}function cl(c,t,e,s,i,n,r){const{geometry:o}=e,{index:a}=o,l=o.attributes.position;for(let h=c,d=t+c;h<d;h++){let u;if(u=h,wt(r,u*3,a,l),r.needsUpdate=!0,s(r,u,i,n))return!0}return!1}function ll(c,t=null){t&&Array.isArray(t)&&(t=new Set(t));const e=c.geometry,s=e.index?e.index.array:null,i=e.attributes.position;let n,r,o,a,l=0;const h=c._roots;for(let u=0,f=h.length;u<f;u++)n=h[u],r=new Uint32Array(n),o=new Uint16Array(n),a=new Float32Array(n),d(0,l),l+=n.byteLength;function d(u,f,I=!1){const E=u*2;if(o[E+15]===Hi){const C=r[u+6],g=o[E+14];let S=1/0,T=1/0,F=1/0,y=-1/0,N=-1/0,w=-1/0;for(let P=3*C,M=3*(C+g);P<M;P++){let x=s[P];const O=i.getX(x),v=i.getY(x),R=i.getZ(x);O<S&&(S=O),O>y&&(y=O),v<T&&(T=v),v>N&&(N=v),R<F&&(F=R),R>w&&(w=R)}return a[u+0]!==S||a[u+1]!==T||a[u+2]!==F||a[u+3]!==y||a[u+4]!==N||a[u+5]!==w?(a[u+0]=S,a[u+1]=T,a[u+2]=F,a[u+3]=y,a[u+4]=N,a[u+5]=w,!0):!1}else{const C=u+8,g=r[u+6],S=C+f,T=g+f;let F=I,y=!1,N=!1;t?F||(y=t.has(S),N=t.has(T),F=!y&&!N):(y=!0,N=!0);const w=F||y,P=F||N;let M=!1;w&&(M=d(C,f,F));let x=!1;P&&(x=d(g,f,F));const O=M||x;if(O)for(let v=0;v<3;v++){const R=C+v,D=g+v,X=a[R],U=a[R+3],j=a[D],k=a[D+3];a[u+v]=X<j?X:j,a[u+v+3]=U>k?U:k}return O}}}const Br=new vt;function De(c,t,e,s){return Ot(c,t,Br),e.intersectBox(Br,s)}function hl(c,t,e,s,i,n){const{geometry:r,_indirectBuffer:o}=c;for(let a=s,l=s+i;a<l;a++){let h=o?o[a]:a;Wi(r,t,e,h,n)}}function ul(c,t,e,s,i){const{geometry:n,_indirectBuffer:r}=c;let o=1/0,a=null;for(let l=s,h=s+i;l<h;l++){let d;d=Wi(n,t,e,r?r[l]:l),d&&d.distance<o&&(a=d,o=d.distance)}return a}function fl(c,t,e,s,i,n,r){const{geometry:o}=e,{index:a}=o,l=o.attributes.position;for(let h=c,d=t+c;h<d;h++){let u;if(u=e.resolveTriangleIndex(h),wt(r,u*3,a,l),r.needsUpdate=!0,s(r,u,i,n))return!0}return!1}const Vr=new B;function dl(c,t,e,s,i){At.setBuffer(c._roots[t]),An(0,c,e,s,i),At.clearBuffer()}function An(c,t,e,s,i){const{float32Array:n,uint16Array:r,uint32Array:o}=At,a=c*2;if(kt(a,r)){const h=Ht(c,o),d=qt(a,r);ol(t,e,s,h,d,i)}else{const h=Qt(c);De(h,n,s,Vr)&&An(h,t,e,s,i);const d=Kt(c,o);De(d,n,s,Vr)&&An(d,t,e,s,i)}}const Yr=new B,Il=["x","y","z"];function El(c,t,e,s){At.setBuffer(c._roots[t]);const i=Fn(0,c,e,s);return At.clearBuffer(),i}function Fn(c,t,e,s){const{float32Array:i,uint16Array:n,uint32Array:r}=At;let o=c*2;if(kt(o,n)){const l=Ht(c,r),h=qt(o,n);return al(t,e,s,l,h)}else{const l=bo(c,r),h=Il[l],u=s.direction[h]>=0;let f,I;u?(f=Qt(c),I=Kt(c,r)):(f=Kt(c,r),I=Qt(c));const m=De(f,i,s,Yr)?Fn(f,t,e,s):null;if(m){const S=m.point[h];if(u?S<=i[I+l]:S>=i[I+l+3])return m}const g=De(I,i,s,Yr)?Fn(I,t,e,s):null;return m&&g?m.distance<=g.distance?m:g:m||g||null}}const hi=new vt,Je=new re,ts=new re,Os=new ft,zr=new zt,ui=new zt;function pl(c,t,e,s){At.setBuffer(c._roots[t]);const i=Sn(0,c,e,s);return At.clearBuffer(),i}function Sn(c,t,e,s,i=null){const{float32Array:n,uint16Array:r,uint32Array:o}=At;let a=c*2;if(i===null&&(e.boundingBox||e.computeBoundingBox(),zr.set(e.boundingBox.min,e.boundingBox.max,s),i=zr),kt(a,r)){const h=t.geometry,d=h.index,u=h.attributes.position,f=e.index,I=e.attributes.position,E=Ht(c,o),m=qt(a,r);if(Os.copy(s).invert(),e.boundsTree)return Ot(c,n,ui),ui.matrix.copy(Os),ui.needsUpdate=!0,e.boundsTree.shapecast({intersectsBounds:g=>ui.intersectsBox(g),intersectsTriangle:g=>{g.a.applyMatrix4(s),g.b.applyMatrix4(s),g.c.applyMatrix4(s),g.needsUpdate=!0;for(let S=E*3,T=(m+E)*3;S<T;S+=3)if(wt(ts,S,d,u),ts.needsUpdate=!0,g.intersectsTriangle(ts))return!0;return!1}});for(let C=E*3,g=(m+E)*3;C<g;C+=3){wt(Je,C,d,u),Je.a.applyMatrix4(Os),Je.b.applyMatrix4(Os),Je.c.applyMatrix4(Os),Je.needsUpdate=!0;for(let S=0,T=f.count;S<T;S+=3)if(wt(ts,S,f,I),ts.needsUpdate=!0,Je.intersectsTriangle(ts))return!0}}else{const h=c+8,d=o[c+6];return Ot(h,n,hi),!!(i.intersectsBox(hi)&&Sn(h,t,e,s,i)||(Ot(d,n,hi),i.intersectsBox(hi)&&Sn(d,t,e,s,i)))}}const fi=new ft,nn=new zt,ys=new zt,Cl=new B,Tl=new B,ml=new B,gl=new B;function Rl(c,t,e,s={},i={},n=0,r=1/0){t.boundingBox||t.computeBoundingBox(),nn.set(t.boundingBox.min,t.boundingBox.max,e),nn.needsUpdate=!0;const o=c.geometry,a=o.attributes.position,l=o.index,h=t.attributes.position,d=t.index,u=jt.getPrimitive(),f=jt.getPrimitive();let I=Cl,E=Tl,m=null,C=null;i&&(m=ml,C=gl);let g=1/0,S=null,T=null;return fi.copy(e).invert(),ys.matrix.copy(fi),c.shapecast({boundsTraverseOrder:F=>nn.distanceToBox(F),intersectsBounds:(F,y,N)=>N<g&&N<r?(y&&(ys.min.copy(F.min),ys.max.copy(F.max),ys.needsUpdate=!0),!0):!1,intersectsRange:(F,y)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:w=>ys.distanceToBox(w),intersectsBounds:(w,P,M)=>M<g&&M<r,intersectsRange:(w,P)=>{for(let M=w,x=w+P;M<x;M++){wt(f,3*M,d,h),f.a.applyMatrix4(e),f.b.applyMatrix4(e),f.c.applyMatrix4(e),f.needsUpdate=!0;for(let O=F,v=F+y;O<v;O++){wt(u,3*O,l,a),u.needsUpdate=!0;const R=u.distanceToTriangle(f,I,m);if(R<g&&(E.copy(I),C&&C.copy(m),g=R,S=O,T=M),R<n)return!0}}}});{const N=Ts(t);for(let w=0,P=N;w<P;w++){wt(f,3*w,d,h),f.a.applyMatrix4(e),f.b.applyMatrix4(e),f.c.applyMatrix4(e),f.needsUpdate=!0;for(let M=F,x=F+y;M<x;M++){wt(u,3*M,l,a),u.needsUpdate=!0;const O=u.distanceToTriangle(f,I,m);if(O<g&&(E.copy(I),C&&C.copy(m),g=O,S=M,T=w),O<n)return!0}}}}}),jt.releasePrimitive(u),jt.releasePrimitive(f),g===1/0?null:(s.point?s.point.copy(E):s.point=E.clone(),s.distance=g,s.faceIndex=S,i&&(i.point?i.point.copy(C):i.point=C.clone(),i.point.applyMatrix4(fi),E.applyMatrix4(fi),i.distance=E.sub(i.point).length(),i.faceIndex=T),s)}function Al(c,t=null){t&&Array.isArray(t)&&(t=new Set(t));const e=c.geometry,s=e.index?e.index.array:null,i=e.attributes.position;let n,r,o,a,l=0;const h=c._roots;for(let u=0,f=h.length;u<f;u++)n=h[u],r=new Uint32Array(n),o=new Uint16Array(n),a=new Float32Array(n),d(0,l),l+=n.byteLength;function d(u,f,I=!1){const E=u*2;if(o[E+15]===Hi){const C=r[u+6],g=o[E+14];let S=1/0,T=1/0,F=1/0,y=-1/0,N=-1/0,w=-1/0;for(let P=C,M=C+g;P<M;P++){const x=3*c.resolveTriangleIndex(P);for(let O=0;O<3;O++){let v=x+O;v=s?s[v]:v;const R=i.getX(v),D=i.getY(v),X=i.getZ(v);R<S&&(S=R),R>y&&(y=R),D<T&&(T=D),D>N&&(N=D),X<F&&(F=X),X>w&&(w=X)}}return a[u+0]!==S||a[u+1]!==T||a[u+2]!==F||a[u+3]!==y||a[u+4]!==N||a[u+5]!==w?(a[u+0]=S,a[u+1]=T,a[u+2]=F,a[u+3]=y,a[u+4]=N,a[u+5]=w,!0):!1}else{const C=u+8,g=r[u+6],S=C+f,T=g+f;let F=I,y=!1,N=!1;t?F||(y=t.has(S),N=t.has(T),F=!y&&!N):(y=!0,N=!0);const w=F||y,P=F||N;let M=!1;w&&(M=d(C,f,F));let x=!1;P&&(x=d(g,f,F));const O=M||x;if(O)for(let v=0;v<3;v++){const R=C+v,D=g+v,X=a[R],U=a[R+3],j=a[D],k=a[D+3];a[u+v]=X<j?X:j,a[u+v+3]=U>k?U:k}return O}}}const Gr=new B;function Fl(c,t,e,s,i){At.setBuffer(c._roots[t]),On(0,c,e,s,i),At.clearBuffer()}function On(c,t,e,s,i){const{float32Array:n,uint16Array:r,uint32Array:o}=At,a=c*2;if(kt(a,r)){const h=Ht(c,o),d=qt(a,r);hl(t,e,s,h,d,i)}else{const h=Qt(c);De(h,n,s,Gr)&&On(h,t,e,s,i);const d=Kt(c,o);De(d,n,s,Gr)&&On(d,t,e,s,i)}}const kr=new B,Sl=["x","y","z"];function Ol(c,t,e,s){At.setBuffer(c._roots[t]);const i=yn(0,c,e,s);return At.clearBuffer(),i}function yn(c,t,e,s){const{float32Array:i,uint16Array:n,uint32Array:r}=At;let o=c*2;if(kt(o,n)){const l=Ht(c,r),h=qt(o,n);return ul(t,e,s,l,h)}else{const l=bo(c,r),h=Sl[l],u=s.direction[h]>=0;let f,I;u?(f=Qt(c),I=Kt(c,r)):(f=Kt(c,r),I=Qt(c));const m=De(f,i,s,kr)?yn(f,t,e,s):null;if(m){const S=m.point[h];if(u?S<=i[I+l]:S>=i[I+l+3])return m}const g=De(I,i,s,kr)?yn(I,t,e,s):null;return m&&g?m.distance<=g.distance?m:g:m||g||null}}const di=new vt,es=new re,ss=new re,Ns=new ft,Hr=new zt,Ii=new zt;function yl(c,t,e,s){At.setBuffer(c._roots[t]);const i=Nn(0,c,e,s);return At.clearBuffer(),i}function Nn(c,t,e,s,i=null){const{float32Array:n,uint16Array:r,uint32Array:o}=At;let a=c*2;if(i===null&&(e.boundingBox||e.computeBoundingBox(),Hr.set(e.boundingBox.min,e.boundingBox.max,s),i=Hr),kt(a,r)){const h=t.geometry,d=h.index,u=h.attributes.position,f=e.index,I=e.attributes.position,E=Ht(c,o),m=qt(a,r);if(Ns.copy(s).invert(),e.boundsTree)return Ot(c,n,Ii),Ii.matrix.copy(Ns),Ii.needsUpdate=!0,e.boundsTree.shapecast({intersectsBounds:g=>Ii.intersectsBox(g),intersectsTriangle:g=>{g.a.applyMatrix4(s),g.b.applyMatrix4(s),g.c.applyMatrix4(s),g.needsUpdate=!0;for(let S=E,T=m+E;S<T;S++)if(wt(ss,3*t.resolveTriangleIndex(S),d,u),ss.needsUpdate=!0,g.intersectsTriangle(ss))return!0;return!1}});for(let C=E,g=m+E;C<g;C++){const S=t.resolveTriangleIndex(C);wt(es,3*S,d,u),es.a.applyMatrix4(Ns),es.b.applyMatrix4(Ns),es.c.applyMatrix4(Ns),es.needsUpdate=!0;for(let T=0,F=f.count;T<F;T+=3)if(wt(ss,T,f,I),ss.needsUpdate=!0,es.intersectsTriangle(ss))return!0}}else{const h=c+8,d=o[c+6];return Ot(h,n,di),!!(i.intersectsBox(di)&&Nn(h,t,e,s,i)||(Ot(d,n,di),i.intersectsBox(di)&&Nn(d,t,e,s,i)))}}const Ei=new ft,rn=new zt,_s=new zt,Nl=new B,_l=new B,Pl=new B,Ll=new B;function wl(c,t,e,s={},i={},n=0,r=1/0){t.boundingBox||t.computeBoundingBox(),rn.set(t.boundingBox.min,t.boundingBox.max,e),rn.needsUpdate=!0;const o=c.geometry,a=o.attributes.position,l=o.index,h=t.attributes.position,d=t.index,u=jt.getPrimitive(),f=jt.getPrimitive();let I=Nl,E=_l,m=null,C=null;i&&(m=Pl,C=Ll);let g=1/0,S=null,T=null;return Ei.copy(e).invert(),_s.matrix.copy(Ei),c.shapecast({boundsTraverseOrder:F=>rn.distanceToBox(F),intersectsBounds:(F,y,N)=>N<g&&N<r?(y&&(_s.min.copy(F.min),_s.max.copy(F.max),_s.needsUpdate=!0),!0):!1,intersectsRange:(F,y)=>{if(t.boundsTree){const N=t.boundsTree;return N.shapecast({boundsTraverseOrder:w=>_s.distanceToBox(w),intersectsBounds:(w,P,M)=>M<g&&M<r,intersectsRange:(w,P)=>{for(let M=w,x=w+P;M<x;M++){const O=N.resolveTriangleIndex(M);wt(f,3*O,d,h),f.a.applyMatrix4(e),f.b.applyMatrix4(e),f.c.applyMatrix4(e),f.needsUpdate=!0;for(let v=F,R=F+y;v<R;v++){const D=c.resolveTriangleIndex(v);wt(u,3*D,l,a),u.needsUpdate=!0;const X=u.distanceToTriangle(f,I,m);if(X<g&&(E.copy(I),C&&C.copy(m),g=X,S=v,T=M),X<n)return!0}}}})}else{const N=Ts(t);for(let w=0,P=N;w<P;w++){wt(f,3*w,d,h),f.a.applyMatrix4(e),f.b.applyMatrix4(e),f.c.applyMatrix4(e),f.needsUpdate=!0;for(let M=F,x=F+y;M<x;M++){const O=c.resolveTriangleIndex(M);wt(u,3*O,l,a),u.needsUpdate=!0;const v=u.distanceToTriangle(f,I,m);if(v<g&&(E.copy(I),C&&C.copy(m),g=v,S=M,T=w),v<n)return!0}}}}}),jt.releasePrimitive(u),jt.releasePrimitive(f),g===1/0?null:(s.point?s.point.copy(E):s.point=E.clone(),s.distance=g,s.faceIndex=S,i&&(i.point?i.point.copy(C):i.point=C.clone(),i.point.applyMatrix4(Ei),E.applyMatrix4(Ei),i.distance=E.sub(i.point).length(),i.faceIndex=T),s)}function Ml(){return typeof SharedArrayBuffer<"u"}const Gs=new At.constructor,Ui=new At.constructor,Pe=new lr(()=>new vt),is=new vt,ns=new vt,on=new vt,an=new vt;let cn=!1;function vl(c,t,e,s){if(cn)throw new Error("MeshBVH: Recursive calls to bvhcast not supported.");cn=!0;const i=c._roots,n=t._roots;let r,o=0,a=0;const l=new ft().copy(e).invert();for(let h=0,d=i.length;h<d;h++){Gs.setBuffer(i[h]),a=0;const u=Pe.getPrimitive();Ot(0,Gs.float32Array,u),u.applyMatrix4(l);for(let f=0,I=n.length;f<I&&(Ui.setBuffer(n[h]),r=ee(0,0,e,l,s,o,a,0,0,u),Ui.clearBuffer(),a+=n[f].length,!r);f++);if(Pe.releasePrimitive(u),Gs.clearBuffer(),o+=i[h].length,r)break}return cn=!1,r}function ee(c,t,e,s,i,n=0,r=0,o=0,a=0,l=null,h=!1){let d,u;h?(d=Ui,u=Gs):(d=Gs,u=Ui);const f=d.float32Array,I=d.uint32Array,E=d.uint16Array,m=u.float32Array,C=u.uint32Array,g=u.uint16Array,S=c*2,T=t*2,F=kt(S,E),y=kt(T,g);let N=!1;if(y&&F)h?N=i(Ht(t,C),qt(t*2,g),Ht(c,I),qt(c*2,E),a,r+t,o,n+c):N=i(Ht(c,I),qt(c*2,E),Ht(t,C),qt(t*2,g),o,n+c,a,r+t);else if(y){const w=Pe.getPrimitive();Ot(t,m,w),w.applyMatrix4(e);const P=Qt(c),M=Kt(c,I);Ot(P,f,is),Ot(M,f,ns);const x=w.intersectsBox(is),O=w.intersectsBox(ns);N=x&&ee(t,P,s,e,i,r,n,a,o+1,w,!h)||O&&ee(t,M,s,e,i,r,n,a,o+1,w,!h),Pe.releasePrimitive(w)}else{const w=Qt(t),P=Kt(t,C);Ot(w,m,on),Ot(P,m,an);const M=l.intersectsBox(on),x=l.intersectsBox(an);if(M&&x)N=ee(c,w,e,s,i,n,r,o,a+1,l,h)||ee(c,P,e,s,i,n,r,o,a+1,l,h);else if(M)if(F)N=ee(c,w,e,s,i,n,r,o,a+1,l,h);else{const O=Pe.getPrimitive();O.copy(on).applyMatrix4(e);const v=Qt(c),R=Kt(c,I);Ot(v,f,is),Ot(R,f,ns);const D=O.intersectsBox(is),X=O.intersectsBox(ns);N=D&&ee(w,v,s,e,i,r,n,a,o+1,O,!h)||X&&ee(w,R,s,e,i,r,n,a,o+1,O,!h),Pe.releasePrimitive(O)}else if(x)if(F)N=ee(c,P,e,s,i,n,r,o,a+1,l,h);else{const O=Pe.getPrimitive();O.copy(an).applyMatrix4(e);const v=Qt(c),R=Kt(c,I);Ot(v,f,is),Ot(R,f,ns);const D=O.intersectsBox(is),X=O.intersectsBox(ns);N=D&&ee(P,v,s,e,i,r,n,a,o+1,O,!h)||X&&ee(P,R,s,e,i,r,n,a,o+1,O,!h),Pe.releasePrimitive(O)}}return N}const pi=new zt,Wr=new vt;class hr{static serialize(t,e={}){e={cloneBuffers:!0,...e};const s=t.geometry,i=t._roots,n=t._indirectBuffer,r=s.getIndex();let o;return e.cloneBuffers?o={roots:i.map(a=>a.slice()),index:r.array.slice(),indirectBuffer:n?n.slice():null}:o={roots:i,index:r.array,indirectBuffer:n},o}static deserialize(t,e,s={}){s={setIndex:!0,indirect:!!t.indirectBuffer,...s};const{index:i,roots:n,indirectBuffer:r}=t,o=new hr(e,{...s,[Ji]:!0});if(o._roots=n,o._indirectBuffer=r||null,s.setIndex){const a=e.getIndex();if(a===null){const l=new Ws(t.index,1,!1);e.setIndex(l)}else a.array!==i&&(a.array.set(i),a.needsUpdate=!0)}return o}get indirect(){return!!this._indirectBuffer}constructor(t,e={}){if(t.isBufferGeometry){if(t.index&&t.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e=Object.assign({strategy:Mo,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,[Ji]:!1},e),e.useSharedArrayBuffer&&!Ml())throw new Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=t,this._roots=null,this._indirectBuffer=null,e[Ji]||(qc(this,e),!t.boundingBox&&e.setBoundingBox&&(t.boundingBox=this.getBoundingBox(new vt)));const{_indirectBuffer:s}=this;this.resolveTriangleIndex=e.indirect?i=>s[i]:i=>i}refit(t=null){return(this.indirect?Al:ll)(this,t)}traverse(t,e=0){const s=this._roots[e],i=new Uint32Array(s),n=new Uint16Array(s);r(0);function r(o,a=0){const l=o*2,h=n[l+15]===Hi;if(h){const d=i[o+6],u=n[l+14];t(a,h,new Float32Array(s,o*4,6),d,u)}else{const d=o+Li/4,u=i[o+6],f=i[o+7];t(a,h,new Float32Array(s,o*4,6),f)||(r(d,a+1),r(u,a+1))}}}raycast(t,e=_r){const s=this._roots,i=this.geometry,n=[],r=e.isMaterial,o=Array.isArray(e),a=i.groups,l=r?e.side:e,h=this.indirect?Fl:dl;for(let d=0,u=s.length;d<u;d++){const f=o?e[a[d].materialIndex].side:l,I=n.length;if(h(this,d,f,t,n),o){const E=a[d].materialIndex;for(let m=I,C=n.length;m<C;m++)n[m].face.materialIndex=E}}return n}raycastFirst(t,e=_r){const s=this._roots,i=this.geometry,n=e.isMaterial,r=Array.isArray(e);let o=null;const a=i.groups,l=n?e.side:e,h=this.indirect?Ol:El;for(let d=0,u=s.length;d<u;d++){const f=r?e[a[d].materialIndex].side:l,I=h(this,d,f,t);I!=null&&(o==null||I.distance<o.distance)&&(o=I,r&&(I.face.materialIndex=a[d].materialIndex))}return o}intersectsGeometry(t,e){let s=!1;const i=this._roots,n=this.indirect?yl:pl;for(let r=0,o=i.length;r<o&&(s=n(this,r,t,e),!s);r++);return s}shapecast(t){const e=jt.getPrimitive(),s=this.indirect?fl:cl;let{boundsTraverseOrder:i,intersectsBounds:n,intersectsRange:r,intersectsTriangle:o}=t;if(r&&o){const d=r;r=(u,f,I,E,m)=>d(u,f,I,E,m)?!0:s(u,f,this,o,I,E,e)}else r||(o?r=(d,u,f,I)=>s(d,u,this,o,f,I,e):r=(d,u,f)=>f);let a=!1,l=0;const h=this._roots;for(let d=0,u=h.length;d<u;d++){const f=h[d];if(a=sl(this,d,n,r,i,l),a)break;l+=f.byteLength}return jt.releasePrimitive(e),a}bvhcast(t,e,s){let{intersectsRanges:i,intersectsTriangles:n}=s;const r=jt.getPrimitive(),o=this.geometry.index,a=this.geometry.attributes.position,l=this.indirect?I=>{const E=this.resolveTriangleIndex(I);wt(r,E*3,o,a)}:I=>{wt(r,I*3,o,a)},h=jt.getPrimitive(),d=t.geometry.index,u=t.geometry.attributes.position,f=t.indirect?I=>{const E=t.resolveTriangleIndex(I);wt(h,E*3,d,u)}:I=>{wt(h,I*3,d,u)};if(n){const I=(E,m,C,g,S,T,F,y)=>{for(let N=C,w=C+g;N<w;N++){f(N),h.a.applyMatrix4(e),h.b.applyMatrix4(e),h.c.applyMatrix4(e),h.needsUpdate=!0;for(let P=E,M=E+m;P<M;P++)if(l(P),r.needsUpdate=!0,n(r,h,P,N,S,T,F,y))return!0}return!1};if(i){const E=i;i=function(m,C,g,S,T,F,y,N){return E(m,C,g,S,T,F,y,N)?!0:I(m,C,g,S,T,F,y,N)}}else i=I}return vl(this,t,e,i)}intersectsBox(t,e){return pi.set(t.min,t.max,e),pi.needsUpdate=!0,this.shapecast({intersectsBounds:s=>pi.intersectsBox(s),intersectsTriangle:s=>pi.intersectsTriangle(s)})}intersectsSphere(t){return this.shapecast({intersectsBounds:e=>t.intersectsBox(e),intersectsTriangle:e=>e.intersectsSphere(t)})}closestPointToGeometry(t,e,s={},i={},n=0,r=1/0){return(this.indirect?wl:Rl)(this,t,e,s,i,n,r)}closestPointToPoint(t,e={},s=0,i=1/0){return il(this,t,e,s,i)}getBoundingBox(t){return t.makeEmpty(),this._roots.forEach(s=>{Ot(0,new Float32Array(s),Wr),t.union(Wr)}),t}}function Xr(c,t,e){return c===null||(c.point.applyMatrix4(t.matrixWorld),c.distance=c.point.distanceTo(e.ray.origin),c.object=t,c.distance<e.near||c.distance>e.far)?null:c}const ln=new Ac,Zr=new ft,Dl=st.prototype.raycast;function bl(c,t){if(this.geometry.boundsTree){if(this.material===void 0)return;Zr.copy(this.matrixWorld).invert(),ln.copy(c.ray).applyMatrix4(Zr);const e=this.geometry.boundsTree;if(c.firstHitOnly===!0){const s=Xr(e.raycastFirst(ln,this.material),this,c);s&&t.push(s)}else{const s=e.raycast(ln,this.material);for(let i=0,n=s.length;i<n;i++){const r=Xr(s[i],this,c);r&&t.push(r)}}}else Dl.call(this,c,t)}function xl(c){return this.boundsTree=new hr(this,c),this.boundsTree}function Ul(){this.boundsTree=null}class q{constructor(){p(this,"enabled",!0),p(this,"trigger",t=>{if(!this.enabled)return;const e=this.handlers.slice(0);for(const s of e)s(t)}),p(this,"handlers",[])}add(t){this.handlers.push(t)}remove(t){this.handlers=this.handlers.filter(e=>e!==t)}reset(){this.handlers.length=0}}class we{constructor(){p(this,"enabled",!0),p(this,"trigger",async t=>{if(!this.enabled)return;const e=this.handlers.slice(0);for(const s of e)await s(t)}),p(this,"handlers",[])}add(t){this.handlers.push(t)}remove(t){this.handlers=this.handlers.filter(e=>e!==t)}reset(){this.handlers.length=0}}class ur{constructor(t){p(this,"isDisposeable",()=>"dispose"in this&&"onDisposed"in this),p(this,"isResizeable",()=>"resize"in this&&"getSize"in this),p(this,"isUpdateable",()=>"onAfterUpdate"in this&&"onBeforeUpdate"in this&&"update"in this),p(this,"isHideable",()=>"visible"in this),p(this,"isConfigurable",()=>"setup"in this&&"config"in this&&"onSetup"in this),this.components=t}}class Rt extends ur{}class fr extends ur{constructor(t){super(t),p(this,"worlds",new Map),p(this,"onWorldChanged",new q),p(this,"currentWorld",null),this.onWorldChanged.add(({world:e,action:s})=>{s==="removed"&&this.worlds.delete(e.uuid)})}}class Bl extends fr{constructor(){super(...arguments),p(this,"hasCameraControls",()=>"controls"in this)}}class Vl extends fr{constructor(){super(...arguments),p(this,"onAfterUpdate",new q),p(this,"onBeforeUpdate",new q),p(this,"onDisposed",new q),p(this,"onResize",new q),p(this,"onClippingPlanesUpdated",new q),p(this,"clippingPlanes",[])}updateClippingPlanes(){this.onClippingPlanesUpdated.trigger()}setPlane(t,e,s){e.isLocal=s;const i=this.clippingPlanes.indexOf(e);t&&i===-1?this.clippingPlanes.push(e):!t&&i>-1&&this.clippingPlanes.splice(i,1),this.three.clippingPlanes=this.clippingPlanes.filter(n=>!n.isLocal)}}const xo=class _n extends Rt{constructor(t){super(t),p(this,"_disposedComponents",new Set),p(this,"enabled",!0),t.add(_n.uuid,this)}get(){return this._disposedComponents}destroy(t,e=!0,s=!0){t.removeFromParent();const i=t;i.dispose&&i.dispose(),this.disposeGeometryAndMaterials(t,e),s&&i.children&&i.children.length&&this.disposeChildren(i),t.children.length=0}disposeGeometry(t){t.boundsTree&&t.disposeBoundsTree&&t.disposeBoundsTree(),t.dispose()}disposeGeometryAndMaterials(t,e){const s=t;s.geometry&&this.disposeGeometry(s.geometry),e&&s.material&&_n.disposeMaterial(s),s.material=[],s.geometry=null}disposeChildren(t){for(const e of t.children)this.destroy(e)}static disposeMaterial(t){if(t.material)if(Array.isArray(t.material))for(const e of t.material)e.dispose();else t.material.dispose()}};p(xo,"uuid","76e9cd8e-ad8f-4753-9ef6-cbc60f7247fe");let Cs=xo;class Yl extends fr{constructor(t){super(t),p(this,"onDisposed",new q),p(this,"directionalLights",new Map),p(this,"ambientLights",new Map)}dispose(){const t=this.components.get(Cs);for(const e of this.three.children){const s=e;s.geometry&&t.destroy(s)}this.deleteAllLights(),this.three.children=[],this.onDisposed.trigger(),this.onDisposed.reset()}deleteAllLights(){for(const[,t]of this.directionalLights)t.removeFromParent(),t.target.removeFromParent(),t.dispose();this.directionalLights.clear();for(const[,t]of this.ambientLights)t.removeFromParent(),t.dispose();this.ambientLights.clear()}}class ve extends Set{constructor(t){super(t),p(this,"onItemAdded",new q),p(this,"onItemDeleted",new q),p(this,"onCleared",new q),p(this,"guard",()=>!0)}clear(){super.clear(),this.onCleared.trigger()}add(...t){for(const e of t)this.has(e)||!this.guard(e)||(super.add(e),this.onItemAdded||(this.onItemAdded=new q),this.onItemAdded.trigger(e));return this}delete(t){const e=super.delete(t);return e&&this.onItemDeleted.trigger(),e}dispose(){this.clear(),this.onItemAdded.reset(),this.onItemDeleted.reset(),this.onCleared.reset()}}class oe extends Map{constructor(t){super(t),p(this,"onItemSet",new q),p(this,"onItemUpdated",new q),p(this,"onItemDeleted",new q),p(this,"onCleared",new q),p(this,"guard",()=>!0)}clear(){super.clear(),this.onCleared.trigger()}set(t,e){const s=this.has(t);if(!(this.guard??(()=>!0))(t,e))return this;const r=super.set(t,e);return s?(this.onItemUpdated||(this.onItemUpdated=new q),this.onItemUpdated.trigger({key:t,value:e})):(this.onItemSet||(this.onItemSet=new q),this.onItemSet.trigger({key:t,value:e})),r}delete(t){const e=super.delete(t);return e&&this.onItemDeleted.trigger(t),e}dispose(){this.clear(),this.onItemSet.reset(),this.onItemDeleted.reset(),this.onCleared.reset()}}class hn{static isEntry(t){return new Set(["Boolean","Color","Text","Number","Select","Vector3","TextSet","None"]).has(t.type)}static copySchema(t,e={}){for(const s in t){const i=t[s];this.isEntry(i)?e[s]=this.copyEntry(i):(e[s]={},this.copySchema(i,e[s]))}return e}static copyEntry(t){if(t.type==="Boolean"){const e=t;return{type:e.type,value:e.value}}if(t.type==="Color"){const e=t;return{type:e.type,value:e.value.clone()}}if(t.type==="Text"){const e=t;return{type:e.type,value:e.value}}if(t.type==="Number"){const e=t;return{type:e.type,value:e.value,min:e.min,max:e.max,interpolable:e.interpolable}}if(t.type==="Select"){const e=t;return{type:e.type,value:e.value,multiple:e.multiple,options:new Set(e.options)}}if(t.type==="Vector3"){const e=t;return{type:e.type,value:e.value.clone()}}if(t.type==="TextSet"){const e=t;return{type:e.type,value:new Set(e.value)}}if(t.type==="None"){const e=t;return{type:e.type,value:e.value}}throw new Error("Invalid entry!")}}const wi=0,zl=1,Gl=new B,$r=new Jt,un=new We,jr=new B,Ci=new ls;class kl{constructor(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new qr,this.unassigned=new qr,this.vertices=[]}setFromPoints(t){if(t.length>=4){this.makeEmpty();for(let e=0,s=t.length;e<s;e++)this.vertices.push(new Hl(t[e]));this.compute()}return this}setFromObject(t){const e=[];return t.updateMatrixWorld(!0),t.traverse(function(s){const i=s.geometry;if(i!==void 0){const n=i.attributes.position;if(n!==void 0)for(let r=0,o=n.count;r<o;r++){const a=new B;a.fromBufferAttribute(n,r).applyMatrix4(s.matrixWorld),e.push(a)}}}),this.setFromPoints(e)}containsPoint(t){const e=this.faces;for(let s=0,i=e.length;s<i;s++)if(e[s].distanceToPoint(t)>this.tolerance)return!1;return!0}intersectRay(t,e){const s=this.faces;let i=-1/0,n=1/0;for(let r=0,o=s.length;r<o;r++){const a=s[r],l=a.distanceToPoint(t.origin),h=a.normal.dot(t.direction);if(l>0&&h>=0)return null;const d=h!==0?-l/h:0;if(!(d<=0)&&(h>0?n=Math.min(d,n):i=Math.max(d,i),i>n))return null}return i!==-1/0?t.at(i,e):t.at(n,e),e}intersectsRay(t){return this.intersectRay(t,Gl)!==null}makeEmpty(){return this.faces=[],this.vertices=[],this}addVertexToFace(t,e){return t.face=e,e.outside===null?this.assigned.append(t):this.assigned.insertBefore(e.outside,t),e.outside=t,this}removeVertexFromFace(t,e){return t===e.outside&&(t.next!==null&&t.next.face===e?e.outside=t.next:e.outside=null),this.assigned.remove(t),this}removeAllVerticesFromFace(t){if(t.outside!==null){const e=t.outside;let s=t.outside;for(;s.next!==null&&s.next.face===t;)s=s.next;return this.assigned.removeSubList(e,s),e.prev=s.next=null,t.outside=null,e}}deleteFaceVertices(t,e){const s=this.removeAllVerticesFromFace(t);if(s!==void 0)if(e===void 0)this.unassigned.appendChain(s);else{let i=s;do{const n=i.next;e.distanceToPoint(i.point)>this.tolerance?this.addVertexToFace(i,e):this.unassigned.append(i),i=n}while(i!==null)}return this}resolveUnassignedPoints(t){if(this.unassigned.isEmpty()===!1){let e=this.unassigned.first();do{const s=e.next;let i=this.tolerance,n=null;for(let r=0;r<t.length;r++){const o=t[r];if(o.mark===wi){const a=o.distanceToPoint(e.point);if(a>i&&(i=a,n=o),i>1e3*this.tolerance)break}}n!==null&&this.addVertexToFace(e,n),e=s}while(e!==null)}return this}computeExtremes(){const t=new B,e=new B,s=[],i=[];for(let n=0;n<3;n++)s[n]=i[n]=this.vertices[0];t.copy(this.vertices[0].point),e.copy(this.vertices[0].point);for(let n=0,r=this.vertices.length;n<r;n++){const o=this.vertices[n],a=o.point;for(let l=0;l<3;l++)a.getComponent(l)<t.getComponent(l)&&(t.setComponent(l,a.getComponent(l)),s[l]=o);for(let l=0;l<3;l++)a.getComponent(l)>e.getComponent(l)&&(e.setComponent(l,a.getComponent(l)),i[l]=o)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(t.x),Math.abs(e.x))+Math.max(Math.abs(t.y),Math.abs(e.y))+Math.max(Math.abs(t.z),Math.abs(e.z))),{min:s,max:i}}computeInitialHull(){const t=this.vertices,e=this.computeExtremes(),s=e.min,i=e.max;let n=0,r=0;for(let u=0;u<3;u++){const f=i[u].point.getComponent(u)-s[u].point.getComponent(u);f>n&&(n=f,r=u)}const o=s[r],a=i[r];let l,h;n=0,$r.set(o.point,a.point);for(let u=0,f=this.vertices.length;u<f;u++){const I=t[u];if(I!==o&&I!==a){$r.closestPointToPoint(I.point,!0,jr);const E=jr.distanceToSquared(I.point);E>n&&(n=E,l=I)}}n=-1,un.setFromCoplanarPoints(o.point,a.point,l.point);for(let u=0,f=this.vertices.length;u<f;u++){const I=t[u];if(I!==o&&I!==a&&I!==l){const E=Math.abs(un.distanceToPoint(I.point));E>n&&(n=E,h=I)}}const d=[];if(un.distanceToPoint(h.point)<0){d.push(ie.create(o,a,l),ie.create(h,a,o),ie.create(h,l,a),ie.create(h,o,l));for(let u=0;u<3;u++){const f=(u+1)%3;d[u+1].getEdge(2).setTwin(d[0].getEdge(f)),d[u+1].getEdge(1).setTwin(d[f+1].getEdge(0))}}else{d.push(ie.create(o,l,a),ie.create(h,o,a),ie.create(h,a,l),ie.create(h,l,o));for(let u=0;u<3;u++){const f=(u+1)%3;d[u+1].getEdge(2).setTwin(d[0].getEdge((3-u)%3)),d[u+1].getEdge(0).setTwin(d[f+1].getEdge(1))}}for(let u=0;u<4;u++)this.faces.push(d[u]);for(let u=0,f=t.length;u<f;u++){const I=t[u];if(I!==o&&I!==a&&I!==l&&I!==h){n=this.tolerance;let E=null;for(let m=0;m<4;m++){const C=this.faces[m].distanceToPoint(I.point);C>n&&(n=C,E=this.faces[m])}E!==null&&this.addVertexToFace(I,E)}}return this}reindexFaces(){const t=[];for(let e=0;e<this.faces.length;e++){const s=this.faces[e];s.mark===wi&&t.push(s)}return this.faces=t,this}nextVertexToAdd(){if(this.assigned.isEmpty()===!1){let t,e=0;const s=this.assigned.first().face;let i=s.outside;do{const n=s.distanceToPoint(i.point);n>e&&(e=n,t=i),i=i.next}while(i!==null&&i.face===s);return t}}computeHorizon(t,e,s,i){this.deleteFaceVertices(s),s.mark=zl;let n;e===null?n=e=s.getEdge(0):n=e.next;do{const r=n.twin,o=r.face;o.mark===wi&&(o.distanceToPoint(t)>this.tolerance?this.computeHorizon(t,r,o,i):i.push(n)),n=n.next}while(n!==e);return this}addAdjoiningFace(t,e){const s=ie.create(t,e.tail(),e.head());return this.faces.push(s),s.getEdge(-1).setTwin(e.twin),s.getEdge(0)}addNewFaces(t,e){this.newFaces=[];let s=null,i=null;for(let n=0;n<e.length;n++){const r=e[n],o=this.addAdjoiningFace(t,r);s===null?s=o:o.next.setTwin(i),this.newFaces.push(o.face),i=o}return s.next.setTwin(i),this}addVertexToHull(t){const e=[];return this.unassigned.clear(),this.removeVertexFromFace(t,t.face),this.computeHorizon(t.point,null,t.face,e),this.addNewFaces(t,e),this.resolveUnassignedPoints(this.newFaces),this}cleanup(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this}compute(){let t;for(this.computeInitialHull();(t=this.nextVertexToAdd())!==void 0;)this.addVertexToHull(t);return this.reindexFaces(),this.cleanup(),this}}class ie{constructor(){this.normal=new B,this.midpoint=new B,this.area=0,this.constant=0,this.outside=null,this.mark=wi,this.edge=null}static create(t,e,s){const i=new ie,n=new fn(t,i),r=new fn(e,i),o=new fn(s,i);return n.next=o.prev=r,r.next=n.prev=o,o.next=r.prev=n,i.edge=n,i.compute()}getEdge(t){let e=this.edge;for(;t>0;)e=e.next,t--;for(;t<0;)e=e.prev,t++;return e}compute(){const t=this.edge.tail(),e=this.edge.head(),s=this.edge.next.head();return Ci.set(t.point,e.point,s.point),Ci.getNormal(this.normal),Ci.getMidpoint(this.midpoint),this.area=Ci.getArea(),this.constant=this.normal.dot(this.midpoint),this}distanceToPoint(t){return this.normal.dot(t)-this.constant}}class fn{constructor(t,e){this.vertex=t,this.prev=null,this.next=null,this.twin=null,this.face=e}head(){return this.vertex}tail(){return this.prev?this.prev.vertex:null}length(){const t=this.head(),e=this.tail();return e!==null?e.point.distanceTo(t.point):-1}lengthSquared(){const t=this.head(),e=this.tail();return e!==null?e.point.distanceToSquared(t.point):-1}setTwin(t){return this.twin=t,t.twin=this,this}}class Hl{constructor(t){this.point=t,this.prev=null,this.next=null,this.face=null}}class qr{constructor(){this.head=null,this.tail=null}first(){return this.head}last(){return this.tail}clear(){return this.head=this.tail=null,this}insertBefore(t,e){return e.prev=t.prev,e.next=t,e.prev===null?this.head=e:e.prev.next=e,t.prev=e,this}insertAfter(t,e){return e.prev=t,e.next=t.next,e.next===null?this.tail=e:e.next.prev=e,t.next=e,this}append(t){return this.head===null?this.head=t:this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t,this}appendChain(t){for(this.head===null?this.head=t:this.tail.next=t,t.prev=this.tail;t.next!==null;)t=t.next;return this.tail=t,this}remove(t){return t.prev===null?this.head=t.next:t.prev.next=t.next,t.next===null?this.tail=t.prev:t.next.prev=t.prev,this}removeSubList(t,e){return t.prev===null?this.head=e.next:t.prev.next=e.next,e.next===null?this.tail=t.prev:e.next.prev=t.prev,this}isEmpty(){return this.head===null}}const Pn=[2,2,1],Ln=[1,0,0];function fe(c,t){return c*3+t}function Wl(c){const t=c.elements;let e=0;for(let s=0;s<9;s++)e+=t[s]*t[s];return Math.sqrt(e)}function Xl(c){const t=c.elements;let e=0;for(let s=0;s<3;s++){const i=t[fe(Pn[s],Ln[s])];e+=2*i*i}return Math.sqrt(e)}function Zl(c,t){let e=0,s=1;const i=c.elements;for(let l=0;l<3;l++){const h=Math.abs(i[fe(Pn[l],Ln[l])]);h>e&&(e=h,s=l)}let n=1,r=0;const o=Ln[s],a=Pn[s];if(Math.abs(i[fe(a,o)])>Number.EPSILON){const l=i[fe(a,a)],h=i[fe(o,o)],d=i[fe(a,o)],u=(l-h)/2/d;let f;u<0?f=-1/(-u+Math.sqrt(1+u*u)):f=1/(u+Math.sqrt(1+u*u)),n=1/Math.sqrt(1+f*f),r=f*n}return t.identity(),t.elements[fe(o,o)]=n,t.elements[fe(a,a)]=n,t.elements[fe(a,o)]=r,t.elements[fe(o,a)]=-r,t}function $l(c,t){let e=0,s=0;const i=10;t.unitary.identity(),t.diagonal.copy(c);const n=t.unitary,r=t.diagonal,o=new ze,a=new ze,l=Number.EPSILON*Wl(r);for(;s<i&&Xl(r)>l;)Zl(r,o),a.copy(o).transpose(),r.multiply(o),r.premultiply(a),n.multiply(o),++e>2&&(s++,e=0);return t}function jl(c){const t=[];for(let rt=0;rt<c.length-2;rt+=3){const ut=c[rt],ht=c[rt+1],pt=c[rt+2];t.push(new B(ut,ht,pt))}const e=new kl;e.setFromPoints(t);const s={unitary:new ze,diagonal:new ze},i=e.faces,n=[],r=[];for(let rt=0,ut=i.length;rt<ut;rt++){const ht=i[rt];let pt=ht.edge;n.length=0;do n.push(pt),pt=pt.next;while(pt!==ht.edge);const Xt=n.length-2;for(let bt=1,A=Xt;bt<=A;bt++){const W=n[0].vertex,G=n[bt+0].vertex,L=n[bt+1].vertex;r.push(W.point.x,W.point.y,W.point.z),r.push(G.point.x,G.point.y,G.point.z),r.push(L.point.x,L.point.y,L.point.z)}}const o=new B,a=new B,l=new B,h=new B,d=new B,u=new B,f=new B,I=new B;let E=0,m=0,C=0,g=0,S=0,T=0,F=0;for(let rt=0,ut=r.length;rt<ut;rt+=9){o.fromArray(r,rt),a.fromArray(r,rt+3),l.fromArray(r,rt+6),f.set(0,0,0),f.add(o).add(a).add(l).divideScalar(3),h.subVectors(a,o),d.subVectors(l,o);const ht=u.crossVectors(h,d).length()/2;I.add(u.copy(f).multiplyScalar(ht)),E+=ht,m+=(9*f.x*f.x+o.x*o.x+a.x*a.x+l.x*l.x)*(ht/12),C+=(9*f.x*f.y+o.x*o.y+a.x*a.y+l.x*l.y)*(ht/12),g+=(9*f.x*f.z+o.x*o.z+a.x*a.z+l.x*l.z)*(ht/12),S+=(9*f.y*f.y+o.y*o.y+a.y*a.y+l.y*l.y)*(ht/12),T+=(9*f.y*f.z+o.y*o.z+a.y*a.z+l.y*l.z)*(ht/12),F+=(9*f.z*f.z+o.z*o.z+a.z*a.z+l.z*l.z)*(ht/12)}I.divideScalar(E),m/=E,C/=E,g/=E,S/=E,T/=E,F/=E,m-=I.x*I.x,C-=I.x*I.y,g-=I.x*I.z,S-=I.y*I.y,T-=I.y*I.z,F-=I.z*I.z;const y=new ze;y.elements[0]=m,y.elements[1]=C,y.elements[2]=g,y.elements[3]=C,y.elements[4]=S,y.elements[5]=T,y.elements[6]=g,y.elements[7]=T,y.elements[8]=F,$l(y,s);const N=s.unitary,w=new B,P=new B,M=new B;N.extractBasis(w,P,M);let x=-1/0,O=-1/0,v=-1/0,R=1/0,D=1/0,X=1/0;for(let rt=0,ut=t.length;rt<ut;rt++){const ht=t[rt];x=Math.max(w.dot(ht),x),O=Math.max(P.dot(ht),O),v=Math.max(M.dot(ht),v),R=Math.min(w.dot(ht),R),D=Math.min(P.dot(ht),D),X=Math.min(M.dot(ht),X)}w.multiplyScalar(.5*(R+x)),P.multiplyScalar(.5*(D+O)),M.multiplyScalar(.5*(X+v));const U=new B,j=new B,k=new ze;U.add(w).add(P).add(M),j.x=x-R,j.y=O-D,j.z=v-X,j.multiplyScalar(.5),k.copy(N);const{x:J,y:Y,z:V}=j,nt=new ft;nt.makeScale(J*2,Y*2,V*2);const et=new ft;et.makeTranslation(-J,-Y,-V);const tt=new ft;tt.makeTranslation(U.x,U.y,U.z);const Ft=new ft;Ft.setFromMatrix3(k);const Nt=new ft;return Nt.multiply(tt),Nt.multiply(Ft),Nt.multiply(et),Nt.multiply(nt),{center:U,halfSizes:j,rotation:k,transformation:Nt}}class Qr{static isTransparent(t){return t.transparent&&t.opacity<1}}const dr=class Mt{static create(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,s=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return`${Mt._lut[t&255]+Mt._lut[t>>8&255]+Mt._lut[t>>16&255]+Mt._lut[t>>24&255]}-${Mt._lut[e&255]}${Mt._lut[e>>8&255]}-${Mt._lut[e>>16&15|64]}${Mt._lut[e>>24&255]}-${Mt._lut[s&63|128]}${Mt._lut[s>>8&255]}-${Mt._lut[s>>16&255]}${Mt._lut[s>>24&255]}${Mt._lut[i&255]}${Mt._lut[i>>8&255]}${Mt._lut[i>>16&255]}${Mt._lut[i>>24&255]}`.toLowerCase()}static validate(t){if(!Mt._pattern.test(t))throw new Error(`${t} is not a valid UUID v4.

- If you're the tool creator, you can take one from https://www.uuidgenerator.net/.

- If you're using a platform tool, verify the uuid isn't misspelled or contact the tool creator.`)}};p(dr,"_pattern",/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/);p(dr,"_lut",["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"]);let Ae=dr;var Ti=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Uo(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var Ir={exports:{}};Ir.exports=Xi;Ir.exports.default=Xi;function Xi(c,t,e){e=e||2;var s=t&&t.length,i=s?t[0]*e:c.length,n=Bo(c,0,i,e,!0),r=[];if(!n||n.next===n.prev)return r;var o,a,l,h,d,u,f;if(s&&(n=th(c,t,n,e)),c.length>80*e){o=l=c[0],a=h=c[1];for(var I=e;I<i;I+=e)d=c[I],u=c[I+1],d<o&&(o=d),u<a&&(a=u),d>l&&(l=d),u>h&&(h=u);f=Math.max(l-o,h-a),f=f!==0?32767/f:0}return Xs(n,r,e,o,a,f,0),r}function Bo(c,t,e,s,i){var n,r;if(i===vn(c,t,e,s)>0)for(n=t;n<e;n+=s)r=Kr(n,c[n],c[n+1],r);else for(n=e-s;n>=t;n-=s)r=Kr(n,c[n],c[n+1],r);return r&&Zi(r,r.next)&&($s(r),r=r.next),r}function He(c,t){if(!c)return c;t||(t=c);var e=c,s;do if(s=!1,!e.steiner&&(Zi(e,e.next)||yt(e.prev,e,e.next)===0)){if($s(e),e=t=e.prev,e===e.next)break;s=!0}else e=e.next;while(s||e!==t);return t}function Xs(c,t,e,s,i,n,r){if(c){!r&&n&&rh(c,s,i,n);for(var o=c,a,l;c.prev!==c.next;){if(a=c.prev,l=c.next,n?Ql(c,s,i,n):ql(c)){t.push(a.i/e|0),t.push(c.i/e|0),t.push(l.i/e|0),$s(c),c=l.next,o=l.next;continue}if(c=l,c===o){r?r===1?(c=Kl(He(c),t,e),Xs(c,t,e,s,i,n,2)):r===2&&Jl(c,t,e,s,i,n):Xs(He(c),t,e,s,i,n,1);break}}}}function ql(c){var t=c.prev,e=c,s=c.next;if(yt(t,e,s)>=0)return!1;for(var i=t.x,n=e.x,r=s.x,o=t.y,a=e.y,l=s.y,h=i<n?i<r?i:r:n<r?n:r,d=o<a?o<l?o:l:a<l?a:l,u=i>n?i>r?i:r:n>r?n:r,f=o>a?o>l?o:l:a>l?a:l,I=s.next;I!==t;){if(I.x>=h&&I.x<=u&&I.y>=d&&I.y<=f&&us(i,o,n,a,r,l,I.x,I.y)&&yt(I.prev,I,I.next)>=0)return!1;I=I.next}return!0}function Ql(c,t,e,s){var i=c.prev,n=c,r=c.next;if(yt(i,n,r)>=0)return!1;for(var o=i.x,a=n.x,l=r.x,h=i.y,d=n.y,u=r.y,f=o<a?o<l?o:l:a<l?a:l,I=h<d?h<u?h:u:d<u?d:u,E=o>a?o>l?o:l:a>l?a:l,m=h>d?h>u?h:u:d>u?d:u,C=wn(f,I,t,e,s),g=wn(E,m,t,e,s),S=c.prevZ,T=c.nextZ;S&&S.z>=C&&T&&T.z<=g;){if(S.x>=f&&S.x<=E&&S.y>=I&&S.y<=m&&S!==i&&S!==r&&us(o,h,a,d,l,u,S.x,S.y)&&yt(S.prev,S,S.next)>=0||(S=S.prevZ,T.x>=f&&T.x<=E&&T.y>=I&&T.y<=m&&T!==i&&T!==r&&us(o,h,a,d,l,u,T.x,T.y)&&yt(T.prev,T,T.next)>=0))return!1;T=T.nextZ}for(;S&&S.z>=C;){if(S.x>=f&&S.x<=E&&S.y>=I&&S.y<=m&&S!==i&&S!==r&&us(o,h,a,d,l,u,S.x,S.y)&&yt(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;T&&T.z<=g;){if(T.x>=f&&T.x<=E&&T.y>=I&&T.y<=m&&T!==i&&T!==r&&us(o,h,a,d,l,u,T.x,T.y)&&yt(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}function Kl(c,t,e){var s=c;do{var i=s.prev,n=s.next.next;!Zi(i,n)&&Vo(i,s,s.next,n)&&Zs(i,n)&&Zs(n,i)&&(t.push(i.i/e|0),t.push(s.i/e|0),t.push(n.i/e|0),$s(s),$s(s.next),s=c=n),s=s.next}while(s!==c);return He(s)}function Jl(c,t,e,s,i,n){var r=c;do{for(var o=r.next.next;o!==r.prev;){if(r.i!==o.i&&ch(r,o)){var a=Yo(r,o);r=He(r,r.next),a=He(a,a.next),Xs(r,t,e,s,i,n,0),Xs(a,t,e,s,i,n,0);return}o=o.next}r=r.next}while(r!==c)}function th(c,t,e,s){var i=[],n,r,o,a,l;for(n=0,r=t.length;n<r;n++)o=t[n]*s,a=n<r-1?t[n+1]*s:c.length,l=Bo(c,o,a,s,!1),l===l.next&&(l.steiner=!0),i.push(ah(l));for(i.sort(eh),n=0;n<i.length;n++)e=sh(i[n],e);return e}function eh(c,t){return c.x-t.x}function sh(c,t){var e=ih(c,t);if(!e)return t;var s=Yo(e,c);return He(s,s.next),He(e,e.next)}function ih(c,t){var e=t,s=c.x,i=c.y,n=-1/0,r;do{if(i<=e.y&&i>=e.next.y&&e.next.y!==e.y){var o=e.x+(i-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(o<=s&&o>n&&(n=o,r=e.x<e.next.x?e:e.next,o===s))return r}e=e.next}while(e!==t);if(!r)return null;var a=r,l=r.x,h=r.y,d=1/0,u;e=r;do s>=e.x&&e.x>=l&&s!==e.x&&us(i<h?s:n,i,l,h,i<h?n:s,i,e.x,e.y)&&(u=Math.abs(i-e.y)/(s-e.x),Zs(e,c)&&(u<d||u===d&&(e.x>r.x||e.x===r.x&&nh(r,e)))&&(r=e,d=u)),e=e.next;while(e!==a);return r}function nh(c,t){return yt(c.prev,c,t.prev)<0&&yt(t.next,c,c.next)<0}function rh(c,t,e,s){var i=c;do i.z===0&&(i.z=wn(i.x,i.y,t,e,s)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==c);i.prevZ.nextZ=null,i.prevZ=null,oh(i)}function oh(c){var t,e,s,i,n,r,o,a,l=1;do{for(e=c,c=null,n=null,r=0;e;){for(r++,s=e,o=0,t=0;t<l&&(o++,s=s.nextZ,!!s);t++);for(a=l;o>0||a>0&&s;)o!==0&&(a===0||!s||e.z<=s.z)?(i=e,e=e.nextZ,o--):(i=s,s=s.nextZ,a--),n?n.nextZ=i:c=i,i.prevZ=n,n=i;e=s}n.nextZ=null,l*=2}while(r>1);return c}function wn(c,t,e,s,i){return c=(c-e)*i|0,t=(t-s)*i|0,c=(c|c<<8)&16711935,c=(c|c<<4)&252645135,c=(c|c<<2)&858993459,c=(c|c<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,c|t<<1}function ah(c){var t=c,e=c;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==c);return e}function us(c,t,e,s,i,n,r,o){return(i-r)*(t-o)>=(c-r)*(n-o)&&(c-r)*(s-o)>=(e-r)*(t-o)&&(e-r)*(n-o)>=(i-r)*(s-o)}function ch(c,t){return c.next.i!==t.i&&c.prev.i!==t.i&&!lh(c,t)&&(Zs(c,t)&&Zs(t,c)&&hh(c,t)&&(yt(c.prev,c,t.prev)||yt(c,t.prev,t))||Zi(c,t)&&yt(c.prev,c,c.next)>0&&yt(t.prev,t,t.next)>0)}function yt(c,t,e){return(t.y-c.y)*(e.x-t.x)-(t.x-c.x)*(e.y-t.y)}function Zi(c,t){return c.x===t.x&&c.y===t.y}function Vo(c,t,e,s){var i=gi(yt(c,t,e)),n=gi(yt(c,t,s)),r=gi(yt(e,s,c)),o=gi(yt(e,s,t));return!!(i!==n&&r!==o||i===0&&mi(c,e,t)||n===0&&mi(c,s,t)||r===0&&mi(e,c,s)||o===0&&mi(e,t,s))}function mi(c,t,e){return t.x<=Math.max(c.x,e.x)&&t.x>=Math.min(c.x,e.x)&&t.y<=Math.max(c.y,e.y)&&t.y>=Math.min(c.y,e.y)}function gi(c){return c>0?1:c<0?-1:0}function lh(c,t){var e=c;do{if(e.i!==c.i&&e.next.i!==c.i&&e.i!==t.i&&e.next.i!==t.i&&Vo(e,e.next,c,t))return!0;e=e.next}while(e!==c);return!1}function Zs(c,t){return yt(c.prev,c,c.next)<0?yt(c,t,c.next)>=0&&yt(c,c.prev,t)>=0:yt(c,t,c.prev)<0||yt(c,c.next,t)<0}function hh(c,t){var e=c,s=!1,i=(c.x+t.x)/2,n=(c.y+t.y)/2;do e.y>n!=e.next.y>n&&e.next.y!==e.y&&i<(e.next.x-e.x)*(n-e.y)/(e.next.y-e.y)+e.x&&(s=!s),e=e.next;while(e!==c);return s}function Yo(c,t){var e=new Mn(c.i,c.x,c.y),s=new Mn(t.i,t.x,t.y),i=c.next,n=t.prev;return c.next=t,t.prev=c,e.next=i,i.prev=e,s.next=e,e.prev=s,n.next=s,s.prev=n,s}function Kr(c,t,e,s){var i=new Mn(c,t,e);return s?(i.next=s.next,i.prev=s,s.next.prev=i,s.next=i):(i.prev=i,i.next=i),i}function $s(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function Mn(c,t,e){this.i=c,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Xi.deviation=function(c,t,e,s){var i=t&&t.length,n=i?t[0]*e:c.length,r=Math.abs(vn(c,0,n,e));if(i)for(var o=0,a=t.length;o<a;o++){var l=t[o]*e,h=o<a-1?t[o+1]*e:c.length;r-=Math.abs(vn(c,l,h,e))}var d=0;for(o=0;o<s.length;o+=3){var u=s[o]*e,f=s[o+1]*e,I=s[o+2]*e;d+=Math.abs((c[u]-c[I])*(c[f+1]-c[u+1])-(c[u]-c[f])*(c[I+1]-c[u+1]))}return r===0&&d===0?0:Math.abs((d-r)/r)};function vn(c,t,e,s){for(var i=0,n=t,r=e-s;n<e;n+=s)i+=(c[r]-c[n])*(c[n+1]+c[r+1]),r=n;return i}Xi.flatten=function(c){for(var t=c[0][0].length,e={vertices:[],holes:[],dimensions:t},s=0,i=0;i<c.length;i++){for(var n=0;n<c[i].length;n++)for(var r=0;r<t;r++)e.vertices.push(c[i][n][r]);i>0&&(s+=c[i-1].length,e.holes.push(s))}return e};var uh=Ir.exports;const fh=Uo(uh);class dh extends Rt{constructor(){super(...arguments),p(this,"enabled",!0),p(this,"_inverseMatrix",new ft),p(this,"_localPlane",new We),p(this,"_tempLine",new Jt),p(this,"_tempVector",new B),p(this,"_plane"),p(this,"_plane2DCoordinateSystem",new ft),p(this,"_precission",1e4),p(this,"_planeAxis")}get plane(){if(!this._plane)throw new Error("Plane not set");return this._plane}set plane(t){this._plane=t}createEdges(t){const{meshes:e,posAttr:s}=t;let i=0;s.array.fill(0);const n=[];let r=0;const o=new st;for(const a of e)if(a.geometry){if(a.geometry.boundsTree||a.geometry.computeBoundsTree(),!a.geometry.boundsTree)throw new Error("Bounds tree not found for edges generation.");if(a instanceof Me){if(a.count===0)continue;const l=a;for(let h=0;h<l.count;h++){o.geometry=a.geometry,o.matrix.copy(a.matrix);const d=new ft;l.getMatrixAt(h,d),o.applyMatrix4(d),o.applyMatrix4(a.matrixWorld),o.updateMatrix(),o.updateMatrixWorld(),this._inverseMatrix.copy(o.matrixWorld).invert(),this._localPlane.copy(this.plane).applyMatrix4(this._inverseMatrix),i=this.shapecast(o,s,i),i!==r&&(n.push(i),r=i)}}else this._inverseMatrix.copy(a.matrixWorld).invert(),this._localPlane.copy(this.plane).applyMatrix4(this._inverseMatrix),i=this.shapecast(a,s,i),i!==r&&(n.push(i),r=i)}return{indexes:n,index:i}}createFills(t,e){this.updatePlane2DCoordinateSystem();const s=[];let i=0;for(let n=0;n<e.length;n++){const r=e[n],o=[];for(let l=i;l<r;l+=2)o.push(l*3);const a=this.computeFill(o,t);for(const l of a)s.push(l);i=r}return s}computeFill(t,e){const s=new Map,i={},n=new Map;let r=0;const o=new Map,a=new Map,l=new Set,h=this._precission;for(let u=0;u<t.length;u++){const f=t[u];let I=0,E=0,m=0,C=0;const g=e[f],S=e[f+1],T=e[f+2],F=e[f+3],y=e[f+4],N=e[f+5];if(this._tempVector.set(g,S,T),this._tempVector.applyMatrix4(this._plane2DCoordinateSystem),I=Math.trunc(this._tempVector.x*h)/h,E=Math.trunc(this._tempVector.y*h)/h,this._tempVector.set(F,y,N),this._tempVector.applyMatrix4(this._plane2DCoordinateSystem),m=Math.trunc(this._tempVector.x*h)/h,C=Math.trunc(this._tempVector.y*h)/h,I===m&&E===C)continue;const w=`${I}|${E}`,P=`${m}|${C}`;s.has(w)||s.set(w,f/3),s.has(P)||s.set(P,f/3+1);const M=s.get(w),x=s.get(P);i[M]=[I,E],i[x]=[m,C];const O=a.has(M),v=o.has(M),R=a.has(x),D=o.has(x);if(!O&&!v&&!R&&!D)a.set(M,r),o.set(x,r),l.add(r),n.set(r,[M,x]),r++;else if(O&&D){const U=a.get(M),j=o.get(x);if(U!==j){const J=n.get(j),Y=n.get(U);if(!J||!Y)continue;n.delete(U),l.delete(U),o.set(Y[Y.length-1],j),o.delete(J[J.length-1]);for(const V of Y)J.push(V)}else l.delete(j);a.delete(M),o.delete(x)}else if(v&&R){const U=a.get(x),j=o.get(M);if(U!==j){const J=n.get(j),Y=n.get(U);if(!J||!Y)continue;n.delete(U),l.delete(U),o.set(Y[Y.length-1],j),o.delete(J[J.length-1]);for(const V of Y)J.push(V)}else l.delete(j);a.delete(x),o.delete(M)}else if(O&&R){const U=a.get(x),j=a.get(M),k=n.get(j),J=n.get(U);if(!k||!J)continue;n.delete(U),l.delete(U),a.delete(k[0]),a.delete(J[0]),o.delete(J[J.length-1]),a.set(J[J.length-1],j),J.reverse(),k.splice(0,0,...J)}else if(v&&D){const U=o.get(x),j=o.get(M),k=n.get(j),J=n.get(U);if(!k||!J)continue;n.delete(U),l.delete(U),o.delete(k[k.length-1]),o.delete(J[J.length-1]),a.delete(J[0]),o.set(J[0],j),J.reverse(),k.push(...J)}else if(O){const U=a.get(M),j=n.get(U);if(!j)continue;j.unshift(x),a.delete(M),a.set(x,U)}else if(v){const U=o.get(M),j=n.get(U);if(!j)continue;j.push(x),o.delete(M),o.set(x,U)}else if(R){const U=a.get(x),j=n.get(U);if(!j)continue;j.unshift(M),a.delete(x),a.set(M,U)}else if(D){const U=o.get(x),j=n.get(U);if(!j)continue;j.push(M),o.delete(x),o.set(M,U)}}const d=[];for(const[u,f]of n){if(l.has(u))continue;const I=[],E=new Map;let m=0;for(const g of f){const S=i[g];I.push(S[0],S[1]),E.set(m++,g)}const C=fh(I);for(const g of C){const S=E.get(g);if(S===void 0)throw new Error("Map error!");d.push(S)}}return d}updatePlane2DCoordinateSystem(){this._plane2DCoordinateSystem=new ft;const t=new B(1,0,0),e=new B(0,1,0),s=this.plane.normal,i=new B;this.plane.coplanarPoint(i),this._planeAxis==="x"?t.crossVectors(e,s):this._planeAxis==="y"?e.crossVectors(s,t):this._planeAxis==="z"||(t.crossVectors(e,s).normalize(),e.crossVectors(s,t)),this._plane2DCoordinateSystem.fromArray([t.x,t.y,t.z,0,e.x,e.y,e.z,0,s.x,s.y,s.z,0,i.x,i.y,i.z,1]),this._plane2DCoordinateSystem.invert()}shapecast(t,e,s){return t.geometry.boundsTree.shapecast({intersectsBounds:i=>this._localPlane.intersectsBox(i),intersectsTriangle:i=>{let n=0;if(this._tempLine.start.copy(i.a),this._tempLine.end.copy(i.b),this._localPlane.intersectLine(this._tempLine,this._tempVector)){const r=this._tempVector.applyMatrix4(t.matrixWorld);e.setXYZ(s,r.x,r.y,r.z),n++,s++}if(this._tempLine.start.copy(i.b),this._tempLine.end.copy(i.c),this._localPlane.intersectLine(this._tempLine,this._tempVector)){const r=this._tempVector.applyMatrix4(t.matrixWorld);e.setXYZ(s,r.x,r.y,r.z),n++,s++}if(this._tempLine.start.copy(i.c),this._tempLine.end.copy(i.a),this._localPlane.intersectLine(this._tempLine,this._tempVector)){const r=this._tempVector.applyMatrix4(t.matrixWorld);e.setXYZ(s,r.x,r.y,r.z),n++,s++}n!==2&&(s-=n)}}),s}}p(dh,"uuid","1a193b87-6376-46c8-9e65-62a1576fdb64");const zo=class Go{constructor(){p(this,"onDisposed",new q),p(this,"list",new Map),p(this,"enabled",!1),p(this,"_clock"),p(this,"onInit",new q),p(this,"update",()=>{if(!this.enabled)return;const t=this._clock.getDelta();for(const[e,s]of this.list)s.enabled&&s.isUpdateable()&&s.update(t);requestAnimationFrame(this.update)}),this._clock=new ic,Go.setupBVH()}add(t,e){if(this.list.has(t))throw new Error("You're trying to add a component that already exists in the components instance. Use Components.get() instead.");Ae.validate(t),this.list.set(t,e)}get(t){const e=t.uuid;if(!this.list.has(e)){const s=new t(this);return this.list.has(e)||this.add(e,s),s}return this.list.get(e)}init(){this.enabled=!0,this._clock.start(),this.update(),this.onInit.trigger()}dispose(){this.enabled=!1;for(const[t,e]of this.list)e.enabled=!1,e.isDisposeable()&&e.dispose();this._clock.stop(),this.onDisposed.trigger(),this.onDisposed.reset()}static setupBVH(){Hs.prototype.computeBoundsTree=xl,Hs.prototype.disposeBoundsTree=Ul,st.prototype.raycast=bl}};p(zo,"release","2.4.4");let ko=zo;class Ih extends ur{constructor(){super(...arguments),p(this,"meshes",new Set),p(this,"onAfterUpdate",new q),p(this,"onBeforeUpdate",new q),p(this,"onDisposed",new q),p(this,"isDisposing",!1),p(this,"enabled",!0),p(this,"uuid",Ae.create()),p(this,"name"),p(this,"_scene"),p(this,"_camera"),p(this,"_renderer",null)}get scene(){if(!this._scene)throw new Error("No scene initialized!");return this._scene}set scene(t){this._scene=t,t.worlds.set(this.uuid,this),t.currentWorld=this,t.onWorldChanged.trigger({world:this,action:"added"})}get camera(){if(!this._camera)throw new Error("No camera initialized!");return this._camera}set camera(t){this._camera=t,t.worlds.set(this.uuid,this),t.currentWorld=this,t.onWorldChanged.trigger({world:this,action:"added"})}get renderer(){return this._renderer}set renderer(t){this._renderer=t,t&&(t.worlds.set(this.uuid,this),t.currentWorld=this,t.onWorldChanged.trigger({world:this,action:"added"}))}update(t){this.enabled&&(!this._scene||!this._camera||(this.scene.currentWorld=this,this.camera.currentWorld=this,this.renderer&&(this.renderer.currentWorld=this),this.onBeforeUpdate.trigger(),this.scene.isUpdateable()&&this.scene.update(t),this.camera.isUpdateable()&&this.camera.update(t),this.renderer&&this.renderer.update(t),this.onAfterUpdate.trigger()))}dispose(t=!0){if(this.enabled=!1,this.isDisposing=!0,this.scene.onWorldChanged.trigger({world:this,action:"removed"}),this.camera.onWorldChanged.trigger({world:this,action:"removed"}),this.renderer&&this.renderer.onWorldChanged.trigger({world:this,action:"removed"}),t){const s=this.components.get(Cs);this.scene.dispose(),this.camera.isDisposeable()&&this.camera.dispose(),this.renderer&&this.renderer.dispose();for(const i of this.meshes)s.destroy(i);this.meshes.clear()}this._scene=null,this._camera=null,this._renderer=null,this.components.get(qo).list.delete(this.uuid),this.onDisposed.trigger(),this.onDisposed.reset()}}class Ze{constructor(t,e,s,i){p(this,"_component"),p(this,"name"),p(this,"uuid"),this._component=t,this.name=s,this.uuid=i??Ae.create(),e.get(Ks).list.set(this.uuid,this)}get controls(){return hn.copySchema(this._config)}set(t){for(const e in t)if(e in this){const s=e;this[s]=t[e].value}}export(t=this._config,e={}){for(const s in t){const i=t[s];if(hn.isEntry(i))if(i.type==="Color"){const{r,g:o,b:a}=i.value;e[s]={...i,value:{r,g:o,b:a}}}else if(i.type==="Vector3"){const{x:r,y:o,z:a}=i.value;e[s]={...i,value:{x:r,y:o,z:a}}}else if(i.type==="TextSet"){const r=Array.from(i.value);e[s]={...i,value:r}}else if(i.type==="Select"){const r=Array.from(i.options);e[s]={...i,options:r}}else e[s]={...i};else e[s]={},this.export(i,e[s])}return e}import(t,e={},s=!0){for(const i in t){const n=t[i];if(hn.isEntry(n))if(n.type==="Color"){const{r:o,g:a,b:l}=n.value;e[i]={...n,value:new Dt(o,a,l)}}else if(n.type==="Vector3"){const{x:o,y:a,z:l}=n.value;e[i]={...n,value:new B(o,a,l)}}else n.type==="TextSet"?e[i]={...n,value:new Set(n.value)}:n.type==="Select"?e[i]={...n,options:new Set(n.options)}:e[i]={...n};else e[i]={},this.import(n,e[i],!1)}s&&this.set(e)}}const Ho=class Wo extends Rt{constructor(t){super(t),p(this,"list",new oe),p(this,"enabled",!0),t.add(Wo.uuid,this)}};p(Ho,"uuid","b8c764e0-6b24-4e77-9a32-35fa728ee5b4");let Ks=Ho;class Eh{constructor(t,e){p(this,"_list"),p(this,"_scene"),this._list=t,this._scene=e}get color(){return this._list.directionalLight.color.value}set color(t){this._list.directionalLight.color.value=t;for(const[,e]of this._scene.directionalLights)e.color.copy(t)}get intensity(){return this._list.directionalLight.intensity.value}set intensity(t){this._list.directionalLight.intensity.value=t;for(const[,e]of this._scene.directionalLights)e.intensity=t}get position(){return this._list.directionalLight.position.value.clone()}set position(t){this._list.directionalLight.position.value=t;for(const[,e]of this._scene.directionalLights)e.position.copy(t)}}class ph{constructor(t,e){p(this,"_list"),p(this,"_scene"),this._list=t,this._scene=e}get color(){return this._list.ambientLight.color.value}set color(t){this._list.ambientLight.color.value=t;for(const[,e]of this._scene.ambientLights)e.color.copy(t)}get intensity(){return this._list.ambientLight.intensity.value}set intensity(t){this._list.ambientLight.intensity.value=t;for(const[,e]of this._scene.ambientLights)e.intensity=t}}class Ch extends Ze{constructor(){super(...arguments),p(this,"_config",{backgroundColor:{value:new Dt,type:"Color"},ambientLight:{color:{type:"Color",value:new Dt},intensity:{type:"Number",interpolable:!0,min:0,max:10,value:2}},directionalLight:{color:{type:"Color",value:new Dt},intensity:{type:"Number",interpolable:!0,min:0,max:10,value:2},position:{type:"Vector3",value:new B}}}),p(this,"ambientLight",new ph(this._config,this._component)),p(this,"directionalLight",new Eh(this._config,this._component))}get backgroundColor(){return this._config.backgroundColor.value}set backgroundColor(t){this._config.backgroundColor.value=t,this._component.three.background=t}}class Th extends Yl{constructor(t){super(t),p(this,"onSetup",new q),p(this,"isSetup",!1),p(this,"three"),p(this,"config",new Ch(this,this.components,"Scene")),p(this,"_defaultConfig",{backgroundColor:new Dt(2107698),directionalLight:{color:new Dt("white"),intensity:1.5,position:new B(5,10,3)},ambientLight:{color:new Dt("white"),intensity:1}}),this.three=new Yi,this.three.background=new Dt(2107698)}setup(t){const e={...this._defaultConfig,...t};this.config.backgroundColor=e.backgroundColor;const s=e.ambientLight;this.config.ambientLight.color=s.color,this.config.ambientLight.intensity=s.intensity;const i=e.directionalLight;this.config.directionalLight.color=i.color,this.config.directionalLight.intensity=i.intensity,this.config.directionalLight.position=i.position,this.deleteAllLights();const{color:n,intensity:r}=this.config.directionalLight,o=new No(n,r);o.position.copy(i.position);const{color:a,intensity:l}=this.config.directionalLight,h=new Ja(a,l);this.three.add(o,h),this.directionalLights.set(o.uuid,o),this.ambientLights.set(h.uuid,h),this.isSetup=!0,this.onSetup.trigger()}dispose(){super.dispose(),this.components.get(Ks).list.delete(this.config.uuid)}}class Uf extends Vl{constructor(t,e,s){super(t),p(this,"enabled",!0),p(this,"container"),p(this,"three"),p(this,"_canvas"),p(this,"_parameters"),p(this,"_resizeObserver",null),p(this,"onContainerUpdated",new q),p(this,"_resizing",!1),p(this,"resize",r=>{if(this._resizing)return;this._resizing=!0,this.onContainerUpdated.trigger();const o=r?r.x:this.container.clientWidth,a=r?r.y:this.container.clientHeight;this.three.setSize(o,a),this.onResize.trigger(new Wt(o,a)),this._resizing=!1}),p(this,"resizeEvent",()=>{this.resize()}),p(this,"onContextLost",r=>{r.preventDefault(),this.enabled=!1}),p(this,"onContextBack",()=>{this.three.setRenderTarget(null),this.three.dispose(),this.three=new ks({canvas:this._canvas,antialias:!0,alpha:!0,...this._parameters}),this.enabled=!0}),this.container=e,this._parameters=s,this.three=new ks({antialias:!0,alpha:!0,...s}),this.three.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.setupRenderer(),this.setupEvents(!0),this.resize(),this._canvas=this.three.domElement;const i=this.three.getContext(),{canvas:n}=i;n.addEventListener("webglcontextlost",this.onContextLost,!1),n.addEventListener("webglcontextrestored",this.onContextBack,!1)}update(){if(!this.enabled||!this.currentWorld)return;this.onBeforeUpdate.trigger(this);const t=this.currentWorld.scene.three,e=this.currentWorld.camera.three;this.three.render(t,e),this.onAfterUpdate.trigger(this)}dispose(){this.enabled=!1,this.setupEvents(!1),this.three.domElement.remove(),this.three.forceContextLoss(),this.three.dispose(),this.onResize.reset(),this.onAfterUpdate.reset(),this.onBeforeUpdate.reset(),this.onDisposed.trigger(),this.onDisposed.reset()}getSize(){return new Wt(this.three.domElement.clientWidth,this.three.domElement.clientHeight)}setupEvents(t){const e=this.three.domElement.parentElement;if(!e)throw new Error("This renderer needs to have an HTML container!");this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null),window.removeEventListener("resize",this.resizeEvent),t&&(this._resizeObserver=new ResizeObserver(this.resizeEvent),this._resizeObserver.observe(e),window.addEventListener("resize",this.resizeEvent))}setupRenderer(){this.three.localClippingEnabled=!0,this.container&&this.container.appendChild(this.three.domElement),this.onContainerUpdated.trigger()}}/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */const ct={LEFT:1,RIGHT:2,MIDDLE:4},H=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768}),rs={NONE:0,IN:1,OUT:-1};function xe(c){return c.isPerspectiveCamera}function ye(c){return c.isOrthographicCamera}const os=Math.PI*2,Jr=Math.PI/2,Xo=1e-5,Ps=Math.PI/180;function se(c,t,e){return Math.max(t,Math.min(e,c))}function mt(c,t=Xo){return Math.abs(c)<t}function Et(c,t,e=Xo){return mt(c-t,e)}function to(c,t){return Math.round(c/t)*t}function Ls(c){return isFinite(c)?c:c<0?-Number.MAX_VALUE:Number.MAX_VALUE}function ws(c){return Math.abs(c)<Number.MAX_VALUE?c:c*(1/0)}function Ri(c,t,e,s,i=1/0,n){s=Math.max(1e-4,s);const r=2/s,o=r*n,a=1/(1+o+.48*o*o+.235*o*o*o);let l=c-t;const h=t,d=i*s;l=se(l,-d,d),t=c-l;const u=(e.value+r*l)*n;e.value=(e.value-r*u)*a;let f=t+(l+u)*a;return h-c>0==f>h&&(f=h,e.value=(f-h)/n),f}function eo(c,t,e,s,i=1/0,n,r){s=Math.max(1e-4,s);const o=2/s,a=o*n,l=1/(1+a+.48*a*a+.235*a*a*a);let h=t.x,d=t.y,u=t.z,f=c.x-h,I=c.y-d,E=c.z-u;const m=h,C=d,g=u,S=i*s,T=S*S,F=f*f+I*I+E*E;if(F>T){const D=Math.sqrt(F);f=f/D*S,I=I/D*S,E=E/D*S}h=c.x-f,d=c.y-I,u=c.z-E;const y=(e.x+o*f)*n,N=(e.y+o*I)*n,w=(e.z+o*E)*n;e.x=(e.x-o*y)*l,e.y=(e.y-o*N)*l,e.z=(e.z-o*w)*l,r.x=h+(f+y)*l,r.y=d+(I+N)*l,r.z=u+(E+w)*l;const P=m-c.x,M=C-c.y,x=g-c.z,O=r.x-m,v=r.y-C,R=r.z-g;return P*O+M*v+x*R>0&&(r.x=m,r.y=C,r.z=g,e.x=(r.x-m)/n,e.y=(r.y-C)/n,e.z=(r.z-g)/n),r}function dn(c,t){t.set(0,0),c.forEach(e=>{t.x+=e.clientX,t.y+=e.clientY}),t.x/=c.length,t.y/=c.length}function In(c,t){return ye(c)?(console.warn(`${t} is not supported in OrthographicCamera`),!0):!1}class mh{constructor(){this._listeners={}}addEventListener(t,e){const s=this._listeners;s[t]===void 0&&(s[t]=[]),s[t].indexOf(e)===-1&&s[t].push(e)}hasEventListener(t,e){const s=this._listeners;return s[t]!==void 0&&s[t].indexOf(e)!==-1}removeEventListener(t,e){const i=this._listeners[t];if(i!==void 0){const n=i.indexOf(e);n!==-1&&i.splice(n,1)}}removeAllEventListeners(t){if(!t){this._listeners={};return}Array.isArray(this._listeners[t])&&(this._listeners[t].length=0)}dispatchEvent(t){const s=this._listeners[t.type];if(s!==void 0){t.target=this;const i=s.slice(0);for(let n=0,r=i.length;n<r;n++)i[n].call(this,t)}}}const gh="2.7.3",Ai=1/8,Zo=typeof window<"u",Rh=Zo&&/Mac/.test(navigator.platform),Ah=!(Zo&&"PointerEvent"in window);let at,so,Fi,En,Gt,lt,It,as,Ms,ce,le,Ue,io,no,$t,vs,cs,ro,pn,oo,Cn,Tn,Si;class Lt extends mh{static install(t){at=t.THREE,so=Object.freeze(new at.Vector3(0,0,0)),Fi=Object.freeze(new at.Vector3(0,1,0)),En=Object.freeze(new at.Vector3(0,0,1)),Gt=new at.Vector2,lt=new at.Vector3,It=new at.Vector3,as=new at.Vector3,Ms=new at.Vector3,ce=new at.Vector3,le=new at.Vector3,Ue=new at.Vector3,io=new at.Vector3,no=new at.Vector3,$t=new at.Spherical,vs=new at.Spherical,cs=new at.Box3,ro=new at.Box3,pn=new at.Sphere,oo=new at.Quaternion,Cn=new at.Quaternion,Tn=new at.Matrix4,Si=new at.Raycaster}static get ACTION(){return H}constructor(t,e){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=H.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=rs.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new at.Vector3,this._focalOffsetVelocity=new at.Vector3,this._zoomVelocity={value:0},this._truckInternal=(T,F,y)=>{let N,w;if(xe(this._camera)){const P=lt.copy(this._camera.position).sub(this._target),M=this._camera.getEffectiveFOV()*Ps,x=P.length()*Math.tan(M*.5);N=this.truckSpeed*T*x/this._elementRect.height,w=this.truckSpeed*F*x/this._elementRect.height}else if(ye(this._camera)){const P=this._camera;N=T*(P.right-P.left)/P.zoom/this._elementRect.width,w=F*(P.top-P.bottom)/P.zoom/this._elementRect.height}else return;this.verticalDragToForward?(y?this.setFocalOffset(this._focalOffsetEnd.x+N,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(N,0,!0),this.forward(-w,!0)):y?this.setFocalOffset(this._focalOffsetEnd.x+N,this._focalOffsetEnd.y+w,this._focalOffsetEnd.z,!0):this.truck(N,w,!0)},this._rotateInternal=(T,F)=>{const y=os*this.azimuthRotateSpeed*T/this._elementRect.height,N=os*this.polarRotateSpeed*F/this._elementRect.height;this.rotate(y,N,!0)},this._dollyInternal=(T,F,y)=>{const N=Math.pow(.95,-T*this.dollySpeed),w=this._sphericalEnd.radius,P=this._sphericalEnd.radius*N,M=se(P,this.minDistance,this.maxDistance),x=M-P;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(P,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(x,!0),this._dollyToNoClamp(M,!0)):this._dollyToNoClamp(M,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?P:M)-w,this._dollyControlCoord.set(F,y)),this._lastDollyDirection=Math.sign(-T)},this._zoomInternal=(T,F,y)=>{const N=Math.pow(.95,T*this.dollySpeed),w=this._zoom,P=this._zoom*N;this.zoomTo(P,!0),this.dollyToCursor&&(this._changedZoom+=P-w,this._dollyControlCoord.set(F,y))},typeof at>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=t,this._yAxisUpSpace=new at.Quaternion().setFromUnitVectors(this._camera.up,Fi),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=H.NONE,this._target=new at.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new at.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new at.Spherical().setFromVector3(lt.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new at.Vector3,new at.Vector3,new at.Vector3,new at.Vector3],this._updateNearPlaneCorners(),this._boundary=new at.Box3(new at.Vector3(-1/0,-1/0,-1/0),new at.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new at.Vector2,this.mouseButtons={left:H.ROTATE,middle:H.DOLLY,right:H.TRUCK,wheel:xe(this._camera)?H.DOLLY:ye(this._camera)?H.ZOOM:H.NONE},this.touches={one:H.TOUCH_ROTATE,two:xe(this._camera)?H.TOUCH_DOLLY_TRUCK:ye(this._camera)?H.TOUCH_ZOOM_TRUCK:H.NONE,three:H.TOUCH_TRUCK};const s=new at.Vector2,i=new at.Vector2,n=new at.Vector2,r=T=>{if(!this._enabled||!this._domElement)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const N=this._domElement.getBoundingClientRect(),w=T.clientX/N.width,P=T.clientY/N.height;if(w<this._interactiveArea.left||w>this._interactiveArea.right||P<this._interactiveArea.top||P>this._interactiveArea.bottom)return}const F=T.pointerType!=="mouse"?null:(T.buttons&ct.LEFT)===ct.LEFT?ct.LEFT:(T.buttons&ct.MIDDLE)===ct.MIDDLE?ct.MIDDLE:(T.buttons&ct.RIGHT)===ct.RIGHT?ct.RIGHT:null;if(F!==null){const N=this._findPointerByMouseButton(F);N&&this._disposePointer(N)}if((T.buttons&ct.LEFT)===ct.LEFT&&this._lockedPointer)return;const y={pointerId:T.pointerId,clientX:T.clientX,clientY:T.clientY,deltaX:0,deltaY:0,mouseButton:F};this._activePointers.push(y),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",h),this._isDragging=!0,E(T)},o=T=>{if(!this._enabled||!this._domElement||this._lockedPointer)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const N=this._domElement.getBoundingClientRect(),w=T.clientX/N.width,P=T.clientY/N.height;if(w<this._interactiveArea.left||w>this._interactiveArea.right||P<this._interactiveArea.top||P>this._interactiveArea.bottom)return}const F=(T.buttons&ct.LEFT)===ct.LEFT?ct.LEFT:(T.buttons&ct.MIDDLE)===ct.MIDDLE?ct.MIDDLE:(T.buttons&ct.RIGHT)===ct.RIGHT?ct.RIGHT:null;if(F!==null){const N=this._findPointerByMouseButton(F);N&&this._disposePointer(N)}const y={pointerId:1,clientX:T.clientX,clientY:T.clientY,deltaX:0,deltaY:0,mouseButton:(T.buttons&ct.LEFT)===ct.LEFT?ct.LEFT:(T.buttons&ct.MIDDLE)===ct.LEFT?ct.MIDDLE:(T.buttons&ct.RIGHT)===ct.LEFT?ct.RIGHT:null};this._activePointers.push(y),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("mouseup",d),this._domElement.ownerDocument.addEventListener("mousemove",l),this._domElement.ownerDocument.addEventListener("mouseup",d),this._isDragging=!0,E(T)},a=T=>{T.cancelable&&T.preventDefault();const F=T.pointerId,y=this._lockedPointer||this._findPointerById(F);if(y){if(y.clientX=T.clientX,y.clientY=T.clientY,y.deltaX=T.movementX,y.deltaY=T.movementY,this._state=0,T.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(T.buttons&ct.LEFT)===ct.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(T.buttons&ct.MIDDLE)===ct.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(T.buttons&ct.RIGHT)===ct.RIGHT&&(this._state=this._state|this.mouseButtons.right);m()}},l=T=>{const F=this._lockedPointer||this._findPointerById(1);F&&(F.clientX=T.clientX,F.clientY=T.clientY,F.deltaX=T.movementX,F.deltaY=T.movementY,this._state=0,(this._lockedPointer||(T.buttons&ct.LEFT)===ct.LEFT)&&(this._state=this._state|this.mouseButtons.left),(T.buttons&ct.MIDDLE)===ct.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(T.buttons&ct.RIGHT)===ct.RIGHT&&(this._state=this._state|this.mouseButtons.right),m())},h=T=>{const F=this._findPointerById(T.pointerId);if(!(F&&F===this._lockedPointer)){if(F&&this._disposePointer(F),T.pointerType==="touch")switch(this._activePointers.length){case 0:this._state=H.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=H.NONE;C()}},d=()=>{const T=this._findPointerById(1);T&&T===this._lockedPointer||(T&&this._disposePointer(T),this._state=H.NONE,C())};let u=-1;const f=T=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===H.NONE)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const P=this._domElement.getBoundingClientRect(),M=T.clientX/P.width,x=T.clientY/P.height;if(M<this._interactiveArea.left||M>this._interactiveArea.right||x<this._interactiveArea.top||x>this._interactiveArea.bottom)return}if(T.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===H.ROTATE||this.mouseButtons.wheel===H.TRUCK){const P=performance.now();u-P<1e3&&this._getClientRect(this._elementRect),u=P}const F=Rh?-1:-3,y=T.deltaMode===1?T.deltaY/F:T.deltaY/(F*10),N=this.dollyToCursor?(T.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,w=this.dollyToCursor?(T.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case H.ROTATE:{this._rotateInternal(T.deltaX,T.deltaY),this._isUserControllingRotate=!0;break}case H.TRUCK:{this._truckInternal(T.deltaX,T.deltaY,!1),this._isUserControllingTruck=!0;break}case H.OFFSET:{this._truckInternal(T.deltaX,T.deltaY,!0),this._isUserControllingOffset=!0;break}case H.DOLLY:{this._dollyInternal(-y,N,w),this._isUserControllingDolly=!0;break}case H.ZOOM:{this._zoomInternal(-y,N,w),this._isUserControllingZoom=!0;break}}this.dispatchEvent({type:"control"})},I=T=>{if(!(!this._domElement||!this._enabled)){if(this.mouseButtons.right===Lt.ACTION.NONE){const F=T instanceof PointerEvent?T.pointerId:(T instanceof MouseEvent,0),y=this._findPointerById(F);y&&this._disposePointer(y),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("mouseup",d);return}T.preventDefault()}},E=T=>{if(!this._enabled)return;if(dn(this._activePointers,Gt),this._getClientRect(this._elementRect),s.copy(Gt),i.copy(Gt),this._activePointers.length>=2){const y=Gt.x-this._activePointers[1].clientX,N=Gt.y-this._activePointers[1].clientY,w=Math.sqrt(y*y+N*N);n.set(0,w);const P=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,M=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;i.set(P,M)}if(this._state=0,!T)this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);else if("pointerType"in T&&T.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else!this._lockedPointer&&(T.buttons&ct.LEFT)===ct.LEFT&&(this._state=this._state|this.mouseButtons.left),(T.buttons&ct.MIDDLE)===ct.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(T.buttons&ct.RIGHT)===ct.RIGHT&&(this._state=this._state|this.mouseButtons.right);((this._state&H.ROTATE)===H.ROTATE||(this._state&H.TOUCH_ROTATE)===H.TOUCH_ROTATE||(this._state&H.TOUCH_DOLLY_ROTATE)===H.TOUCH_DOLLY_ROTATE||(this._state&H.TOUCH_ZOOM_ROTATE)===H.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&H.TRUCK)===H.TRUCK||(this._state&H.TOUCH_TRUCK)===H.TOUCH_TRUCK||(this._state&H.TOUCH_DOLLY_TRUCK)===H.TOUCH_DOLLY_TRUCK||(this._state&H.TOUCH_ZOOM_TRUCK)===H.TOUCH_ZOOM_TRUCK)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&H.DOLLY)===H.DOLLY||(this._state&H.TOUCH_DOLLY)===H.TOUCH_DOLLY||(this._state&H.TOUCH_DOLLY_TRUCK)===H.TOUCH_DOLLY_TRUCK||(this._state&H.TOUCH_DOLLY_OFFSET)===H.TOUCH_DOLLY_OFFSET||(this._state&H.TOUCH_DOLLY_ROTATE)===H.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&H.ZOOM)===H.ZOOM||(this._state&H.TOUCH_ZOOM)===H.TOUCH_ZOOM||(this._state&H.TOUCH_ZOOM_TRUCK)===H.TOUCH_ZOOM_TRUCK||(this._state&H.TOUCH_ZOOM_OFFSET)===H.TOUCH_ZOOM_OFFSET||(this._state&H.TOUCH_ZOOM_ROTATE)===H.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&H.OFFSET)===H.OFFSET||(this._state&H.TOUCH_OFFSET)===H.TOUCH_OFFSET||(this._state&H.TOUCH_DOLLY_OFFSET)===H.TOUCH_DOLLY_OFFSET||(this._state&H.TOUCH_ZOOM_OFFSET)===H.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})},m=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,dn(this._activePointers,Gt);const F=this._domElement&&document.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,y=F?-F.deltaX:i.x-Gt.x,N=F?-F.deltaY:i.y-Gt.y;if(i.copy(Gt),((this._state&H.ROTATE)===H.ROTATE||(this._state&H.TOUCH_ROTATE)===H.TOUCH_ROTATE||(this._state&H.TOUCH_DOLLY_ROTATE)===H.TOUCH_DOLLY_ROTATE||(this._state&H.TOUCH_ZOOM_ROTATE)===H.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(y,N),this._isUserControllingRotate=!0),(this._state&H.DOLLY)===H.DOLLY||(this._state&H.ZOOM)===H.ZOOM){const w=this.dollyToCursor?(s.x-this._elementRect.x)/this._elementRect.width*2-1:0,P=this.dollyToCursor?(s.y-this._elementRect.y)/this._elementRect.height*-2+1:0,M=this.dollyDragInverted?-1:1;(this._state&H.DOLLY)===H.DOLLY?(this._dollyInternal(M*N*Ai,w,P),this._isUserControllingDolly=!0):(this._zoomInternal(M*N*Ai,w,P),this._isUserControllingZoom=!0)}if((this._state&H.TOUCH_DOLLY)===H.TOUCH_DOLLY||(this._state&H.TOUCH_ZOOM)===H.TOUCH_ZOOM||(this._state&H.TOUCH_DOLLY_TRUCK)===H.TOUCH_DOLLY_TRUCK||(this._state&H.TOUCH_ZOOM_TRUCK)===H.TOUCH_ZOOM_TRUCK||(this._state&H.TOUCH_DOLLY_OFFSET)===H.TOUCH_DOLLY_OFFSET||(this._state&H.TOUCH_ZOOM_OFFSET)===H.TOUCH_ZOOM_OFFSET||(this._state&H.TOUCH_DOLLY_ROTATE)===H.TOUCH_DOLLY_ROTATE||(this._state&H.TOUCH_ZOOM_ROTATE)===H.TOUCH_ZOOM_ROTATE){const w=Gt.x-this._activePointers[1].clientX,P=Gt.y-this._activePointers[1].clientY,M=Math.sqrt(w*w+P*P),x=n.y-M;n.set(0,M);const O=this.dollyToCursor?(i.x-this._elementRect.x)/this._elementRect.width*2-1:0,v=this.dollyToCursor?(i.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&H.TOUCH_DOLLY)===H.TOUCH_DOLLY||(this._state&H.TOUCH_DOLLY_ROTATE)===H.TOUCH_DOLLY_ROTATE||(this._state&H.TOUCH_DOLLY_TRUCK)===H.TOUCH_DOLLY_TRUCK||(this._state&H.TOUCH_DOLLY_OFFSET)===H.TOUCH_DOLLY_OFFSET?(this._dollyInternal(x*Ai,O,v),this._isUserControllingDolly=!0):(this._zoomInternal(x*Ai,O,v),this._isUserControllingZoom=!0)}((this._state&H.TRUCK)===H.TRUCK||(this._state&H.TOUCH_TRUCK)===H.TOUCH_TRUCK||(this._state&H.TOUCH_DOLLY_TRUCK)===H.TOUCH_DOLLY_TRUCK||(this._state&H.TOUCH_ZOOM_TRUCK)===H.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(y,N,!1),this._isUserControllingTruck=!0),((this._state&H.OFFSET)===H.OFFSET||(this._state&H.TOUCH_OFFSET)===H.TOUCH_OFFSET||(this._state&H.TOUCH_DOLLY_OFFSET)===H.TOUCH_DOLLY_OFFSET||(this._state&H.TOUCH_ZOOM_OFFSET)===H.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(y,N,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},C=()=>{dn(this._activePointers,Gt),i.copy(Gt),this._dragNeedsUpdate=!1,(this._activePointers.length===0||this._activePointers.length===1&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),this._activePointers.length===0&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.removeEventListener("mouseup",d),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",g),this._domElement.ownerDocument.addEventListener("pointerlockerror",S),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",h),E())},this.unlockPointer=()=>{this._lockedPointer!==null&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),document.exitPointerLock(),this.cancel(),this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointerlockchange",g),this._domElement.ownerDocument.removeEventListener("pointerlockerror",S))};const g=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},S=()=>{this.unlockPointer()};this._addAllEventListeners=T=>{this._domElement=T,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",r),Ah&&this._domElement.addEventListener("mousedown",o),this._domElement.addEventListener("pointercancel",h),this._domElement.addEventListener("wheel",f,{passive:!1}),this._domElement.addEventListener("contextmenu",I)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",r),this._domElement.removeEventListener("mousedown",o),this._domElement.removeEventListener("pointercancel",h),this._domElement.removeEventListener("wheel",f,{passive:!1}),this._domElement.removeEventListener("contextmenu",I),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.removeEventListener("mouseup",d),this._domElement.ownerDocument.removeEventListener("pointerlockchange",g),this._domElement.ownerDocument.removeEventListener("pointerlockerror",S))},this.cancel=()=>{this._state!==H.NONE&&(this._state=H.NONE,this._activePointers.length=0,C())},e&&this.connect(e),this.update(0)}get camera(){return this._camera}set camera(t){this._camera=t,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._domElement&&(t?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(t){this._spherical.radius===t&&this._sphericalEnd.radius===t||(this._spherical.radius=t,this._sphericalEnd.radius=t,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(t){this._spherical.theta===t&&this._sphericalEnd.theta===t||(this._spherical.theta=t,this._sphericalEnd.theta=t,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(t){this._spherical.phi===t&&this._sphericalEnd.phi===t||(this._spherical.phi=t,this._sphericalEnd.phi=t,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(t){this._boundaryEnclosesCamera=t,this._needsUpdate=!0}set interactiveArea(t){this._interactiveArea.width=se(t.width,0,1),this._interactiveArea.height=se(t.height,0,1),this._interactiveArea.x=se(t.x,0,1-this._interactiveArea.width),this._interactiveArea.y=se(t.y,0,1-this._interactiveArea.height)}addEventListener(t,e){super.addEventListener(t,e)}removeEventListener(t,e){super.removeEventListener(t,e)}rotate(t,e,s=!1){return this.rotateTo(this._sphericalEnd.theta+t,this._sphericalEnd.phi+e,s)}rotateAzimuthTo(t,e=!1){return this.rotateTo(t,this._sphericalEnd.phi,e)}rotatePolarTo(t,e=!1){return this.rotateTo(this._sphericalEnd.theta,t,e)}rotateTo(t,e,s=!1){this._isUserControllingRotate=!1;const i=se(t,this.minAzimuthAngle,this.maxAzimuthAngle),n=se(e,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=i,this._sphericalEnd.phi=n,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,s||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const r=!s||Et(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Et(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(r)}dolly(t,e=!1){return this.dollyTo(this._sphericalEnd.radius-t,e)}dollyTo(t,e=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=rs.NONE,this._changedDolly=0,this._dollyToNoClamp(se(t,this.minDistance,this.maxDistance),e)}_dollyToNoClamp(t,e=!1){const s=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const r=this._collisionTest(),o=Et(r,this._spherical.radius);if(!(s>t)&&o)return Promise.resolve();this._sphericalEnd.radius=Math.min(t,r)}else this._sphericalEnd.radius=t;this._needsUpdate=!0,e||(this._spherical.radius=this._sphericalEnd.radius);const n=!e||Et(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(n)}dollyInFixed(t,e=!1){this._targetEnd.add(this._getCameraDirection(Ms).multiplyScalar(t)),e||this._target.copy(this._targetEnd);const s=!e||Et(this._target.x,this._targetEnd.x,this.restThreshold)&&Et(this._target.y,this._targetEnd.y,this.restThreshold)&&Et(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(s)}zoom(t,e=!1){return this.zoomTo(this._zoomEnd+t,e)}zoomTo(t,e=!1){this._isUserControllingZoom=!1,this._zoomEnd=se(t,this.minZoom,this.maxZoom),this._needsUpdate=!0,e||(this._zoom=this._zoomEnd);const s=!e||Et(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(s)}pan(t,e,s=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(t,e,s)}truck(t,e,s=!1){this._camera.updateMatrix(),ce.setFromMatrixColumn(this._camera.matrix,0),le.setFromMatrixColumn(this._camera.matrix,1),ce.multiplyScalar(t),le.multiplyScalar(-e);const i=lt.copy(ce).add(le),n=It.copy(this._targetEnd).add(i);return this.moveTo(n.x,n.y,n.z,s)}forward(t,e=!1){lt.setFromMatrixColumn(this._camera.matrix,0),lt.crossVectors(this._camera.up,lt),lt.multiplyScalar(t);const s=It.copy(this._targetEnd).add(lt);return this.moveTo(s.x,s.y,s.z,e)}elevate(t,e=!1){return lt.copy(this._camera.up).multiplyScalar(t),this.moveTo(this._targetEnd.x+lt.x,this._targetEnd.y+lt.y,this._targetEnd.z+lt.z,e)}moveTo(t,e,s,i=!1){this._isUserControllingTruck=!1;const n=lt.set(t,e,s).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,n,this.boundaryFriction),this._needsUpdate=!0,i||this._target.copy(this._targetEnd);const r=!i||Et(this._target.x,this._targetEnd.x,this.restThreshold)&&Et(this._target.y,this._targetEnd.y,this.restThreshold)&&Et(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(r)}lookInDirectionOf(t,e,s,i=!1){const o=lt.set(t,e,s).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius);return this.setPosition(o.x,o.y,o.z,i)}fitToBox(t,e,{cover:s=!1,paddingLeft:i=0,paddingRight:n=0,paddingBottom:r=0,paddingTop:o=0}={}){const a=[],l=t.isBox3?cs.copy(t):cs.setFromObject(t);l.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const h=to(this._sphericalEnd.theta,Jr),d=to(this._sphericalEnd.phi,Jr);a.push(this.rotateTo(h,d,e));const u=lt.setFromSpherical(this._sphericalEnd).normalize(),f=oo.setFromUnitVectors(u,En),I=Et(Math.abs(u.y),1);I&&f.multiply(Cn.setFromAxisAngle(Fi,h)),f.multiply(this._yAxisUpSpaceInverse);const E=ro.makeEmpty();It.copy(l.min).applyQuaternion(f),E.expandByPoint(It),It.copy(l.min).setX(l.max.x).applyQuaternion(f),E.expandByPoint(It),It.copy(l.min).setY(l.max.y).applyQuaternion(f),E.expandByPoint(It),It.copy(l.max).setZ(l.min.z).applyQuaternion(f),E.expandByPoint(It),It.copy(l.min).setZ(l.max.z).applyQuaternion(f),E.expandByPoint(It),It.copy(l.max).setY(l.min.y).applyQuaternion(f),E.expandByPoint(It),It.copy(l.max).setX(l.min.x).applyQuaternion(f),E.expandByPoint(It),It.copy(l.max).applyQuaternion(f),E.expandByPoint(It),E.min.x-=i,E.min.y-=r,E.max.x+=n,E.max.y+=o,f.setFromUnitVectors(En,u),I&&f.premultiply(Cn.invert()),f.premultiply(this._yAxisUpSpace);const m=E.getSize(lt),C=E.getCenter(It).applyQuaternion(f);if(xe(this._camera)){const g=this.getDistanceToFitBox(m.x,m.y,m.z,s);a.push(this.moveTo(C.x,C.y,C.z,e)),a.push(this.dollyTo(g,e)),a.push(this.setFocalOffset(0,0,0,e))}else if(ye(this._camera)){const g=this._camera,S=g.right-g.left,T=g.top-g.bottom,F=s?Math.max(S/m.x,T/m.y):Math.min(S/m.x,T/m.y);a.push(this.moveTo(C.x,C.y,C.z,e)),a.push(this.zoomTo(F,e)),a.push(this.setFocalOffset(0,0,0,e))}return Promise.all(a)}fitToSphere(t,e){const s=[],n=t instanceof at.Sphere?pn.copy(t):Lt.createBoundingSphere(t,pn);if(s.push(this.moveTo(n.center.x,n.center.y,n.center.z,e)),xe(this._camera)){const r=this.getDistanceToFitSphere(n.radius);s.push(this.dollyTo(r,e))}else if(ye(this._camera)){const r=this._camera.right-this._camera.left,o=this._camera.top-this._camera.bottom,a=2*n.radius,l=Math.min(r/a,o/a);s.push(this.zoomTo(l,e))}return s.push(this.setFocalOffset(0,0,0,e)),Promise.all(s)}setLookAt(t,e,s,i,n,r,o=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=rs.NONE,this._changedDolly=0;const a=It.set(i,n,r),l=lt.set(t,e,s);this._targetEnd.copy(a),this._sphericalEnd.setFromVector3(l.sub(a).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,o||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const h=!o||Et(this._target.x,this._targetEnd.x,this.restThreshold)&&Et(this._target.y,this._targetEnd.y,this.restThreshold)&&Et(this._target.z,this._targetEnd.z,this.restThreshold)&&Et(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Et(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Et(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(h)}lerpLookAt(t,e,s,i,n,r,o,a,l,h,d,u,f,I=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=rs.NONE,this._changedDolly=0;const E=lt.set(i,n,r),m=It.set(t,e,s);$t.setFromVector3(m.sub(E).applyQuaternion(this._yAxisUpSpace));const C=as.set(h,d,u),g=It.set(o,a,l);vs.setFromVector3(g.sub(C).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(E.lerp(C,f));const S=vs.theta-$t.theta,T=vs.phi-$t.phi,F=vs.radius-$t.radius;this._sphericalEnd.set($t.radius+F*f,$t.phi+T*f,$t.theta+S*f),this.normalizeRotations(),this._needsUpdate=!0,I||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const y=!I||Et(this._target.x,this._targetEnd.x,this.restThreshold)&&Et(this._target.y,this._targetEnd.y,this.restThreshold)&&Et(this._target.z,this._targetEnd.z,this.restThreshold)&&Et(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Et(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Et(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(y)}setPosition(t,e,s,i=!1){return this.setLookAt(t,e,s,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,i)}setTarget(t,e,s,i=!1){const n=this.getPosition(lt),r=this.setLookAt(n.x,n.y,n.z,t,e,s,i);return this._sphericalEnd.phi=se(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),r}setFocalOffset(t,e,s,i=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(t,e,s),this._needsUpdate=!0,i||this._focalOffset.copy(this._focalOffsetEnd);const n=!i||Et(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&Et(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&Et(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}setOrbitPoint(t,e,s){this._camera.updateMatrixWorld(),ce.setFromMatrixColumn(this._camera.matrixWorldInverse,0),le.setFromMatrixColumn(this._camera.matrixWorldInverse,1),Ue.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const i=lt.set(t,e,s),n=i.distanceTo(this._camera.position),r=i.sub(this._camera.position);ce.multiplyScalar(r.x),le.multiplyScalar(r.y),Ue.multiplyScalar(r.z),lt.copy(ce).add(le).add(Ue),lt.z=lt.z+n,this.dollyTo(n,!1),this.setFocalOffset(-lt.x,lt.y,-lt.z,!1),this.moveTo(t,e,s,!1)}setBoundary(t){if(!t){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(t),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(t,e,s,i){if(t===null){this._viewport=null;return}this._viewport=this._viewport||new at.Vector4,typeof t=="number"?this._viewport.set(t,e,s,i):this._viewport.copy(t)}getDistanceToFitBox(t,e,s,i=!1){if(In(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const n=t/e,r=this._camera.getEffectiveFOV()*Ps,o=this._camera.aspect;return((i?n>o:n<o)?e:t/o)*.5/Math.tan(r*.5)+s*.5}getDistanceToFitSphere(t){if(In(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const e=this._camera.getEffectiveFOV()*Ps,s=Math.atan(Math.tan(e*.5)*this._camera.aspect)*2,i=1<this._camera.aspect?e:s;return t/Math.sin(i*.5)}getTarget(t,e=!0){return(t&&t.isVector3?t:new at.Vector3).copy(e?this._targetEnd:this._target)}getPosition(t,e=!0){return(t&&t.isVector3?t:new at.Vector3).setFromSpherical(e?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(e?this._targetEnd:this._target)}getSpherical(t,e=!0){return(t&&t instanceof at.Spherical?t:new at.Spherical).copy(e?this._sphericalEnd:this._spherical)}getFocalOffset(t,e=!0){return(t&&t.isVector3?t:new at.Vector3).copy(e?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%os,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=os),this._spherical.theta+=os*Math.round((this._sphericalEnd.theta-this._spherical.theta)/os)}reset(t=!1){if(!Et(this._camera.up.x,this._cameraUp0.x)||!Et(this._camera.up.y,this._cameraUp0.y)||!Et(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const s=this.getPosition(lt);this.updateCameraUp(),this.setPosition(s.x,s.y,s.z)}const e=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,t),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,t),this.zoomTo(this._zoom0,t)];return Promise.all(e)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,Fi),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const t=lt.subVectors(this._target,this._camera.position).normalize(),e=It.crossVectors(t,this._camera.up);this._camera.up.crossVectors(e,t).normalize(),this._camera.updateMatrixWorld();const s=this.getPosition(lt);this.updateCameraUp(),this.setPosition(s.x,s.y,s.z)}update(t){const e=this._sphericalEnd.theta-this._spherical.theta,s=this._sphericalEnd.phi-this._spherical.phi,i=this._sphericalEnd.radius-this._spherical.radius,n=io.subVectors(this._targetEnd,this._target),r=no.subVectors(this._focalOffsetEnd,this._focalOffset),o=this._zoomEnd-this._zoom;if(mt(e))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const d=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=Ri(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,d,1/0,t),this._needsUpdate=!0}if(mt(s))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const d=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=Ri(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,d,1/0,t),this._needsUpdate=!0}if(mt(i))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const d=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=Ri(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,d,this.maxSpeed,t),this._needsUpdate=!0}if(mt(n.x)&&mt(n.y)&&mt(n.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const d=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;eo(this._target,this._targetEnd,this._targetVelocity,d,this.maxSpeed,t,this._target),this._needsUpdate=!0}if(mt(r.x)&&mt(r.y)&&mt(r.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const d=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;eo(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,d,this.maxSpeed,t,this._focalOffset),this._needsUpdate=!0}if(mt(o))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const d=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=Ri(this._zoom,this._zoomEnd,this._zoomVelocity,d,1/0,t)}if(this.dollyToCursor){if(xe(this._camera)&&this._changedDolly!==0){const d=this._spherical.radius-this._lastDistance,u=this._camera,f=this._getCameraDirection(Ms),I=lt.copy(f).cross(u.up).normalize();I.lengthSq()===0&&(I.x=1);const E=It.crossVectors(I,f),m=this._sphericalEnd.radius*Math.tan(u.getEffectiveFOV()*Ps*.5),g=(this._sphericalEnd.radius-d-this._sphericalEnd.radius)/this._sphericalEnd.radius,S=as.copy(this._targetEnd).add(I.multiplyScalar(this._dollyControlCoord.x*m*u.aspect)).add(E.multiplyScalar(this._dollyControlCoord.y*m)),T=lt.copy(this._targetEnd).lerp(S,g),F=this._lastDollyDirection===rs.IN&&this._spherical.radius<=this.minDistance,y=this._lastDollyDirection===rs.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(F||y)){this._sphericalEnd.radius-=d,this._spherical.radius-=d;const w=It.copy(f).multiplyScalar(-d);T.add(w)}this._boundary.clampPoint(T,T);const N=It.subVectors(T,this._targetEnd);this._targetEnd.copy(T),this._target.add(N),this._changedDolly-=d,mt(this._changedDolly)&&(this._changedDolly=0)}else if(ye(this._camera)&&this._changedZoom!==0){const d=this._zoom-this._lastZoom,u=this._camera,f=lt.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(u.near+u.far)/(u.near-u.far)).unproject(u),I=It.set(0,0,-1).applyQuaternion(u.quaternion),E=as.copy(f).add(I.multiplyScalar(-f.dot(u.up))),C=-(this._zoom-d-this._zoom)/this._zoom,g=this._getCameraDirection(Ms),S=this._targetEnd.dot(g),T=lt.copy(this._targetEnd).lerp(E,C),F=T.dot(g),y=g.multiplyScalar(F-S);T.sub(y),this._boundary.clampPoint(T,T);const N=It.subVectors(T,this._targetEnd);this._targetEnd.copy(T),this._target.add(N),this._changedZoom-=d,mt(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const a=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,a),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!mt(this._focalOffset.x)||!mt(this._focalOffset.y)||!mt(this._focalOffset.z))&&(this._camera.updateMatrixWorld(),ce.setFromMatrixColumn(this._camera.matrix,0),le.setFromMatrixColumn(this._camera.matrix,1),Ue.setFromMatrixColumn(this._camera.matrix,2),ce.multiplyScalar(this._focalOffset.x),le.multiplyScalar(-this._focalOffset.y),Ue.multiplyScalar(this._focalOffset.z),lt.copy(ce).add(le).add(Ue),this._camera.position.add(lt)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),lt.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const h=this._needsUpdate;return h&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):h?(this.dispatchEvent({type:"update"}),mt(e,this.restThreshold)&&mt(s,this.restThreshold)&&mt(i,this.restThreshold)&&mt(n.x,this.restThreshold)&&mt(n.y,this.restThreshold)&&mt(n.z,this.restThreshold)&&mt(r.x,this.restThreshold)&&mt(r.y,this.restThreshold)&&mt(r.z,this.restThreshold)&&mt(o,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!h&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=h,this._needsUpdate=!1,h}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:Ls(this.maxDistance),minZoom:this.minZoom,maxZoom:Ls(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:Ls(this.maxPolarAngle),minAzimuthAngle:Ls(this.minAzimuthAngle),maxAzimuthAngle:Ls(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:lt.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(t,e=!1){const s=JSON.parse(t);this.enabled=s.enabled,this.minDistance=s.minDistance,this.maxDistance=ws(s.maxDistance),this.minZoom=s.minZoom,this.maxZoom=ws(s.maxZoom),this.minPolarAngle=s.minPolarAngle,this.maxPolarAngle=ws(s.maxPolarAngle),this.minAzimuthAngle=ws(s.minAzimuthAngle),this.maxAzimuthAngle=ws(s.maxAzimuthAngle),this.smoothTime=s.smoothTime,this.draggingSmoothTime=s.draggingSmoothTime,this.dollySpeed=s.dollySpeed,this.truckSpeed=s.truckSpeed,this.dollyToCursor=s.dollyToCursor,this.verticalDragToForward=s.verticalDragToForward,this._target0.fromArray(s.target0),this._position0.fromArray(s.position0),this._zoom0=s.zoom0,this._focalOffset0.fromArray(s.focalOffset0),this.moveTo(s.target[0],s.target[1],s.target[2],e),$t.setFromVector3(lt.fromArray(s.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo($t.theta,$t.phi,e),this.dollyTo($t.radius,e),this.zoomTo(s.zoom,e),this.setFocalOffset(s.focalOffset[0],s.focalOffset[1],s.focalOffset[2],e),this._needsUpdate=!0}connect(t){if(this._domElement){console.warn("camera-controls is already connected.");return}t.setAttribute("data-camera-controls-version",gh),this._addAllEventListeners(t),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(t){return t.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(t){return this._getTargetDirection(t).negate()}_findPointerById(t){return this._activePointers.find(e=>e.pointerId===t)}_findPointerByMouseButton(t){return this._activePointers.find(e=>e.mouseButton===t)}_disposePointer(t){this._activePointers.splice(this._activePointers.indexOf(t),1)}_encloseToBoundary(t,e,s){const i=e.lengthSq();if(i===0)return t;const n=It.copy(e).add(t),o=this._boundary.clampPoint(n,as).sub(n),a=o.lengthSq();if(a===0)return t.add(e);if(a===i)return t;if(s===0)return t.add(e).add(o);{const l=1+s*a/e.dot(o);return t.add(It.copy(e).multiplyScalar(l)).add(o.multiplyScalar(1-s))}}_updateNearPlaneCorners(){if(xe(this._camera)){const t=this._camera,e=t.near,s=t.getEffectiveFOV()*Ps,i=Math.tan(s*.5)*e,n=i*t.aspect;this._nearPlaneCorners[0].set(-n,-i,0),this._nearPlaneCorners[1].set(n,-i,0),this._nearPlaneCorners[2].set(n,i,0),this._nearPlaneCorners[3].set(-n,i,0)}else if(ye(this._camera)){const t=this._camera,e=1/t.zoom,s=t.left*e,i=t.right*e,n=t.top*e,r=t.bottom*e;this._nearPlaneCorners[0].set(s,n,0),this._nearPlaneCorners[1].set(i,n,0),this._nearPlaneCorners[2].set(i,r,0),this._nearPlaneCorners[3].set(s,r,0)}}_collisionTest(){let t=1/0;if(!(this.colliderMeshes.length>=1)||In(this._camera,"_collisionTest"))return t;const s=this._getTargetDirection(Ms);Tn.lookAt(so,s,this._camera.up);for(let i=0;i<4;i++){const n=It.copy(this._nearPlaneCorners[i]);n.applyMatrix4(Tn);const r=as.addVectors(this._target,n);Si.set(r,s),Si.far=this._spherical.radius+1;const o=Si.intersectObjects(this.colliderMeshes);o.length!==0&&o[0].distance<t&&(t=o[0].distance)}return t}_getClientRect(t){if(!this._domElement)return;const e=this._domElement.getBoundingClientRect();return t.x=e.left,t.y=e.top,this._viewport?(t.x+=this._viewport.x,t.y+=e.height-this._viewport.w-this._viewport.y,t.width=this._viewport.z,t.height=this._viewport.w):(t.width=e.width,t.height=e.height),t}_createOnRestPromise(t){return t?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(e=>{const s=()=>{this.removeEventListener("rest",s),e()};this.addEventListener("rest",s)}))}_addAllEventListeners(t){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(t){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(t){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(t,e=new at.Sphere){const s=e,i=s.center;cs.makeEmpty(),t.traverseVisible(r=>{r.isMesh&&cs.expandByObject(r)}),cs.getCenter(i);let n=0;return t.traverseVisible(r=>{if(!r.isMesh)return;const o=r,a=o.geometry.clone();a.applyMatrix4(o.matrixWorld);const h=a.attributes.position;for(let d=0,u=h.count;d<u;d++)lt.fromBufferAttribute(h,d),n=Math.max(n,i.distanceToSquared(lt))}),s.radius=Math.sqrt(n),s}}class js extends Bl{constructor(t){super(t),p(this,"onBeforeUpdate",new q),p(this,"onAfterUpdate",new q),p(this,"onAspectUpdated",new q),p(this,"onDisposed",new q),p(this,"three"),p(this,"_allControls",new Map),p(this,"updateAspect",()=>{var e;if(!(!this.currentWorld||!this.currentWorld.renderer)){if(this.three instanceof ke){this.onAspectUpdated.trigger();return}if((e=this.currentWorld.renderer)!=null&&e.isResizeable()){const s=this.currentWorld.renderer.getSize();this.three.aspect=s.width/s.height,this.three.updateProjectionMatrix(),this.onAspectUpdated.trigger()}}}),this.three=this.setupCamera(),this.setupEvents(!0),this.onWorldChanged.add(({action:e,world:s})=>{if(e==="added"){const i=this.newCameraControls();this._allControls.set(s.uuid,i)}if(e==="removed"){const i=this._allControls.get(s.uuid);i&&(i.dispose(),this._allControls.delete(s.uuid))}})}get controls(){if(!this.currentWorld)throw new Error("This camera needs a world to work!");const t=this._allControls.get(this.currentWorld.uuid);if(!t)throw new Error("Controls not found!");return t}get enabled(){return this.currentWorld===null?!1:this.controls.enabled}set enabled(t){this.currentWorld!==null&&(this.controls.enabled=t)}dispose(){this.setupEvents(!1),this.onAspectUpdated.reset(),this.onBeforeUpdate.reset(),this.onAfterUpdate.reset(),this.three.removeFromParent(),this.onDisposed.trigger(),this.onDisposed.reset();for(const[t,e]of this._allControls)e.dispose()}update(t){this.enabled&&(this.onBeforeUpdate.trigger(this),this.controls.update(t),this.onAfterUpdate.trigger(this))}setupCamera(){const t=window.innerWidth/window.innerHeight,e=new Hn(60,t,1,1e3);return e.position.set(50,50,50),e.lookAt(new B(0,0,0)),e}newCameraControls(){if(!this.currentWorld)throw new Error("This camera needs a world to work!");if(!this.currentWorld.renderer)throw new Error("This camera needs a renderer to work!");Lt.install({THREE:js.getSubsetOfThree()});const{domElement:t}=this.currentWorld.renderer.three,e=new Lt(this.three,t);return e.smoothTime=.2,e.dollyToCursor=!0,e.infinityDolly=!0,e.minDistance=6,e}setupEvents(t){t?window.addEventListener("resize",this.updateAspect):window.removeEventListener("resize",this.updateAspect)}static getSubsetOfThree(){return{MOUSE:tc,Vector2:Wt,Vector3:B,Vector4:ec,Quaternion:ne,Matrix4:ft,Spherical:sc,Box3:vt,Sphere:Vi,Raycaster:Wn,MathUtils:Di}}}const $o=class jo extends Rt{constructor(t){super(t),p(this,"onAfterUpdate",new q),p(this,"onBeforeUpdate",new q),p(this,"onDisposed",new q),p(this,"list",new oe),p(this,"enabled",!0),t.add(jo.uuid,this)}create(){const t=new Ih(this.components),e=t.uuid;if(this.list.has(e))throw new Error("There is already a world with this name!");return this.list.set(e,t),t}delete(t){if(!this.list.has(t.uuid))throw new Error("The provided world is not found in the list!");this.list.delete(t.uuid),t.dispose()}dispose(){this.enabled=!1;for(const[t,e]of this.list)e.dispose();this.list.clear(),this.onDisposed.trigger()}update(t){if(this.enabled)for(const[e,s]of this.list)s.update(t)}};p($o,"uuid","fdb61dc4-2ec1-4966-b83d-54ea795fad4a");let qo=$o;function Fh(c,t,e,s){return new Promise((i,n)=>{function r(){const o=c.clientWaitSync(t,e,0);if(o===c.WAIT_FAILED){n();return}if(o===c.TIMEOUT_EXPIRED){setTimeout(r,s);return}i()}r()})}async function Sh(c,t,e,s,i,n,r){const o=c.fenceSync(c.SYNC_GPU_COMMANDS_COMPLETE,0);c.flush(),await Fh(c,o,0,10),c.deleteSync(o),c.bindBuffer(t,e),c.getBufferSubData(t,s,i,n,r),c.bindBuffer(t,null)}async function Qo(c,t,e,s,i,n,r,o){const a=c.createBuffer();return c.bindBuffer(c.PIXEL_PACK_BUFFER,a),c.bufferData(c.PIXEL_PACK_BUFFER,o.byteLength,c.STREAM_READ),c.readPixels(t,e,s,i,n,r,0),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),await Sh(c,c.PIXEL_PACK_BUFFER,a,0,o),c.deleteBuffer(a),o}class Oh extends Ze{constructor(){super(...arguments),p(this,"_config",{enabled:{value:!0,type:"Boolean"},width:{type:"Number",interpolable:!0,value:512,min:32,max:1024},height:{type:"Number",interpolable:!0,value:512,min:32,max:1024},autoUpdate:{value:!0,type:"Boolean"},renderDebugFrame:{value:!1,type:"Boolean"},updateInterval:{type:"Number",interpolable:!0,value:1,min:0,max:1},threshold:{type:"Number",interpolable:!0,value:100,min:1,max:512}}),p(this,"_interval",null)}get enabled(){return this._config.enabled.value}set enabled(t){this._config.enabled.value=t,this._component.enabled=t}get width(){return this._config.width.value}set width(t){this.setWidthHeight(t,this.height)}get height(){return this._config.height.value}set height(t){this.setWidthHeight(this.width,t)}get autoUpdate(){return this._config.autoUpdate.value}set autoUpdate(t){this.setAutoAndInterval(t,this.updateInterval)}get updateInterval(){return this._config.updateInterval.value}set updateInterval(t){this.setAutoAndInterval(this.autoUpdate,t)}get renderDebugFrame(){return this._config.renderDebugFrame.value}set renderDebugFrame(t){this._config.renderDebugFrame.value=t}get threshold(){return this._config.threshold.value}set threshold(t){this._config.threshold.value=t}setWidthHeight(t,e){if(t<=0||e<=0)throw new Error("The width and height of the culler renderer must be more than 0!");this._config.width.value=t,this._config.height.value=e,this.resetRenderTarget()}setAutoAndInterval(t,e){if(e<=0)throw new Error("The updateInterval of the culler renderer must be more than 0!");this._config.autoUpdate.value=t,this._config.updateInterval.value=e,this.resetInterval(t)}resetRenderTarget(){this._component.renderTarget.dispose(),this._component.renderTarget=new bi(this.width,this.height),this._component.bufferSize=this.width*this.height*4,this._component.buffer=new Uint8Array(this._component.bufferSize)}resetInterval(t){this._interval!==null&&window.clearInterval(this._interval),t&&(this._interval=window.setInterval(async()=>{this._component.preventUpdate||await this._component.updateVisibility()},this.updateInterval))}}class yh{constructor(t,e){if(p(this,"onSetup",new q),p(this,"onDisposed",new q),p(this,"onViewUpdated",new we),p(this,"enabled",!0),p(this,"needsUpdate",!1),p(this,"components"),p(this,"renderTarget",new bi),p(this,"bufferSize",1),p(this,"buffer",new Uint8Array),p(this,"preventUpdate",!1),p(this,"config"),p(this,"isSetup",!1),p(this,"world"),p(this,"renderer"),p(this,"_defaultConfig",{enabled:!0,height:512,width:512,updateInterval:1e3,autoUpdate:!0,renderDebugFrame:!1,threshold:100}),p(this,"worker"),p(this,"scene",new Yi),p(this,"_availableColor",1),p(this,"_isWorkerBusy",!1),p(this,"updateVisibility",async n=>{if(!this.enabled||!this.needsUpdate&&!n||this._isWorkerBusy)return;this._isWorkerBusy=!0;const r=this.world.camera.three;r.updateMatrix();const{width:o,height:a}=this.config;this.renderer.setSize(o,a),this.renderer.setRenderTarget(this.renderTarget),this.renderer.render(this.scene,r);const l=this.renderer.getContext();await Qo(l,0,0,o,a,l.RGBA,l.UNSIGNED_BYTE,this.buffer),this.renderer.setRenderTarget(null),this.config.renderDebugFrame&&this.renderer.render(this.scene,r),this.worker.postMessage({buffer:this.buffer}),this.needsUpdate=!1}),!e.renderer)throw new Error("The given world must have a renderer!");this.components=t,this.config=new Oh(this,this.components,"Culler renderer"),this.world=e,this.renderer=new ks,this.renderer.clippingPlanes=e.renderer.clippingPlanes;const s=`
      addEventListener("message", (event) => {
        const { buffer } = event.data;
        const colors = new Map();
        for (let i = 0; i < buffer.length; i += 4) {
          const r = buffer[i];
          const g = buffer[i + 1];
          const b = buffer[i + 2];
          const code = "" + r + "-" + g + "-" + b;
          if(colors.has(code)) {
            colors.set(code, colors.get(code) + 1);
          } else {
            colors.set(code, 1);
          }
        }
        postMessage({ colors });
      });
    `,i=new Blob([s],{type:"application/javascript"});this.worker=new Worker(URL.createObjectURL(i)),this.setup()}dispose(){this.enabled=!1,this.config.autoUpdate=!1,this.components.get(Ks).list.delete(this.config.uuid);for(const e of this.scene.children)e.removeFromParent();this.onViewUpdated.reset(),this.worker.terminate(),this.renderer.forceContextLoss(),this.renderer.dispose(),this.renderTarget.dispose(),this.buffer=null,this.onDisposed.reset()}setup(t){const e={...this._defaultConfig,...t},{width:s,height:i}=e;this.config.setWidthHeight(s,i);const{updateInterval:n,autoUpdate:r}=e;this.config.setAutoAndInterval(r,n),this.config.threshold=e.threshold,this.isSetup=!0,this.onSetup.trigger()}getAvailableColor(){let t=BigInt(this._availableColor.toString());const e=[];do e.unshift(Number(t%256n)),t/=256n;while(t);for(;e.length!==3;)e.unshift(0);const[s,i,n]=e,r=`${s}-${i}-${n}`;return{r:s,g:i,b:n,code:r}}increaseColor(){if(this._availableColor===256*256*256){console.warn("Color can't be increased over 256 x 256 x 256!");return}this._availableColor++}decreaseColor(){if(this._availableColor===1){console.warn("Color can't be decreased under 0!");return}this._availableColor--}}class Nh extends yh{constructor(t,e){super(t,e),p(this,"onViewUpdated",new q),p(this,"colorMeshes",new Map),p(this,"_colorCodeMeshMap",new Map),p(this,"_meshIDColorCodeMap",new Map),p(this,"_currentVisibleMeshes",new Set),p(this,"_recentlyHiddenMeshes",new Set),p(this,"_transparentMat",new Es({transparent:!0,opacity:0})),p(this,"handleWorkerMessage",async s=>{if(this.preventUpdate)return;const i=s.data.colors;this._recentlyHiddenMeshes=new Set(this._currentVisibleMeshes),this._currentVisibleMeshes.clear();for(const[n,r]of i){if(r<this.config.threshold)continue;const o=this._colorCodeMeshMap.get(n);o&&(this._currentVisibleMeshes.add(o),this._recentlyHiddenMeshes.delete(o))}this.onViewUpdated.trigger({seen:this._currentVisibleMeshes,unseen:this._recentlyHiddenMeshes}),this._isWorkerBusy=!1}),this.worker.addEventListener("message",this.handleWorkerMessage),this.onViewUpdated.add(({seen:s,unseen:i})=>{for(const n of s)n.visible=!0;for(const n of i)n.visible=!1})}get threshold(){return this.config.threshold}set threshold(t){this.config.threshold=t}dispose(){super.dispose(),this._currentVisibleMeshes.clear(),this._recentlyHiddenMeshes.clear(),this._meshIDColorCodeMap.clear(),this._transparentMat.dispose(),this._colorCodeMeshMap.clear();const t=this.components.get(Cs);for(const e in this.colorMeshes){const s=this.colorMeshes.get(e);s&&t.destroy(s,!0)}this.colorMeshes.clear()}add(t){if(!this.enabled)return;if(this.preventUpdate){console.log("Culler processing not finished yet.");return}this.preventUpdate=!0;const e=t instanceof Me,{geometry:s,material:i}=t,{colorMaterial:n,code:r}=this.getAvailableMaterial();let o;if(Array.isArray(i)){let h=!0;const d=[];for(const u of i)Qr.isTransparent(u)?d.push(this._transparentMat):(h=!1,d.push(n));if(h){n.dispose(),this.preventUpdate=!1;return}o=d}else if(Qr.isTransparent(i)){n.dispose(),this.preventUpdate=!1;return}else o=n;this._colorCodeMeshMap.set(r,t),this._meshIDColorCodeMap.set(t.uuid,r);const a=e?t.count:1,l=new Me(s,o,a);e?l.instanceMatrix=t.instanceMatrix:l.setMatrixAt(0,new ft),t.visible=!1,t.updateWorldMatrix(!0,!1),l.applyMatrix4(t.matrixWorld),l.updateMatrix(),this.scene.add(l),this.colorMeshes.set(t.uuid,l),this.increaseColor(),this.preventUpdate=!1}remove(t){if(this.preventUpdate){console.log("Culler processing not finished yet.");return}this.preventUpdate=!0;const e=this.components.get(Cs);this._currentVisibleMeshes.delete(t),this._recentlyHiddenMeshes.delete(t);const s=this.colorMeshes.get(t.uuid),i=this._meshIDColorCodeMap.get(t.uuid);if(!s||!i){this.preventUpdate=!1;return}this._colorCodeMeshMap.delete(i),this._meshIDColorCodeMap.delete(t.uuid),this.colorMeshes.delete(t.uuid),s.geometry=void 0,s.material=[],e.destroy(s,!0),this._recentlyHiddenMeshes.delete(t),this._currentVisibleMeshes.delete(t),this.preventUpdate=!1}updateInstanced(t){for(const e of t){const s=this.colorMeshes.get(e.uuid);s&&(s.count=e.count)}}getAvailableMaterial(){const{r:t,g:e,b:s,code:i}=this.getAvailableColor(),n=Qi.enabled;Qi.enabled=!1;const r=new Dt(`rgb(${t}, ${e}, ${s})`);if(!this.world.renderer)throw new Error("Renderer not found in the world!");const o=this.world.renderer.clippingPlanes,a=new Es({color:r,clippingPlanes:o,side:qs});return Qi.enabled=n,{colorMaterial:a,code:i}}}const Ko=class Dn extends Rt{constructor(t){super(t),p(this,"onDisposed",new q),p(this,"_enabled",!0),p(this,"list",new Map),t.add(Dn.uuid,this)}get enabled(){return this._enabled}set enabled(t){this._enabled=t;for(const[e,s]of this.list)s.enabled=t}create(t){if(this.list.has(t.uuid))return this.list.get(t.uuid);const e=new Nh(this.components,t);return this.list.set(t.uuid,e),e}delete(t){const e=this.list.get(t.uuid);e&&e.dispose(),this.list.delete(t.uuid)}dispose(){this.enabled=!1,this.onDisposed.trigger(Dn.uuid),this.onDisposed.reset();for(const[t,e]of this.list)e.dispose();this.list.clear()}updateInstanced(t){for(const[,e]of this.list)e.updateInstanced(t)}};p(Ko,"uuid","69f2a50d-c266-44fc-b1bd-fa4d34be89e6");let _h=Ko;class Ph{constructor(t,e){if(p(this,"onDisposed",new q),p(this,"onDistanceComputed",new q),p(this,"excludedObjects",new Set),p(this,"enabled",!0),p(this,"renderDebugFrame",!1),p(this,"components"),p(this,"scene",new Yi),p(this,"camera",new ke(-1,1,1,-1,0,1)),p(this,"depthMaterial"),p(this,"world"),p(this,"renderer"),p(this,"worker"),p(this,"_width",512),p(this,"_height",512),p(this,"_postQuad"),p(this,"tempRT"),p(this,"resultRT"),p(this,"bufferSize"),p(this,"_buffer"),p(this,"_isWorkerBusy",!1),p(this,"compute",async()=>{if(!this.enabled||this.world.isDisposing||this._isWorkerBusy)return;this._isWorkerBusy=!0,this.world.camera.three.updateMatrix(),this.renderer.setSize(this._width,this._height),this.renderer.setRenderTarget(this.tempRT);const o="visibilityBeforeDistanceCheck";for(const l of this.excludedObjects)l.userData[o]=l.visible,l.visible=!1;this.renderer.render(this.world.scene.three,this.world.camera.three);for(const l of this.excludedObjects)l.userData[o]!==void 0&&(l.visible=l.userData[o]);this.depthMaterial.uniforms.tDiffuse.value=this.tempRT.texture,this.depthMaterial.uniforms.tDepth.value=this.tempRT.depthTexture,this.renderer.setRenderTarget(this.resultRT),this.renderer.render(this.scene,this.camera);const a=this.renderer.getContext();try{await Qo(a,0,0,this._width,this._height,a.RGBA,a.UNSIGNED_BYTE,this._buffer)}catch{this.renderer.setRenderTarget(null),this._isWorkerBusy=!1;return}this.renderer.setRenderTarget(null),this.renderDebugFrame&&this.renderer.render(this.scene,this.camera),this.worker.postMessage({buffer:this._buffer})}),p(this,"handleWorkerMessage",o=>{if(!this.enabled||this.world.isDisposing)return;const a=o.data.colors;let l=Number.MAX_VALUE;for(const I of a)I!==0&&I<l&&(l=I);const h=this.world.camera.three||ke,u=(l/255-1)*-1*(h.far-h.near),f=Math.min(u,h.far);this.onDistanceComputed.trigger(f),this._isWorkerBusy=!1}),!e.renderer)throw new Error("The given world must have a renderer!");this.components=t,this.world=e;const s=e.camera.three;this.renderer=new ks,this.tempRT=new bi(this._width,this._height),this.bufferSize=this._width*this._height*4,this._buffer=new Uint8Array(this.bufferSize),this.tempRT.texture.minFilter=Sr,this.tempRT.texture.magFilter=Sr,this.tempRT.stencilBuffer=!1,this.tempRT.samples=0,this.tempRT.depthTexture=new nc(this._width,this._height),this.tempRT.depthTexture.format=rc,this.tempRT.depthTexture.type=oc,this.resultRT=new bi(this._width,this._height),this.depthMaterial=new _o({vertexShader:`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
    `,fragmentShader:`
#include <packing>

varying vec2 vUv;
uniform sampler2D tDiffuse;
uniform sampler2D tDepth;
uniform float cameraNear;
uniform float cameraFar;


float readDepth( sampler2D depthSampler, vec2 coord ) {
  float fragCoordZ = texture2D( depthSampler, coord ).x;
  float viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );
  return viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );
}

void main() {
  //vec3 diffuse = texture2D( tDiffuse, vUv ).rgb;
  float depth = readDepth( tDepth, vUv );

  gl_FragColor.rgb = 1.0 - vec3( depth );
  gl_FragColor.a = 1.0;
}
    `,uniforms:{cameraNear:{value:s.near},cameraFar:{value:s.far},tDiffuse:{value:null},tDepth:{value:null}}});const i=new zi(2,2);this._postQuad=new st(i,this.depthMaterial),this.scene.add(this._postQuad),this.renderer.clippingPlanes=e.renderer.clippingPlanes;const n=`
      addEventListener("message", (event) => {
        const { buffer } = event.data;
        const colors = new Set();
        for (let i = 0; i < buffer.length; i += 4) {
          const r = buffer[i];
          colors.add(r);
        }
        postMessage({ colors });
      });
    `,r=new Blob([n],{type:"application/javascript"});this.worker=new Worker(URL.createObjectURL(r)),this.worker.addEventListener("message",this.handleWorkerMessage)}dispose(){this.enabled=!1,this.onDistanceComputed.reset(),this.worker.terminate(),this.renderer.forceContextLoss(),this.renderer.dispose(),this.tempRT.dispose(),this.resultRT.dispose();const t=[...this.scene.children];this.excludedObjects.clear();for(const e of t)e.removeFromParent();this._postQuad.geometry.dispose(),this._postQuad.removeFromParent(),this._buffer=null,this.onDisposed.reset()}}class Bf extends Th{constructor(){super(...arguments),p(this,"_distanceRenderer"),p(this,"autoBias",!0),p(this,"_defaultShadowConfig",{cascade:1,resolution:512}),p(this,"_lightsWithShadow",new Map),p(this,"_isComputingShadows",!1),p(this,"_shadowsEnabled",!0),p(this,"_bias",0),p(this,"recomputeShadows",t=>{if(!this._shadowsEnabled)return;if(this.autoBias&&(this.bias=t/-1e5),t*=1.5,!this.currentWorld)throw new Error("A world needs to be assigned to the scene before computing shadows!");if(!this._lightsWithShadow.size)throw new Error("No shadows found!");const s=this.currentWorld.camera.three;if(!(s instanceof Hn)&&!(s instanceof ke))throw new Error("Invalid camera type!");const i=new B;s.getWorldDirection(i);let n=t;const r=new B;r.copy(this.config.directionalLight.position),r.normalize();for(const[o,a]of this._lightsWithShadow){const l=this.directionalLights.get(a);if(!l)throw new Error("Light not found.");const h=new B;h.copy(i);const d=o===this._lightsWithShadow.size-1,u=d?n/2:n*2/3;h.multiplyScalar(u),h.add(s.position);const f=n-u,I=new B;I.copy(r),I.multiplyScalar(f),l.target.position.copy(h),l.position.copy(h),l.position.add(I),l.shadow.camera.right=f,l.shadow.camera.left=-f,l.shadow.camera.top=f,l.shadow.camera.bottom=-f,l.shadow.camera.far=f*2,l.shadow.camera.updateProjectionMatrix(),l.shadow.camera.updateMatrix(),d||(n/=3)}this._isComputingShadows=!1})}get bias(){return this._bias}set bias(t){this._bias=t;for(const[,e]of this._lightsWithShadow){const s=this.directionalLights.get(e);s&&(s.shadow.bias=t)}}get shadowsEnabled(){return this._shadowsEnabled}set shadowsEnabled(t){this._shadowsEnabled=t;for(const[,e]of this.directionalLights)e.castShadow=t}get distanceRenderer(){if(!this._distanceRenderer)throw new Error("You must set up this component before accessing the distance renderer!");return this._distanceRenderer}setup(t){super.setup(t);const e={...this._defaultConfig,...this._defaultShadowConfig,...t};if(e.cascade<=0)throw new Error("Config.shadows.cascade must be a natural number greater than 0!");if(e.cascade>1)throw new Error("Multiple shadows not supported yet!");if(!this.currentWorld)throw new Error("A world needs to be assigned to the scene before setting it up!");for(const[,s]of this.directionalLights)s.target.removeFromParent(),s.removeFromParent(),s.dispose();this.directionalLights.clear(),this._distanceRenderer||(this._distanceRenderer=new Ph(this.components,this.currentWorld),this._distanceRenderer.onDistanceComputed.add(this.recomputeShadows)),this._lightsWithShadow.clear();for(let s=0;s<e.cascade;s++){const i=new No;i.intensity=this.config.directionalLight.intensity,i.color=this.config.directionalLight.color,i.position.copy(this.config.directionalLight.position),i.shadow.mapSize.width=e.resolution,i.shadow.mapSize.height=e.resolution,this.three.add(i,i.target),this.directionalLights.set(i.uuid,i),this._lightsWithShadow.set(s,i.uuid),i.castShadow=!0,i.shadow.bias=this._bias}}dispose(){super.dispose(),this._distanceRenderer&&this._distanceRenderer.dispose(),this._lightsWithShadow.clear()}async updateShadows(){this._isComputingShadows||!this._shadowsEnabled||(this._isComputingShadows=!0,await this.distanceRenderer.compute())}}class Lh{constructor(t){p(this,"_event"),p(this,"_position",new Wt),p(this,"onDisposed",new q),p(this,"updateMouseInfo",e=>{this._event=e}),this.dom=t,this.setupEvents(!0)}get position(){if(this._event){const t=this.dom.getBoundingClientRect();this._position.x=this.getPositionX(t,this._event),this._position.y=this.getPositionY(t,this._event)}return this._position}dispose(){this.setupEvents(!1),this.onDisposed.trigger(),this.onDisposed.reset()}getPositionY(t,e){return-((this.getDataObject(e).clientY-t.top)/(t.bottom-t.top))*2+1}getPositionX(t,e){return(this.getDataObject(e).clientX-t.left)/(t.right-t.left)*2-1}getDataObject(t){return t instanceof MouseEvent?t:t.touches[0]}setupEvents(t){t?(this.dom.addEventListener("pointermove",this.updateMouseInfo),this.dom.addEventListener("touchstart",this.updateMouseInfo)):(this.dom.removeEventListener("pointermove",this.updateMouseInfo),this.dom.removeEventListener("touchstart",this.updateMouseInfo))}}class wh{constructor(t,e){p(this,"enabled",!0),p(this,"components"),p(this,"onDisposed",new q),p(this,"mouse"),p(this,"three",new Wn),p(this,"world");const s=e.renderer;if(!s)throw new Error("A renderer is needed for the raycaster to work!");this.world=e,this.mouse=new Lh(s.three.domElement),this.components=t}dispose(){this.mouse.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}castRay(t=Array.from(this.world.meshes),e=this.mouse.position){if(!this.world)throw new Error("A world is needed to cast rays!");const s=this.world.camera.three;return this.three.setFromCamera(e,s),this.intersect(t)}castRayFromVector(t,e,s=Array.from(this.world.meshes)){return this.three.set(t,e),this.intersect(s)}intersect(t=Array.from(this.world.meshes)){const e=this.three.intersectObjects(t),s=this.filterClippingPlanes(e);return s.length>0?s[0]:null}filterClippingPlanes(t){if(!this.world.renderer)throw new Error("Renderer not found!");const e=this.world.renderer.three;if(!e.clippingPlanes)return t;const s=e.clippingPlanes;return t.length<=0||!s||(s==null?void 0:s.length)<=0?t:t.filter(i=>s.every(n=>n.distanceToPoint(i.point)>0))}}const Jo=class ta extends Rt{constructor(t){super(t),p(this,"enabled",!0),p(this,"list",new Map),p(this,"onDisposed",new q),t.add(ta.uuid,this)}get(t){if(this.list.has(t.uuid))return this.list.get(t.uuid);const e=new wh(this.components,t);return this.list.set(t.uuid,e),t.onDisposed.add(()=>{this.delete(t)}),e}delete(t){const e=this.list.get(t.uuid);e&&e.dispose(),this.list.delete(t.uuid)}dispose(){for(const[t,e]of this.list)e.dispose();this.list.clear(),this.onDisposed.trigger()}};p(Jo,"uuid","d5d8bdf0-db25-4952-b951-b643af207ace");let bn=Jo;class Mh extends Ze{constructor(){super(...arguments),p(this,"_config",{visible:{value:!0,type:"Boolean"},color:{value:new Dt,type:"Color"},primarySize:{type:"Number",interpolable:!0,value:1,min:0,max:1e3},secondarySize:{type:"Number",interpolable:!0,value:10,min:0,max:1e3},distance:{type:"Number",interpolable:!0,value:500,min:0,max:500}})}get visible(){return this._config.visible.value}set visible(t){this._config.visible.value=t,this._component.visible=t}get color(){return this._config.color.value}set color(t){this._config.color.value=t,this._component.material.uniforms.uColor.value=t,this._component.material.uniformsNeedUpdate=!0}get primarySize(){return this._config.primarySize.value}set primarySize(t){this._config.primarySize.value=t,this._component.material.uniforms.uSize1.value=t,this._component.material.uniformsNeedUpdate=!0}get secondarySize(){return this._config.secondarySize.value}set secondarySize(t){this._config.secondarySize.value=t,this._component.material.uniforms.uSize2.value=t,this._component.material.uniformsNeedUpdate=!0}get distance(){return this._config.distance.value}set distance(t){this._config.distance.value=t,this._component.material.uniforms.uDistance.value=t,this._component.material.uniformsNeedUpdate=!0}}class vh{constructor(t,e){p(this,"onDisposed",new q),p(this,"onSetup",new q),p(this,"isSetup",!1),p(this,"world"),p(this,"components"),p(this,"config"),p(this,"_defaultConfig",{visible:!0,color:new Dt(12303291),primarySize:1,secondarySize:10,distance:500}),p(this,"three"),p(this,"_fade",3),p(this,"updateZoom",()=>{this.world.camera instanceof js&&(this.material.uniforms.uZoom.value=this.world.camera.three.zoom)}),this.world=e;const{color:s,primarySize:i,secondarySize:n,distance:r}=this._defaultConfig;this.components=t,this.config=new Mh(this,this.components,"Grid");const o=new zi(2,2,1,1),a=new _o({side:qs,uniforms:{uSize1:{value:i},uSize2:{value:n},uColor:{value:s},uDistance:{value:r},uFade:{value:this._fade},uZoom:{value:1}},transparent:!0,vertexShader:`
            
            varying vec3 worldPosition;
            
            uniform float uDistance;
            
            void main() {
            
                    vec3 pos = position.xzy * uDistance;
                    pos.xz += cameraPosition.xz;
                    
                    worldPosition = pos;
                    
                    gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
            
            }
            `,fragmentShader:`
            
            varying vec3 worldPosition;
            
            uniform float uZoom;
            uniform float uFade;
            uniform float uSize1;
            uniform float uSize2;
            uniform vec3 uColor;
            uniform float uDistance;
                
                
                
                float getGrid(float size) {
                
                    vec2 r = worldPosition.xz / size;
                    
                    
                    vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);
                    float line = min(grid.x, grid.y);
                    
                
                    return 1.0 - min(line, 1.0);
                }
                
            void main() {
            
                    
                    float d = 1.0 - min(distance(cameraPosition.xz, worldPosition.xz) / uDistance, 1.0);
                    
                    float g1 = getGrid(uSize1);
                    float g2 = getGrid(uSize2);
                    
                    // Ortho camera fades the grid away when zooming out
                    float minZoom = step(0.2, uZoom);
                    float zoomFactor = pow(min(uZoom, 1.), 2.) * minZoom;
                    
                    gl_FragColor = vec4(uColor.rgb, mix(g2, g1, g1) * pow(d, uFade));
                    gl_FragColor.a = mix(0.5 * gl_FragColor.a, gl_FragColor.a, g2) * zoomFactor;
                    
                    if ( gl_FragColor.a <= 0.0 ) discard;
                    
            
            }
            
            `,extensions:{derivatives:!0}});this.three=new st(o,a),this.three.frustumCulled=!1,e.scene.three.add(this.three),this.setupEvents(!0)}get visible(){return this.three.visible}set visible(t){t?this.world.scene.three.add(this.three):this.three.removeFromParent()}get material(){return this.three.material}get fade(){return this._fade===3}set fade(t){this._fade=t?3:0,this.material.uniforms.uFade.value=this._fade}setup(t){const e={...this._defaultConfig,...t};this.config.visible=!0,this.config.color=e.color,this.config.primarySize=e.primarySize,this.config.secondarySize=e.secondarySize,this.config.distance=e.distance,this.isSetup=!0,this.onSetup.trigger()}dispose(){this.setupEvents(!1),this.components.get(Ks).list.delete(this.config.uuid),this.components.get(Cs).destroy(this.three),this.onDisposed.trigger(),this.onDisposed.reset(),this.world=null,this.components=null}setupEvents(t){if(this.world.isDisposing||!(this.world.camera instanceof js))return;const e=this.world.camera.controls;t?e.addEventListener("update",this.updateZoom):e.removeEventListener("update",this.updateZoom)}}const ea=class sa extends Rt{constructor(t){super(t),p(this,"list",new Map),p(this,"onDisposed",new q),p(this,"enabled",!0),t.add(sa.uuid,this)}create(t){if(this.list.has(t.uuid))throw new Error("This world already has a grid!");const e=new vh(this.components,t);return this.list.set(t.uuid,e),t.onDisposed.add(()=>{this.delete(t)}),e}delete(t){const e=this.list.get(t.uuid);e&&e.dispose(),this.list.delete(t.uuid)}dispose(){for(const[t,e]of this.list)e.dispose();this.list.clear(),this.onDisposed.trigger(),this.onDisposed.reset()}};p(ea,"uuid","d1e814d5-b81c-4452-87a2-f039375e0489");let Vf=ea;const Be=new Wn,Ut=new B,Oe=new B,St=new ne,ao={X:new B(1,0,0),Y:new B(0,1,0),Z:new B(0,0,1)},mn={type:"change"},co={type:"mouseDown"},lo={type:"mouseUp",mode:null},ho={type:"objectChange"};class Dh extends xi{constructor(t,e){super(),e===void 0&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),e=document),this.isTransformControls=!0,this.visible=!1,this.domElement=e,this.domElement.style.touchAction="none";const s=new Yh;this._gizmo=s,this.add(s);const i=new zh;this._plane=i,this.add(i);const n=this;function r(g,S){let T=S;Object.defineProperty(n,g,{get:function(){return T!==void 0?T:S},set:function(F){T!==F&&(T=F,i[g]=F,s[g]=F,n.dispatchEvent({type:g+"-changed",value:F}),n.dispatchEvent(mn))}}),n[g]=S,i[g]=S,s[g]=S}r("camera",t),r("object",void 0),r("enabled",!0),r("axis",null),r("mode","translate"),r("translationSnap",null),r("rotationSnap",null),r("scaleSnap",null),r("space","world"),r("size",1),r("dragging",!1),r("showX",!0),r("showY",!0),r("showZ",!0);const o=new B,a=new B,l=new ne,h=new ne,d=new B,u=new ne,f=new B,I=new B,E=new B,m=0,C=new B;r("worldPosition",o),r("worldPositionStart",a),r("worldQuaternion",l),r("worldQuaternionStart",h),r("cameraPosition",d),r("cameraQuaternion",u),r("pointStart",f),r("pointEnd",I),r("rotationAxis",E),r("rotationAngle",m),r("eye",C),this._offset=new B,this._startNorm=new B,this._endNorm=new B,this._cameraScale=new B,this._parentPosition=new B,this._parentQuaternion=new ne,this._parentQuaternionInv=new ne,this._parentScale=new B,this._worldScaleStart=new B,this._worldQuaternionInv=new ne,this._worldScale=new B,this._positionStart=new B,this._quaternionStart=new ne,this._scaleStart=new B,this._getPointer=bh.bind(this),this._onPointerDown=Uh.bind(this),this._onPointerHover=xh.bind(this),this._onPointerMove=Bh.bind(this),this._onPointerUp=Vh.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){this.object!==void 0&&(this.object.updateMatrixWorld(),this.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(t){if(this.object===void 0||this.dragging===!0)return;Be.setFromCamera(t,this.camera);const e=gn(this._gizmo.picker[this.mode],Be);e?this.axis=e.object.name:this.axis=null}pointerDown(t){if(!(this.object===void 0||this.dragging===!0||t.button!==0)&&this.axis!==null){Be.setFromCamera(t,this.camera);const e=gn(this._plane,Be,!0);e&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(e.point).sub(this.worldPositionStart)),this.dragging=!0,co.mode=this.mode,this.dispatchEvent(co)}}pointerMove(t){const e=this.axis,s=this.mode,i=this.object;let n=this.space;if(s==="scale"?n="local":(e==="E"||e==="XYZE"||e==="XYZ")&&(n="world"),i===void 0||e===null||this.dragging===!1||t.button!==-1)return;Be.setFromCamera(t,this.camera);const r=gn(this._plane,Be,!0);if(r){if(this.pointEnd.copy(r.point).sub(this.worldPositionStart),s==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),n==="local"&&e!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),e.indexOf("X")===-1&&(this._offset.x=0),e.indexOf("Y")===-1&&(this._offset.y=0),e.indexOf("Z")===-1&&(this._offset.z=0),n==="local"&&e!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),i.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(n==="local"&&(i.position.applyQuaternion(St.copy(this._quaternionStart).invert()),e.search("X")!==-1&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),e.search("Y")!==-1&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),e.search("Z")!==-1&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.position.applyQuaternion(this._quaternionStart)),n==="world"&&(i.parent&&i.position.add(Ut.setFromMatrixPosition(i.parent.matrixWorld)),e.search("X")!==-1&&(i.position.x=Math.round(i.position.x/this.translationSnap)*this.translationSnap),e.search("Y")!==-1&&(i.position.y=Math.round(i.position.y/this.translationSnap)*this.translationSnap),e.search("Z")!==-1&&(i.position.z=Math.round(i.position.z/this.translationSnap)*this.translationSnap),i.parent&&i.position.sub(Ut.setFromMatrixPosition(i.parent.matrixWorld))));else if(s==="scale"){if(e.search("XYZ")!==-1){let o=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(o*=-1),Oe.set(o,o,o)}else Ut.copy(this.pointStart),Oe.copy(this.pointEnd),Ut.applyQuaternion(this._worldQuaternionInv),Oe.applyQuaternion(this._worldQuaternionInv),Oe.divide(Ut),e.search("X")===-1&&(Oe.x=1),e.search("Y")===-1&&(Oe.y=1),e.search("Z")===-1&&(Oe.z=1);i.scale.copy(this._scaleStart).multiply(Oe),this.scaleSnap&&(e.search("X")!==-1&&(i.scale.x=Math.round(i.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),e.search("Y")!==-1&&(i.scale.y=Math.round(i.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),e.search("Z")!==-1&&(i.scale.z=Math.round(i.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(s==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);const o=20/this.worldPosition.distanceTo(Ut.setFromMatrixPosition(this.camera.matrixWorld));let a=!1;e==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(Ut.copy(this.rotationAxis).cross(this.eye))*o):(e==="X"||e==="Y"||e==="Z")&&(this.rotationAxis.copy(ao[e]),Ut.copy(ao[e]),n==="local"&&Ut.applyQuaternion(this.worldQuaternion),Ut.cross(this.eye),Ut.length()===0?a=!0:this.rotationAngle=this._offset.dot(Ut.normalize())*o),(e==="E"||a)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),n==="local"&&e!=="E"&&e!=="XYZE"?(i.quaternion.copy(this._quaternionStart),i.quaternion.multiply(St.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),i.quaternion.copy(St.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),i.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(mn),this.dispatchEvent(ho)}}pointerUp(t){t.button===0&&(this.dragging&&this.axis!==null&&(lo.mode=this.mode,this.dispatchEvent(lo)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse(function(t){t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose()})}attach(t){return this.object=t,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(mn),this.dispatchEvent(ho),this.pointStart.copy(this.pointEnd))}getRaycaster(){return Be}getMode(){return this.mode}setMode(t){this.mode=t}setTranslationSnap(t){this.translationSnap=t}setRotationSnap(t){this.rotationSnap=t}setScaleSnap(t){this.scaleSnap=t}setSize(t){this.size=t}setSpace(t){this.space=t}}function bh(c){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:c.button};{const t=this.domElement.getBoundingClientRect();return{x:(c.clientX-t.left)/t.width*2-1,y:-(c.clientY-t.top)/t.height*2+1,button:c.button}}}function xh(c){if(this.enabled)switch(c.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(c));break}}function Uh(c){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(c.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(c)),this.pointerDown(this._getPointer(c)))}function Bh(c){this.enabled&&this.pointerMove(this._getPointer(c))}function Vh(c){this.enabled&&(this.domElement.releasePointerCapture(c.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(c)))}function gn(c,t,e){const s=t.intersectObject(c,!0);for(let i=0;i<s.length;i++)if(s[i].object.visible||e)return s[i];return!1}const Oi=new Pc,Ct=new B(0,1,0),uo=new B(0,0,0),fo=new ft,yi=new ne,Mi=new ne,he=new B,Io=new ft,Bs=new B(1,0,0),Ve=new B(0,1,0),Vs=new B(0,0,1),Ni=new B,Ds=new B,bs=new B;class Yh extends xi{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const t=new Es({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),e=new wo({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),s=t.clone();s.opacity=.15;const i=e.clone();i.opacity=.5;const n=t.clone();n.color.setHex(16711680);const r=t.clone();r.color.setHex(65280);const o=t.clone();o.color.setHex(255);const a=t.clone();a.color.setHex(16711680),a.opacity=.5;const l=t.clone();l.color.setHex(65280),l.opacity=.5;const h=t.clone();h.color.setHex(255),h.opacity=.5;const d=t.clone();d.opacity=.25;const u=t.clone();u.color.setHex(16776960),u.opacity=.25,t.clone().color.setHex(16776960);const I=t.clone();I.color.setHex(7895160);const E=new Bt(0,.04,.1,12);E.translate(0,.05,0);const m=new xt(.08,.08,.08);m.translate(0,.04,0);const C=new Hs;C.setAttribute("position",new Pr([0,0,0,1,0,0],3));const g=new Bt(.0075,.0075,.5,3);g.translate(0,.25,0);function S(D,X){const U=new As(D,.0075,3,64,X*Math.PI*2);return U.rotateY(Math.PI/2),U.rotateX(Math.PI/2),U}function T(){const D=new Hs;return D.setAttribute("position",new Pr([0,0,0,1,1,1],3)),D}const F={X:[[new st(E,n),[.5,0,0],[0,0,-Math.PI/2]],[new st(E,n),[-.5,0,0],[0,0,Math.PI/2]],[new st(g,n),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new st(E,r),[0,.5,0]],[new st(E,r),[0,-.5,0],[Math.PI,0,0]],[new st(g,r)]],Z:[[new st(E,o),[0,0,.5],[Math.PI/2,0,0]],[new st(E,o),[0,0,-.5],[-Math.PI/2,0,0]],[new st(g,o),null,[Math.PI/2,0,0]]],XYZ:[[new st(new ei(.1,0),d.clone()),[0,0,0]]],XY:[[new st(new xt(.15,.15,.01),h.clone()),[.15,.15,0]]],YZ:[[new st(new xt(.15,.15,.01),a.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new st(new xt(.15,.15,.01),l.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},y={X:[[new st(new Bt(.2,0,.6,4),s),[.3,0,0],[0,0,-Math.PI/2]],[new st(new Bt(.2,0,.6,4),s),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new st(new Bt(.2,0,.6,4),s),[0,.3,0]],[new st(new Bt(.2,0,.6,4),s),[0,-.3,0],[0,0,Math.PI]]],Z:[[new st(new Bt(.2,0,.6,4),s),[0,0,.3],[Math.PI/2,0,0]],[new st(new Bt(.2,0,.6,4),s),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new st(new ei(.2,0),s)]],XY:[[new st(new xt(.2,.2,.01),s),[.15,.15,0]]],YZ:[[new st(new xt(.2,.2,.01),s),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new st(new xt(.2,.2,.01),s),[.15,0,.15],[-Math.PI/2,0,0]]]},N={START:[[new st(new ei(.01,2),i),null,null,null,"helper"]],END:[[new st(new ei(.01,2),i),null,null,null,"helper"]],DELTA:[[new Fe(T(),i),null,null,null,"helper"]],X:[[new Fe(C,i.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Fe(C,i.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Fe(C,i.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},w={XYZE:[[new st(S(.5,1),I),null,[0,Math.PI/2,0]]],X:[[new st(S(.5,.5),n)]],Y:[[new st(S(.5,.5),r),null,[0,0,-Math.PI/2]]],Z:[[new st(S(.5,.5),o),null,[0,Math.PI/2,0]]],E:[[new st(S(.75,1),u),null,[0,Math.PI/2,0]]]},P={AXIS:[[new Fe(C,i.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},M={XYZE:[[new st(new Fc(.25,10,8),s)]],X:[[new st(new As(.5,.1,4,24),s),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new st(new As(.5,.1,4,24),s),[0,0,0],[Math.PI/2,0,0]]],Z:[[new st(new As(.5,.1,4,24),s),[0,0,0],[0,0,-Math.PI/2]]],E:[[new st(new As(.75,.1,2,24),s)]]},x={X:[[new st(m,n),[.5,0,0],[0,0,-Math.PI/2]],[new st(g,n),[0,0,0],[0,0,-Math.PI/2]],[new st(m,n),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new st(m,r),[0,.5,0]],[new st(g,r)],[new st(m,r),[0,-.5,0],[0,0,Math.PI]]],Z:[[new st(m,o),[0,0,.5],[Math.PI/2,0,0]],[new st(g,o),[0,0,0],[Math.PI/2,0,0]],[new st(m,o),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new st(new xt(.15,.15,.01),h),[.15,.15,0]]],YZ:[[new st(new xt(.15,.15,.01),a),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new st(new xt(.15,.15,.01),l),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new st(new xt(.1,.1,.1),d.clone())]]},O={X:[[new st(new Bt(.2,0,.6,4),s),[.3,0,0],[0,0,-Math.PI/2]],[new st(new Bt(.2,0,.6,4),s),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new st(new Bt(.2,0,.6,4),s),[0,.3,0]],[new st(new Bt(.2,0,.6,4),s),[0,-.3,0],[0,0,Math.PI]]],Z:[[new st(new Bt(.2,0,.6,4),s),[0,0,.3],[Math.PI/2,0,0]],[new st(new Bt(.2,0,.6,4),s),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new st(new xt(.2,.2,.01),s),[.15,.15,0]]],YZ:[[new st(new xt(.2,.2,.01),s),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new st(new xt(.2,.2,.01),s),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new st(new xt(.2,.2,.2),s),[0,0,0]]]},v={X:[[new Fe(C,i.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Fe(C,i.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Fe(C,i.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function R(D){const X=new xi;for(const U in D)for(let j=D[U].length;j--;){const k=D[U][j][0].clone(),J=D[U][j][1],Y=D[U][j][2],V=D[U][j][3],nt=D[U][j][4];k.name=U,k.tag=nt,J&&k.position.set(J[0],J[1],J[2]),Y&&k.rotation.set(Y[0],Y[1],Y[2]),V&&k.scale.set(V[0],V[1],V[2]),k.updateMatrix();const et=k.geometry.clone();et.applyMatrix4(k.matrix),k.geometry=et,k.renderOrder=1/0,k.position.set(0,0,0),k.rotation.set(0,0,0),k.scale.set(1,1,1),X.add(k)}return X}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=R(F)),this.add(this.gizmo.rotate=R(w)),this.add(this.gizmo.scale=R(x)),this.add(this.picker.translate=R(y)),this.add(this.picker.rotate=R(M)),this.add(this.picker.scale=R(O)),this.add(this.helper.translate=R(N)),this.add(this.helper.rotate=R(P)),this.add(this.helper.scale=R(v)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(t){const s=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:Mi;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let i=[];i=i.concat(this.picker[this.mode].children),i=i.concat(this.gizmo[this.mode].children),i=i.concat(this.helper[this.mode].children);for(let n=0;n<i.length;n++){const r=i[n];r.visible=!0,r.rotation.set(0,0,0),r.position.copy(this.worldPosition);let o;if(this.camera.isOrthographicCamera?o=(this.camera.top-this.camera.bottom)/this.camera.zoom:o=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),r.scale.set(1,1,1).multiplyScalar(o*this.size/4),r.tag==="helper"){r.visible=!1,r.name==="AXIS"?(r.visible=!!this.axis,this.axis==="X"&&(St.setFromEuler(Oi.set(0,0,0)),r.quaternion.copy(s).multiply(St),Math.abs(Ct.copy(Bs).applyQuaternion(s).dot(this.eye))>.9&&(r.visible=!1)),this.axis==="Y"&&(St.setFromEuler(Oi.set(0,0,Math.PI/2)),r.quaternion.copy(s).multiply(St),Math.abs(Ct.copy(Ve).applyQuaternion(s).dot(this.eye))>.9&&(r.visible=!1)),this.axis==="Z"&&(St.setFromEuler(Oi.set(0,Math.PI/2,0)),r.quaternion.copy(s).multiply(St),Math.abs(Ct.copy(Vs).applyQuaternion(s).dot(this.eye))>.9&&(r.visible=!1)),this.axis==="XYZE"&&(St.setFromEuler(Oi.set(0,Math.PI/2,0)),Ct.copy(this.rotationAxis),r.quaternion.setFromRotationMatrix(fo.lookAt(uo,Ct,Ve)),r.quaternion.multiply(St),r.visible=this.dragging),this.axis==="E"&&(r.visible=!1)):r.name==="START"?(r.position.copy(this.worldPositionStart),r.visible=this.dragging):r.name==="END"?(r.position.copy(this.worldPosition),r.visible=this.dragging):r.name==="DELTA"?(r.position.copy(this.worldPositionStart),r.quaternion.copy(this.worldQuaternionStart),Ut.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),Ut.applyQuaternion(this.worldQuaternionStart.clone().invert()),r.scale.copy(Ut),r.visible=this.dragging):(r.quaternion.copy(s),this.dragging?r.position.copy(this.worldPositionStart):r.position.copy(this.worldPosition),this.axis&&(r.visible=this.axis.search(r.name)!==-1));continue}r.quaternion.copy(s),this.mode==="translate"||this.mode==="scale"?(r.name==="X"&&Math.abs(Ct.copy(Bs).applyQuaternion(s).dot(this.eye))>.99&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),r.name==="Y"&&Math.abs(Ct.copy(Ve).applyQuaternion(s).dot(this.eye))>.99&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),r.name==="Z"&&Math.abs(Ct.copy(Vs).applyQuaternion(s).dot(this.eye))>.99&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),r.name==="XY"&&Math.abs(Ct.copy(Vs).applyQuaternion(s).dot(this.eye))<.2&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),r.name==="YZ"&&Math.abs(Ct.copy(Bs).applyQuaternion(s).dot(this.eye))<.2&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),r.name==="XZ"&&Math.abs(Ct.copy(Ve).applyQuaternion(s).dot(this.eye))<.2&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1)):this.mode==="rotate"&&(yi.copy(s),Ct.copy(this.eye).applyQuaternion(St.copy(s).invert()),r.name.search("E")!==-1&&r.quaternion.setFromRotationMatrix(fo.lookAt(this.eye,uo,Ve)),r.name==="X"&&(St.setFromAxisAngle(Bs,Math.atan2(-Ct.y,Ct.z)),St.multiplyQuaternions(yi,St),r.quaternion.copy(St)),r.name==="Y"&&(St.setFromAxisAngle(Ve,Math.atan2(Ct.x,Ct.z)),St.multiplyQuaternions(yi,St),r.quaternion.copy(St)),r.name==="Z"&&(St.setFromAxisAngle(Vs,Math.atan2(Ct.y,Ct.x)),St.multiplyQuaternions(yi,St),r.quaternion.copy(St))),r.visible=r.visible&&(r.name.indexOf("X")===-1||this.showX),r.visible=r.visible&&(r.name.indexOf("Y")===-1||this.showY),r.visible=r.visible&&(r.name.indexOf("Z")===-1||this.showZ),r.visible=r.visible&&(r.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),r.material._color=r.material._color||r.material.color.clone(),r.material._opacity=r.material._opacity||r.material.opacity,r.material.color.copy(r.material._color),r.material.opacity=r.material._opacity,this.enabled&&this.axis&&(r.name===this.axis||this.axis.split("").some(function(a){return r.name===a}))&&(r.material.color.setHex(16776960),r.material.opacity=1)}super.updateMatrixWorld(t)}}class zh extends st{constructor(){super(new zi(1e5,1e5,2,2),new Es({visible:!1,wireframe:!0,side:qs,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(t){let e=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(e="local"),Ni.copy(Bs).applyQuaternion(e==="local"?this.worldQuaternion:Mi),Ds.copy(Ve).applyQuaternion(e==="local"?this.worldQuaternion:Mi),bs.copy(Vs).applyQuaternion(e==="local"?this.worldQuaternion:Mi),Ct.copy(Ds),this.mode){case"translate":case"scale":switch(this.axis){case"X":Ct.copy(this.eye).cross(Ni),he.copy(Ni).cross(Ct);break;case"Y":Ct.copy(this.eye).cross(Ds),he.copy(Ds).cross(Ct);break;case"Z":Ct.copy(this.eye).cross(bs),he.copy(bs).cross(Ct);break;case"XY":he.copy(bs);break;case"YZ":he.copy(Ni);break;case"XZ":Ct.copy(bs),he.copy(Ds);break;case"XYZ":case"E":he.set(0,0,0);break}break;case"rotate":default:he.set(0,0,0)}he.length()===0?this.quaternion.copy(this.cameraQuaternion):(Io.lookAt(Ut.set(0,0,0),he,Ct),this.quaternion.setFromRotationMatrix(Io)),super.updateMatrixWorld(t)}}class Er{constructor(t,e,s,i,n,r=5,o=!0){if(p(this,"onDraggingStarted",new q),p(this,"onDraggingEnded",new q),p(this,"onDisposed",new q),p(this,"normal"),p(this,"origin"),p(this,"three",new We),p(this,"components"),p(this,"world"),p(this,"type","default"),p(this,"_helper"),p(this,"_visible",!0),p(this,"_enabled",!0),p(this,"_controlsActive",!1),p(this,"_arrowBoundBox",new st),p(this,"_planeMesh"),p(this,"_controls"),p(this,"_hiddenMaterial",new Es({visible:!1})),p(this,"update",()=>{this._enabled&&this.three.setFromNormalAndCoplanarPoint(this.normal,this._helper.position)}),p(this,"changeDrag",a=>{this._visible=!a.value,this.preventCameraMovement(),this.notifyDraggingChanged(a)}),this.components=t,this.world=e,!e.renderer)throw new Error("The given world must have a renderer!");this.normal=i,this.origin=s,e.renderer.setPlane(!0,this.three),this._planeMesh=Er.newPlaneMesh(r,n),this._helper=this.newHelper(),this._controls=this.newTransformControls(),this.three.setFromNormalAndCoplanarPoint(i,s),o&&this.toggleControls(!0)}get enabled(){return this._enabled}set enabled(t){if(!this.world.isDisposing){if(!this.world.renderer)throw new Error("No renderer found for clipping plane!");this._enabled=t,this.world.renderer.setPlane(t,this.three)}}get visible(){return this._visible}set visible(t){this._visible=t,this._controls.visible=t,this._helper.visible=t,this.toggleControls(t)}get meshes(){return[this._planeMesh,this._arrowBoundBox]}get planeMaterial(){return this._planeMesh.material}set planeMaterial(t){this._planeMesh.material=t}get size(){return this._planeMesh.scale.x}set size(t){this._planeMesh.scale.set(t,t,t)}get helper(){return this._helper}setFromNormalAndCoplanarPoint(t,e){this.reset(),this.normal.equals(t)||(this.normal.copy(t),this._helper.lookAt(t)),this.origin.copy(e),this._helper.position.copy(e),this._helper.updateMatrix(),this.update()}dispose(){this._enabled=!1,this.onDraggingStarted.reset(),this.onDraggingEnded.reset(),this._helper.removeFromParent(),this.world.renderer&&this.world.renderer.setPlane(!1,this.three),this._arrowBoundBox.removeFromParent(),this._arrowBoundBox.geometry.dispose(),this._planeMesh.geometry.dispose(),this._controls.removeFromParent(),this._controls.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}reset(){const t=new B(1,0,0),e=new B;this.normal.equals(t)||(this.normal.copy(t),this._helper.lookAt(t)),this.origin.copy(e),this._helper.position.copy(e),this._helper.updateMatrix()}toggleControls(t){if(t){if(this._controlsActive)return;this._controls.addEventListener("change",this.update),this._controls.addEventListener("dragging-changed",this.changeDrag)}else this._controls.removeEventListener("change",this.update),this._controls.removeEventListener("dragging-changed",this.changeDrag);this._controlsActive=t}newTransformControls(){if(!this.world.renderer)throw new Error("No renderer found for clipping plane!");const t=this.world.camera.three,e=this.world.renderer.three.domElement,s=new Dh(t,e);return this.initializeControls(s),this.world.scene.three.add(s),s}initializeControls(t){t.attach(this._helper),t.showX=!1,t.showY=!1,t.setSpace("local"),this.createArrowBoundingBox(),t.children[0].children[0].add(this._arrowBoundBox)}createArrowBoundingBox(){this._arrowBoundBox.geometry=new Bt(.18,.18,1.2),this._arrowBoundBox.material=this._hiddenMaterial,this._arrowBoundBox.rotateX(Math.PI/2),this._arrowBoundBox.updateMatrix(),this._arrowBoundBox.geometry.applyMatrix4(this._arrowBoundBox.matrix)}notifyDraggingChanged(t){t.value?this.onDraggingStarted.trigger():this.onDraggingEnded.trigger()}preventCameraMovement(){this.world.camera.enabled=this._visible}newHelper(){const t=new xi;return t.lookAt(this.normal),t.position.copy(this.origin),this._planeMesh.position.z+=.01,t.add(this._planeMesh),this.world.scene.three.add(t),t}static newPlaneMesh(t,e){const s=new zi(1),i=new st(s,e);return i.scale.set(t,t,t),i}}class Gh extends Ze{constructor(){super(...arguments),p(this,"_config",{enabled:{value:!0,type:"Boolean"},visible:{value:!0,type:"Boolean"},color:{value:new Dt,type:"Color"},opacity:{type:"Number",interpolable:!0,value:1,min:0,max:1},size:{type:"Number",interpolable:!0,value:2,min:0,max:100}})}get enabled(){return this._config.enabled.value}set enabled(t){this._config.enabled.value=t,this._component.enabled=t}get visible(){return this._config.visible.value}set visible(t){this._config.visible.value=t,this._component.visible=t}get color(){return this._config.color.value}set color(t){this._config.color.value=t,this._component.material.color.copy(t)}get opacity(){return this._config.opacity.value}set opacity(t){this._config.opacity.value=t,this._component.material.opacity=t}get size(){return this._config.size.value}set size(t){this._config.size.value=t,this._component.size=t}}const ia=class vi extends Rt{constructor(t){super(t),p(this,"onSetup",new q),p(this,"onBeforeDrag",new q),p(this,"onAfterDrag",new q),p(this,"onBeforeCreate",new q),p(this,"onBeforeCancel",new q),p(this,"onAfterCancel",new q),p(this,"onBeforeDelete",new q),p(this,"onAfterCreate",new q),p(this,"onAfterDelete",new q),p(this,"onDisposed",new q),p(this,"isSetup",!1),p(this,"orthogonalY",!1),p(this,"toleranceOrthogonalY",.7),p(this,"Type",Er),p(this,"list",[]),p(this,"config",new Gh(this,this.components,"Clipper",vi.uuid)),p(this,"_defaultConfig",{color:new Dt(12255487),opacity:.2,size:2}),p(this,"_material",new Es({color:12255487,side:qs,transparent:!0,opacity:.2})),p(this,"_size",5),p(this,"_enabled",!1),p(this,"_visible",!0),p(this,"_onStartDragging",()=>{this.onBeforeDrag.trigger()}),p(this,"_onEndDragging",()=>{this.onAfterDrag.trigger()}),this.components.add(vi.uuid,this)}get enabled(){return this._enabled}set enabled(t){this._enabled=t;for(const e of this.list)e.enabled=t;this.updateMaterialsAndPlanes()}get visible(){return this._visible}set visible(t){this._visible=t;for(const e of this.list)e.visible=t}get material(){return this._material}set material(t){this._material=t;for(const e of this.list)e.planeMaterial=t}get size(){return this._size}set size(t){this._size=t;for(const e of this.list)e.size=t}dispose(){this._enabled=!1,this.components.get(Ks).list.delete(this.config.uuid);for(const e of this.list)e.dispose();this.list.length=0,this._material.dispose(),this.onBeforeCreate.reset(),this.onBeforeCancel.reset(),this.onBeforeDelete.reset(),this.onBeforeDrag.reset(),this.onAfterCreate.reset(),this.onAfterCancel.reset(),this.onAfterDelete.reset(),this.onAfterDrag.reset(),this.onDisposed.trigger(vi.uuid),this.onDisposed.reset()}create(t){const i=this.components.get(bn).get(t).castRay();return i?this.createPlaneFromIntersection(t,i):null}createFromNormalAndCoplanarPoint(t,e,s){const i=this.newPlane(t,s,e);return this.updateMaterialsAndPlanes(),i}delete(t,e){e||(e=this.pickPlane(t)),e&&this.deletePlane(e)}deleteAll(t){const e=[...this.list];for(const s of e)if(!t||t.has(s.type)){this.delete(s.world,s);const i=this.list.indexOf(s);i!==-1&&this.list.splice(i,1)}}setup(t){const e={...this._defaultConfig,...t};this.config.color=e.color,this.config.opacity=e.opacity,this.config.size=e.size,this.isSetup=!0,this.onSetup.trigger()}deletePlane(t){const e=this.list.indexOf(t);if(e!==-1){if(this.list.splice(e,1),!t.world.renderer)throw new Error("Renderer not found for this plane's world!");t.world.renderer.setPlane(!1,t.three),t.dispose(),this.updateMaterialsAndPlanes(),this.onAfterDelete.trigger(t)}}pickPlane(t){const s=this.components.get(bn).get(t),i=this.getAllPlaneMeshes(),n=s.castRay(i);if(n){const r=n.object;return this.list.find(o=>o.meshes.includes(r))}}getAllPlaneMeshes(){const t=[];for(const e of this.list)t.push(...e.meshes);return t}createPlaneFromIntersection(t,e){var s;if(!t.renderer)throw new Error("The given world must have a renderer!");const i=e.point.distanceTo(new B(0,0,0)),n=(s=e.face)==null?void 0:s.normal;if(!i||!n)return null;const r=this.getWorldNormal(e,n),o=this.newPlane(t,e.point,r.negate());return o.visible=this._visible,o.size=this._size,t.renderer.setPlane(!0,o.three),this.updateMaterialsAndPlanes(),o}getWorldNormal(t,e){const s=t.object;let i=t.object.matrixWorld.clone();if(s instanceof Me&&t.instanceId!==void 0){const a=new ft;s.getMatrixAt(t.instanceId,a),i=a.multiply(i)}const r=new ze().getNormalMatrix(i),o=e.clone().applyMatrix3(r).normalize();return this.normalizePlaneDirectionY(o),o}normalizePlaneDirectionY(t){this.orthogonalY&&(t.y>this.toleranceOrthogonalY&&(t.x=0,t.y=1,t.z=0),t.y<-this.toleranceOrthogonalY&&(t.x=0,t.y=-1,t.z=0))}newPlane(t,e,s){const i=new this.Type(this.components,t,e,s,this._material);return i.onDraggingStarted.add(this._onStartDragging),i.onDraggingEnded.add(this._onEndDragging),this.list.push(i),this.onAfterCreate.trigger(i),i}updateMaterialsAndPlanes(){const t=this.components.get(qo);for(const[e,s]of t.list){if(!s.renderer)continue;s.renderer.updateClippingPlanes();const{clippingPlanes:i}=s.renderer;for(const n of s.meshes)if(n.material)if(Array.isArray(n.material))for(const r of n.material)r.clippingPlanes=i;else n.material.clippingPlanes=i}}};p(ia,"uuid","66290bc5-18c4-4cd1-9379-2e17a0617611");let kh=ia;class Hh{constructor(t){p(this,"enabled",!1),p(this,"id","FirstPerson"),this.camera=t}set(t){if(this.enabled=t,t){if(this.camera.projection.current!=="Perspective"){this.camera.set("Orbit");return}this.setupFirstPersonCamera()}}setupFirstPersonCamera(){const t=this.camera.controls,e=new B;t.distance--,t.getPosition(e),t.minDistance=1,t.maxDistance=1,t.distance=1,t.moveTo(e.x,e.y,e.z),t.truckSpeed=50,t.mouseButtons.wheel=Lt.ACTION.DOLLY,t.touches.two=Lt.ACTION.TOUCH_ZOOM_TRUCK}}class Wh{constructor(t){p(this,"enabled",!0),p(this,"id","Orbit"),this.camera=t,this.activateOrbitControls()}set(t){this.enabled=t,t&&this.activateOrbitControls()}activateOrbitControls(){const t=this.camera.controls;t.minDistance=1,t.maxDistance=300;const e=new B;t.getPosition(e);const s=e.length();t.distance=s,t.truckSpeed=2;const{rotation:i}=this.camera.three,n=new B(0,0,-1).applyEuler(i),r=e.addScaledVector(n,s);t.moveTo(r.x,r.y,r.z)}}class Xh{constructor(t){p(this,"enabled",!1),p(this,"id","Plan"),p(this,"mouseAction1"),p(this,"mouseAction2"),p(this,"mouseInitialized",!1),p(this,"defaultAzimuthSpeed"),p(this,"defaultPolarSpeed"),this.camera=t,this.defaultAzimuthSpeed=t.controls.azimuthRotateSpeed,this.defaultPolarSpeed=t.controls.polarRotateSpeed}set(t){this.enabled=t;const e=this.camera.controls;e.azimuthRotateSpeed=t?0:this.defaultAzimuthSpeed,e.polarRotateSpeed=t?0:this.defaultPolarSpeed,this.mouseInitialized||(this.mouseAction1=e.touches.one,this.mouseAction2=e.touches.two,this.mouseInitialized=!0),t?(e.mouseButtons.left=Lt.ACTION.TRUCK,e.touches.one=Lt.ACTION.TOUCH_TRUCK,e.touches.two=Lt.ACTION.TOUCH_ZOOM):(e.mouseButtons.left=Lt.ACTION.ROTATE,e.touches.one=this.mouseAction1,e.touches.two=this.mouseAction2)}}class Zh{constructor(t){p(this,"onChanged",new q),p(this,"current","Perspective"),p(this,"camera"),p(this,"matchOrthoDistanceEnabled",!1),p(this,"_component"),p(this,"_previousDistance",-1),this._component=t,this.camera=t.three}async set(t){this.current!==t&&(t==="Orthographic"?this.setOrthoCamera():await this.setPerspectiveCamera(),this.onChanged.trigger(this.camera))}async toggle(){const e=this.current==="Perspective"?"Orthographic":"Perspective";await this.set(e)}setOrthoCamera(){if(this._component.mode===null||this._component.mode.id==="FirstPerson")return;this._previousDistance=this._component.controls.distance,this._component.controls.distance=200;const t=this.getPerspectiveDims();if(!t)return;const{width:e,height:s}=t;this.setupOrthoCamera(s,e),this.camera=this._component.threeOrtho,this.current="Orthographic"}getPerspectiveDims(){const t=this._component.currentWorld;if(!t||!t.renderer)return null;const e=new B;this._component.threePersp.getWorldDirection(e);const s=new B;this._component.controls.getTarget(s);const n=s.clone().sub(this._component.threePersp.position).dot(e),r=t.renderer.getSize(),o=r.x/r.y,a=this._component.threePersp,l=n*2*Math.atan(a.fov*(Math.PI/180)/2);return{width:l*o,height:l}}setupOrthoCamera(t,e){this._component.controls.mouseButtons.wheel=Lt.ACTION.ZOOM,this._component.controls.mouseButtons.middle=Lt.ACTION.ZOOM,this._component.controls.touches.two=Lt.ACTION.TOUCH_ZOOM_TRUCK,this._component.controls.touches.three=Lt.ACTION.TOUCH_ZOOM_TRUCK,this._component.controls.dollySpeed=5;const s=this._component.threePersp,i=this._component.threeOrtho;i.zoom=1,i.left=e/-2,i.right=e/2,i.top=t/2,i.bottom=t/-2,i.updateProjectionMatrix(),i.position.copy(s.position),i.quaternion.copy(s.quaternion),this._component.controls.camera=i}getDistance(){const t=this._component.threePersp,e=this._component.threeOrtho;return(e.top-e.bottom)/e.zoom/(2*Math.atan(t.fov*(Math.PI/180)/2))}async setPerspectiveCamera(){this._component.controls.mouseButtons.wheel=Lt.ACTION.DOLLY,this._component.controls.mouseButtons.middle=Lt.ACTION.DOLLY;const t=this._component.threePersp,e=this._component.threeOrtho;t.position.copy(e.position),t.quaternion.copy(e.quaternion),this._component.controls.mouseButtons.wheel=Lt.ACTION.DOLLY,this._component.controls.touches.two=Lt.ACTION.TOUCH_DOLLY_TRUCK,this._component.controls.touches.three=Lt.ACTION.TOUCH_DOLLY_TRUCK,this._component.controls.dollySpeed=5,this.matchOrthoDistanceEnabled?this._component.controls.distance=this.getDistance():this._component.controls.distance=this._previousDistance,await this._component.controls.zoomTo(1),t.updateProjectionMatrix(),this._component.controls.camera=t,this.camera=t,this.current="Perspective"}}class $h extends js{constructor(t){super(t),p(this,"projection"),p(this,"threeOrtho"),p(this,"threePersp"),p(this,"_userInputButtons",{}),p(this,"_frustumSize",50),p(this,"_navigationModes",new Map),p(this,"_mode",null),p(this,"previousSize",null),this.threePersp=this.three,this.threeOrtho=this.newOrthoCamera(),this.projection=new Zh(this),this.onAspectUpdated.add(()=>{this.setOrthoPerspCameraAspect()}),this.projection.onChanged.add(e=>{this.three=e,this.updateAspect()}),this.onWorldChanged.add(({action:e})=>{e==="added"&&(this._navigationModes.clear(),this._navigationModes.set("Orbit",new Wh(this)),this._navigationModes.set("FirstPerson",new Hh(this)),this._navigationModes.set("Plan",new Xh(this)),this._mode=this._navigationModes.get("Orbit"),this.mode.set(!0,{preventTargetAdjustment:!0}),this.currentWorld&&this.currentWorld.renderer&&(this.previousSize=this.currentWorld.renderer.getSize().clone()))})}get mode(){if(!this._mode)throw new Error("Mode not found, camera not initialized");return this._mode}dispose(){super.dispose(),this.threeOrtho.removeFromParent()}set(t){if(this.mode!==null&&this.mode.id!==t){if(this.mode.set(!1),!this._navigationModes.has(t))throw new Error("The specified mode does not exist!");this._mode=this._navigationModes.get(t),this.mode.set(!0)}}async fit(t,e=1.5){if(!this.enabled)return;const s=Number.MAX_VALUE,i=Number.MIN_VALUE,n=new B(s,s,s),r=new B(i,i,i);for(const u of t){const f=new vt().setFromObject(u);f.min.x<n.x&&(n.x=f.min.x),f.min.y<n.y&&(n.y=f.min.y),f.min.z<n.z&&(n.z=f.min.z),f.max.x>r.x&&(r.x=f.max.x),f.max.y>r.y&&(r.y=f.max.y),f.max.z>r.z&&(r.z=f.max.z)}const o=new vt(n,r),a=new B;o.getSize(a);const l=new B;o.getCenter(l);const h=Math.max(a.x,a.y,a.z)*e,d=new Vi(l,h);await this.controls.fitToSphere(d,!0)}setUserInput(t){t?this.enableUserInput():this.disableUserInput()}disableUserInput(){this._userInputButtons.left=this.controls.mouseButtons.left,this._userInputButtons.right=this.controls.mouseButtons.right,this._userInputButtons.middle=this.controls.mouseButtons.middle,this._userInputButtons.wheel=this.controls.mouseButtons.wheel,this.controls.mouseButtons.left=0,this.controls.mouseButtons.right=0,this.controls.mouseButtons.middle=0,this.controls.mouseButtons.wheel=0}enableUserInput(){Object.keys(this._userInputButtons).length!==0&&(this.controls.mouseButtons.left=this._userInputButtons.left,this.controls.mouseButtons.right=this._userInputButtons.right,this.controls.mouseButtons.middle=this._userInputButtons.middle,this.controls.mouseButtons.wheel=this._userInputButtons.wheel)}newOrthoCamera(){const t=window.innerWidth/window.innerHeight;return new ke(this._frustumSize*t/-2,this._frustumSize*t/2,this._frustumSize/2,this._frustumSize/-2,.1,1e3)}setOrthoPerspCameraAspect(){if(!this.currentWorld||!this.currentWorld.renderer||!this.previousSize)return;const t=this.currentWorld.renderer.getSize(),e=this.threeOrtho.top,s=this.threeOrtho.right,i=t.y/this.previousSize.y,n=t.x/this.previousSize.x,r=e*i,o=s*n;this.threeOrtho.left=-o,this.threeOrtho.right=o,this.threeOrtho.top=r,this.threeOrtho.bottom=-r,this.threeOrtho.updateProjectionMatrix(),this.previousSize.copy(t)}}const Eo=new Map([[Gi,{forRelated:"Decomposes",forRelating:"IsDecomposedBy"}],[Xn,{forRelated:"HasAssociations",forRelating:"AssociatedTo"}],[Zn,{forRelated:"HasAssociations",forRelating:"ClassificationForObjects"}],[$n,{forRelated:"HasAssignments",forRelating:"IsGroupedBy"}],[Qs,{forRelated:"IsDefinedBy",forRelating:"DefinesOcurrence"}],[jn,{forRelated:"IsTypedBy",forRelating:"Types"}],[qn,{forRelated:"IsDefinedBy",forRelating:"Defines"}],[ki,{forRelated:"ContainedInStructure",forRelating:"ContainsElements"}],[Qn,{forRelated:"AssignedToFlowElement",forRelating:"HasControlElements"}],[Kn,{forRelated:"ConnectedFrom",forRelating:"ConnectedTo"}],[Jn,{forRelated:"HasAssignments",forRelating:"ReferencedBy"}],[tr,{forRelated:"HasContext",forRelating:"Declares"}],[er,{forRelated:"HasAssignments",forRelating:"Controls"}],[sr,{forRelated:"Nests",forRelating:"IsNestedBy"}],[ir,{forRelated:"HasAssociations",forRelating:"DocumentRefForObjects"}]]),Bi={950732822:"IFCURIREFERENCE",4075327185:"IFCTIME",1209108979:"IFCTEMPERATURERATEOFCHANGEMEASURE",3457685358:"IFCSOUNDPRESSURELEVELMEASURE",4157543285:"IFCSOUNDPOWERLEVELMEASURE",2798247006:"IFCPROPERTYSETDEFINITIONSET",1790229001:"IFCPOSITIVEINTEGER",525895558:"IFCNONNEGATIVELENGTHMEASURE",1774176899:"IFCLINEINDEX",1275358634:"IFCLANGUAGEID",2541165894:"IFCDURATION",3701338814:"IFCDAYINWEEKNUMBER",2195413836:"IFCDATETIME",937566702:"IFCDATE",1683019596:"IFCCARDINALPOINTREFERENCE",2314439260:"IFCBINARY",1500781891:"IFCAREADENSITYMEASURE",3683503648:"IFCARCINDEX",4065007721:"IFCYEARNUMBER",1718600412:"IFCWARPINGMOMENTMEASURE",51269191:"IFCWARPINGCONSTANTMEASURE",2593997549:"IFCVOLUMETRICFLOWRATEMEASURE",3458127941:"IFCVOLUMEMEASURE",3345633955:"IFCVAPORPERMEABILITYMEASURE",1278329552:"IFCTORQUEMEASURE",2591213694:"IFCTIMESTAMP",2726807636:"IFCTIMEMEASURE",743184107:"IFCTHERMODYNAMICTEMPERATUREMEASURE",2016195849:"IFCTHERMALTRANSMITTANCEMEASURE",857959152:"IFCTHERMALRESISTANCEMEASURE",2281867870:"IFCTHERMALEXPANSIONCOEFFICIENTMEASURE",2645777649:"IFCTHERMALCONDUCTIVITYMEASURE",232962298:"IFCTHERMALADMITTANCEMEASURE",296282323:"IFCTEXTTRANSFORMATION",603696268:"IFCTEXTFONTNAME",3490877962:"IFCTEXTDECORATION",1460886941:"IFCTEXTALIGNMENT",2801250643:"IFCTEXT",58845555:"IFCTEMPERATUREGRADIENTMEASURE",361837227:"IFCSPECULARROUGHNESS",2757832317:"IFCSPECULAREXPONENT",3477203348:"IFCSPECIFICHEATCAPACITYMEASURE",993287707:"IFCSOUNDPRESSUREMEASURE",846465480:"IFCSOUNDPOWERMEASURE",3471399674:"IFCSOLIDANGLEMEASURE",408310005:"IFCSHEARMODULUSMEASURE",2190458107:"IFCSECTIONALAREAINTEGRALMEASURE",3467162246:"IFCSECTIONMODULUSMEASURE",2766185779:"IFCSECONDINMINUTE",3211557302:"IFCROTATIONALSTIFFNESSMEASURE",1755127002:"IFCROTATIONALMASSMEASURE",2133746277:"IFCROTATIONALFREQUENCYMEASURE",200335297:"IFCREAL",96294661:"IFCRATIOMEASURE",3972513137:"IFCRADIOACTIVITYMEASURE",3665567075:"IFCPRESSUREMEASURE",2169031380:"IFCPRESENTABLETEXT",1364037233:"IFCPOWERMEASURE",1245737093:"IFCPOSITIVERATIOMEASURE",3054510233:"IFCPOSITIVEPLANEANGLEMEASURE",2815919920:"IFCPOSITIVELENGTHMEASURE",4042175685:"IFCPLANEANGLEMEASURE",2642773653:"IFCPLANARFORCEMEASURE",2260317790:"IFCPARAMETERVALUE",929793134:"IFCPHMEASURE",2395907400:"IFCNUMERICMEASURE",2095195183:"IFCNORMALISEDRATIOMEASURE",765770214:"IFCMONTHINYEARNUMBER",2615040989:"IFCMONETARYMEASURE",3114022597:"IFCMOMENTOFINERTIAMEASURE",1648970520:"IFCMOLECULARWEIGHTMEASURE",3177669450:"IFCMOISTUREDIFFUSIVITYMEASURE",1753493141:"IFCMODULUSOFSUBGRADEREACTIONMEASURE",1052454078:"IFCMODULUSOFROTATIONALSUBGRADEREACTIONMEASURE",2173214787:"IFCMODULUSOFLINEARSUBGRADEREACTIONMEASURE",3341486342:"IFCMODULUSOFELASTICITYMEASURE",102610177:"IFCMINUTEINHOUR",3531705166:"IFCMASSPERLENGTHMEASURE",3124614049:"IFCMASSMEASURE",4017473158:"IFCMASSFLOWRATEMEASURE",1477762836:"IFCMASSDENSITYMEASURE",2486716878:"IFCMAGNETICFLUXMEASURE",286949696:"IFCMAGNETICFLUXDENSITYMEASURE",151039812:"IFCLUMINOUSINTENSITYMEASURE",2755797622:"IFCLUMINOUSINTENSITYDISTRIBUTIONMEASURE",2095003142:"IFCLUMINOUSFLUXMEASURE",503418787:"IFCLOGICAL",3086160713:"IFCLINEARVELOCITYMEASURE",1307019551:"IFCLINEARSTIFFNESSMEASURE",2128979029:"IFCLINEARMOMENTMEASURE",191860431:"IFCLINEARFORCEMEASURE",1243674935:"IFCLENGTHMEASURE",3258342251:"IFCLABEL",2054016361:"IFCKINEMATICVISCOSITYMEASURE",3192672207:"IFCISOTHERMALMOISTURECAPACITYMEASURE",3686016028:"IFCIONCONCENTRATIONMEASURE",3809634241:"IFCINTEGERCOUNTRATEMEASURE",1939436016:"IFCINTEGER",2679005408:"IFCINDUCTANCEMEASURE",3358199106:"IFCILLUMINANCEMEASURE",983778844:"IFCIDENTIFIER",2589826445:"IFCHOURINDAY",1158859006:"IFCHEATINGVALUEMEASURE",3113092358:"IFCHEATFLUXDENSITYMEASURE",3064340077:"IFCGLOBALLYUNIQUEID",3044325142:"IFCFREQUENCYMEASURE",1361398929:"IFCFORCEMEASURE",2590844177:"IFCFONTWEIGHT",2715512545:"IFCFONTVARIANT",1102727119:"IFCFONTSTYLE",2078135608:"IFCENERGYMEASURE",2506197118:"IFCELECTRICVOLTAGEMEASURE",2951915441:"IFCELECTRICRESISTANCEMEASURE",3790457270:"IFCELECTRICCURRENTMEASURE",2093906313:"IFCELECTRICCONDUCTANCEMEASURE",3818826038:"IFCELECTRICCHARGEMEASURE",1827137117:"IFCELECTRICCAPACITANCEMEASURE",69416015:"IFCDYNAMICVISCOSITYMEASURE",524656162:"IFCDOSEEQUIVALENTMEASURE",4134073009:"IFCDIMENSIONCOUNT",1514641115:"IFCDESCRIPTIVEMEASURE",300323983:"IFCDAYLIGHTSAVINGHOUR",86635668:"IFCDAYINMONTHNUMBER",94842927:"IFCCURVATUREMEASURE",1778710042:"IFCCOUNTMEASURE",3238673880:"IFCCONTEXTDEPENDENTMEASURE",3812528620:"IFCCOMPOUNDPLANEANGLEMEASURE",2991860651:"IFCCOMPLEXNUMBER",1867003952:"IFCBOXALIGNMENT",2735952531:"IFCBOOLEAN",2650437152:"IFCAREAMEASURE",632304761:"IFCANGULARVELOCITYMEASURE",360377573:"IFCAMOUNTOFSUBSTANCEMEASURE",4182062534:"IFCACCELERATIONMEASURE",3699917729:"IFCABSORBEDDOSEMEASURE",1971632696:"IFCGEOSLICE",2680139844:"IFCGEOMODEL",24726584:"IFCELECTRICFLOWTREATMENTDEVICE",3693000487:"IFCDISTRIBUTIONBOARD",3460952963:"IFCCONVEYORSEGMENT",3999819293:"IFCCAISSONFOUNDATION",3314249567:"IFCBOREHOLE",4196446775:"IFCBEARING",325726236:"IFCALIGNMENT",3425753595:"IFCTRACKELEMENT",991950508:"IFCSIGNAL",3798194928:"IFCREINFORCEDSOIL",3290496277:"IFCRAIL",1383356374:"IFCPAVEMENT",2182337498:"IFCNAVIGATIONELEMENT",234836483:"IFCMOORINGDEVICE",2078563270:"IFCMOBILETELECOMMUNICATIONSAPPLIANCE",1638804497:"IFCLIQUIDTERMINAL",1154579445:"IFCLINEARPOSITIONINGELEMENT",2696325953:"IFCKERB",2713699986:"IFCGEOTECHNICALASSEMBLY",2142170206:"IFCELECTRICFLOWTREATMENTDEVICETYPE",3376911765:"IFCEARTHWORKSFILL",1077100507:"IFCEARTHWORKSELEMENT",3071239417:"IFCEARTHWORKSCUT",479945903:"IFCDISTRIBUTIONBOARDTYPE",3426335179:"IFCDEEPFOUNDATION",1502416096:"IFCCOURSE",2940368186:"IFCCONVEYORSEGMENTTYPE",3203706013:"IFCCAISSONFOUNDATIONTYPE",3862327254:"IFCBUILTSYSTEM",1876633798:"IFCBUILTELEMENT",963979645:"IFCBRIDGEPART",644574406:"IFCBRIDGE",3649138523:"IFCBEARINGTYPE",1662888072:"IFCALIGNMENTVERTICAL",317615605:"IFCALIGNMENTSEGMENT",1545765605:"IFCALIGNMENTHORIZONTAL",4266260250:"IFCALIGNMENTCANT",3956297820:"IFCVIBRATIONDAMPERTYPE",1530820697:"IFCVIBRATIONDAMPER",840318589:"IFCVEHICLE",1953115116:"IFCTRANSPORTATIONDEVICE",618700268:"IFCTRACKELEMENTTYPE",2281632017:"IFCTENDONCONDUITTYPE",3663046924:"IFCTENDONCONDUIT",42703149:"IFCSINESPIRAL",1894708472:"IFCSIGNALTYPE",3599934289:"IFCSIGNTYPE",33720170:"IFCSIGN",1027922057:"IFCSEVENTHORDERPOLYNOMIALSPIRAL",544395925:"IFCSEGMENTEDREFERENCECURVE",3649235739:"IFCSECONDORDERPOLYNOMIALSPIRAL",550521510:"IFCROADPART",146592293:"IFCROAD",3818125796:"IFCRELADHERESTOELEMENT",4021432810:"IFCREFERENT",1891881377:"IFCRAILWAYPART",3992365140:"IFCRAILWAY",1763565496:"IFCRAILTYPE",1946335990:"IFCPOSITIONINGELEMENT",514975943:"IFCPAVEMENTTYPE",506776471:"IFCNAVIGATIONELEMENTTYPE",710110818:"IFCMOORINGDEVICETYPE",1950438474:"IFCMOBILETELECOMMUNICATIONSAPPLIANCETYPE",976884017:"IFCMARINEPART",525669439:"IFCMARINEFACILITY",1770583370:"IFCLIQUIDTERMINALTYPE",2176059722:"IFCLINEARELEMENT",679976338:"IFCKERBTYPE",3948183225:"IFCIMPACTPROTECTIONDEVICETYPE",2568555532:"IFCIMPACTPROTECTIONDEVICE",2898700619:"IFCGRADIENTCURVE",1594536857:"IFCGEOTECHNICALSTRATUM",4230923436:"IFCGEOTECHNICALELEMENT",4228831410:"IFCFACILITYPARTCOMMON",1310830890:"IFCFACILITYPART",24185140:"IFCFACILITY",4234616927:"IFCDIRECTRIXDERIVEDREFERENCESWEPTAREASOLID",1306400036:"IFCDEEPFOUNDATIONTYPE",4189326743:"IFCCOURSETYPE",2000195564:"IFCCOSINESPIRAL",3497074424:"IFCCLOTHOID",1626504194:"IFCBUILTELEMENTTYPE",3651464721:"IFCVEHICLETYPE",1229763772:"IFCTRIANGULATEDIRREGULARNETWORK",3665877780:"IFCTRANSPORTATIONDEVICETYPE",782932809:"IFCTHIRDORDERPOLYNOMIALSPIRAL",2735484536:"IFCSPIRAL",1356537516:"IFCSECTIONEDSURFACE",1290935644:"IFCSECTIONEDSOLIDHORIZONTAL",1862484736:"IFCSECTIONEDSOLID",1441486842:"IFCRELPOSITIONS",1033248425:"IFCRELASSOCIATESPROFILEDEF",3381221214:"IFCPOLYNOMIALCURVE",2485787929:"IFCOFFSETCURVEBYDISTANCES",590820931:"IFCOFFSETCURVE",3465909080:"IFCINDEXEDPOLYGONALTEXTUREMAP",593015953:"IFCDIRECTRIXCURVESWEPTAREASOLID",4212018352:"IFCCURVESEGMENT",3425423356:"IFCAXIS2PLACEMENTLINEAR",823603102:"IFCSEGMENT",2165702409:"IFCPOINTBYDISTANCEEXPRESSION",182550632:"IFCOPENCROSSPROFILEDEF",388784114:"IFCLINEARPLACEMENT",536804194:"IFCALIGNMENTHORIZONTALSEGMENT",3752311538:"IFCALIGNMENTCANTSEGMENT",1010789467:"IFCTEXTURECOORDINATEINDICESWITHVOIDS",222769930:"IFCTEXTURECOORDINATEINDICES",2691318326:"IFCQUANTITYNUMBER",3633395639:"IFCALIGNMENTVERTICALSEGMENT",2879124712:"IFCALIGNMENTPARAMETERSEGMENT",25142252:"IFCCONTROLLER",3087945054:"IFCALARM",4288193352:"IFCACTUATOR",630975310:"IFCUNITARYCONTROLELEMENT",4086658281:"IFCSENSOR",2295281155:"IFCPROTECTIVEDEVICETRIPPINGUNIT",182646315:"IFCFLOWINSTRUMENT",1426591983:"IFCFIRESUPPRESSIONTERMINAL",819412036:"IFCFILTER",3415622556:"IFCFAN",1003880860:"IFCELECTRICTIMECONTROL",402227799:"IFCELECTRICMOTOR",264262732:"IFCELECTRICGENERATOR",3310460725:"IFCELECTRICFLOWSTORAGEDEVICE",862014818:"IFCELECTRICDISTRIBUTIONBOARD",1904799276:"IFCELECTRICAPPLIANCE",1360408905:"IFCDUCTSILENCER",3518393246:"IFCDUCTSEGMENT",342316401:"IFCDUCTFITTING",562808652:"IFCDISTRIBUTIONCIRCUIT",4074379575:"IFCDAMPER",3640358203:"IFCCOOLINGTOWER",4136498852:"IFCCOOLEDBEAM",2272882330:"IFCCONDENSER",3571504051:"IFCCOMPRESSOR",3221913625:"IFCCOMMUNICATIONSAPPLIANCE",639361253:"IFCCOIL",3902619387:"IFCCHILLER",4217484030:"IFCCABLESEGMENT",1051757585:"IFCCABLEFITTING",3758799889:"IFCCABLECARRIERSEGMENT",635142910:"IFCCABLECARRIERFITTING",2938176219:"IFCBURNER",32344328:"IFCBOILER",2906023776:"IFCBEAMSTANDARDCASE",277319702:"IFCAUDIOVISUALAPPLIANCE",2056796094:"IFCAIRTOAIRHEATRECOVERY",177149247:"IFCAIRTERMINALBOX",1634111441:"IFCAIRTERMINAL",486154966:"IFCWINDOWSTANDARDCASE",4237592921:"IFCWASTETERMINAL",4156078855:"IFCWALLELEMENTEDCASE",4207607924:"IFCVALVE",4292641817:"IFCUNITARYEQUIPMENT",3179687236:"IFCUNITARYCONTROLELEMENTTYPE",3026737570:"IFCTUBEBUNDLE",3825984169:"IFCTRANSFORMER",812556717:"IFCTANK",1162798199:"IFCSWITCHINGDEVICE",385403989:"IFCSTRUCTURALLOADCASE",1404847402:"IFCSTACKTERMINAL",1999602285:"IFCSPACEHEATER",3420628829:"IFCSOLARDEVICE",3027962421:"IFCSLABSTANDARDCASE",3127900445:"IFCSLABELEMENTEDCASE",1329646415:"IFCSHADINGDEVICE",3053780830:"IFCSANITARYTERMINAL",2572171363:"IFCREINFORCINGBARTYPE",1232101972:"IFCRATIONALBSPLINECURVEWITHKNOTS",90941305:"IFCPUMP",655969474:"IFCPROTECTIVEDEVICETRIPPINGUNITTYPE",738039164:"IFCPROTECTIVEDEVICE",1156407060:"IFCPLATESTANDARDCASE",3612865200:"IFCPIPESEGMENT",310824031:"IFCPIPEFITTING",3694346114:"IFCOUTLET",144952367:"IFCOUTERBOUNDARYCURVE",2474470126:"IFCMOTORCONNECTION",1911478936:"IFCMEMBERSTANDARDCASE",1437502449:"IFCMEDICALDEVICE",629592764:"IFCLIGHTFIXTURE",76236018:"IFCLAMP",2176052936:"IFCJUNCTIONBOX",4175244083:"IFCINTERCEPTOR",2068733104:"IFCHUMIDIFIER",3319311131:"IFCHEATEXCHANGER",2188021234:"IFCFLOWMETER",1209101575:"IFCEXTERNALSPATIALELEMENT",484807127:"IFCEVAPORATOR",3747195512:"IFCEVAPORATIVECOOLER",2814081492:"IFCENGINE",2417008758:"IFCELECTRICDISTRIBUTIONBOARDTYPE",3242481149:"IFCDOORSTANDARDCASE",3205830791:"IFCDISTRIBUTIONSYSTEM",400855858:"IFCCOMMUNICATIONSAPPLIANCETYPE",905975707:"IFCCOLUMNSTANDARDCASE",1677625105:"IFCCIVILELEMENT",3296154744:"IFCCHIMNEY",2674252688:"IFCCABLEFITTINGTYPE",2188180465:"IFCBURNERTYPE",1177604601:"IFCBUILDINGSYSTEM",39481116:"IFCBUILDINGELEMENTPARTTYPE",1136057603:"IFCBOUNDARYCURVE",2461110595:"IFCBSPLINECURVEWITHKNOTS",1532957894:"IFCAUDIOVISUALAPPLIANCETYPE",4088093105:"IFCWORKCALENDAR",4009809668:"IFCWINDOWTYPE",926996030:"IFCVOIDINGFEATURE",2391383451:"IFCVIBRATIONISOLATOR",2415094496:"IFCTENDONTYPE",3081323446:"IFCTENDONANCHORTYPE",413509423:"IFCSYSTEMFURNITUREELEMENT",3101698114:"IFCSURFACEFEATURE",3657597509:"IFCSTRUCTURALSURFACEACTION",2757150158:"IFCSTRUCTURALCURVEREACTION",1004757350:"IFCSTRUCTURALCURVEACTION",338393293:"IFCSTAIRTYPE",1072016465:"IFCSOLARDEVICETYPE",4074543187:"IFCSHADINGDEVICETYPE",2157484638:"IFCSEAMCURVE",2781568857:"IFCROOFTYPE",2310774935:"IFCREINFORCINGMESHTYPE",964333572:"IFCREINFORCINGELEMENTTYPE",683857671:"IFCRATIONALBSPLINESURFACEWITHKNOTS",1469900589:"IFCRAMPTYPE",2839578677:"IFCPOLYGONALFACESET",1158309216:"IFCPILETYPE",3079942009:"IFCOPENINGSTANDARDCASE",1114901282:"IFCMEDICALDEVICETYPE",3113134337:"IFCINTERSECTIONCURVE",3946677679:"IFCINTERCEPTORTYPE",2571569899:"IFCINDEXEDPOLYCURVE",3493046030:"IFCGEOGRAPHICELEMENT",1509553395:"IFCFURNITURE",1893162501:"IFCFOOTINGTYPE",2853485674:"IFCEXTERNALSPATIALSTRUCTUREELEMENT",4148101412:"IFCEVENT",132023988:"IFCENGINETYPE",2397081782:"IFCELEMENTASSEMBLYTYPE",2323601079:"IFCDOORTYPE",1213902940:"IFCCYLINDRICALSURFACE",1525564444:"IFCCONSTRUCTIONPRODUCTRESOURCETYPE",4105962743:"IFCCONSTRUCTIONMATERIALRESOURCETYPE",2185764099:"IFCCONSTRUCTIONEQUIPMENTRESOURCETYPE",15328376:"IFCCOMPOSITECURVEONSURFACE",3875453745:"IFCCOMPLEXPROPERTYTEMPLATE",3893394355:"IFCCIVILELEMENTTYPE",2197970202:"IFCCHIMNEYTYPE",167062518:"IFCBSPLINESURFACEWITHKNOTS",2887950389:"IFCBSPLINESURFACE",2603310189:"IFCADVANCEDBREPWITHVOIDS",1635779807:"IFCADVANCEDBREP",2916149573:"IFCTRIANGULATEDFACESET",1935646853:"IFCTOROIDALSURFACE",2387106220:"IFCTESSELLATEDFACESET",3206491090:"IFCTASKTYPE",699246055:"IFCSURFACECURVE",4095615324:"IFCSUBCONTRACTRESOURCETYPE",603775116:"IFCSTRUCTURALSURFACEREACTION",4015995234:"IFCSPHERICALSURFACE",2481509218:"IFCSPATIALZONETYPE",463610769:"IFCSPATIALZONE",710998568:"IFCSPATIALELEMENTTYPE",1412071761:"IFCSPATIALELEMENT",3663146110:"IFCSIMPLEPROPERTYTEMPLATE",3243963512:"IFCREVOLVEDAREASOLIDTAPERED",816062949:"IFCREPARAMETRISEDCOMPOSITECURVESEGMENT",1521410863:"IFCRELSPACEBOUNDARY2NDLEVEL",3523091289:"IFCRELSPACEBOUNDARY1STLEVEL",427948657:"IFCRELINTERFERESELEMENTS",307848117:"IFCRELDEFINESBYTEMPLATE",1462361463:"IFCRELDEFINESBYOBJECT",2565941209:"IFCRELDECLARES",1027710054:"IFCRELASSIGNSTOGROUPBYFACTOR",3521284610:"IFCPROPERTYTEMPLATE",492091185:"IFCPROPERTYSETTEMPLATE",653396225:"IFCPROJECTLIBRARY",569719735:"IFCPROCEDURETYPE",3967405729:"IFCPREDEFINEDPROPERTYSET",1682466193:"IFCPCURVE",428585644:"IFCLABORRESOURCETYPE",2294589976:"IFCINDEXEDPOLYGONALFACEWITHVOIDS",178912537:"IFCINDEXEDPOLYGONALFACE",4095422895:"IFCGEOGRAPHICELEMENTTYPE",2652556860:"IFCFIXEDREFERENCESWEPTAREASOLID",2804161546:"IFCEXTRUDEDAREASOLIDTAPERED",4024345920:"IFCEVENTTYPE",2629017746:"IFCCURVEBOUNDEDSURFACE",1815067380:"IFCCREWRESOURCETYPE",3419103109:"IFCCONTEXT",2574617495:"IFCCONSTRUCTIONRESOURCETYPE",2059837836:"IFCCARTESIANPOINTLIST3D",1675464909:"IFCCARTESIANPOINTLIST2D",574549367:"IFCCARTESIANPOINTLIST",3406155212:"IFCADVANCEDFACE",3698973494:"IFCTYPERESOURCE",3736923433:"IFCTYPEPROCESS",901063453:"IFCTESSELLATEDITEM",1096409881:"IFCSWEPTDISKSOLIDPOLYGONAL",1042787934:"IFCRESOURCETIME",1608871552:"IFCRESOURCECONSTRAINTRELATIONSHIP",2943643501:"IFCRESOURCEAPPROVALRELATIONSHIP",2090586900:"IFCQUANTITYSET",1482703590:"IFCPROPERTYTEMPLATEDEFINITION",3778827333:"IFCPREDEFINEDPROPERTIES",2998442950:"IFCMIRROREDPROFILEDEF",853536259:"IFCMATERIALRELATIONSHIP",3404854881:"IFCMATERIALPROFILESETUSAGETAPERING",3079605661:"IFCMATERIALPROFILESETUSAGE",2852063980:"IFCMATERIALCONSTITUENTSET",3708119e3:"IFCMATERIALCONSTITUENT",1585845231:"IFCLAGTIME",2133299955:"IFCINDEXEDTRIANGLETEXTUREMAP",1437953363:"IFCINDEXEDTEXTUREMAP",3570813810:"IFCINDEXEDCOLOURMAP",1437805879:"IFCEXTERNALREFERENCERELATIONSHIP",297599258:"IFCEXTENDEDPROPERTIES",211053100:"IFCEVENTTIME",2713554722:"IFCCONVERSIONBASEDUNITWITHOFFSET",3285139300:"IFCCOLOURRGBLIST",1236880293:"IFCWORKTIME",1199560280:"IFCTIMEPERIOD",3611470254:"IFCTEXTUREVERTEXLIST",2771591690:"IFCTASKTIMERECURRING",1549132990:"IFCTASKTIME",2043862942:"IFCTABLECOLUMN",2934153892:"IFCSURFACEREINFORCEMENTAREA",609421318:"IFCSTRUCTURALLOADORRESULT",3478079324:"IFCSTRUCTURALLOADCONFIGURATION",1054537805:"IFCSCHEDULINGTIME",2439245199:"IFCRESOURCELEVELRELATIONSHIP",2433181523:"IFCREFERENCE",3915482550:"IFCRECURRENCEPATTERN",986844984:"IFCPROPERTYABSTRACTION",3843373140:"IFCPROJECTEDCRS",677532197:"IFCPRESENTATIONITEM",1507914824:"IFCMATERIALUSAGEDEFINITION",552965576:"IFCMATERIALPROFILEWITHOFFSETS",164193824:"IFCMATERIALPROFILESET",2235152071:"IFCMATERIALPROFILE",1847252529:"IFCMATERIALLAYERWITHOFFSETS",760658860:"IFCMATERIALDEFINITION",3057273783:"IFCMAPCONVERSION",4294318154:"IFCEXTERNALINFORMATION",1466758467:"IFCCOORDINATEREFERENCESYSTEM",1785450214:"IFCCOORDINATEOPERATION",775493141:"IFCCONNECTIONVOLUMEGEOMETRY",979691226:"IFCREINFORCINGBAR",3700593921:"IFCELECTRICDISTRIBUTIONPOINT",1062813311:"IFCDISTRIBUTIONCONTROLELEMENT",1052013943:"IFCDISTRIBUTIONCHAMBERELEMENT",578613899:"IFCCONTROLLERTYPE",2454782716:"IFCCHAMFEREDGEFEATURE",753842376:"IFCBEAM",3001207471:"IFCALARMTYPE",2874132201:"IFCACTUATORTYPE",3304561284:"IFCWINDOW",3512223829:"IFCWALLSTANDARDCASE",2391406946:"IFCWALL",3313531582:"IFCVIBRATIONISOLATORTYPE",2347447852:"IFCTENDONANCHOR",3824725483:"IFCTENDON",2515109513:"IFCSTRUCTURALANALYSISMODEL",4252922144:"IFCSTAIRFLIGHT",331165859:"IFCSTAIR",1529196076:"IFCSLAB",1783015770:"IFCSENSORTYPE",1376911519:"IFCROUNDEDEDGEFEATURE",2016517767:"IFCROOF",2320036040:"IFCREINFORCINGMESH",3027567501:"IFCREINFORCINGELEMENT",3055160366:"IFCRATIONALBEZIERCURVE",3283111854:"IFCRAMPFLIGHT",3024970846:"IFCRAMP",2262370178:"IFCRAILING",3171933400:"IFCPLATE",1687234759:"IFCPILE",1073191201:"IFCMEMBER",900683007:"IFCFOOTING",3508470533:"IFCFLOWTREATMENTDEVICE",2223149337:"IFCFLOWTERMINAL",707683696:"IFCFLOWSTORAGEDEVICE",987401354:"IFCFLOWSEGMENT",3132237377:"IFCFLOWMOVINGDEVICE",4037862832:"IFCFLOWINSTRUMENTTYPE",4278956645:"IFCFLOWFITTING",2058353004:"IFCFLOWCONTROLLER",4222183408:"IFCFIRESUPPRESSIONTERMINALTYPE",1810631287:"IFCFILTERTYPE",346874300:"IFCFANTYPE",1658829314:"IFCENERGYCONVERSIONDEVICE",857184966:"IFCELECTRICALELEMENT",1634875225:"IFCELECTRICALCIRCUIT",712377611:"IFCELECTRICTIMECONTROLTYPE",1217240411:"IFCELECTRICMOTORTYPE",1365060375:"IFCELECTRICHEATERTYPE",1534661035:"IFCELECTRICGENERATORTYPE",3277789161:"IFCELECTRICFLOWSTORAGEDEVICETYPE",663422040:"IFCELECTRICAPPLIANCETYPE",855621170:"IFCEDGEFEATURE",2030761528:"IFCDUCTSILENCERTYPE",3760055223:"IFCDUCTSEGMENTTYPE",869906466:"IFCDUCTFITTINGTYPE",395920057:"IFCDOOR",3041715199:"IFCDISTRIBUTIONPORT",3040386961:"IFCDISTRIBUTIONFLOWELEMENT",1945004755:"IFCDISTRIBUTIONELEMENT",2063403501:"IFCDISTRIBUTIONCONTROLELEMENTTYPE",1599208980:"IFCDISTRIBUTIONCHAMBERELEMENTTYPE",2635815018:"IFCDISCRETEACCESSORYTYPE",1335981549:"IFCDISCRETEACCESSORY",4147604152:"IFCDIAMETERDIMENSION",3961806047:"IFCDAMPERTYPE",3495092785:"IFCCURTAINWALL",1973544240:"IFCCOVERING",2954562838:"IFCCOOLINGTOWERTYPE",335055490:"IFCCOOLEDBEAMTYPE",488727124:"IFCCONSTRUCTIONPRODUCTRESOURCE",1060000209:"IFCCONSTRUCTIONMATERIALRESOURCE",3898045240:"IFCCONSTRUCTIONEQUIPMENTRESOURCE",1163958913:"IFCCONDITIONCRITERION",2188551683:"IFCCONDITION",2816379211:"IFCCONDENSERTYPE",3850581409:"IFCCOMPRESSORTYPE",843113511:"IFCCOLUMN",2301859152:"IFCCOILTYPE",2611217952:"IFCCIRCLE",2951183804:"IFCCHILLERTYPE",1285652485:"IFCCABLESEGMENTTYPE",3293546465:"IFCCABLECARRIERSEGMENTTYPE",395041908:"IFCCABLECARRIERFITTINGTYPE",1909888760:"IFCBUILDINGELEMENTPROXYTYPE",1095909175:"IFCBUILDINGELEMENTPROXY",2979338954:"IFCBUILDINGELEMENTPART",52481810:"IFCBUILDINGELEMENTCOMPONENT",3299480353:"IFCBUILDINGELEMENT",231477066:"IFCBOILERTYPE",1916977116:"IFCBEZIERCURVE",819618141:"IFCBEAMTYPE",1967976161:"IFCBSPLINECURVE",3460190687:"IFCASSET",2470393545:"IFCANGULARDIMENSION",1871374353:"IFCAIRTOAIRHEATRECOVERYTYPE",3352864051:"IFCAIRTERMINALTYPE",1411407467:"IFCAIRTERMINALBOXTYPE",3821786052:"IFCACTIONREQUEST",1213861670:"IFC2DCOMPOSITECURVE",1033361043:"IFCZONE",3342526732:"IFCWORKSCHEDULE",4218914973:"IFCWORKPLAN",1028945134:"IFCWORKCONTROL",1133259667:"IFCWASTETERMINALTYPE",1898987631:"IFCWALLTYPE",2769231204:"IFCVIRTUALELEMENT",728799441:"IFCVALVETYPE",1911125066:"IFCUNITARYEQUIPMENTTYPE",1600972822:"IFCTUBEBUNDLETYPE",3593883385:"IFCTRIMMEDCURVE",1620046519:"IFCTRANSPORTELEMENT",1692211062:"IFCTRANSFORMERTYPE",1637806684:"IFCTIMESERIESSCHEDULE",5716631:"IFCTANKTYPE",2254336722:"IFCSYSTEM",2315554128:"IFCSWITCHINGDEVICETYPE",148013059:"IFCSUBCONTRACTRESOURCE",1975003073:"IFCSTRUCTURALSURFACECONNECTION",2986769608:"IFCSTRUCTURALRESULTGROUP",1235345126:"IFCSTRUCTURALPOINTREACTION",734778138:"IFCSTRUCTURALPOINTCONNECTION",2082059205:"IFCSTRUCTURALPOINTACTION",3987759626:"IFCSTRUCTURALPLANARACTIONVARYING",1621171031:"IFCSTRUCTURALPLANARACTION",1252848954:"IFCSTRUCTURALLOADGROUP",1721250024:"IFCSTRUCTURALLINEARACTIONVARYING",1807405624:"IFCSTRUCTURALLINEARACTION",2445595289:"IFCSTRUCTURALCURVEMEMBERVARYING",214636428:"IFCSTRUCTURALCURVEMEMBER",4243806635:"IFCSTRUCTURALCURVECONNECTION",1179482911:"IFCSTRUCTURALCONNECTION",682877961:"IFCSTRUCTURALACTION",1039846685:"IFCSTAIRFLIGHTTYPE",3112655638:"IFCSTACKTERMINALTYPE",3812236995:"IFCSPACETYPE",652456506:"IFCSPACEPROGRAM",1305183839:"IFCSPACEHEATERTYPE",3856911033:"IFCSPACE",2533589738:"IFCSLABTYPE",4097777520:"IFCSITE",4105383287:"IFCSERVICELIFE",3517283431:"IFCSCHEDULETIMECONTROL",1768891740:"IFCSANITARYTERMINALTYPE",2863920197:"IFCRELASSIGNSTASKS",160246688:"IFCRELAGGREGATES",2324767716:"IFCRAMPFLIGHTTYPE",2893384427:"IFCRAILINGTYPE",3248260540:"IFCRADIUSDIMENSION",2250791053:"IFCPUMPTYPE",1842657554:"IFCPROTECTIVEDEVICETYPE",3651124850:"IFCPROJECTIONELEMENT",3642467123:"IFCPROJECTORDERRECORD",2904328755:"IFCPROJECTORDER",2744685151:"IFCPROCEDURE",3740093272:"IFCPORT",3724593414:"IFCPOLYLINE",4017108033:"IFCPLATETYPE",4231323485:"IFCPIPESEGMENTTYPE",804291784:"IFCPIPEFITTINGTYPE",3327091369:"IFCPERMIT",2382730787:"IFCPERFORMANCEHISTORY",2837617999:"IFCOUTLETTYPE",3425660407:"IFCORDERACTION",3588315303:"IFCOPENINGELEMENT",4143007308:"IFCOCCUPANT",1916936684:"IFCMOVE",977012517:"IFCMOTORCONNECTIONTYPE",3181161470:"IFCMEMBERTYPE",2108223431:"IFCMECHANICALFASTENERTYPE",377706215:"IFCMECHANICALFASTENER",2506943328:"IFCLINEARDIMENSION",1161773419:"IFCLIGHTFIXTURETYPE",1051575348:"IFCLAMPTYPE",3827777499:"IFCLABORRESOURCE",4288270099:"IFCJUNCTIONBOXTYPE",2391368822:"IFCINVENTORY",1806887404:"IFCHUMIDIFIERTYPE",1251058090:"IFCHEATEXCHANGERTYPE",2706460486:"IFCGROUP",3009204131:"IFCGRID",200128114:"IFCGASTERMINALTYPE",814719939:"IFCFURNITURESTANDARD",263784265:"IFCFURNISHINGELEMENT",3009222698:"IFCFLOWTREATMENTDEVICETYPE",2297155007:"IFCFLOWTERMINALTYPE",1339347760:"IFCFLOWSTORAGEDEVICETYPE",1834744321:"IFCFLOWSEGMENTTYPE",1482959167:"IFCFLOWMOVINGDEVICETYPE",3815607619:"IFCFLOWMETERTYPE",3198132628:"IFCFLOWFITTINGTYPE",3907093117:"IFCFLOWCONTROLLERTYPE",1287392070:"IFCFEATUREELEMENTSUBTRACTION",2143335405:"IFCFEATUREELEMENTADDITION",2827207264:"IFCFEATUREELEMENT",2489546625:"IFCFASTENERTYPE",647756555:"IFCFASTENER",3737207727:"IFCFACETEDBREPWITHVOIDS",807026263:"IFCFACETEDBREP",3390157468:"IFCEVAPORATORTYPE",3174744832:"IFCEVAPORATIVECOOLERTYPE",3272907226:"IFCEQUIPMENTSTANDARD",1962604670:"IFCEQUIPMENTELEMENT",2107101300:"IFCENERGYCONVERSIONDEVICETYPE",1704287377:"IFCELLIPSE",2590856083:"IFCELEMENTCOMPONENTTYPE",1623761950:"IFCELEMENTCOMPONENT",4123344466:"IFCELEMENTASSEMBLY",1758889154:"IFCELEMENT",360485395:"IFCELECTRICALBASEPROPERTIES",3849074793:"IFCDISTRIBUTIONFLOWELEMENTTYPE",3256556792:"IFCDISTRIBUTIONELEMENTTYPE",681481545:"IFCDIMENSIONCURVEDIRECTEDCALLOUT",1457835157:"IFCCURTAINWALLTYPE",3295246426:"IFCCREWRESOURCE",1916426348:"IFCCOVERINGTYPE",1419761937:"IFCCOSTSCHEDULE",3895139033:"IFCCOSTITEM",3293443760:"IFCCONTROL",2559216714:"IFCCONSTRUCTIONRESOURCE",2510884976:"IFCCONIC",3732776249:"IFCCOMPOSITECURVE",300633059:"IFCCOLUMNTYPE",2937912522:"IFCCIRCLEHOLLOWPROFILEDEF",3124254112:"IFCBUILDINGSTOREY",1950629157:"IFCBUILDINGELEMENTTYPE",4031249490:"IFCBUILDING",1260505505:"IFCBOUNDEDCURVE",3649129432:"IFCBOOLEANCLIPPINGRESULT",1334484129:"IFCBLOCK",3207858831:"IFCASYMMETRICISHAPEPROFILEDEF",1674181508:"IFCANNOTATION",2296667514:"IFCACTOR",2097647324:"IFCTRANSPORTELEMENTTYPE",3473067441:"IFCTASK",1580310250:"IFCSYSTEMFURNITUREELEMENTTYPE",4124788165:"IFCSURFACEOFREVOLUTION",2809605785:"IFCSURFACEOFLINEAREXTRUSION",2028607225:"IFCSURFACECURVESWEPTAREASOLID",4070609034:"IFCSTRUCTUREDDIMENSIONCALLOUT",2218152070:"IFCSTRUCTURALSURFACEMEMBERVARYING",3979015343:"IFCSTRUCTURALSURFACEMEMBER",3689010777:"IFCSTRUCTURALREACTION",530289379:"IFCSTRUCTURALMEMBER",3136571912:"IFCSTRUCTURALITEM",3544373492:"IFCSTRUCTURALACTIVITY",451544542:"IFCSPHERE",3893378262:"IFCSPATIALSTRUCTUREELEMENTTYPE",2706606064:"IFCSPATIALSTRUCTUREELEMENT",3626867408:"IFCRIGHTCIRCULARCYLINDER",4158566097:"IFCRIGHTCIRCULARCONE",1856042241:"IFCREVOLVEDAREASOLID",2914609552:"IFCRESOURCE",1401173127:"IFCRELVOIDSELEMENT",3451746338:"IFCRELSPACEBOUNDARY",366585022:"IFCRELSERVICESBUILDINGS",4122056220:"IFCRELSEQUENCE",1058617721:"IFCRELSCHEDULESCOSTITEMS",1245217292:"IFCRELREFERENCEDINSPATIALSTRUCTURE",750771296:"IFCRELPROJECTSELEMENT",202636808:"IFCRELOVERRIDESPROPERTIES",2051452291:"IFCRELOCCUPIESSPACES",3268803585:"IFCRELNESTS",4189434867:"IFCRELINTERACTIONREQUIREMENTS",279856033:"IFCRELFLOWCONTROLELEMENTS",3940055652:"IFCRELFILLSELEMENT",781010003:"IFCRELDEFINESBYTYPE",4186316022:"IFCRELDEFINESBYPROPERTIES",693640335:"IFCRELDEFINES",2551354335:"IFCRELDECOMPOSES",2802773753:"IFCRELCOVERSSPACES",886880790:"IFCRELCOVERSBLDGELEMENTS",3242617779:"IFCRELCONTAINEDINSPATIALSTRUCTURE",3678494232:"IFCRELCONNECTSWITHREALIZINGELEMENTS",504942748:"IFCRELCONNECTSWITHECCENTRICITY",1638771189:"IFCRELCONNECTSSTRUCTURALMEMBER",3912681535:"IFCRELCONNECTSSTRUCTURALELEMENT",2127690289:"IFCRELCONNECTSSTRUCTURALACTIVITY",3190031847:"IFCRELCONNECTSPORTS",4201705270:"IFCRELCONNECTSPORTTOELEMENT",3945020480:"IFCRELCONNECTSPATHELEMENTS",1204542856:"IFCRELCONNECTSELEMENTS",826625072:"IFCRELCONNECTS",2851387026:"IFCRELASSOCIATESPROFILEPROPERTIES",2655215786:"IFCRELASSOCIATESMATERIAL",3840914261:"IFCRELASSOCIATESLIBRARY",982818633:"IFCRELASSOCIATESDOCUMENT",2728634034:"IFCRELASSOCIATESCONSTRAINT",919958153:"IFCRELASSOCIATESCLASSIFICATION",4095574036:"IFCRELASSOCIATESAPPROVAL",1327628568:"IFCRELASSOCIATESAPPLIEDVALUE",1865459582:"IFCRELASSOCIATES",205026976:"IFCRELASSIGNSTORESOURCE",3372526763:"IFCRELASSIGNSTOPROJECTORDER",2857406711:"IFCRELASSIGNSTOPRODUCT",4278684876:"IFCRELASSIGNSTOPROCESS",1307041759:"IFCRELASSIGNSTOGROUP",2495723537:"IFCRELASSIGNSTOCONTROL",1683148259:"IFCRELASSIGNSTOACTOR",3939117080:"IFCRELASSIGNS",3454111270:"IFCRECTANGULARTRIMMEDSURFACE",2798486643:"IFCRECTANGULARPYRAMID",2770003689:"IFCRECTANGLEHOLLOWPROFILEDEF",3219374653:"IFCPROXY",1451395588:"IFCPROPERTYSET",4194566429:"IFCPROJECTIONCURVE",103090709:"IFCPROJECT",4208778838:"IFCPRODUCT",2945172077:"IFCPROCESS",220341763:"IFCPLANE",603570806:"IFCPLANARBOX",3566463478:"IFCPERMEABLECOVERINGPROPERTIES",3505215534:"IFCOFFSETCURVE3D",3388369263:"IFCOFFSETCURVE2D",3888040117:"IFCOBJECT",1425443689:"IFCMANIFOLDSOLIDBREP",1281925730:"IFCLINE",572779678:"IFCLSHAPEPROFILEDEF",1484403080:"IFCISHAPEPROFILEDEF",987898635:"IFCGEOMETRICCURVESET",1268542332:"IFCFURNITURETYPE",4238390223:"IFCFURNISHINGELEMENTTYPE",3455213021:"IFCFLUIDFLOWPROPERTIES",315944413:"IFCFILLAREASTYLETILES",4203026998:"IFCFILLAREASTYLETILESYMBOLWITHSTYLE",374418227:"IFCFILLAREASTYLEHATCHING",2047409740:"IFCFACEBASEDSURFACEMODEL",477187591:"IFCEXTRUDEDAREASOLID",80994333:"IFCENERGYPROPERTIES",2835456948:"IFCELLIPSEPROFILEDEF",2777663545:"IFCELEMENTARYSURFACE",339256511:"IFCELEMENTTYPE",1883228015:"IFCELEMENTQUANTITY",1472233963:"IFCEDGELOOP",4006246654:"IFCDRAUGHTINGPREDEFINEDCURVEFONT",445594917:"IFCDRAUGHTINGPREDEFINEDCOLOUR",3073041342:"IFCDRAUGHTINGCALLOUT",526551008:"IFCDOORSTYLE",1714330368:"IFCDOORPANELPROPERTIES",2963535650:"IFCDOORLININGPROPERTIES",32440307:"IFCDIRECTION",4054601972:"IFCDIMENSIONCURVETERMINATOR",606661476:"IFCDIMENSIONCURVE",693772133:"IFCDEFINEDSYMBOL",2827736869:"IFCCURVEBOUNDEDPLANE",2601014836:"IFCCURVE",2147822146:"IFCCSGSOLID",2506170314:"IFCCSGPRIMITIVE3D",194851669:"IFCCRANERAILFSHAPEPROFILEDEF",4133800736:"IFCCRANERAILASHAPEPROFILEDEF",2485617015:"IFCCOMPOSITECURVESEGMENT",2205249479:"IFCCLOSEDSHELL",1383045692:"IFCCIRCLEPROFILEDEF",1416205885:"IFCCARTESIANTRANSFORMATIONOPERATOR3DNONUNIFORM",3331915920:"IFCCARTESIANTRANSFORMATIONOPERATOR3D",3486308946:"IFCCARTESIANTRANSFORMATIONOPERATOR2DNONUNIFORM",3749851601:"IFCCARTESIANTRANSFORMATIONOPERATOR2D",59481748:"IFCCARTESIANTRANSFORMATIONOPERATOR",1123145078:"IFCCARTESIANPOINT",2898889636:"IFCCSHAPEPROFILEDEF",2713105998:"IFCBOXEDHALFSPACE",2581212453:"IFCBOUNDINGBOX",4182860854:"IFCBOUNDEDSURFACE",2736907675:"IFCBOOLEANRESULT",2740243338:"IFCAXIS2PLACEMENT3D",3125803723:"IFCAXIS2PLACEMENT2D",4261334040:"IFCAXIS1PLACEMENT",1302238472:"IFCANNOTATIONSURFACE",2265737646:"IFCANNOTATIONFILLAREAOCCURRENCE",669184980:"IFCANNOTATIONFILLAREA",3288037868:"IFCANNOTATIONCURVEOCCURRENCE",2543172580:"IFCZSHAPEPROFILEDEF",1299126871:"IFCWINDOWSTYLE",512836454:"IFCWINDOWPANELPROPERTIES",336235671:"IFCWINDOWLININGPROPERTIES",2759199220:"IFCVERTEXLOOP",1417489154:"IFCVECTOR",427810014:"IFCUSHAPEPROFILEDEF",2347495698:"IFCTYPEPRODUCT",1628702193:"IFCTYPEOBJECT",1345879162:"IFCTWODIRECTIONREPEATFACTOR",2715220739:"IFCTRAPEZIUMPROFILEDEF",3124975700:"IFCTEXTLITERALWITHEXTENT",4282788508:"IFCTEXTLITERAL",3028897424:"IFCTERMINATORSYMBOL",3071757647:"IFCTSHAPEPROFILEDEF",230924584:"IFCSWEPTSURFACE",1260650574:"IFCSWEPTDISKSOLID",2247615214:"IFCSWEPTAREASOLID",1878645084:"IFCSURFACESTYLERENDERING",2513912981:"IFCSURFACE",2233826070:"IFCSUBEDGE",3653947884:"IFCSTRUCTURALSTEELPROFILEPROPERTIES",3843319758:"IFCSTRUCTURALPROFILEPROPERTIES",1190533807:"IFCSTRUCTURALLOADSINGLEFORCEWARPING",1597423693:"IFCSTRUCTURALLOADSINGLEFORCE",1973038258:"IFCSTRUCTURALLOADSINGLEDISPLACEMENTDISTORTION",2473145415:"IFCSTRUCTURALLOADSINGLEDISPLACEMENT",2668620305:"IFCSTRUCTURALLOADPLANARFORCE",1595516126:"IFCSTRUCTURALLOADLINEARFORCE",390701378:"IFCSPACETHERMALLOADPROPERTIES",1202362311:"IFCSOUNDVALUE",2485662743:"IFCSOUNDPROPERTIES",723233188:"IFCSOLIDMODEL",2609359061:"IFCSLIPPAGECONNECTIONCONDITION",4124623270:"IFCSHELLBASEDSURFACEMODEL",2411513650:"IFCSERVICELIFEFACTOR",1509187699:"IFCSECTIONEDSPINE",2778083089:"IFCROUNDEDRECTANGLEPROFILEDEF",478536968:"IFCRELATIONSHIP",3765753017:"IFCREINFORCEMENTDEFINITIONPROPERTIES",3413951693:"IFCREGULARTIMESERIES",3615266464:"IFCRECTANGLEPROFILEDEF",110355661:"IFCPROPERTYTABLEVALUE",3650150729:"IFCPROPERTYSINGLEVALUE",3357820518:"IFCPROPERTYSETDEFINITION",941946838:"IFCPROPERTYREFERENCEVALUE",2752243245:"IFCPROPERTYLISTVALUE",4166981789:"IFCPROPERTYENUMERATEDVALUE",1680319473:"IFCPROPERTYDEFINITION",871118103:"IFCPROPERTYBOUNDEDVALUE",673634403:"IFCPRODUCTDEFINITIONSHAPE",179317114:"IFCPREDEFINEDPOINTMARKERSYMBOL",433424934:"IFCPREDEFINEDDIMENSIONSYMBOL",2559016684:"IFCPREDEFINEDCURVEFONT",759155922:"IFCPREDEFINEDCOLOUR",2775532180:"IFCPOLYGONALBOUNDEDHALFSPACE",2924175390:"IFCPOLYLOOP",1423911732:"IFCPOINTONSURFACE",4022376103:"IFCPOINTONCURVE",2067069095:"IFCPOINT",1663979128:"IFCPLANAREXTENT",2004835150:"IFCPLACEMENT",597895409:"IFCPIXELTEXTURE",3021840470:"IFCPHYSICALCOMPLEXQUANTITY",2519244187:"IFCPATH",2529465313:"IFCPARAMETERIZEDPROFILEDEF",1029017970:"IFCORIENTEDEDGE",2665983363:"IFCOPENSHELL",2833995503:"IFCONEDIRECTIONREPEATFACTOR",219451334:"IFCOBJECTDEFINITION",1430189142:"IFCMECHANICALCONCRETEMATERIALPROPERTIES",2022407955:"IFCMATERIALDEFINITIONREPRESENTATION",2347385850:"IFCMAPPEDITEM",1008929658:"IFCLOOP",2624227202:"IFCLOCALPLACEMENT",3422422726:"IFCLIGHTSOURCESPOT",1520743889:"IFCLIGHTSOURCEPOSITIONAL",4266656042:"IFCLIGHTSOURCEGONIOMETRIC",2604431987:"IFCLIGHTSOURCEDIRECTIONAL",125510826:"IFCLIGHTSOURCEAMBIENT",1402838566:"IFCLIGHTSOURCE",3741457305:"IFCIRREGULARTIMESERIES",3905492369:"IFCIMAGETEXTURE",2445078500:"IFCHYGROSCOPICMATERIALPROPERTIES",812098782:"IFCHALFSPACESOLID",178086475:"IFCGRIDPLACEMENT",3590301190:"IFCGEOMETRICSET",4142052618:"IFCGEOMETRICREPRESENTATIONSUBCONTEXT",2453401579:"IFCGEOMETRICREPRESENTATIONITEM",3448662350:"IFCGEOMETRICREPRESENTATIONCONTEXT",1446786286:"IFCGENERALPROFILEPROPERTIES",803998398:"IFCGENERALMATERIALPROPERTIES",3857492461:"IFCFUELPROPERTIES",738692330:"IFCFILLAREASTYLE",4219587988:"IFCFAILURECONNECTIONCONDITION",3008276851:"IFCFACESURFACE",803316827:"IFCFACEOUTERBOUND",1809719519:"IFCFACEBOUND",2556980723:"IFCFACE",1860660968:"IFCEXTENDEDMATERIALPROPERTIES",476780140:"IFCEDGECURVE",3900360178:"IFCEDGE",4170525392:"IFCDRAUGHTINGPREDEFINEDTEXTFONT",3732053477:"IFCDOCUMENTREFERENCE",1694125774:"IFCDIMENSIONPAIR",2273265877:"IFCDIMENSIONCALLOUTRELATIONSHIP",3632507154:"IFCDERIVEDPROFILEDEF",3800577675:"IFCCURVESTYLE",2889183280:"IFCCONVERSIONBASEDUNIT",3050246964:"IFCCONTEXTDEPENDENTUNIT",45288368:"IFCCONNECTIONPOINTECCENTRICITY",1981873012:"IFCCONNECTIONCURVEGEOMETRY",370225590:"IFCCONNECTEDFACESET",1485152156:"IFCCOMPOSITEPROFILEDEF",2542286263:"IFCCOMPLEXPROPERTY",776857604:"IFCCOLOURRGB",647927063:"IFCCLASSIFICATIONREFERENCE",3150382593:"IFCCENTERLINEPROFILEDEF",616511568:"IFCBLOBTEXTURE",2705031697:"IFCARBITRARYPROFILEDEFWITHVOIDS",1310608509:"IFCARBITRARYOPENPROFILEDEF",3798115385:"IFCARBITRARYCLOSEDPROFILEDEF",2297822566:"IFCANNOTATIONTEXTOCCURRENCE",3612888222:"IFCANNOTATIONSYMBOLOCCURRENCE",962685235:"IFCANNOTATIONSURFACEOCCURRENCE",2442683028:"IFCANNOTATIONOCCURRENCE",1065908215:"IFCWATERPROPERTIES",891718957:"IFCVIRTUALGRIDINTERSECTION",1907098498:"IFCVERTEXPOINT",3304826586:"IFCVERTEXBASEDTEXTUREMAP",2799835756:"IFCVERTEX",180925521:"IFCUNITASSIGNMENT",1735638870:"IFCTOPOLOGYREPRESENTATION",1377556343:"IFCTOPOLOGICALREPRESENTATIONITEM",581633288:"IFCTIMESERIESVALUE",1718945513:"IFCTIMESERIESREFERENCERELATIONSHIP",3101149627:"IFCTIMESERIES",3317419933:"IFCTHERMALMATERIALPROPERTIES",1210645708:"IFCTEXTUREVERTEX",2552916305:"IFCTEXTUREMAP",1742049831:"IFCTEXTURECOORDINATEGENERATOR",280115917:"IFCTEXTURECOORDINATE",1484833681:"IFCTEXTSTYLEWITHBOXCHARACTERISTICS",1640371178:"IFCTEXTSTYLETEXTMODEL",2636378356:"IFCTEXTSTYLEFORDEFINEDFONT",1983826977:"IFCTEXTSTYLEFONTMODEL",1447204868:"IFCTEXTSTYLE",912023232:"IFCTELECOMADDRESS",531007025:"IFCTABLEROW",985171141:"IFCTABLE",1290481447:"IFCSYMBOLSTYLE",626085974:"IFCSURFACETEXTURE",1351298697:"IFCSURFACESTYLEWITHTEXTURES",846575682:"IFCSURFACESTYLESHADING",1607154358:"IFCSURFACESTYLEREFRACTION",3303107099:"IFCSURFACESTYLELIGHTING",1300840506:"IFCSURFACESTYLE",3049322572:"IFCSTYLEDREPRESENTATION",3958052878:"IFCSTYLEDITEM",2830218821:"IFCSTYLEMODEL",3408363356:"IFCSTRUCTURALLOADTEMPERATURE",2525727697:"IFCSTRUCTURALLOADSTATIC",2162789131:"IFCSTRUCTURALLOAD",2273995522:"IFCSTRUCTURALCONNECTIONCONDITION",3692461612:"IFCSIMPLEPROPERTY",4240577450:"IFCSHAPEREPRESENTATION",3982875396:"IFCSHAPEMODEL",867548509:"IFCSHAPEASPECT",4165799628:"IFCSECTIONREINFORCEMENTPROPERTIES",2042790032:"IFCSECTIONPROPERTIES",448429030:"IFCSIUNIT",2341007311:"IFCROOT",3679540991:"IFCRIBPLATEPROFILEPROPERTIES",1660063152:"IFCREPRESENTATIONMAP",3008791417:"IFCREPRESENTATIONITEM",3377609919:"IFCREPRESENTATIONCONTEXT",1076942058:"IFCREPRESENTATION",1222501353:"IFCRELAXATION",1580146022:"IFCREINFORCEMENTBARPROPERTIES",2692823254:"IFCREFERENCESVALUEDOCUMENT",825690147:"IFCQUANTITYWEIGHT",2405470396:"IFCQUANTITYVOLUME",3252649465:"IFCQUANTITYTIME",931644368:"IFCQUANTITYLENGTH",2093928680:"IFCQUANTITYCOUNT",2044713172:"IFCQUANTITYAREA",3710013099:"IFCPROPERTYENUMERATION",148025276:"IFCPROPERTYDEPENDENCYRELATIONSHIP",3896028662:"IFCPROPERTYCONSTRAINTRELATIONSHIP",2598011224:"IFCPROPERTY",2802850158:"IFCPROFILEPROPERTIES",3958567839:"IFCPROFILEDEF",2267347899:"IFCPRODUCTSOFCOMBUSTIONPROPERTIES",2095639259:"IFCPRODUCTREPRESENTATION",2417041796:"IFCPRESENTATIONSTYLEASSIGNMENT",3119450353:"IFCPRESENTATIONSTYLE",1304840413:"IFCPRESENTATIONLAYERWITHSTYLE",2022622350:"IFCPRESENTATIONLAYERASSIGNMENT",1775413392:"IFCPREDEFINEDTEXTFONT",3213052703:"IFCPREDEFINEDTERMINATORSYMBOL",990879717:"IFCPREDEFINEDSYMBOL",3727388367:"IFCPREDEFINEDITEM",3355820592:"IFCPOSTALADDRESS",2226359599:"IFCPHYSICALSIMPLEQUANTITY",2483315170:"IFCPHYSICALQUANTITY",101040310:"IFCPERSONANDORGANIZATION",2077209135:"IFCPERSON",1207048766:"IFCOWNERHISTORY",1411181986:"IFCORGANIZATIONRELATIONSHIP",4251960020:"IFCORGANIZATION",1227763645:"IFCOPTICALMATERIALPROPERTIES",2251480897:"IFCOBJECTIVE",3701648758:"IFCOBJECTPLACEMENT",1918398963:"IFCNAMEDUNIT",2706619895:"IFCMONETARYUNIT",3368373690:"IFCMETRIC",677618848:"IFCMECHANICALSTEELMATERIALPROPERTIES",4256014907:"IFCMECHANICALMATERIALPROPERTIES",2597039031:"IFCMEASUREWITHUNIT",3265635763:"IFCMATERIALPROPERTIES",2199411900:"IFCMATERIALLIST",1303795690:"IFCMATERIALLAYERSETUSAGE",3303938423:"IFCMATERIALLAYERSET",248100487:"IFCMATERIALLAYER",1847130766:"IFCMATERIALCLASSIFICATIONRELATIONSHIP",1838606355:"IFCMATERIAL",30780891:"IFCLOCALTIME",1566485204:"IFCLIGHTINTENSITYDISTRIBUTION",4162380809:"IFCLIGHTDISTRIBUTIONDATA",3452421091:"IFCLIBRARYREFERENCE",2655187982:"IFCLIBRARYINFORMATION",3020489413:"IFCIRREGULARTIMESERIESVALUE",852622518:"IFCGRIDAXIS",3548104201:"IFCEXTERNALLYDEFINEDTEXTFONT",3207319532:"IFCEXTERNALLYDEFINEDSYMBOL",1040185647:"IFCEXTERNALLYDEFINEDSURFACESTYLE",2242383968:"IFCEXTERNALLYDEFINEDHATCHSTYLE",3200245327:"IFCEXTERNALREFERENCE",1648886627:"IFCENVIRONMENTALIMPACTVALUE",3796139169:"IFCDRAUGHTINGCALLOUTRELATIONSHIP",770865208:"IFCDOCUMENTINFORMATIONRELATIONSHIP",1154170062:"IFCDOCUMENTINFORMATION",1376555844:"IFCDOCUMENTELECTRONICFORMAT",2949456006:"IFCDIMENSIONALEXPONENTS",1045800335:"IFCDERIVEDUNITELEMENT",1765591967:"IFCDERIVEDUNIT",1072939445:"IFCDATEANDTIME",3510044353:"IFCCURVESTYLEFONTPATTERN",2367409068:"IFCCURVESTYLEFONTANDSCALING",1105321065:"IFCCURVESTYLEFONT",539742890:"IFCCURRENCYRELATIONSHIP",602808272:"IFCCOSTVALUE",1065062679:"IFCCOORDINATEDUNIVERSALTIMEOFFSET",347226245:"IFCCONSTRAINTRELATIONSHIP",613356794:"IFCCONSTRAINTCLASSIFICATIONRELATIONSHIP",1658513725:"IFCCONSTRAINTAGGREGATIONRELATIONSHIP",1959218052:"IFCCONSTRAINT",2732653382:"IFCCONNECTIONSURFACEGEOMETRY",4257277454:"IFCCONNECTIONPORTGEOMETRY",2614616156:"IFCCONNECTIONPOINTGEOMETRY",2859738748:"IFCCONNECTIONGEOMETRY",3264961684:"IFCCOLOURSPECIFICATION",3639012971:"IFCCLASSIFICATIONNOTATIONFACET",938368621:"IFCCLASSIFICATIONNOTATION",1098599126:"IFCCLASSIFICATIONITEMRELATIONSHIP",1767535486:"IFCCLASSIFICATIONITEM",747523909:"IFCCLASSIFICATION",622194075:"IFCCALENDARDATE",2069777674:"IFCBOUNDARYNODECONDITIONWARPING",1387855156:"IFCBOUNDARYNODECONDITION",3367102660:"IFCBOUNDARYFACECONDITION",1560379544:"IFCBOUNDARYEDGECONDITION",4037036970:"IFCBOUNDARYCONDITION",3869604511:"IFCAPPROVALRELATIONSHIP",390851274:"IFCAPPROVALPROPERTYRELATIONSHIP",2080292479:"IFCAPPROVALACTORRELATIONSHIP",130549933:"IFCAPPROVAL",1110488051:"IFCAPPLIEDVALUERELATIONSHIP",411424972:"IFCAPPLIEDVALUE",639542469:"IFCAPPLICATION",618182010:"IFCADDRESS",3630933823:"IFCACTORROLE",599546466:"FILE_DESCRIPTION",1390159747:"FILE_NAME",1109904537:"FILE_SCHEMA"};class ds{static async getUnits(t){var e,s,i;const{IFCUNITASSIGNMENT:n}=ue,r=await t.getAllPropertiesOfType(n);if(!r)return 1;const o=Object.keys(r),a=r[parseInt(o[0],10)];for(const l of a.Units){if(l.value===void 0||l.value===null)continue;const h=await t.getProperties(l.value);if(!h||!h.UnitType||!h.UnitType.value||h.UnitType.value!=="LENGTHUNIT")continue;let u=1,f=1;return h.Name.value==="METRE"&&(f=1),h.Name.value==="FOOT"&&(f=.3048),((e=h.Prefix)==null?void 0:e.value)==="MILLI"?u=.001:((s=h.Prefix)==null?void 0:s.value)==="CENTI"?u=.01:((i=h.Prefix)==null?void 0:i.value)==="DECI"&&(u=.1),f*u}return 1}static async findItemByGuid(t,e){var s;const i=t.getAllPropertiesIDs();for(const n of i){const r=await t.getProperties(n);if(r&&((s=r.GlobalId)==null?void 0:s.value)===e)return r}return null}static async getRelationMap(t,e,s){var i;const r=s??(async()=>{}),o={},a=t.getAllPropertiesIDs();for(const l of a){const h=await t.getProperties(l);if(!h)continue;const d=h.type===e,u=Object.keys(h).find(C=>C.startsWith("Relating")),f=Object.keys(h).find(C=>C.startsWith("Related"));if(!(d&&u&&f))continue;const I=await t.getProperties((i=h[u])==null?void 0:i.value),E=h[f];if(!I||!E||!(E&&Array.isArray(E)))continue;const m=E.map(C=>C.value);await r(I.expressID,m),o[I.expressID]=m}return o}static async getQsetQuantities(t,e,s){const n=s??(()=>{}),r=await t.getProperties(e);return!r||r.type!==Pi?null:(r.Quantities??[{}]).map(l=>(l.value&&n(l.value),l.value)).filter(l=>l!==null)}static async getPsetProps(t,e,s){const n=s??(()=>{}),r=await t.getProperties(e);return!r||r.type!==fs?null:(r.HasProperties??[{}]).map(l=>(l.value&&n(l.value),l.value)).filter(l=>l!==null)}static async getPsetRel(t,e){var s;if(!await t.getProperties(e))return null;const n=await t.getAllPropertiesOfType(Qs);if(!n)return null;const r=Object.values(n);let o=null;for(const a of r)((s=a.RelatingPropertyDefinition)==null?void 0:s.value)===e&&(o=a.expressID);return o}static async getQsetRel(t,e){return ds.getPsetRel(t,e)}static async getEntityName(t,e){var s;const i=await t.getProperties(e);if(!i)return{key:null,name:null};const n=Object.keys(i).find(o=>o.endsWith("Name"))??null,r=n?(s=i[n])==null?void 0:s.value:null;return{key:n,name:r}}static async getQuantityValue(t,e){const s=await t.getProperties(e);if(!s)return{key:null,value:null};const i=Object.keys(s).find(r=>r.endsWith("Value"))??null;let n;return i===null||s[i]===void 0||s[i]===null?n=null:n=s[i].value,{key:i,value:n}}static isRel(t){return Bi[t].startsWith("IFCREL")}static async attributeExists(t,e,s){const i=await t.getProperties(e);return i?Object.keys(i).includes(s):!1}static async groupEntitiesByType(t,e){var s;const i=new Map;for(const n of e){const r=await t.getProperties(n);if(!r)continue;const o=r.type;i.get(o)||i.set(o,new Set),(s=i.get(o))==null||s.add(n)}return i}}const jh={IFCURIREFERENCE:"IfcUriReference",IFCTIME:"IfcTime",IFCTEMPERATURERATEOFCHANGEMEASURE:"IfcTemperatureRateOfChangeMeasure",IFCSOUNDPRESSURELEVELMEASURE:"IfcSoundPressureLevelMeasure",IFCSOUNDPOWERLEVELMEASURE:"IfcSoundPowerLevelMeasure",IFCPROPERTYSETDEFINITIONSET:"IfcPropertySetDefinitionSet",IFCPOSITIVEINTEGER:"IfcPositiveInteger",IFCNONNEGATIVELENGTHMEASURE:"IfcNonNegativeLengthMeasure",IFCLINEINDEX:"IfcLineIndex",IFCLANGUAGEID:"IfcLanguageId",IFCDURATION:"IfcDuration",IFCDAYINWEEKNUMBER:"IfcDayInWeekNumber",IFCDATETIME:"IfcDateTime",IFCDATE:"IfcDate",IFCCARDINALPOINTREFERENCE:"IfcCardinalPointReference",IFCBINARY:"IfcBinary",IFCAREADENSITYMEASURE:"IfcAreaDensityMeasure",IFCARCINDEX:"IfcArcIndex",IFCYEARNUMBER:"IfcYearNumber",IFCWARPINGMOMENTMEASURE:"IfcWarpingMomentMeasure",IFCWARPINGCONSTANTMEASURE:"IfcWarpingConstantMeasure",IFCVOLUMETRICFLOWRATEMEASURE:"IfcVolumetricFlowRateMeasure",IFCVOLUMEMEASURE:"IfcVolumeMeasure",IFCVAPORPERMEABILITYMEASURE:"IfcVaporPermeabilityMeasure",IFCTORQUEMEASURE:"IfcTorqueMeasure",IFCTIMESTAMP:"IfcTimestamp",IFCTIMEMEASURE:"IfcTimeMeasure",IFCTHERMODYNAMICTEMPERATUREMEASURE:"IfcThermodynamicTemperatureMeasure",IFCTHERMALTRANSMITTANCEMEASURE:"IfcThermalTransmittanceMeasure",IFCTHERMALRESISTANCEMEASURE:"IfcThermalResistanceMeasure",IFCTHERMALEXPANSIONCOEFFICIENTMEASURE:"IfcThermalExpansionCoefficientMeasure",IFCTHERMALCONDUCTIVITYMEASURE:"IfcThermalConductivityMeasure",IFCTHERMALADMITTANCEMEASURE:"IfcThermalAdmittanceMeasure",IFCTEXTTRANSFORMATION:"IfcTextTransformation",IFCTEXTFONTNAME:"IfcTextFontName",IFCTEXTDECORATION:"IfcTextDecoration",IFCTEXTALIGNMENT:"IfcTextAlignment",IFCTEXT:"IfcText",IFCTEMPERATUREGRADIENTMEASURE:"IfcTemperatureGradientMeasure",IFCSPECULARROUGHNESS:"IfcSpecularRoughness",IFCSPECULAREXPONENT:"IfcSpecularExponent",IFCSPECIFICHEATCAPACITYMEASURE:"IfcSpecificHeatCapacityMeasure",IFCSOUNDPRESSUREMEASURE:"IfcSoundPressureMeasure",IFCSOUNDPOWERMEASURE:"IfcSoundPowerMeasure",IFCSOLIDANGLEMEASURE:"IfcSolidAngleMeasure",IFCSHEARMODULUSMEASURE:"IfcShearModulusMeasure",IFCSECTIONALAREAINTEGRALMEASURE:"IfcSectionalAreaIntegralMeasure",IFCSECTIONMODULUSMEASURE:"IfcSectionModulusMeasure",IFCSECONDINMINUTE:"IfcSecondInMinute",IFCROTATIONALSTIFFNESSMEASURE:"IfcRotationalStiffnessMeasure",IFCROTATIONALMASSMEASURE:"IfcRotationalMassMeasure",IFCROTATIONALFREQUENCYMEASURE:"IfcRotationalFrequencyMeasure",IFCREAL:"IfcReal",IFCRATIOMEASURE:"IfcRatioMeasure",IFCRADIOACTIVITYMEASURE:"IfcRadioactivityMeasure",IFCPRESSUREMEASURE:"IfcPressureMeasure",IFCPRESENTABLETEXT:"IfcPresentableText",IFCPOWERMEASURE:"IfcPowerMeasure",IFCPOSITIVERATIOMEASURE:"IfcPositiveRatioMeasure",IFCPOSITIVEPLANEANGLEMEASURE:"IfcPositivePlaneAngleMeasure",IFCPOSITIVELENGTHMEASURE:"IfcPositiveLengthMeasure",IFCPLANEANGLEMEASURE:"IfcPlaneAngleMeasure",IFCPLANARFORCEMEASURE:"IfcPlanarForceMeasure",IFCPARAMETERVALUE:"IfcParameterValue",IFCPHMEASURE:"IfcPhMeasure",IFCNUMERICMEASURE:"IfcNumericMeasure",IFCNORMALISEDRATIOMEASURE:"IfcNormalisedRatioMeasure",IFCMONTHINYEARNUMBER:"IfcMonthInYearNumber",IFCMONETARYMEASURE:"IfcMonetaryMeasure",IFCMOMENTOFINERTIAMEASURE:"IfcMomentOfInertiaMeasure",IFCMOLECULARWEIGHTMEASURE:"IfcMolecularWeightMeasure",IFCMOISTUREDIFFUSIVITYMEASURE:"IfcMoistureDiffusivityMeasure",IFCMODULUSOFSUBGRADEREACTIONMEASURE:"IfcModulusOfSubgradeReactionMeasure",IFCMODULUSOFROTATIONALSUBGRADEREACTIONMEASURE:"IfcModulusOfRotationalSubgradeReactionMeasure",IFCMODULUSOFLINEARSUBGRADEREACTIONMEASURE:"IfcModulusOfLinearSubgradeReactionMeasure",IFCMODULUSOFELASTICITYMEASURE:"IfcModulusOfElasticityMeasure",IFCMINUTEINHOUR:"IfcMinuteInHour",IFCMASSPERLENGTHMEASURE:"IfcMassPerLengthMeasure",IFCMASSMEASURE:"IfcMassMeasure",IFCMASSFLOWRATEMEASURE:"IfcMassFlowRateMeasure",IFCMASSDENSITYMEASURE:"IfcMassDensityMeasure",IFCMAGNETICFLUXMEASURE:"IfcMagneticFluxMeasure",IFCMAGNETICFLUXDENSITYMEASURE:"IfcMagneticFluxDensityMeasure",IFCLUMINOUSINTENSITYMEASURE:"IfcLuminousIntensityMeasure",IFCLUMINOUSINTENSITYDISTRIBUTIONMEASURE:"IfcLuminousIntensityDistributionMeasure",IFCLUMINOUSFLUXMEASURE:"IfcLuminousFluxMeasure",IFCLOGICAL:"IfcLogical",IFCLINEARVELOCITYMEASURE:"IfcLinearVelocityMeasure",IFCLINEARSTIFFNESSMEASURE:"IfcLinearStiffnessMeasure",IFCLINEARMOMENTMEASURE:"IfcLinearMomentMeasure",IFCLINEARFORCEMEASURE:"IfcLinearForceMeasure",IFCLENGTHMEASURE:"IfcLengthMeasure",IFCLABEL:"IfcLabel",IFCKINEMATICVISCOSITYMEASURE:"IfcKinematicViscosityMeasure",IFCISOTHERMALMOISTURECAPACITYMEASURE:"IfcIsothermalMoistureCapacityMeasure",IFCIONCONCENTRATIONMEASURE:"IfcIonConcentrationMeasure",IFCINTEGERCOUNTRATEMEASURE:"IfcIntegerCountRateMeasure",IFCINTEGER:"IfcInteger",IFCINDUCTANCEMEASURE:"IfcInductanceMeasure",IFCILLUMINANCEMEASURE:"IfcIlluminanceMeasure",IFCIDENTIFIER:"IfcIdentifier",IFCHOURINDAY:"IfcHourInDay",IFCHEATINGVALUEMEASURE:"IfcHeatingValueMeasure",IFCHEATFLUXDENSITYMEASURE:"IfcHeatFluxDensityMeasure",IFCGLOBALLYUNIQUEID:"IfcGloballyUniqueId",IFCFREQUENCYMEASURE:"IfcFrequencyMeasure",IFCFORCEMEASURE:"IfcForceMeasure",IFCFONTWEIGHT:"IfcFontWeight",IFCFONTVARIANT:"IfcFontVariant",IFCFONTSTYLE:"IfcFontStyle",IFCENERGYMEASURE:"IfcEnergyMeasure",IFCELECTRICVOLTAGEMEASURE:"IfcElectricVoltageMeasure",IFCELECTRICRESISTANCEMEASURE:"IfcElectricResistanceMeasure",IFCELECTRICCURRENTMEASURE:"IfcElectricCurrentMeasure",IFCELECTRICCONDUCTANCEMEASURE:"IfcElectricConductanceMeasure",IFCELECTRICCHARGEMEASURE:"IfcElectricChargeMeasure",IFCELECTRICCAPACITANCEMEASURE:"IfcElectricCapacitanceMeasure",IFCDYNAMICVISCOSITYMEASURE:"IfcDynamicViscosityMeasure",IFCDOSEEQUIVALENTMEASURE:"IfcDoseEquivalentMeasure",IFCDIMENSIONCOUNT:"IfcDimensionCount",IFCDESCRIPTIVEMEASURE:"IfcDescriptiveMeasure",IFCDAYLIGHTSAVINGHOUR:"IfcDaylightSavingHour",IFCDAYINMONTHNUMBER:"IfcDayInMonthNumber",IFCCURVATUREMEASURE:"IfcCurvatureMeasure",IFCCOUNTMEASURE:"IfcCountMeasure",IFCCONTEXTDEPENDENTMEASURE:"IfcContextDependentMeasure",IFCCOMPOUNDPLANEANGLEMEASURE:"IfcCompoundPlaneAngleMeasure",IFCCOMPLEXNUMBER:"IfcComplexNumber",IFCBOXALIGNMENT:"IfcBoxAlignment",IFCBOOLEAN:"IfcBoolean",IFCAREAMEASURE:"IfcAreaMeasure",IFCANGULARVELOCITYMEASURE:"IfcAngularVelocityMeasure",IFCAMOUNTOFSUBSTANCEMEASURE:"IfcAmountOfSubstanceMeasure",IFCACCELERATIONMEASURE:"IfcAccelerationMeasure",IFCABSORBEDDOSEMEASURE:"IfcAbsorbedDoseMeasure",IFCGEOSLICE:"IfcGeoSlice",IFCGEOMODEL:"IfcGeoModel",IFCELECTRICFLOWTREATMENTDEVICE:"IfcElectricFlowTreatmentDevice",IFCDISTRIBUTIONBOARD:"IfcDistributionBoard",IFCCONVEYORSEGMENT:"IfcConveyorSegment",IFCCAISSONFOUNDATION:"IfcCaissonFoundation",IFCBOREHOLE:"IfcBorehole",IFCBEARING:"IfcBearing",IFCALIGNMENT:"IfcAlignment",IFCTRACKELEMENT:"IfcTrackElement",IFCSIGNAL:"IfcSignal",IFCREINFORCEDSOIL:"IfcReinforcedSoil",IFCRAIL:"IfcRail",IFCPAVEMENT:"IfcPavement",IFCNAVIGATIONELEMENT:"IfcNavigationElement",IFCMOORINGDEVICE:"IfcMooringDevice",IFCMOBILETELECOMMUNICATIONSAPPLIANCE:"IfcMobileTelecommunicationsAppliance",IFCLIQUIDTERMINAL:"IfcLiquidTerminal",IFCLINEARPOSITIONINGELEMENT:"IfcLinearPositioningElement",IFCKERB:"IfcKerb",IFCGEOTECHNICALASSEMBLY:"IfcGeotechnicalAssembly",IFCELECTRICFLOWTREATMENTDEVICETYPE:"IfcElectricFlowTreatmentDeviceType",IFCEARTHWORKSFILL:"IfcEarthworksFill",IFCEARTHWORKSELEMENT:"IfcEarthworksElement",IFCEARTHWORKSCUT:"IfcEarthworksCut",IFCDISTRIBUTIONBOARDTYPE:"IfcDistributionBoardType",IFCDEEPFOUNDATION:"IfcDeepFoundation",IFCCOURSE:"IfcCourse",IFCCONVEYORSEGMENTTYPE:"IfcConveyorSegmentType",IFCCAISSONFOUNDATIONTYPE:"IfcCaissonFoundationType",IFCBUILTSYSTEM:"IfcBuiltSystem",IFCBUILTELEMENT:"IfcBuiltElement",IFCBRIDGEPART:"IfcBridgePart",IFCBRIDGE:"IfcBridge",IFCBEARINGTYPE:"IfcBearingType",IFCALIGNMENTVERTICAL:"IfcAlignmentVertical",IFCALIGNMENTSEGMENT:"IfcAlignmentSegment",IFCALIGNMENTHORIZONTAL:"IfcAlignmentHorizontal",IFCALIGNMENTCANT:"IfcAlignmentCant",IFCVIBRATIONDAMPERTYPE:"IfcVibrationDamperType",IFCVIBRATIONDAMPER:"IfcVibrationDamper",IFCVEHICLE:"IfcVehicle",IFCTRANSPORTATIONDEVICE:"IfcTransportationDevice",IFCTRACKELEMENTTYPE:"IfcTrackElementType",IFCTENDONCONDUITTYPE:"IfcTendonConduitType",IFCTENDONCONDUIT:"IfcTendonConduit",IFCSINESPIRAL:"IfcSineSpiral",IFCSIGNALTYPE:"IfcSignalType",IFCSIGNTYPE:"IfcSignType",IFCSIGN:"IfcSign",IFCSEVENTHORDERPOLYNOMIALSPIRAL:"IfcSeventhOrderPolynomialSpiral",IFCSEGMENTEDREFERENCECURVE:"IfcSegmentedReferenceCurve",IFCSECONDORDERPOLYNOMIALSPIRAL:"IfcSecondOrderPolynomialSpiral",IFCROADPART:"IfcRoadPart",IFCROAD:"IfcRoad",IFCRELADHERESTOELEMENT:"IfcRelAdheresToElement",IFCREFERENT:"IfcReferent",IFCRAILWAYPART:"IfcRailwayPart",IFCRAILWAY:"IfcRailway",IFCRAILTYPE:"IfcRailType",IFCPOSITIONINGELEMENT:"IfcPositioningElement",IFCPAVEMENTTYPE:"IfcPavementType",IFCNAVIGATIONELEMENTTYPE:"IfcNavigationElementType",IFCMOORINGDEVICETYPE:"IfcMooringDeviceType",IFCMOBILETELECOMMUNICATIONSAPPLIANCETYPE:"IfcMobileTelecommunicationsApplianceType",IFCMARINEPART:"IfcMarinePart",IFCMARINEFACILITY:"IfcMarineFacility",IFCLIQUIDTERMINALTYPE:"IfcLiquidTerminalType",IFCLINEARELEMENT:"IfcLinearElement",IFCKERBTYPE:"IfcKerbType",IFCIMPACTPROTECTIONDEVICETYPE:"IfcImpactProtectionDeviceType",IFCIMPACTPROTECTIONDEVICE:"IfcImpactProtectionDevice",IFCGRADIENTCURVE:"IfcGradientCurve",IFCGEOTECHNICALSTRATUM:"IfcGeotechnicalStratum",IFCGEOTECHNICALELEMENT:"IfcGeotechnicalElement",IFCFACILITYPARTCOMMON:"IfcFacilityPartCommon",IFCFACILITYPART:"IfcFacilityPart",IFCFACILITY:"IfcFacility",IFCDIRECTRIXDERIVEDREFERENCESWEPTAREASOLID:"IfcDirectrixDerivedReferenceSweptAreaSolid",IFCDEEPFOUNDATIONTYPE:"IfcDeepFoundationType",IFCCOURSETYPE:"IfcCourseType",IFCCOSINESPIRAL:"IfcCosineSpiral",IFCCLOTHOID:"IfcClothoid",IFCBUILTELEMENTTYPE:"IfcBuiltElementType",IFCVEHICLETYPE:"IfcVehicleType",IFCTRIANGULATEDIRREGULARNETWORK:"IfcTriangulatedIrregularNetwork",IFCTRANSPORTATIONDEVICETYPE:"IfcTransportationDeviceType",IFCTHIRDORDERPOLYNOMIALSPIRAL:"IfcThirdOrderPolynomialSpiral",IFCSPIRAL:"IfcSpiral",IFCSECTIONEDSURFACE:"IfcSectionedSurface",IFCSECTIONEDSOLIDHORIZONTAL:"IfcSectionedSolidHorizontal",IFCSECTIONEDSOLID:"IfcSectionedSolid",IFCRELPOSITIONS:"IfcRelPositions",IFCRELASSOCIATESPROFILEDEF:"IfcRelAssociatesProfileDef",IFCPOLYNOMIALCURVE:"IfcPolynomialCurve",IFCOFFSETCURVEBYDISTANCES:"IfcOffsetCurveByDistances",IFCOFFSETCURVE:"IfcOffsetCurve",IFCINDEXEDPOLYGONALTEXTUREMAP:"IfcIndexedPolygonalTextureMap",IFCDIRECTRIXCURVESWEPTAREASOLID:"IfcDirectrixCurveSweptAreaSolid",IFCCURVESEGMENT:"IfcCurveSegment",IFCAXIS2PLACEMENTLINEAR:"IfcAxis2PlacementLinear",IFCSEGMENT:"IfcSegment",IFCPOINTBYDISTANCEEXPRESSION:"IfcPointByDistanceExpression",IFCOPENCROSSPROFILEDEF:"IfcOpenCrossProfileDef",IFCLINEARPLACEMENT:"IfcLinearPlacement",IFCALIGNMENTHORIZONTALSEGMENT:"IfcAlignmentHorizontalSegment",IFCALIGNMENTCANTSEGMENT:"IfcAlignmentCantSegment",IFCTEXTURECOORDINATEINDICESWITHVOIDS:"IfcTextureCoordinateIndicesWithVoids",IFCTEXTURECOORDINATEINDICES:"IfcTextureCoordinateIndices",IFCQUANTITYNUMBER:"IfcQuantityNumber",IFCALIGNMENTVERTICALSEGMENT:"IfcAlignmentVerticalSegment",IFCALIGNMENTPARAMETERSEGMENT:"IfcAlignmentParameterSegment",IFCCONTROLLER:"IfcController",IFCALARM:"IfcAlarm",IFCACTUATOR:"IfcActuator",IFCUNITARYCONTROLELEMENT:"IfcUnitaryControlElement",IFCSENSOR:"IfcSensor",IFCPROTECTIVEDEVICETRIPPINGUNIT:"IfcProtectiveDeviceTrippingUnit",IFCFLOWINSTRUMENT:"IfcFlowInstrument",IFCFIRESUPPRESSIONTERMINAL:"IfcFireSuppressionTerminal",IFCFILTER:"IfcFilter",IFCFAN:"IfcFan",IFCELECTRICTIMECONTROL:"IfcElectricTimeControl",IFCELECTRICMOTOR:"IfcElectricMotor",IFCELECTRICGENERATOR:"IfcElectricGenerator",IFCELECTRICFLOWSTORAGEDEVICE:"IfcElectricFlowStorageDevice",IFCELECTRICDISTRIBUTIONBOARD:"IfcElectricDistributionBoard",IFCELECTRICAPPLIANCE:"IfcElectricAppliance",IFCDUCTSILENCER:"IfcDuctSilencer",IFCDUCTSEGMENT:"IfcDuctSegment",IFCDUCTFITTING:"IfcDuctFitting",IFCDISTRIBUTIONCIRCUIT:"IfcDistributionCircuit",IFCDAMPER:"IfcDamper",IFCCOOLINGTOWER:"IfcCoolingTower",IFCCOOLEDBEAM:"IfcCooledBeam",IFCCONDENSER:"IfcCondenser",IFCCOMPRESSOR:"IfcCompressor",IFCCOMMUNICATIONSAPPLIANCE:"IfcCommunicationsAppliance",IFCCOIL:"IfcCoil",IFCCHILLER:"IfcChiller",IFCCABLESEGMENT:"IfcCableSegment",IFCCABLEFITTING:"IfcCableFitting",IFCCABLECARRIERSEGMENT:"IfcCableCarrierSegment",IFCCABLECARRIERFITTING:"IfcCableCarrierFitting",IFCBURNER:"IfcBurner",IFCBOILER:"IfcBoiler",IFCBEAMSTANDARDCASE:"IfcBeamStandardCase",IFCAUDIOVISUALAPPLIANCE:"IfcAudioVisualAppliance",IFCAIRTOAIRHEATRECOVERY:"IfcAirToAirHeatRecovery",IFCAIRTERMINALBOX:"IfcAirTerminalBox",IFCAIRTERMINAL:"IfcAirTerminal",IFCWINDOWSTANDARDCASE:"IfcWindowStandardCase",IFCWASTETERMINAL:"IfcWasteTerminal",IFCWALLELEMENTEDCASE:"IfcWallElementedCase",IFCVALVE:"IfcValve",IFCUNITARYEQUIPMENT:"IfcUnitaryEquipment",IFCUNITARYCONTROLELEMENTTYPE:"IfcUnitaryControlElementType",IFCTUBEBUNDLE:"IfcTubeBundle",IFCTRANSFORMER:"IfcTransformer",IFCTANK:"IfcTank",IFCSWITCHINGDEVICE:"IfcSwitchingDevice",IFCSTRUCTURALLOADCASE:"IfcStructuralLoadCase",IFCSTACKTERMINAL:"IfcStackTerminal",IFCSPACEHEATER:"IfcSpaceHeater",IFCSOLARDEVICE:"IfcSolarDevice",IFCSLABSTANDARDCASE:"IfcSlabStandardCase",IFCSLABELEMENTEDCASE:"IfcSlabElementedCase",IFCSHADINGDEVICE:"IfcShadingDevice",IFCSANITARYTERMINAL:"IfcSanitaryTerminal",IFCREINFORCINGBARTYPE:"IfcReinforcingBarType",IFCRATIONALBSPLINECURVEWITHKNOTS:"IfcRationalBSplineCurveWithKnots",IFCPUMP:"IfcPump",IFCPROTECTIVEDEVICETRIPPINGUNITTYPE:"IfcProtectiveDeviceTrippingUnitType",IFCPROTECTIVEDEVICE:"IfcProtectiveDevice",IFCPLATESTANDARDCASE:"IfcPlateStandardCase",IFCPIPESEGMENT:"IfcPipeSegment",IFCPIPEFITTING:"IfcPipeFitting",IFCOUTLET:"IfcOutlet",IFCOUTERBOUNDARYCURVE:"IfcOuterBoundaryCurve",IFCMOTORCONNECTION:"IfcMotorConnection",IFCMEMBERSTANDARDCASE:"IfcMemberStandardCase",IFCMEDICALDEVICE:"IfcMedicalDevice",IFCLIGHTFIXTURE:"IfcLightFixture",IFCLAMP:"IfcLamp",IFCJUNCTIONBOX:"IfcJunctionBox",IFCINTERCEPTOR:"IfcInterceptor",IFCHUMIDIFIER:"IfcHumidifier",IFCHEATEXCHANGER:"IfcHeatExchanger",IFCFLOWMETER:"IfcFlowMeter",IFCEXTERNALSPATIALELEMENT:"IfcExternalSpatialElement",IFCEVAPORATOR:"IfcEvaporator",IFCEVAPORATIVECOOLER:"IfcEvaporativeCooler",IFCENGINE:"IfcEngine",IFCELECTRICDISTRIBUTIONBOARDTYPE:"IfcElectricDistributionBoardType",IFCDOORSTANDARDCASE:"IfcDoorStandardCase",IFCDISTRIBUTIONSYSTEM:"IfcDistributionSystem",IFCCOMMUNICATIONSAPPLIANCETYPE:"IfcCommunicationsApplianceType",IFCCOLUMNSTANDARDCASE:"IfcColumnStandardCase",IFCCIVILELEMENT:"IfcCivilElement",IFCCHIMNEY:"IfcChimney",IFCCABLEFITTINGTYPE:"IfcCableFittingType",IFCBURNERTYPE:"IfcBurnerType",IFCBUILDINGSYSTEM:"IfcBuildingSystem",IFCBUILDINGELEMENTPARTTYPE:"IfcBuildingElementPartType",IFCBOUNDARYCURVE:"IfcBoundaryCurve",IFCBSPLINECURVEWITHKNOTS:"IfcBSplineCurveWithKnots",IFCAUDIOVISUALAPPLIANCETYPE:"IfcAudioVisualApplianceType",IFCWORKCALENDAR:"IfcWorkCalendar",IFCWINDOWTYPE:"IfcWindowType",IFCVOIDINGFEATURE:"IfcVoidingFeature",IFCVIBRATIONISOLATOR:"IfcVibrationIsolator",IFCTENDONTYPE:"IfcTendonType",IFCTENDONANCHORTYPE:"IfcTendonAnchorType",IFCSYSTEMFURNITUREELEMENT:"IfcSystemFurnitureElement",IFCSURFACEFEATURE:"IfcSurfaceFeature",IFCSTRUCTURALSURFACEACTION:"IfcStructuralSurfaceAction",IFCSTRUCTURALCURVEREACTION:"IfcStructuralCurveReaction",IFCSTRUCTURALCURVEACTION:"IfcStructuralCurveAction",IFCSTAIRTYPE:"IfcStairType",IFCSOLARDEVICETYPE:"IfcSolarDeviceType",IFCSHADINGDEVICETYPE:"IfcShadingDeviceType",IFCSEAMCURVE:"IfcSeamCurve",IFCROOFTYPE:"IfcRoofType",IFCREINFORCINGMESHTYPE:"IfcReinforcingMeshType",IFCREINFORCINGELEMENTTYPE:"IfcReinforcingElementType",IFCRATIONALBSPLINESURFACEWITHKNOTS:"IfcRationalBSplineSurfaceWithKnots",IFCRAMPTYPE:"IfcRampType",IFCPOLYGONALFACESET:"IfcPolygonalFaceSet",IFCPILETYPE:"IfcPileType",IFCOPENINGSTANDARDCASE:"IfcOpeningStandardCase",IFCMEDICALDEVICETYPE:"IfcMedicalDeviceType",IFCINTERSECTIONCURVE:"IfcIntersectionCurve",IFCINTERCEPTORTYPE:"IfcInterceptorType",IFCINDEXEDPOLYCURVE:"IfcIndexedPolyCurve",IFCGEOGRAPHICELEMENT:"IfcGeographicElement",IFCFURNITURE:"IfcFurniture",IFCFOOTINGTYPE:"IfcFootingType",IFCEXTERNALSPATIALSTRUCTUREELEMENT:"IfcExternalSpatialStructureElement",IFCEVENT:"IfcEvent",IFCENGINETYPE:"IfcEngineType",IFCELEMENTASSEMBLYTYPE:"IfcElementAssemblyType",IFCDOORTYPE:"IfcDoorType",IFCCYLINDRICALSURFACE:"IfcCylindricalSurface",IFCCONSTRUCTIONPRODUCTRESOURCETYPE:"IfcConstructionProductResourceType",IFCCONSTRUCTIONMATERIALRESOURCETYPE:"IfcConstructionMaterialResourceType",IFCCONSTRUCTIONEQUIPMENTRESOURCETYPE:"IfcConstructionEquipmentResourceType",IFCCOMPOSITECURVEONSURFACE:"IfcCompositeCurveOnSurface",IFCCOMPLEXPROPERTYTEMPLATE:"IfcComplexPropertyTemplate",IFCCIVILELEMENTTYPE:"IfcCivilElementType",IFCCHIMNEYTYPE:"IfcChimneyType",IFCBSPLINESURFACEWITHKNOTS:"IfcBSplineSurfaceWithKnots",IFCBSPLINESURFACE:"IfcBSplineSurface",IFCADVANCEDBREPWITHVOIDS:"IfcAdvancedBrepWithVoids",IFCADVANCEDBREP:"IfcAdvancedBrep",IFCTRIANGULATEDFACESET:"IfcTriangulatedFaceSet",IFCTOROIDALSURFACE:"IfcToroidalSurface",IFCTESSELLATEDFACESET:"IfcTessellatedFaceSet",IFCTASKTYPE:"IfcTaskType",IFCSURFACECURVE:"IfcSurfaceCurve",IFCSUBCONTRACTRESOURCETYPE:"IfcSubContractResourceType",IFCSTRUCTURALSURFACEREACTION:"IfcStructuralSurfaceReaction",IFCSPHERICALSURFACE:"IfcSphericalSurface",IFCSPATIALZONETYPE:"IfcSpatialZoneType",IFCSPATIALZONE:"IfcSpatialZone",IFCSPATIALELEMENTTYPE:"IfcSpatialElementType",IFCSPATIALELEMENT:"IfcSpatialElement",IFCSIMPLEPROPERTYTEMPLATE:"IfcSimplePropertyTemplate",IFCREVOLVEDAREASOLIDTAPERED:"IfcRevolvedAreaSolidTapered",IFCREPARAMETRISEDCOMPOSITECURVESEGMENT:"IfcReparametrisedCompositeCurveSegment",IFCRELSPACEBOUNDARY2NDLEVEL:"IfcRelSpaceBoundary2ndLevel",IFCRELSPACEBOUNDARY1STLEVEL:"IfcRelSpaceBoundary1stLevel",IFCRELINTERFERESELEMENTS:"IfcRelInterferesElements",IFCRELDEFINESBYTEMPLATE:"IfcRelDefinesByTemplate",IFCRELDEFINESBYOBJECT:"IfcRelDefinesByObject",IFCRELDECLARES:"IfcRelDeclares",IFCRELASSIGNSTOGROUPBYFACTOR:"IfcRelAssignsToGroupByFactor",IFCPROPERTYTEMPLATE:"IfcPropertyTemplate",IFCPROPERTYSETTEMPLATE:"IfcPropertySetTemplate",IFCPROJECTLIBRARY:"IfcProjectLibrary",IFCPROCEDURETYPE:"IfcProcedureType",IFCPREDEFINEDPROPERTYSET:"IfcPredefinedPropertySet",IFCPCURVE:"IfcPCurve",IFCLABORRESOURCETYPE:"IfcLaborResourceType",IFCINDEXEDPOLYGONALFACEWITHVOIDS:"IfcIndexedPolygonalFaceWithVoids",IFCINDEXEDPOLYGONALFACE:"IfcIndexedPolygonalFace",IFCGEOGRAPHICELEMENTTYPE:"IfcGeographicElementType",IFCFIXEDREFERENCESWEPTAREASOLID:"IfcFixedReferenceSweptAreaSolid",IFCEXTRUDEDAREASOLIDTAPERED:"IfcExtrudedAreaSolidTapered",IFCEVENTTYPE:"IfcEventType",IFCCURVEBOUNDEDSURFACE:"IfcCurveBoundedSurface",IFCCREWRESOURCETYPE:"IfcCrewResourceType",IFCCONTEXT:"IfcContext",IFCCONSTRUCTIONRESOURCETYPE:"IfcConstructionResourceType",IFCCARTESIANPOINTLIST3D:"IfcCartesianPointList3D",IFCCARTESIANPOINTLIST2D:"IfcCartesianPointList2D",IFCCARTESIANPOINTLIST:"IfcCartesianPointList",IFCADVANCEDFACE:"IfcAdvancedFace",IFCTYPERESOURCE:"IfcTypeResource",IFCTYPEPROCESS:"IfcTypeProcess",IFCTESSELLATEDITEM:"IfcTessellatedItem",IFCSWEPTDISKSOLIDPOLYGONAL:"IfcSweptDiskSolidPolygonal",IFCRESOURCETIME:"IfcResourceTime",IFCRESOURCECONSTRAINTRELATIONSHIP:"IfcResourceConstraintRelationship",IFCRESOURCEAPPROVALRELATIONSHIP:"IfcResourceApprovalRelationship",IFCQUANTITYSET:"IfcQuantitySet",IFCPROPERTYTEMPLATEDEFINITION:"IfcPropertyTemplateDefinition",IFCPREDEFINEDPROPERTIES:"IfcPredefinedProperties",IFCMIRROREDPROFILEDEF:"IfcMirroredProfileDef",IFCMATERIALRELATIONSHIP:"IfcMaterialRelationship",IFCMATERIALPROFILESETUSAGETAPERING:"IfcMaterialProfileSetUsageTapering",IFCMATERIALPROFILESETUSAGE:"IfcMaterialProfileSetUsage",IFCMATERIALCONSTITUENTSET:"IfcMaterialConstituentSet",IFCMATERIALCONSTITUENT:"IfcMaterialConstituent",IFCLAGTIME:"IfcLagTime",IFCINDEXEDTRIANGLETEXTUREMAP:"IfcIndexedTriangleTextureMap",IFCINDEXEDTEXTUREMAP:"IfcIndexedTextureMap",IFCINDEXEDCOLOURMAP:"IfcIndexedColourMap",IFCEXTERNALREFERENCERELATIONSHIP:"IfcExternalReferenceRelationship",IFCEXTENDEDPROPERTIES:"IfcExtendedProperties",IFCEVENTTIME:"IfcEventTime",IFCCONVERSIONBASEDUNITWITHOFFSET:"IfcConversionBasedUnitWithOffset",IFCCOLOURRGBLIST:"IfcColourRgbList",IFCWORKTIME:"IfcWorkTime",IFCTIMEPERIOD:"IfcTimePeriod",IFCTEXTUREVERTEXLIST:"IfcTextureVertexList",IFCTASKTIMERECURRING:"IfcTaskTimeRecurring",IFCTASKTIME:"IfcTaskTime",IFCTABLECOLUMN:"IfcTableColumn",IFCSURFACEREINFORCEMENTAREA:"IfcSurfaceReinforcementArea",IFCSTRUCTURALLOADORRESULT:"IfcStructuralLoadOrResult",IFCSTRUCTURALLOADCONFIGURATION:"IfcStructuralLoadConfiguration",IFCSCHEDULINGTIME:"IfcSchedulingTime",IFCRESOURCELEVELRELATIONSHIP:"IfcResourceLevelRelationship",IFCREFERENCE:"IfcReference",IFCRECURRENCEPATTERN:"IfcRecurrencePattern",IFCPROPERTYABSTRACTION:"IfcPropertyAbstraction",IFCPROJECTEDCRS:"IfcProjectedCrs",IFCPRESENTATIONITEM:"IfcPresentationItem",IFCMATERIALUSAGEDEFINITION:"IfcMaterialUsageDefinition",IFCMATERIALPROFILEWITHOFFSETS:"IfcMaterialProfileWithOffsets",IFCMATERIALPROFILESET:"IfcMaterialProfileSet",IFCMATERIALPROFILE:"IfcMaterialProfile",IFCMATERIALLAYERWITHOFFSETS:"IfcMaterialLayerWithOffsets",IFCMATERIALDEFINITION:"IfcMaterialDefinition",IFCMAPCONVERSION:"IfcMapConversion",IFCEXTERNALINFORMATION:"IfcExternalInformation",IFCCOORDINATEREFERENCESYSTEM:"IfcCoordinateReferenceSystem",IFCCOORDINATEOPERATION:"IfcCoordinateOperation",IFCCONNECTIONVOLUMEGEOMETRY:"IfcConnectionVolumeGeometry",IFCREINFORCINGBAR:"IfcReinforcingBar",IFCELECTRICDISTRIBUTIONPOINT:"IfcElectricDistributionPoint",IFCDISTRIBUTIONCONTROLELEMENT:"IfcDistributionControlElement",IFCDISTRIBUTIONCHAMBERELEMENT:"IfcDistributionChamberElement",IFCCONTROLLERTYPE:"IfcControllerType",IFCCHAMFEREDGEFEATURE:"IfcChamferEdgeFeature",IFCBEAM:"IfcBeam",IFCALARMTYPE:"IfcAlarmType",IFCACTUATORTYPE:"IfcActuatorType",IFCWINDOW:"IfcWindow",IFCWALLSTANDARDCASE:"IfcWallStandardCase",IFCWALL:"IfcWall",IFCVIBRATIONISOLATORTYPE:"IfcVibrationIsolatorType",IFCTENDONANCHOR:"IfcTendonAnchor",IFCTENDON:"IfcTendon",IFCSTRUCTURALANALYSISMODEL:"IfcStructuralAnalysisModel",IFCSTAIRFLIGHT:"IfcStairFlight",IFCSTAIR:"IfcStair",IFCSLAB:"IfcSlab",IFCSENSORTYPE:"IfcSensorType",IFCROUNDEDEDGEFEATURE:"IfcRoundedEdgeFeature",IFCROOF:"IfcRoof",IFCREINFORCINGMESH:"IfcReinforcingMesh",IFCREINFORCINGELEMENT:"IfcReinforcingElement",IFCRATIONALBEZIERCURVE:"IfcRationalBezierCurve",IFCRAMPFLIGHT:"IfcRampFlight",IFCRAMP:"IfcRamp",IFCRAILING:"IfcRailing",IFCPLATE:"IfcPlate",IFCPILE:"IfcPile",IFCMEMBER:"IfcMember",IFCFOOTING:"IfcFooting",IFCFLOWTREATMENTDEVICE:"IfcFlowTreatmentDevice",IFCFLOWTERMINAL:"IfcFlowTerminal",IFCFLOWSTORAGEDEVICE:"IfcFlowStorageDevice",IFCFLOWSEGMENT:"IfcFlowSegment",IFCFLOWMOVINGDEVICE:"IfcFlowMovingDevice",IFCFLOWINSTRUMENTTYPE:"IfcFlowInstrumentType",IFCFLOWFITTING:"IfcFlowFitting",IFCFLOWCONTROLLER:"IfcFlowController",IFCFIRESUPPRESSIONTERMINALTYPE:"IfcFireSuppressionTerminalType",IFCFILTERTYPE:"IfcFilterType",IFCFANTYPE:"IfcFanType",IFCENERGYCONVERSIONDEVICE:"IfcEnergyConversionDevice",IFCELECTRICALELEMENT:"IfcElectricalElement",IFCELECTRICALCIRCUIT:"IfcElectricalCircuit",IFCELECTRICTIMECONTROLTYPE:"IfcElectricTimeControlType",IFCELECTRICMOTORTYPE:"IfcElectricMotorType",IFCELECTRICHEATERTYPE:"IfcElectricHeaterType",IFCELECTRICGENERATORTYPE:"IfcElectricGeneratorType",IFCELECTRICFLOWSTORAGEDEVICETYPE:"IfcElectricFlowStorageDeviceType",IFCELECTRICAPPLIANCETYPE:"IfcElectricApplianceType",IFCEDGEFEATURE:"IfcEdgeFeature",IFCDUCTSILENCERTYPE:"IfcDuctSilencerType",IFCDUCTSEGMENTTYPE:"IfcDuctSegmentType",IFCDUCTFITTINGTYPE:"IfcDuctFittingType",IFCDOOR:"IfcDoor",IFCDISTRIBUTIONPORT:"IfcDistributionPort",IFCDISTRIBUTIONFLOWELEMENT:"IfcDistributionFlowElement",IFCDISTRIBUTIONELEMENT:"IfcDistributionElement",IFCDISTRIBUTIONCONTROLELEMENTTYPE:"IfcDistributionControlElementType",IFCDISTRIBUTIONCHAMBERELEMENTTYPE:"IfcDistributionChamberElementType",IFCDISCRETEACCESSORYTYPE:"IfcDiscreteAccessoryType",IFCDISCRETEACCESSORY:"IfcDiscreteAccessory",IFCDIAMETERDIMENSION:"IfcDiameterDimension",IFCDAMPERTYPE:"IfcDamperType",IFCCURTAINWALL:"IfcCurtainWall",IFCCOVERING:"IfcCovering",IFCCOOLINGTOWERTYPE:"IfcCoolingTowerType",IFCCOOLEDBEAMTYPE:"IfcCooledBeamType",IFCCONSTRUCTIONPRODUCTRESOURCE:"IfcConstructionProductResource",IFCCONSTRUCTIONMATERIALRESOURCE:"IfcConstructionMaterialResource",IFCCONSTRUCTIONEQUIPMENTRESOURCE:"IfcConstructionEquipmentResource",IFCCONDITIONCRITERION:"IfcConditionCriterion",IFCCONDITION:"IfcCondition",IFCCONDENSERTYPE:"IfcCondenserType",IFCCOMPRESSORTYPE:"IfcCompressorType",IFCCOLUMN:"IfcColumn",IFCCOILTYPE:"IfcCoilType",IFCCIRCLE:"IfcCircle",IFCCHILLERTYPE:"IfcChillerType",IFCCABLESEGMENTTYPE:"IfcCableSegmentType",IFCCABLECARRIERSEGMENTTYPE:"IfcCableCarrierSegmentType",IFCCABLECARRIERFITTINGTYPE:"IfcCableCarrierFittingType",IFCBUILDINGELEMENTPROXYTYPE:"IfcBuildingElementProxyType",IFCBUILDINGELEMENTPROXY:"IfcBuildingElementProxy",IFCBUILDINGELEMENTPART:"IfcBuildingElementPart",IFCBUILDINGELEMENTCOMPONENT:"IfcBuildingElementComponent",IFCBUILDINGELEMENT:"IfcBuildingElement",IFCBOILERTYPE:"IfcBoilerType",IFCBEZIERCURVE:"IfcBezierCurve",IFCBEAMTYPE:"IfcBeamType",IFCBSPLINECURVE:"IfcBSplineCurve",IFCASSET:"IfcAsset",IFCANGULARDIMENSION:"IfcAngularDimension",IFCAIRTOAIRHEATRECOVERYTYPE:"IfcAirToAirHeatRecoveryType",IFCAIRTERMINALTYPE:"IfcAirTerminalType",IFCAIRTERMINALBOXTYPE:"IfcAirTerminalBoxType",IFCACTIONREQUEST:"IfcActionRequest",IFC2DCOMPOSITECURVE:"Ifc2DCompositeCurve",IFCZONE:"IfcZone",IFCWORKSCHEDULE:"IfcWorkSchedule",IFCWORKPLAN:"IfcWorkPlan",IFCWORKCONTROL:"IfcWorkControl",IFCWASTETERMINALTYPE:"IfcWasteTerminalType",IFCWALLTYPE:"IfcWallType",IFCVIRTUALELEMENT:"IfcVirtualElement",IFCVALVETYPE:"IfcValveType",IFCUNITARYEQUIPMENTTYPE:"IfcUnitaryEquipmentType",IFCTUBEBUNDLETYPE:"IfcTubeBundleType",IFCTRIMMEDCURVE:"IfcTrimmedCurve",IFCTRANSPORTELEMENT:"IfcTransportElement",IFCTRANSFORMERTYPE:"IfcTransformerType",IFCTIMESERIESSCHEDULE:"IfcTimeSeriesSchedule",IFCTANKTYPE:"IfcTankType",IFCSYSTEM:"IfcSystem",IFCSWITCHINGDEVICETYPE:"IfcSwitchingDeviceType",IFCSUBCONTRACTRESOURCE:"IfcSubContractResource",IFCSTRUCTURALSURFACECONNECTION:"IfcStructuralSurfaceConnection",IFCSTRUCTURALRESULTGROUP:"IfcStructuralResultGroup",IFCSTRUCTURALPOINTREACTION:"IfcStructuralPointReaction",IFCSTRUCTURALPOINTCONNECTION:"IfcStructuralPointConnection",IFCSTRUCTURALPOINTACTION:"IfcStructuralPointAction",IFCSTRUCTURALPLANARACTIONVARYING:"IfcStructuralPlanarActionVarying",IFCSTRUCTURALPLANARACTION:"IfcStructuralPlanarAction",IFCSTRUCTURALLOADGROUP:"IfcStructuralLoadGroup",IFCSTRUCTURALLINEARACTIONVARYING:"IfcStructuralLinearActionVarying",IFCSTRUCTURALLINEARACTION:"IfcStructuralLinearAction",IFCSTRUCTURALCURVEMEMBERVARYING:"IfcStructuralCurveMemberVarying",IFCSTRUCTURALCURVEMEMBER:"IfcStructuralCurveMember",IFCSTRUCTURALCURVECONNECTION:"IfcStructuralCurveConnection",IFCSTRUCTURALCONNECTION:"IfcStructuralConnection",IFCSTRUCTURALACTION:"IfcStructuralAction",IFCSTAIRFLIGHTTYPE:"IfcStairFlightType",IFCSTACKTERMINALTYPE:"IfcStackTerminalType",IFCSPACETYPE:"IfcSpaceType",IFCSPACEPROGRAM:"IfcSpaceProgram",IFCSPACEHEATERTYPE:"IfcSpaceHeaterType",IFCSPACE:"IfcSpace",IFCSLABTYPE:"IfcSlabType",IFCSITE:"IfcSite",IFCSERVICELIFE:"IfcServiceLife",IFCSCHEDULETIMECONTROL:"IfcScheduleTimeControl",IFCSANITARYTERMINALTYPE:"IfcSanitaryTerminalType",IFCRELASSIGNSTASKS:"IfcRelAssignsTasks",IFCRELAGGREGATES:"IfcRelAggregates",IFCRAMPFLIGHTTYPE:"IfcRampFlightType",IFCRAILINGTYPE:"IfcRailingType",IFCRADIUSDIMENSION:"IfcRadiusDimension",IFCPUMPTYPE:"IfcPumpType",IFCPROTECTIVEDEVICETYPE:"IfcProtectiveDeviceType",IFCPROJECTIONELEMENT:"IfcProjectionElement",IFCPROJECTORDERRECORD:"IfcProjectOrderRecord",IFCPROJECTORDER:"IfcProjectOrder",IFCPROCEDURE:"IfcProcedure",IFCPORT:"IfcPort",IFCPOLYLINE:"IfcPolyline",IFCPLATETYPE:"IfcPlateType",IFCPIPESEGMENTTYPE:"IfcPipeSegmentType",IFCPIPEFITTINGTYPE:"IfcPipeFittingType",IFCPERMIT:"IfcPermit",IFCPERFORMANCEHISTORY:"IfcPerformanceHistory",IFCOUTLETTYPE:"IfcOutletType",IFCORDERACTION:"IfcOrderAction",IFCOPENINGELEMENT:"IfcOpeningElement",IFCOCCUPANT:"IfcOccupant",IFCMOVE:"IfcMove",IFCMOTORCONNECTIONTYPE:"IfcMotorConnectionType",IFCMEMBERTYPE:"IfcMemberType",IFCMECHANICALFASTENERTYPE:"IfcMechanicalFastenerType",IFCMECHANICALFASTENER:"IfcMechanicalFastener",IFCLINEARDIMENSION:"IfcLinearDimension",IFCLIGHTFIXTURETYPE:"IfcLightFixtureType",IFCLAMPTYPE:"IfcLampType",IFCLABORRESOURCE:"IfcLaborResource",IFCJUNCTIONBOXTYPE:"IfcJunctionBoxType",IFCINVENTORY:"IfcInventory",IFCHUMIDIFIERTYPE:"IfcHumidifierType",IFCHEATEXCHANGERTYPE:"IfcHeatExchangerType",IFCGROUP:"IfcGroup",IFCGRID:"IfcGrid",IFCGASTERMINALTYPE:"IfcGasTerminalType",IFCFURNITURESTANDARD:"IfcFurnitureStandard",IFCFURNISHINGELEMENT:"IfcFurnishingElement",IFCFLOWTREATMENTDEVICETYPE:"IfcFlowTreatmentDeviceType",IFCFLOWTERMINALTYPE:"IfcFlowTerminalType",IFCFLOWSTORAGEDEVICETYPE:"IfcFlowStorageDeviceType",IFCFLOWSEGMENTTYPE:"IfcFlowSegmentType",IFCFLOWMOVINGDEVICETYPE:"IfcFlowMovingDeviceType",IFCFLOWMETERTYPE:"IfcFlowMeterType",IFCFLOWFITTINGTYPE:"IfcFlowFittingType",IFCFLOWCONTROLLERTYPE:"IfcFlowControllerType",IFCFEATUREELEMENTSUBTRACTION:"IfcFeatureElementSubtraction",IFCFEATUREELEMENTADDITION:"IfcFeatureElementAddition",IFCFEATUREELEMENT:"IfcFeatureElement",IFCFASTENERTYPE:"IfcFastenerType",IFCFASTENER:"IfcFastener",IFCFACETEDBREPWITHVOIDS:"IfcFacetedBrepWithVoids",IFCFACETEDBREP:"IfcFacetedBrep",IFCEVAPORATORTYPE:"IfcEvaporatorType",IFCEVAPORATIVECOOLERTYPE:"IfcEvaporativeCoolerType",IFCEQUIPMENTSTANDARD:"IfcEquipmentStandard",IFCEQUIPMENTELEMENT:"IfcEquipmentElement",IFCENERGYCONVERSIONDEVICETYPE:"IfcEnergyConversionDeviceType",IFCELLIPSE:"IfcEllipse",IFCELEMENTCOMPONENTTYPE:"IfcElementComponentType",IFCELEMENTCOMPONENT:"IfcElementComponent",IFCELEMENTASSEMBLY:"IfcElementAssembly",IFCELEMENT:"IfcElement",IFCELECTRICALBASEPROPERTIES:"IfcElectricalBaseProperties",IFCDISTRIBUTIONFLOWELEMENTTYPE:"IfcDistributionFlowElementType",IFCDISTRIBUTIONELEMENTTYPE:"IfcDistributionElementType",IFCDIMENSIONCURVEDIRECTEDCALLOUT:"IfcDimensionCurveDirectedCallout",IFCCURTAINWALLTYPE:"IfcCurtainWallType",IFCCREWRESOURCE:"IfcCrewResource",IFCCOVERINGTYPE:"IfcCoveringType",IFCCOSTSCHEDULE:"IfcCostSchedule",IFCCOSTITEM:"IfcCostItem",IFCCONTROL:"IfcControl",IFCCONSTRUCTIONRESOURCE:"IfcConstructionResource",IFCCONIC:"IfcConic",IFCCOMPOSITECURVE:"IfcCompositeCurve",IFCCOLUMNTYPE:"IfcColumnType",IFCCIRCLEHOLLOWPROFILEDEF:"IfcCircleHollowProfileDef",IFCBUILDINGSTOREY:"IfcBuildingStorey",IFCBUILDINGELEMENTTYPE:"IfcBuildingElementType",IFCBUILDING:"IfcBuilding",IFCBOUNDEDCURVE:"IfcBoundedCurve",IFCBOOLEANCLIPPINGRESULT:"IfcBooleanClippingResult",IFCBLOCK:"IfcBlock",IFCASYMMETRICISHAPEPROFILEDEF:"IfcAsymmetricIShapeProfileDef",IFCANNOTATION:"IfcAnnotation",IFCACTOR:"IfcActor",IFCTRANSPORTELEMENTTYPE:"IfcTransportElementType",IFCTASK:"IfcTask",IFCSYSTEMFURNITUREELEMENTTYPE:"IfcSystemFurnitureElementType",IFCSURFACEOFREVOLUTION:"IfcSurfaceOfRevolution",IFCSURFACEOFLINEAREXTRUSION:"IfcSurfaceOfLinearExtrusion",IFCSURFACECURVESWEPTAREASOLID:"IfcSurfaceCurveSweptAreaSolid",IFCSTRUCTUREDDIMENSIONCALLOUT:"IfcStructuredDimensionCallout",IFCSTRUCTURALSURFACEMEMBERVARYING:"IfcStructuralSurfaceMemberVarying",IFCSTRUCTURALSURFACEMEMBER:"IfcStructuralSurfaceMember",IFCSTRUCTURALREACTION:"IfcStructuralReaction",IFCSTRUCTURALMEMBER:"IfcStructuralMember",IFCSTRUCTURALITEM:"IfcStructuralItem",IFCSTRUCTURALACTIVITY:"IfcStructuralActivity",IFCSPHERE:"IfcSphere",IFCSPATIALSTRUCTUREELEMENTTYPE:"IfcSpatialStructureElementType",IFCSPATIALSTRUCTUREELEMENT:"IfcSpatialStructureElement",IFCRIGHTCIRCULARCYLINDER:"IfcRightCircularCylinder",IFCRIGHTCIRCULARCONE:"IfcRightCircularCone",IFCREVOLVEDAREASOLID:"IfcRevolvedAreaSolid",IFCRESOURCE:"IfcResource",IFCRELVOIDSELEMENT:"IfcRelVoidsElement",IFCRELSPACEBOUNDARY:"IfcRelSpaceBoundary",IFCRELSERVICESBUILDINGS:"IfcRelServicesBuildings",IFCRELSEQUENCE:"IfcRelSequence",IFCRELSCHEDULESCOSTITEMS:"IfcRelSchedulesCostItems",IFCRELREFERENCEDINSPATIALSTRUCTURE:"IfcRelReferencedInSpatialStructure",IFCRELPROJECTSELEMENT:"IfcRelProjectsElement",IFCRELOVERRIDESPROPERTIES:"IfcRelOverridesProperties",IFCRELOCCUPIESSPACES:"IfcRelOccupiesSpaces",IFCRELNESTS:"IfcRelNests",IFCRELINTERACTIONREQUIREMENTS:"IfcRelInteractionRequirements",IFCRELFLOWCONTROLELEMENTS:"IfcRelFlowControlElements",IFCRELFILLSELEMENT:"IfcRelFillsElement",IFCRELDEFINESBYTYPE:"IfcRelDefinesByType",IFCRELDEFINESBYPROPERTIES:"IfcRelDefinesByProperties",IFCRELDEFINES:"IfcRelDefines",IFCRELDECOMPOSES:"IfcRelDecomposes",IFCRELCOVERSSPACES:"IfcRelCoversSpaces",IFCRELCOVERSBLDGELEMENTS:"IfcRelCoversBldgElements",IFCRELCONTAINEDINSPATIALSTRUCTURE:"IfcRelContainedInSpatialStructure",IFCRELCONNECTSWITHREALIZINGELEMENTS:"IfcRelConnectsWithRealizingElements",IFCRELCONNECTSWITHECCENTRICITY:"IfcRelConnectsWithEccentricity",IFCRELCONNECTSSTRUCTURALMEMBER:"IfcRelConnectsStructuralMember",IFCRELCONNECTSSTRUCTURALELEMENT:"IfcRelConnectsStructuralElement",IFCRELCONNECTSSTRUCTURALACTIVITY:"IfcRelConnectsStructuralActivity",IFCRELCONNECTSPORTS:"IfcRelConnectsPorts",IFCRELCONNECTSPORTTOELEMENT:"IfcRelConnectsPortToElement",IFCRELCONNECTSPATHELEMENTS:"IfcRelConnectsPathElements",IFCRELCONNECTSELEMENTS:"IfcRelConnectsElements",IFCRELCONNECTS:"IfcRelConnects",IFCRELASSOCIATESPROFILEPROPERTIES:"IfcRelAssociatesProfileProperties",IFCRELASSOCIATESMATERIAL:"IfcRelAssociatesMaterial",IFCRELASSOCIATESLIBRARY:"IfcRelAssociatesLibrary",IFCRELASSOCIATESDOCUMENT:"IfcRelAssociatesDocument",IFCRELASSOCIATESCONSTRAINT:"IfcRelAssociatesConstraint",IFCRELASSOCIATESCLASSIFICATION:"IfcRelAssociatesClassification",IFCRELASSOCIATESAPPROVAL:"IfcRelAssociatesApproval",IFCRELASSOCIATESAPPLIEDVALUE:"IfcRelAssociatesAppliedValue",IFCRELASSOCIATES:"IfcRelAssociates",IFCRELASSIGNSTORESOURCE:"IfcRelAssignsToResource",IFCRELASSIGNSTOPROJECTORDER:"IfcRelAssignsToProjectOrder",IFCRELASSIGNSTOPRODUCT:"IfcRelAssignsToProduct",IFCRELASSIGNSTOPROCESS:"IfcRelAssignsToProcess",IFCRELASSIGNSTOGROUP:"IfcRelAssignsToGroup",IFCRELASSIGNSTOCONTROL:"IfcRelAssignsToControl",IFCRELASSIGNSTOACTOR:"IfcRelAssignsToActor",IFCRELASSIGNS:"IfcRelAssigns",IFCRECTANGULARTRIMMEDSURFACE:"IfcRectangularTrimmedSurface",IFCRECTANGULARPYRAMID:"IfcRectangularPyramid",IFCRECTANGLEHOLLOWPROFILEDEF:"IfcRectangleHollowProfileDef",IFCPROXY:"IfcProxy",IFCPROPERTYSET:"IfcPropertySet",IFCPROJECTIONCURVE:"IfcProjectionCurve",IFCPROJECT:"IfcProject",IFCPRODUCT:"IfcProduct",IFCPROCESS:"IfcProcess",IFCPLANE:"IfcPlane",IFCPLANARBOX:"IfcPlanarBox",IFCPERMEABLECOVERINGPROPERTIES:"IfcPermeableCoveringProperties",IFCOFFSETCURVE3D:"IfcOffsetCurve3D",IFCOFFSETCURVE2D:"IfcOffsetCurve2D",IFCOBJECT:"IfcObject",IFCMANIFOLDSOLIDBREP:"IfcManifoldSolidBrep",IFCLINE:"IfcLine",IFCLSHAPEPROFILEDEF:"IfcLShapeProfileDef",IFCISHAPEPROFILEDEF:"IfcIShapeProfileDef",IFCGEOMETRICCURVESET:"IfcGeometricCurveSet",IFCFURNITURETYPE:"IfcFurnitureType",IFCFURNISHINGELEMENTTYPE:"IfcFurnishingElementType",IFCFLUIDFLOWPROPERTIES:"IfcFluidFlowProperties",IFCFILLAREASTYLETILES:"IfcFillAreaStyleTiles",IFCFILLAREASTYLETILESYMBOLWITHSTYLE:"IfcFillAreaStyleTileSymbolWithStyle",IFCFILLAREASTYLEHATCHING:"IfcFillAreaStyleHatching",IFCFACEBASEDSURFACEMODEL:"IfcFaceBasedSurfaceModel",IFCEXTRUDEDAREASOLID:"IfcExtrudedAreaSolid",IFCENERGYPROPERTIES:"IfcEnergyProperties",IFCELLIPSEPROFILEDEF:"IfcEllipseProfileDef",IFCELEMENTARYSURFACE:"IfcElementarySurface",IFCELEMENTTYPE:"IfcElementType",IFCELEMENTQUANTITY:"IfcElementQuantity",IFCEDGELOOP:"IfcEdgeLoop",IFCDRAUGHTINGPREDEFINEDCURVEFONT:"IfcDraughtingPredefinedCurveFont",IFCDRAUGHTINGPREDEFINEDCOLOUR:"IfcDraughtingPredefinedColour",IFCDRAUGHTINGCALLOUT:"IfcDraughtingCallout",IFCDOORSTYLE:"IfcDoorStyle",IFCDOORPANELPROPERTIES:"IfcDoorPanelProperties",IFCDOORLININGPROPERTIES:"IfcDoorLiningProperties",IFCDIRECTION:"IfcDirection",IFCDIMENSIONCURVETERMINATOR:"IfcDimensionCurveTerminator",IFCDIMENSIONCURVE:"IfcDimensionCurve",IFCDEFINEDSYMBOL:"IfcDefinedSymbol",IFCCURVEBOUNDEDPLANE:"IfcCurveBoundedPlane",IFCCURVE:"IfcCurve",IFCCSGSOLID:"IfcCsgSolid",IFCCSGPRIMITIVE3D:"IfcCsgPrimitive3D",IFCCRANERAILFSHAPEPROFILEDEF:"IfcCraneRailFShapeProfileDef",IFCCRANERAILASHAPEPROFILEDEF:"IfcCraneRailAShapeProfileDef",IFCCOMPOSITECURVESEGMENT:"IfcCompositeCurveSegment",IFCCLOSEDSHELL:"IfcClosedShell",IFCCIRCLEPROFILEDEF:"IfcCircleProfileDef",IFCCARTESIANTRANSFORMATIONOPERATOR3DNONUNIFORM:"IfcCartesianTransformationOperator3DNonUniform",IFCCARTESIANTRANSFORMATIONOPERATOR3D:"IfcCartesianTransformationOperator3D",IFCCARTESIANTRANSFORMATIONOPERATOR2DNONUNIFORM:"IfcCartesianTransformationOperator2DNonUniform",IFCCARTESIANTRANSFORMATIONOPERATOR2D:"IfcCartesianTransformationOperator2D",IFCCARTESIANTRANSFORMATIONOPERATOR:"IfcCartesianTransformationOperator",IFCCARTESIANPOINT:"IfcCartesianPoint",IFCCSHAPEPROFILEDEF:"IfcCShapeProfileDef",IFCBOXEDHALFSPACE:"IfcBoxedHalfSpace",IFCBOUNDINGBOX:"IfcBoundingBox",IFCBOUNDEDSURFACE:"IfcBoundedSurface",IFCBOOLEANRESULT:"IfcBooleanResult",IFCAXIS2PLACEMENT3D:"IfcAxis2Placement3D",IFCAXIS2PLACEMENT2D:"IfcAxis2Placement2D",IFCAXIS1PLACEMENT:"IfcAxis1Placement",IFCANNOTATIONSURFACE:"IfcAnnotationSurface",IFCANNOTATIONFILLAREAOCCURRENCE:"IfcAnnotationFillAreaOccurrence",IFCANNOTATIONFILLAREA:"IfcAnnotationFillArea",IFCANNOTATIONCURVEOCCURRENCE:"IfcAnnotationCurveOccurrence",IFCZSHAPEPROFILEDEF:"IfcZShapeProfileDef",IFCWINDOWSTYLE:"IfcWindowStyle",IFCWINDOWPANELPROPERTIES:"IfcWindowPanelProperties",IFCWINDOWLININGPROPERTIES:"IfcWindowLiningProperties",IFCVERTEXLOOP:"IfcVertexLoop",IFCVECTOR:"IfcVector",IFCUSHAPEPROFILEDEF:"IfcUShapeProfileDef",IFCTYPEPRODUCT:"IfcTypeProduct",IFCTYPEOBJECT:"IfcTypeObject",IFCTWODIRECTIONREPEATFACTOR:"IfcTwoDirectionRepeatFactor",IFCTRAPEZIUMPROFILEDEF:"IfcTrapeziumProfileDef",IFCTEXTLITERALWITHEXTENT:"IfcTextLiteralWithExtent",IFCTEXTLITERAL:"IfcTextLiteral",IFCTERMINATORSYMBOL:"IfcTerminatorSymbol",IFCTSHAPEPROFILEDEF:"IfcTShapeProfileDef",IFCSWEPTSURFACE:"IfcSweptSurface",IFCSWEPTDISKSOLID:"IfcSweptDiskSolid",IFCSWEPTAREASOLID:"IfcSweptAreaSolid",IFCSURFACESTYLERENDERING:"IfcSurfaceStyleRendering",IFCSURFACE:"IfcSurface",IFCSUBEDGE:"IfcSubedge",IFCSTRUCTURALSTEELPROFILEPROPERTIES:"IfcStructuralSteelProfileProperties",IFCSTRUCTURALPROFILEPROPERTIES:"IfcStructuralProfileProperties",IFCSTRUCTURALLOADSINGLEFORCEWARPING:"IfcStructuralLoadSingleForceWarping",IFCSTRUCTURALLOADSINGLEFORCE:"IfcStructuralLoadSingleForce",IFCSTRUCTURALLOADSINGLEDISPLACEMENTDISTORTION:"IfcStructuralLoadSingleDisplacementDistortion",IFCSTRUCTURALLOADSINGLEDISPLACEMENT:"IfcStructuralLoadSingleDisplacement",IFCSTRUCTURALLOADPLANARFORCE:"IfcStructuralLoadPlanarForce",IFCSTRUCTURALLOADLINEARFORCE:"IfcStructuralLoadLinearForce",IFCSPACETHERMALLOADPROPERTIES:"IfcSpaceThermalLoadProperties",IFCSOUNDVALUE:"IfcSoundValue",IFCSOUNDPROPERTIES:"IfcSoundProperties",IFCSOLIDMODEL:"IfcSolidModel",IFCSLIPPAGECONNECTIONCONDITION:"IfcSlippageConnectionCondition",IFCSHELLBASEDSURFACEMODEL:"IfcShellBasedSurfaceModel",IFCSERVICELIFEFACTOR:"IfcServiceLifeFactor",IFCSECTIONEDSPINE:"IfcSectionedSpine",IFCROUNDEDRECTANGLEPROFILEDEF:"IfcRoundedRectangleProfileDef",IFCRELATIONSHIP:"IfcRelationship",IFCREINFORCEMENTDEFINITIONPROPERTIES:"IfcReinforcementDefinitionProperties",IFCREGULARTIMESERIES:"IfcRegularTimeSeries",IFCRECTANGLEPROFILEDEF:"IfcRectangleProfileDef",IFCPROPERTYTABLEVALUE:"IfcPropertyTableValue",IFCPROPERTYSINGLEVALUE:"IfcPropertySingleValue",IFCPROPERTYSETDEFINITION:"IfcPropertySetDefinition",IFCPROPERTYREFERENCEVALUE:"IfcPropertyReferenceValue",IFCPROPERTYLISTVALUE:"IfcPropertyListValue",IFCPROPERTYENUMERATEDVALUE:"IfcPropertyEnumeratedValue",IFCPROPERTYDEFINITION:"IfcPropertyDefinition",IFCPROPERTYBOUNDEDVALUE:"IfcPropertyBoundedValue",IFCPRODUCTDEFINITIONSHAPE:"IfcProductDefinitionShape",IFCPREDEFINEDPOINTMARKERSYMBOL:"IfcPredefinedPointMarkerSymbol",IFCPREDEFINEDDIMENSIONSYMBOL:"IfcPredefinedDimensionSymbol",IFCPREDEFINEDCURVEFONT:"IfcPredefinedCurveFont",IFCPREDEFINEDCOLOUR:"IfcPredefinedColour",IFCPOLYGONALBOUNDEDHALFSPACE:"IfcPolygonalBoundedHalfSpace",IFCPOLYLOOP:"IfcPolyLoop",IFCPOINTONSURFACE:"IfcPointOnSurface",IFCPOINTONCURVE:"IfcPointOnCurve",IFCPOINT:"IfcPoint",IFCPLANAREXTENT:"IfcPlanarExtent",IFCPLACEMENT:"IfcPlacement",IFCPIXELTEXTURE:"IfcPixelTexture",IFCPHYSICALCOMPLEXQUANTITY:"IfcPhysicalComplexQuantity",IFCPATH:"IfcPath",IFCPARAMETERIZEDPROFILEDEF:"IfcParameterizedProfileDef",IFCORIENTEDEDGE:"IfcOrientedEdge",IFCOPENSHELL:"IfcOpenShell",IFCONEDIRECTIONREPEATFACTOR:"IfcOneDirectionRepeatFactor",IFCOBJECTDEFINITION:"IfcObjectDefinition",IFCMECHANICALCONCRETEMATERIALPROPERTIES:"IfcMechanicalConcreteMaterialProperties",IFCMATERIALDEFINITIONREPRESENTATION:"IfcMaterialDefinitionRepresentation",IFCMAPPEDITEM:"IfcMappedItem",IFCLOOP:"IfcLoop",IFCLOCALPLACEMENT:"IfcLocalPlacement",IFCLIGHTSOURCESPOT:"IfcLightSourceSpot",IFCLIGHTSOURCEPOSITIONAL:"IfcLightSourcePositional",IFCLIGHTSOURCEGONIOMETRIC:"IfcLightSourceGoniometric",IFCLIGHTSOURCEDIRECTIONAL:"IfcLightSourceDirectional",IFCLIGHTSOURCEAMBIENT:"IfcLightSourceAmbient",IFCLIGHTSOURCE:"IfcLightSource",IFCIRREGULARTIMESERIES:"IfcIrregularTimeSeries",IFCIMAGETEXTURE:"IfcImageTexture",IFCHYGROSCOPICMATERIALPROPERTIES:"IfcHygroscopicMaterialProperties",IFCHALFSPACESOLID:"IfcHalfSpaceSolid",IFCGRIDPLACEMENT:"IfcGridPlacement",IFCGEOMETRICSET:"IfcGeometricSet",IFCGEOMETRICREPRESENTATIONSUBCONTEXT:"IfcGeometricRepresentationSubContext",IFCGEOMETRICREPRESENTATIONITEM:"IfcGeometricRepresentationItem",IFCGEOMETRICREPRESENTATIONCONTEXT:"IfcGeometricRepresentationContext",IFCGENERALPROFILEPROPERTIES:"IfcGeneralProfileProperties",IFCGENERALMATERIALPROPERTIES:"IfcGeneralMaterialProperties",IFCFUELPROPERTIES:"IfcFuelProperties",IFCFILLAREASTYLE:"IfcFillAreaStyle",IFCFAILURECONNECTIONCONDITION:"IfcFailureConnectionCondition",IFCFACESURFACE:"IfcFaceSurface",IFCFACEOUTERBOUND:"IfcFaceOuterBound",IFCFACEBOUND:"IfcFaceBound",IFCFACE:"IfcFace",IFCEXTENDEDMATERIALPROPERTIES:"IfcExtendedMaterialProperties",IFCEDGECURVE:"IfcEdgeCurve",IFCEDGE:"IfcEdge",IFCDRAUGHTINGPREDEFINEDTEXTFONT:"IfcDraughtingPredefinedTextFont",IFCDOCUMENTREFERENCE:"IfcDocumentReference",IFCDIMENSIONPAIR:"IfcDimensionPair",IFCDIMENSIONCALLOUTRELATIONSHIP:"IfcDimensionCalloutRelationship",IFCDERIVEDPROFILEDEF:"IfcDerivedProfileDef",IFCCURVESTYLE:"IfcCurveStyle",IFCCONVERSIONBASEDUNIT:"IfcConversionBasedUnit",IFCCONTEXTDEPENDENTUNIT:"IfcContextDependentUnit",IFCCONNECTIONPOINTECCENTRICITY:"IfcConnectionPointEccentricity",IFCCONNECTIONCURVEGEOMETRY:"IfcConnectionCurveGeometry",IFCCONNECTEDFACESET:"IfcConnectedFaceSet",IFCCOMPOSITEPROFILEDEF:"IfcCompositeProfileDef",IFCCOMPLEXPROPERTY:"IfcComplexProperty",IFCCOLOURRGB:"IfcColourRgb",IFCCLASSIFICATIONREFERENCE:"IfcClassificationReference",IFCCENTERLINEPROFILEDEF:"IfcCenterLineProfileDef",IFCBLOBTEXTURE:"IfcBlobTexture",IFCARBITRARYPROFILEDEFWITHVOIDS:"IfcArbitraryProfileDefWithVoids",IFCARBITRARYOPENPROFILEDEF:"IfcArbitraryOpenProfileDef",IFCARBITRARYCLOSEDPROFILEDEF:"IfcArbitraryClosedProfileDef",IFCANNOTATIONTEXTOCCURRENCE:"IfcAnnotationTextOccurrence",IFCANNOTATIONSYMBOLOCCURRENCE:"IfcAnnotationSymbolOccurrence",IFCANNOTATIONSURFACEOCCURRENCE:"IfcAnnotationSurfaceOccurrence",IFCANNOTATIONOCCURRENCE:"IfcAnnotationOccurrence",IFCWATERPROPERTIES:"IfcWaterProperties",IFCVIRTUALGRIDINTERSECTION:"IfcVirtualGridIntersection",IFCVERTEXPOINT:"IfcVertexPoint",IFCVERTEXBASEDTEXTUREMAP:"IfcVertexBasedTextureMap",IFCVERTEX:"IfcVertex",IFCUNITASSIGNMENT:"IfcUnitAssignment",IFCTOPOLOGYREPRESENTATION:"IfcTopologyRepresentation",IFCTOPOLOGICALREPRESENTATIONITEM:"IfcTopologicalRepresentationItem",IFCTIMESERIESVALUE:"IfcTimeSeriesValue",IFCTIMESERIESREFERENCERELATIONSHIP:"IfcTimeSeriesReferenceRelationship",IFCTIMESERIES:"IfcTimeSeries",IFCTHERMALMATERIALPROPERTIES:"IfcThermalMaterialProperties",IFCTEXTUREVERTEX:"IfcTextureVertex",IFCTEXTUREMAP:"IfcTextureMap",IFCTEXTURECOORDINATEGENERATOR:"IfcTextureCoordinateGenerator",IFCTEXTURECOORDINATE:"IfcTextureCoordinate",IFCTEXTSTYLEWITHBOXCHARACTERISTICS:"IfcTextStyleWithBoxCharacteristics",IFCTEXTSTYLETEXTMODEL:"IfcTextStyleTextModel",IFCTEXTSTYLEFORDEFINEDFONT:"IfcTextStyleForDefinedFont",IFCTEXTSTYLEFONTMODEL:"IfcTextStyleFontModel",IFCTEXTSTYLE:"IfcTextStyle",IFCTELECOMADDRESS:"IfcTelecomAddress",IFCTABLEROW:"IfcTableRow",IFCTABLE:"IfcTable",IFCSYMBOLSTYLE:"IfcSymbolStyle",IFCSURFACETEXTURE:"IfcSurfaceTexture",IFCSURFACESTYLEWITHTEXTURES:"IfcSurfaceStyleWithTextures",IFCSURFACESTYLESHADING:"IfcSurfaceStyleShading",IFCSURFACESTYLEREFRACTION:"IfcSurfaceStyleRefraction",IFCSURFACESTYLELIGHTING:"IfcSurfaceStyleLighting",IFCSURFACESTYLE:"IfcSurfaceStyle",IFCSTYLEDREPRESENTATION:"IfcStyledRepresentation",IFCSTYLEDITEM:"IfcStyledItem",IFCSTYLEMODEL:"IfcStyleModel",IFCSTRUCTURALLOADTEMPERATURE:"IfcStructuralLoadTemperature",IFCSTRUCTURALLOADSTATIC:"IfcStructuralLoadStatic",IFCSTRUCTURALLOAD:"IfcStructuralLoad",IFCSTRUCTURALCONNECTIONCONDITION:"IfcStructuralConnectionCondition",IFCSIMPLEPROPERTY:"IfcSimpleProperty",IFCSHAPEREPRESENTATION:"IfcShapeRepresentation",IFCSHAPEMODEL:"IfcShapeModel",IFCSHAPEASPECT:"IfcShapeAspect",IFCSECTIONREINFORCEMENTPROPERTIES:"IfcSectionReinforcementProperties",IFCSECTIONPROPERTIES:"IfcSectionProperties",IFCSIUNIT:"IfcSIUnit",IFCROOT:"IfcRoot",IFCRIBPLATEPROFILEPROPERTIES:"IfcRibPlateProfileProperties",IFCREPRESENTATIONMAP:"IfcRepresentationMap",IFCREPRESENTATIONITEM:"IfcRepresentationItem",IFCREPRESENTATIONCONTEXT:"IfcRepresentationContext",IFCREPRESENTATION:"IfcRepresentation",IFCRELAXATION:"IfcRelaxation",IFCREINFORCEMENTBARPROPERTIES:"IfcReinforcementBarProperties",IFCREFERENCESVALUEDOCUMENT:"IfcReferencesValueDocument",IFCQUANTITYWEIGHT:"IfcQuantityWeight",IFCQUANTITYVOLUME:"IfcQuantityVolume",IFCQUANTITYTIME:"IfcQuantityTime",IFCQUANTITYLENGTH:"IfcQuantityLength",IFCQUANTITYCOUNT:"IfcQuantityCount",IFCQUANTITYAREA:"IfcQuantityArea",IFCPROPERTYENUMERATION:"IfcPropertyEnumeration",IFCPROPERTYDEPENDENCYRELATIONSHIP:"IfcPropertyDependencyRelationship",IFCPROPERTYCONSTRAINTRELATIONSHIP:"IfcPropertyConstraintRelationship",IFCPROPERTY:"IfcProperty",IFCPROFILEPROPERTIES:"IfcProfileProperties",IFCPROFILEDEF:"IfcProfileDef",IFCPRODUCTSOFCOMBUSTIONPROPERTIES:"IfcProductsOfCombustionProperties",IFCPRODUCTREPRESENTATION:"IfcProductRepresentation",IFCPRESENTATIONSTYLEASSIGNMENT:"IfcPresentationStyleAssignment",IFCPRESENTATIONSTYLE:"IfcPresentationStyle",IFCPRESENTATIONLAYERWITHSTYLE:"IfcPresentationLayerWithStyle",IFCPRESENTATIONLAYERASSIGNMENT:"IfcPresentationLayerAssignment",IFCPREDEFINEDTEXTFONT:"IfcPredefinedTextFont",IFCPREDEFINEDTERMINATORSYMBOL:"IfcPredefinedTerminatorSymbol",IFCPREDEFINEDSYMBOL:"IfcPredefinedSymbol",IFCPREDEFINEDITEM:"IfcPredefinedItem",IFCPOSTALADDRESS:"IfcPostalAddress",IFCPHYSICALSIMPLEQUANTITY:"IfcPhysicalSimpleQuantity",IFCPHYSICALQUANTITY:"IfcPhysicalQuantity",IFCPERSONANDORGANIZATION:"IfcPersonAndOrganization",IFCPERSON:"IfcPerson",IFCOWNERHISTORY:"IfcOwnerHistory",IFCORGANIZATIONRELATIONSHIP:"IfcOrganizationRelationship",IFCORGANIZATION:"IfcOrganization",IFCOPTICALMATERIALPROPERTIES:"IfcOpticalMaterialProperties",IFCOBJECTIVE:"IfcObjective",IFCOBJECTPLACEMENT:"IfcObjectPlacement",IFCNAMEDUNIT:"IfcNamedUnit",IFCMONETARYUNIT:"IfcMonetaryUnit",IFCMETRIC:"IfcMetric",IFCMECHANICALSTEELMATERIALPROPERTIES:"IfcMechanicalSteelMaterialProperties",IFCMECHANICALMATERIALPROPERTIES:"IfcMechanicalMaterialProperties",IFCMEASUREWITHUNIT:"IfcMeasureWithUnit",IFCMATERIALPROPERTIES:"IfcMaterialProperties",IFCMATERIALLIST:"IfcMaterialList",IFCMATERIALLAYERSETUSAGE:"IfcMaterialLayerSetUsage",IFCMATERIALLAYERSET:"IfcMaterialLayerSet",IFCMATERIALLAYER:"IfcMaterialLayer",IFCMATERIALCLASSIFICATIONRELATIONSHIP:"IfcMaterialClassificationRelationship",IFCMATERIAL:"IfcMaterial",IFCLOCALTIME:"IfcLocalTime",IFCLIGHTINTENSITYDISTRIBUTION:"IfcLightIntensityDistribution",IFCLIGHTDISTRIBUTIONDATA:"IfcLightDistributionData",IFCLIBRARYREFERENCE:"IfcLibraryReference",IFCLIBRARYINFORMATION:"IfcLibraryInformation",IFCIRREGULARTIMESERIESVALUE:"IfcIrregularTimeSeriesValue",IFCGRIDAXIS:"IfcGridAxis",IFCEXTERNALLYDEFINEDTEXTFONT:"IfcExternallyDefinedTextFont",IFCEXTERNALLYDEFINEDSYMBOL:"IfcExternallyDefinedSymbol",IFCEXTERNALLYDEFINEDSURFACESTYLE:"IfcExternallyDefinedSurfaceStyle",IFCEXTERNALLYDEFINEDHATCHSTYLE:"IfcExternallyDefinedHatchStyle",IFCEXTERNALREFERENCE:"IfcExternalReference",IFCENVIRONMENTALIMPACTVALUE:"IfcEnvironmentalImpactValue",IFCDRAUGHTINGCALLOUTRELATIONSHIP:"IfcDraughtingCalloutRelationship",IFCDOCUMENTINFORMATIONRELATIONSHIP:"IfcDocumentInformationRelationship",IFCDOCUMENTINFORMATION:"IfcDocumentInformation",IFCDOCUMENTELECTRONICFORMAT:"IfcDocumentElectronicFormat",IFCDIMENSIONALEXPONENTS:"IfcDimensionalExponents",IFCDERIVEDUNITELEMENT:"IfcDerivedUnitElement",IFCDERIVEDUNIT:"IfcDerivedUnit",IFCDATEANDTIME:"IfcDateAndTime",IFCCURVESTYLEFONTPATTERN:"IfcCurveStyleFontPattern",IFCCURVESTYLEFONTANDSCALING:"IfcCurveStyleFontAndScaling",IFCCURVESTYLEFONT:"IfcCurveStyleFont",IFCCURRENCYRELATIONSHIP:"IfcCurrencyRelationship",IFCCOSTVALUE:"IfcCostValue",IFCCOORDINATEDUNIVERSALTIMEOFFSET:"IfcCoordinatedUniversalTimeOffset",IFCCONSTRAINTRELATIONSHIP:"IfcConstraintRelationship",IFCCONSTRAINTCLASSIFICATIONRELATIONSHIP:"IfcConstraintClassificationRelationship",IFCCONSTRAINTAGGREGATIONRELATIONSHIP:"IfcConstraintAggregationRelationship",IFCCONSTRAINT:"IfcConstraint",IFCCONNECTIONSURFACEGEOMETRY:"IfcConnectionSurfaceGeometry",IFCCONNECTIONPORTGEOMETRY:"IfcConnectionPortGeometry",IFCCONNECTIONPOINTGEOMETRY:"IfcConnectionPointGeometry",IFCCONNECTIONGEOMETRY:"IfcConnectionGeometry",IFCCOLOURSPECIFICATION:"IfcColourSpecification",IFCCLASSIFICATIONNOTATIONFACET:"IfcClassificationNotationFacet",IFCCLASSIFICATIONNOTATION:"IfcClassificationNotation",IFCCLASSIFICATIONITEMRELATIONSHIP:"IfcClassificationItemRelationship",IFCCLASSIFICATIONITEM:"IfcClassificationItem",IFCCLASSIFICATION:"IfcClassification",IFCCALENDARDATE:"IfcCalendarDate",IFCBOUNDARYNODECONDITIONWARPING:"IfcBoundaryNodeConditionWarping",IFCBOUNDARYNODECONDITION:"IfcBoundaryNodeCondition",IFCBOUNDARYFACECONDITION:"IfcBoundaryFaceCondition",IFCBOUNDARYEDGECONDITION:"IfcBoundaryEdgeCondition",IFCBOUNDARYCONDITION:"IfcBoundaryCondition",IFCAPPROVALRELATIONSHIP:"IfcApprovalRelationship",IFCAPPROVALPROPERTYRELATIONSHIP:"IfcApprovalPropertyRelationship",IFCAPPROVALACTORRELATIONSHIP:"IfcApprovalActorRelationship",IFCAPPROVAL:"IfcApproval",IFCAPPLIEDVALUERELATIONSHIP:"IfcAppliedValueRelationship",IFCAPPLIEDVALUE:"IfcAppliedValue",IFCAPPLICATION:"IfcApplication",IFCADDRESS:"IfcAddress",IFCACTORROLE:"IfcActorRole"};class qh{constructor(){p(this,"factor",1),p(this,"complement",1)}apply(t){const s=this.getScaleMatrix().multiply(t);t.copy(s)}setUp(t){var e,s,i;this.factor=1;const n=this.getLengthUnits(t);if(!n)return;const r=n==null,o=n.Name===void 0||n.Name===null;r||o||(n.Name.value==="FOOT"&&(this.factor=.3048),((e=n.Prefix)==null?void 0:e.value)==="MILLI"?this.complement=.001:((s=n.Prefix)==null?void 0:s.value)==="CENTI"?this.complement=.01:((i=n.Prefix)==null?void 0:i.value)==="DECI"&&(this.complement=.01))}getLengthUnits(t){try{const s=t.GetLineIDsWithType(0,Sc).get(0),i=t.GetLine(0,s);for(const n of i.Units){if(!n||n.value===null||n.value===void 0)continue;const r=t.GetLine(0,n.value);if(r.UnitType&&r.UnitType.value==="LENGTHUNIT")return r}return null}catch{return console.log("Could not get units"),null}}getScaleMatrix(){const t=this.factor;return new ft().fromArray([t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1])}}class na{constructor(){p(this,"itemsByFloor",{}),p(this,"_units",new qh)}setUp(t){this._units.setUp(t),this.cleanUp();try{const e=t.GetLineIDsWithType(0,ki),s=new Set,i=t.GetLineIDsWithType(0,Xe);for(let l=0;l<i.size();l++)s.add(i.get(l));const n=t.GetLineIDsWithType(0,Gi),r=n.size();for(let l=0;l<r;l++){const h=n.get(l),d=t.GetLine(0,h);if(!d||!d.RelatingObject||!d.RelatedObjects)continue;const u=d.RelatingObject.value,f=d.RelatedObjects;for(const I of f){const E=I.value;s.has(E)&&(this.itemsByFloor[E]=u)}}const o={},a=e.size();for(let l=0;l<a;l++){const h=e.get(l),d=t.GetLine(0,h);if(!d||!d.RelatingStructure||!d.RelatedElements)continue;const u=d.RelatingStructure.value,f=d.RelatedElements;if(s.has(u))for(const I of f){o[u]||(o[u]=[]);const E=I.value;o[u].push(E)}else for(const I of f){const E=I.value;this.itemsByFloor[E]=u}}for(const l in o){const h=this.itemsByFloor[l];if(h!==void 0){const d=o[l];for(const u of d)this.itemsByFloor[u]=h}}for(let l=0;l<r;l++){const h=n.get(l),d=t.GetLine(0,h);if(!d||!d.RelatingObject||!d.RelatedObjects)continue;const u=d.RelatingObject.value,f=d.RelatedObjects;for(const I of f){const E=I.value,m=this.itemsByFloor[u];m!==void 0&&(this.itemsByFloor[E]=m)}}}catch{console.log("Could not get floors.")}}cleanUp(){this.itemsByFloor={}}}class pr{constructor(){p(this,"includeProperties",!0),p(this,"optionalCategories",[Xe]),p(this,"wasm",{path:"",absolute:!1,logLevel:dc.LOG_LEVEL_OFF}),p(this,"excludedCategories",new Set),p(this,"includedCategories",new Set),p(this,"saveLocations",!1),p(this,"webIfc",{COORDINATE_TO_ORIGIN:!0}),p(this,"autoSetWasm",!0),p(this,"customLocateFileHandler",null)}}class ra{constructor(){p(this,"defLineMat",new wo({color:16777215}))}read(t){const e=t.GetAllAlignments(0),s=t.GetAllCrossSections2D(0),i=t.GetAllCrossSections3D(0),n={IfcAlignment:e,IfcCrossSection2D:s,IfcCrossSection3D:i};return this.get(n)}get(t){if(t.IfcAlignment){const e=new Map;for(const s of t.IfcAlignment){const i=new Ic;i.absolute=this.getCurves(s.curve3D,i),i.horizontal=this.getCurves(s.horizontal,i),i.vertical=this.getCurves(s.vertical,i),e.set(e.size,i)}return{alignments:e,coordinationMatrix:new ft}}}getCurves(t,e){const s=[];let i=0;for(const n of t){const r={};if(n.data)for(const u of n.data){const[f,I]=u.split(": "),E=parseFloat(I);r[f]=E||I}const{points:o}=n,a=new Float32Array(o.length*3);for(let u=0;u<o.length;u++){const{x:f,y:I,z:E}=o[u];a[u*3]=f,a[u*3+1]=I,a[u*3+2]=E||0}const l=new Ws(a,3),h=new Ec;h.setAttribute("position",l);const d=new pc(i,r,e,h,this.defLineMat);s.push(d.curve),i++}return s}}class oa{getNameInfo(t){var e;const s={},{arguments:i}=t.GetHeaderLine(0,Cc)||{};if(!i)return s;const[n,r,o,a,l,h,d]=i;if(n!=null&&n.value&&(s.name=n.value),r!=null&&r.value&&(s.creationDate=new Date(r.value)),o){s.author={};const[u,f]=o;u!=null&&u.value&&(s.author.name=u.value),f!=null&&f.value&&(s.author.email=f.value)}return a&&((e=a[0])!=null&&e.value)&&(s.organization=a[0].value),l!=null&&l.value&&(s.preprocessorVersion=l==null?void 0:l.value),h!=null&&h.value&&(s.originatingSystem=h==null?void 0:h.value),d!=null&&d.value&&(s.authorization=d==null?void 0:d.value),s}getDescriptionInfo(t){var e;const s={},{arguments:i}=t.GetHeaderLine(0,Tc)||{};if(!i)return s;const[n,r]=i;if(Array.isArray(n)&&((e=n[0])!=null&&e.value)){const o=n[0].value.match(/\[([^\]]+)\]/);o&&o[1]&&(s.viewDefinition=o[1])}return r!=null&&r.value&&(s.implementationLevel=r.value),s}}class aa{static get(t,e){const s=[nr,rr,or,ar,Xe,Oc,yc,Nc,_c],i=t.data;for(const n of s){const r=e.GetLineIDsWithType(0,n),o=r.size();for(let a=0;a<o;a++){const l=r.get(a);i.has(l)||i.set(l,[[],[0,n]])}}}}const ca=new Set([1123145078,574549367,1675464909,2059837836,3798115385,32440307,3125803723,3207858831,2740243338,2624227202,4240577450,3615266464,3724593414,220341763,477187591,1878645084,1300840506,3303107099,1607154358,1878645084,846575682,1351298697,2417041796,3049322572,3331915920,1416205885,776857604,3285139300,3958052878,2827736869,2732653382,673634403,3448662350,4142052618,2924175390,803316827,2556980723,1809719519,2205249479,807026263,3737207727,1660063152,2347385850,2705031697,3732776249,2485617015,2611217952,1704287377,2937912522,2770003689,1281925730,1484403080,3448662350,4142052618,3800577675,4006246654,3590301190,1383045692,2775532180,2047409740,370225590,3593883385,2665983363,4124623270,812098782,3649129432,987898635,1105321065,3510044353,1635779807,2603310189,3406155212,1310608509,4261334040,2736907675,3649129432,1136057603,1260505505,4182860854,2713105998,2898889636,59481748,3749851601,3486308946,3150382593,1062206242,3264961684,15328376,1485152156,370225590,1981873012,2859738748,45288368,2614616156,2732653382,775493141,2147822146,2601014836,2629017746,1186437898,2367409068,1213902940,3632507154,3900360178,476780140,1472233963,2804161546,3008276851,738692330,374418227,315944413,3905492369,3570813810,2571569899,178912537,2294589976,1437953363,2133299955,572779678,3092502836,388784114,2624227202,1425443689,3057273783,2347385850,1682466193,2519244187,2839578677,3958567839,2513912981,2830218821,427810014,2916149573]),la=class ha extends Rt{constructor(t){super(t),p(this,"enabled",!0),t.add(ha.uuid,this)}async export(t,e,s=!1,i=!0){const n={},r=new Set(t.GetIfcEntityList(e)),o=new Set([nr,rr,or,ar,Xe]);for(const a of o)r.add(a);for(const a of r){if(ca.has(a))continue;const l=o.has(a)&&i,h=t.GetLineIDsWithType(e,a);for(const d of h)try{const u=t.GetLine(0,d,l,s);n[u.expressID]=u}catch{console.log(`Could not get property ${d}, with recursive ${l} and indirect ${s}.`)}}return n}};p(la,"uuid","b32c4332-cd67-436e-ba7f-196646c7a635");let Qh=la;const ua=class xn extends Rt{constructor(t){super(t),p(this,"onDisposed",new q),p(this,"onIfcStartedLoading",new q),p(this,"onSetup",new q),p(this,"settings",new pr),p(this,"webIfc",new Is),p(this,"enabled",!0),p(this,"_material",new Or),p(this,"_spatialTree",new na),p(this,"_metaData",new oa),p(this,"_fragmentInstances",new Map),p(this,"_civil",new ra),p(this,"_visitedFragments",new Map),p(this,"_materialT",new Or({transparent:!0,opacity:.5})),this.components.add(xn.uuid,this),this.settings.excludedCategories.add(Po)}dispose(){this.webIfc=null,this.onDisposed.trigger(xn.uuid),this.onDisposed.reset()}async setup(t){this.settings={...this.settings,...t},this.settings.autoSetWasm&&await this.autoSetWasm(),this.onSetup.trigger()}async load(t,e=!0,s=""){const i=performance.now();this.onIfcStartedLoading.trigger(),await this.readIfcFile(t);const n=await this.getAllGeometries();n.name=s;const o=await this.components.get(Qh).export(this.webIfc,0);n.setLocalProperties(o);const a=this.components.get(gt);a.groups.set(n.uuid,n);for(const l of n.items)a.list.set(l.id,l),l.mesh.uuid=l.id,l.group=n;a.onFragmentsLoaded.trigger(n),e&&a.coordinate([n]);for(const[l]of n.data){const h=o[l];if(!h||!h.GlobalId)continue;const d=h.GlobalId.value||h.GlobalId;n.globalToExpressIDs.set(d,l)}return aa.get(n,this.webIfc),this.cleanUp(),console.log(`Streaming the IFC took ${performance.now()-i} ms!`),n}async readIfcFile(t){const{path:e,absolute:s,logLevel:i}=this.settings.wasm;return this.webIfc.SetWasmPath(e,s),await this.webIfc.Init(this.settings.customLocateFileHandler||void 0),i&&this.webIfc.SetLogLevel(i),this.webIfc.OpenModel(t,this.settings.webIfc)}cleanUp(){try{this.webIfc.Dispose()}catch{console.log("Web-ifc wasn't disposed.")}this.webIfc=null,this.webIfc=new Is,this._visitedFragments.clear(),this._fragmentInstances.clear()}async getAllGeometries(){this._spatialTree.setUp(this.webIfc);const t=this.webIfc.GetIfcEntityList(0),e=new zs;e.ifcMetadata={name:"",description:"",...this._metaData.getNameInfo(this.webIfc),...this._metaData.getDescriptionInfo(this.webIfc),schema:this.webIfc.GetModelSchema(0)||"IFC2X3",maxExpressID:this.webIfc.GetMaxExpressID(0)};const s=[];for(const n of t){if(!this.webIfc.IsIfcElement(n)&&n!==Xe)continue;const r=this.settings.includedCategories;if(r.size>0&&!r.has(n))continue;if(this.settings.excludedCategories.has(n))continue;const o=this.webIfc.GetLineIDsWithType(0,n),a=o.size();for(let l=0;l<a;l++){const h=o.get(l);s.push(h);const d=this._spatialTree.itemsByFloor[h]||0;e.data.set(h,[[],[d,n]])}}this._spatialTree.cleanUp(),this.webIfc.StreamMeshes(0,s,n=>{this.getMesh(n,e)});for(const n of this._visitedFragments){const{index:r,fragment:o}=n[1];e.keyFragments.set(r,o.id)}for(const n of e.items){const r=this._fragmentInstances.get(n.id);if(!r)throw new Error("Fragment not found!");const o=[];for(const[a,l]of r)o.push(l);n.add(o)}const i=this.webIfc.GetCoordinationMatrix(0);return e.coordinationMatrix.fromArray(i),e.civilData=this._civil.read(this.webIfc),e}getMesh(t,e){const s=t.geometries.size(),i=t.expressID;for(let n=0;n<s;n++){const r=t.geometries.get(n),{x:o,y:a,z:l,w:h}=r.color,d=h!==1,{geometryExpressID:u}=r,f=`${u}-${d}`;if(!this._visitedFragments.has(f)){const T=this.getGeometry(this.webIfc,u),F=d?this._materialT:this._material,y=new ac(T,F,1);e.add(y.mesh),e.items.push(y);const N=this._visitedFragments.size;this._visitedFragments.set(f,{index:N,fragment:y})}const I=new Dt().setRGB(o,a,l,"srgb"),E=new ft;E.fromArray(r.flatTransformation);const m=this._visitedFragments.get(f);if(m===void 0)throw new Error("Error getting geometry data for streaming!");const C=e.data.get(i);if(!C)throw new Error("Data not found!");C[0].push(m.index);const{fragment:g}=m;this._fragmentInstances.has(g.id)||this._fragmentInstances.set(g.id,new Map);const S=this._fragmentInstances.get(g.id);if(!S)throw new Error("Instances not found!");if(S.has(i)){const T=S.get(i);if(!T)throw new Error("Instance not found!");T.transforms.push(E),T.colors&&T.colors.push(I)}else S.set(i,{id:i,transforms:[E],colors:[I]})}}getGeometry(t,e){const s=t.GetGeometry(0,e),i=t.GetIndexArray(s.GetIndexData(),s.GetIndexDataSize()),n=t.GetVertexArray(s.GetVertexData(),s.GetVertexDataSize()),r=new Float32Array(n.length/2),o=new Float32Array(n.length/2);for(let d=0;d<n.length;d+=6)r[d/2]=n[d],r[d/2+1]=n[d+1],r[d/2+2]=n[d+2],o[d/2]=n[d+3],o[d/2+1]=n[d+4],o[d/2+2]=n[d+5];const a=new Hs,l=new Ws(r,3),h=new Ws(o,3);return a.setAttribute("position",l),a.setAttribute("normal",h),a.setIndex(Array.from(i)),s.delete(),a}async autoSetWasm(){const t=await fetch(`https://unpkg.com/@thatopen/components@${ko.release}/package.json`);if(!t.ok){console.warn("Couldn't get openbim-components package.json. Set wasm settings manually.");return}const e=await t.json();if(!("web-ifc"in e.peerDependencies))console.warn("Couldn't get web-ifc from peer dependencies in openbim-components. Set wasm settings manually.");else{const s=e.peerDependencies["web-ifc"];this.settings.wasm.path=`https://unpkg.com/web-ifc@${s}/`,this.settings.wasm.absolute=!0}}};p(ua,"uuid","a659add7-1418-4771-a0d6-7d4d438e4624");let Kh=ua;const Jh={IfcRelAssignsToControl:{related:5,relating:7},IfcRelAssignsToGroup:{related:5,relating:7},IfcRelAssignsToProduct:{related:5,relating:7},IfcRelAssociatesClassification:{related:5,relating:6},IfcRelAssociatesMaterial:{related:5,relating:6},IfcRelAssociatesDocument:{related:5,relating:6},IfcRelContainedInSpatialStructure:{related:5,relating:6},IfcRelFlowControlElements:{related:5,relating:6},IfcRelConnectsElements:{related:7,relating:6},IfcRelDeclares:{related:6,relating:5},IfcRelAggregates:{related:6,relating:5},IfcRelNests:{related:6,relating:5},IfcRelDefinesByProperties:{related:5,relating:6},IfcRelDefinesByType:{related:5,relating:6},IfcRelDefinesByTemplate:{related:5,relating:6}},tu={[er]:"IfcRelAssignsToControl",[$n]:"IfcRelAssignsToGroup",[Jn]:"IfcRelAssignsToProduct",[Zn]:"IfcRelAssociatesClassification",[Xn]:"IfcRelAssociatesMaterial",[ir]:"IfcRelAssociatesDocument",[ki]:"IfcRelContainedInSpatialStructure",[Kn]:"IfcRelConnectsElements",[Qn]:"IfcRelFlowControlElements",[tr]:"IfcRelDeclares",[Gi]:"IfcRelAggregates",[sr]:"IfcRelNests",[Qs]:"IfcRelDefinesByProperties",[jn]:"IfcRelDefinesByType",[qn]:"IfcRelDefinesByTemplate"},fa=class Ye extends Rt{constructor(t){super(t),p(this,"onDisposed",new q),p(this,"onRequestFile",new q),p(this,"ifcToExport",null),p(this,"onElementToPset",new q),p(this,"onPropToPset",new q),p(this,"onPsetRemoved",new q),p(this,"onDataChanged",new q),p(this,"wasm",{path:"/",absolute:!1}),p(this,"enabled",!0),p(this,"attributeListeners",{}),p(this,"selectedModel"),p(this,"changeMap",{}),this.components.add(Ye.uuid,this)}dispose(){this.selectedModel=void 0,this.attributeListeners={},this.changeMap={},this.onElementToPset.reset(),this.onPropToPset.reset(),this.onPsetRemoved.reset(),this.onDataChanged.reset(),this.onDisposed.trigger(Ye.uuid),this.onDisposed.reset()}static getIFCSchema(t){const e=t.ifcMetadata.schema;if(!e)throw new Error("IFC Schema not found");return e.startsWith("IFC2X3")?"IFC2X3":e.startsWith("IFC4")&&e.replace("IFC4","")===""?"IFC4":e.startsWith("IFC4X3")?"IFC4X3":e}async setData(t,...e){for(const s of e){const{expressID:i}=s;(!i||i===-1)&&(s.expressID=this.getNewExpressID(t)),await t.setProperties(s.expressID,s),this.registerChange(t,s.expressID)}}async newPset(t,e,s){const i=Ye.getIFCSchema(t),{handle:n}=await this.getOwnerHistory(t),r=this.newGUID(t),o=new ue[i].IfcLabel(e),a=s?new ue[i].IfcText(s):null,l=new ue[i].IfcPropertySet(r,n,o,a,[]);return l.expressID=this.getNewExpressID(t),await this.setData(t,l),{pset:l}}async removePset(t,...e){for(const s of e){const i=await t.getProperties(s);if((i==null?void 0:i.type)!==fs)continue;const n=await ds.getPsetRel(t,s);if(n&&(await t.setProperties(n,null),this.registerChange(t,n)),i){for(const r of i.HasProperties)await t.setProperties(r.value,null);await t.setProperties(s,null),this.onPsetRemoved.trigger({model:t,psetID:s}),this.registerChange(t,s)}}}newSingleStringProperty(t,e,s,i){return this.newSingleProperty(t,e,s,i)}newSingleNumericProperty(t,e,s,i){return this.newSingleProperty(t,e,s,i)}newSingleBooleanProperty(t,e,s,i){return this.newSingleProperty(t,e,s,i)}async removePsetProp(t,e,s){const i=await t.getProperties(e),n=await t.getProperties(s);!i||!n||i.type===fs&&n&&(i.HasProperties=i.HasProperties.filter(r=>r.value!==s),await t.setProperties(s,null),this.registerChange(t,e,s))}addElementToPset(t,e,...s){this.components.get(te).addEntitiesRelation(t,e,{type:Qs,inv:"DefinesOcurrence"},...s)}async addPropToPset(t,e,...s){const i=await t.getProperties(e);if(i){for(const n of s){if(i.HasProperties.includes(n))continue;const r=new _e(n);i.HasProperties.push(r),this.onPropToPset.trigger({model:t,psetID:e,propID:n})}this.registerChange(t,e)}}async createIfcRel(t,e,s,i){const n=tu[e];if(!n)throw new Error(`IfcPropertiesManager: ${n} is unsoported.`);const r=Ye.getIFCSchema(t),o=Jh[n],a=ue[r][n];if(!(o&&a))throw new Error(`IfcPropertiesManager: ${n} is unsoported.`);const l=[new ue[r].IfcGloballyUniqueId(Ae.create())],{related:h,relating:d}=o,f=[...new Set(i)].map(m=>new _e(m)),I=(m,C)=>{for(let g=m;g<C-1;g++)l.push(null)};h<d?(I(1,h),l.push(f),I(h,d),l.push(new _e(s))):(I(1,d),I(d,h),l.push(new _e(s)),l.push(f));const E=new a(...l);return await this.setData(t,E),E}async saveToIfc(t,e){const s=this.components.get(Kh),i=s.webIfc,n=await s.readIfcFile(e);await this.components.get(te).applyRelationChanges();const o=this.changeMap[t.uuid]??[];for(const l of o){const h=await t.getProperties(l);h?i.WriteLine(n,h):i.GetLine(n,l)&&i.DeleteLine(n,l)}const a=i.SaveModel(n);return s.webIfc.CloseModel(n),s.cleanUp(),a}async getEntityRef(t,e){const s=await t.getAllPropertiesOfType(e);if(!s)return null;const i=[];for(const n in s){const r=new _e(Number(n));i.push(r)}return i}async setAttributeListener(t,e,s){this.attributeListeners[t.uuid]||(this.attributeListeners[t.uuid]={});const i=this.attributeListeners[t.uuid][e]?this.attributeListeners[t.uuid][e][s]:null;if(i)return i;const n=await t.getProperties(e);if(!n)throw new Error(`Entity with expressID ${e} doesn't exists.`);const r=n[s];if(Array.isArray(r)||!r)throw new Error(`Attribute ${s} is array or null, and it can't have a listener.`);const o=r.value;if(o===void 0||o==null)throw new Error(`Attribute ${s} has a badly defined handle.`);const a=new q;return Object.defineProperty(n[s],"value",{get(){return this._value},async set(l){this._value=l,a.trigger(l)}}),n[s].value=o,this.attributeListeners[t.uuid][e]||(this.attributeListeners[t.uuid][e]={}),this.attributeListeners[t.uuid][e][s]=a,a}getNewExpressID(t){return t.ifcMetadata.maxExpressID++,t.ifcMetadata.maxExpressID}newGUID(t){const e=Ye.getIFCSchema(t);return new ue[e].IfcGloballyUniqueId(Ae.create())}async getOwnerHistory(t){const e=await t.getAllPropertiesOfType(cc);if(!e)throw new Error("No OwnerHistory was found.");const s=Object.keys(e).map(r=>parseInt(r,10)),i=e[s[0]],n=new _e(i.expressID);return{entity:i,handle:n}}registerChange(t,...e){this.changeMap[t.uuid]||(this.changeMap[t.uuid]=new Set);for(const s of e)this.changeMap[t.uuid].add(s),this.onDataChanged.trigger({model:t,expressID:s})}async newSingleProperty(t,e,s,i){const n=Ye.getIFCSchema(t),r=new ue[n].IfcIdentifier(s),o=new ue[n][e](i),a=new ue[n].IfcPropertySingleValue(r,null,o,null);return a.expressID=this.getNewExpressID(t),await this.setData(t,a),a}};p(fa,"uuid","58c2d9f0-183c-48d6-a402-dfcf5b9a34df");let eu=fa;const da=class Un extends Rt{constructor(t){super(t),p(this,"onDisposed",new q),p(this,"onRelationsIndexed",new q),p(this,"relationMaps",{}),p(this,"enabled",!0),p(this,"_relToAttributesMap",Eo),p(this,"_inverseAttributes",["IsDecomposedBy","Decomposes","AssociatedTo","HasAssociations","ClassificationForObjects","IsGroupedBy","HasAssignments","IsDefinedBy","DefinesOcurrence","IsTypedBy","Types","Defines","ContainedInStructure","ContainsElements","HasControlElements","AssignedToFlowElement","ConnectedTo","ConnectedFrom","ReferencedBy","Declares","HasContext","Controls","IsNestedBy","Nests","DocumentRefForObjects"]),p(this,"_ifcRels",[Gi,Xn,Zn,$n,Qs,jn,qn,ki,Qn,Kn,Jn,tr,er,sr,ir]),p(this,"onFragmentsDisposed",s=>{delete this.relationMaps[s.groupID]}),p(this,"_changeMap",{}),p(this,"onEntitiesRelated",new q),this.components.add(Un.uuid,this),t.get(gt).onFragmentsDisposed.add(this.onFragmentsDisposed)}indexRelations(t,e,s,i){const n=Object.keys(e).find(h=>h.startsWith("Relating")),r=Object.keys(e).find(h=>h.startsWith("Related"));if(!(n&&r))return;const o=e[n].value,a=e[r].map(h=>h.value),l=this.getEntityRelations(t,o,i);for(const h of a)l.push(h);for(const h of a)this.getEntityRelations(t,h,s).push(o)}getAttributeIndex(t){const e=this._inverseAttributes.indexOf(t);if(e===-1)throw new Error(`IfcRelationsIndexer: ${t} is not a valid IFC Inverse Attribute name or its not supported yet by this component.`);return e}setRelationMap(t,e){this.relationMaps[t.uuid]=e,this.onRelationsIndexed.trigger({modelID:t.uuid,relationsMap:e})}async process(t,e){if(!t.hasProperties)throw new Error("FragmentsGroup properties not found");let s=this.relationMaps[t.uuid];s||(s=new Map,this.relationMaps[t.uuid]=s);const i=t.getLocalProperties();if(!i)return s;const n=(e==null?void 0:e.relationsToProcess)??this._ifcRels;for(const[r,o]of Object.entries(i)){if(!n.includes(o.type))continue;const a=this._relToAttributesMap.get(o.type);if(!a)continue;const{forRelated:l,forRelating:h}=a;this.indexRelations(s,o,l,h)}return this.setRelationMap(t,s),s}async processFromWebIfc(t,e){const s=new Map;for(const i of this._ifcRels){const n=this._relToAttributesMap.get(i);if(!n)continue;const{forRelated:r,forRelating:o}=n,a=t.GetLineIDsWithType(e,i);for(let l=0;l<a.size();l++){const h=await t.properties.getItemProperties(e,a.get(l));this.indexRelations(s,h,r,o)}}return this.onRelationsIndexed.trigger({modelID:e.toString(),relationsMap:s}),s}getEntityRelations(t,e,s){const i=this.getAttributeIndex(s);let n;if(t instanceof zs?n=this.relationMaps[t.uuid]:typeof t=="string"?n=this.relationMaps[t]:n=t,!n&&(t instanceof zs||typeof t=="string")){n=new Map;const a=t instanceof zs?t.uuid:t;this.relationMaps[a]=n}let r=n.get(e);r||(r=new Map,n.set(e,r));let o=r.get(i);return o||(o=[],r.set(i,o)),o}serializeRelations(t){const e={};for(const[s,i]of t.entries()){e[s]||(e[s]={});for(const[n,r]of i.entries())e[s][n]=r}return JSON.stringify(e)}serializeModelRelations(t){const e=this.relationMaps[t.uuid];return e?this.serializeRelations(e):null}serializeAllRelations(){const t={};for(const e in this.relationMaps){const s=this.relationMaps[e],i={};for(const[n,r]of s.entries()){i[n]||(i[n]={});for(const[o,a]of r.entries())i[n][o]=a}t[e]=i}return JSON.stringify(t)}getRelationsMapFromJSON(t){const e=JSON.parse(t),s=new Map;for(const i in e){const n=e[i],r=new Map;for(const o in n)r.set(Number(o),n[o]);s.set(Number(i),r)}return s}dispose(){this.relationMaps={},this.components.get(gt).onFragmentsDisposed.remove(this.onFragmentsDisposed),this.onDisposed.trigger(Un.uuid),this.onDisposed.reset()}getEntitiesWithRelation(t,e,s){const i=this.relationMaps[t.uuid];if(!i)throw new Error("IfcRelationsIndexer: the model relations are not indexed!");const n=new Set;for(const[r,o]of i){const a=this.getAttributeIndex(e),l=o.get(a);l&&l.includes(s)&&n.add(r)}return n}addEntityRelations(t,e,s,...i){const n=this.getEntityRelations(t,e,s);if(n)n.push(...i);else{const r=this.getAttributeIndex(s),o=this.relationMaps[t.uuid].get(e);o==null||o.set(r,i)}}async applyRelationChanges(){const t=this.components.get(gt),e=this.components.get(eu);for(const s in this._changeMap){const i=t.groups.get(s);if(!i)continue;const n=this._changeMap[s];for(const[r,o]of n)for(const[a,l]of o){const{related:h,relID:d}=l;if(d){const u=await i.getProperties(d);if(!u)continue;const f=Object.keys(u),I=f.find(m=>m.startsWith("Related")),E=f.find(m=>m.startsWith("Relating"));if(!(I&&E))continue;u[I]=[...h].map(m=>new _e(m)),u[E]=new _e(a),await e.setData(i,u)}else{const u=await e.createIfcRel(i,r,a,[...h]);if(!u)continue;l.relID=u.expressID}}}}addEntitiesRelation(t,e,s,...i){const{type:n,inv:r}=s;let o=this.relationMaps[t.uuid];if(o||(o=new Map,this.relationMaps[t.uuid]=o),!this._ifcRels.includes(n))return;const a=Eo.get(n);if(!a)return;const{forRelated:l,forRelating:h}=a;if(!(l===r||h===r))return;let d=this._changeMap[t.uuid];d||(d=new oe,this._changeMap[t.uuid]=d);const u=h===r?[e]:i,f=l===r?[e]:i;let I=d.get(n);I||(I=new oe,I.onItemSet.add(()=>this.onEntitiesRelated.trigger({invAttribute:r,relType:n,relatingIDs:u,relatedIDs:f})),I.onItemUpdated.add(()=>this.onEntitiesRelated.trigger({invAttribute:r,relType:n,relatingIDs:u,relatedIDs:f})),d.set(n,I));for(const E of u){let m=I.get(E);m||(m={related:new ve},I.set(E,m)),m.related.add(...f)}for(const E of u)this.getEntityRelations(t,E,h).push(...f);for(const E of f)this.getEntityRelations(t,E,l).push(...u)}getEntityChildren(t,e,s=new Set){if(s.add(e),this.relationMaps[t.uuid]===void 0)throw new Error("The provided model has no indices. You have to generate them first.");const n=this.getEntityRelations(t,e,"IsDecomposedBy");if(n)for(const o of n)this.getEntityChildren(t,o,s);const r=this.getEntityRelations(t,e,"ContainsElements");if(r)for(const o of r)this.getEntityChildren(t,o,s);return s}};p(da,"uuid","23a889ab-83b3-44a4-8bee-ead83438370b");let te=da;const Ia=class Ea extends Rt{constructor(t){super(t),p(this,"onDisposed",new q),p(this,"onFragmentsLoaded",new q),p(this,"onFragmentsDisposed",new q),p(this,"list",new oe),p(this,"groups",new oe),p(this,"baseCoordinationModel",""),p(this,"baseCoordinationMatrix",new ft),p(this,"enabled",!0),p(this,"_loader",new Lo),this.components.add(Ea.uuid,this)}get meshes(){const t=[];for(const[e,s]of this.list)t.push(s.mesh);return t}dispose(){for(const[t,e]of this.groups)e.dispose(!0);this.baseCoordinationModel="",this.groups.clear(),this.list.clear(),this.onFragmentsLoaded.reset(),this.onFragmentsDisposed.reset(),this.onDisposed.trigger(),this.onDisposed.reset()}disposeGroup(t){const{uuid:e}=t,s=[];for(const i of t.items)s.push(i.id),this.list.delete(i.id);t.dispose(!0),this.groups.delete(t.uuid),this.groups.size===0&&(this.baseCoordinationModel="",this.baseCoordinationMatrix=new ft),this.onFragmentsDisposed.trigger({groupID:e,fragmentIDs:s})}load(t,e){const i={...{coordinate:!0},...e},{coordinate:n,name:r,properties:o,relationsMap:a}=i,l=this._loader.import(t);e&&(l.isStreamed=e.isStreamed||!1),r&&(l.name=r);for(const h of l.items)h.group=l,this.list.set(h.id,h);return n&&this.coordinate([l]),this.groups.set(l.uuid,l),o&&l.setLocalProperties(o),a&&this.components.get(te).setRelationMap(l,a),this.onFragmentsLoaded.trigger(l),l}export(t){return this._loader.export(t)}getModelIdMap(t){const e={};for(const s in t){const i=this.list.get(s);if(!(i&&i.group))continue;const n=i.group;n.uuid in e||(e[n.uuid]=new Set);const r=t[s];for(const o of r)e[n.uuid].add(o)}return e}modelIdToFragmentIdMap(t){let e={};for(const s in t){const i=this.groups.get(s);if(!i)continue;const n=t[s],r=i.getFragmentMap(n);e={...e,...r}}return e}guidToFragmentIdMap(t){const e={};for(const[i,n]of this.groups){i in e||(e[i]=new Set);for(const r of t){const o=n.globalToExpressIDs.get(r);o&&e[i].add(o)}}return this.modelIdToFragmentIdMap(e)}fragmentIdMapToGuids(t){const e=[],s=this.getModelIdMap(t);for(const i in s){const n=this.groups.get(i);if(!n)continue;const r=s[i];for(const o of r)for(const[a,l]of n.globalToExpressIDs.entries())if(l===o){e.push(a);break}}return e}coordinate(t=Array.from(this.groups.values())){if(this.baseCoordinationModel.length===0){const s=t.pop();if(!s)return;this.baseCoordinationModel=s.uuid,this.baseCoordinationMatrix=s.coordinationMatrix.clone()}if(t.length)for(const s of t)s.coordinationMatrix.equals(this.baseCoordinationMatrix)||(s.position.set(0,0,0),s.rotation.set(0,0,0),s.scale.set(1,1,1),s.updateMatrix(),this.applyBaseCoordinateSystem(s,s.coordinationMatrix))}applyBaseCoordinateSystem(t,e){e&&t.applyMatrix4(e.clone().invert()),t.applyMatrix4(this.baseCoordinationMatrix)}clone(t,e){const s=t.cloneGroup(e);this.groups.set(s.uuid,s);for(const i of s.items)this.list.set(i.id,i);return s}};p(Ia,"uuid","fef46874-46a3-461b-8c44-2922ab77c806");let gt=Ia;function _i(c){throw new Error('Could not dynamically require "'+c+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pa={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(c,t){(function(e){c.exports=e()})(function(){return function e(s,i,n){function r(l,h){if(!i[l]){if(!s[l]){var d=typeof _i=="function"&&_i;if(!h&&d)return d(l,!0);if(o)return o(l,!0);var u=new Error("Cannot find module '"+l+"'");throw u.code="MODULE_NOT_FOUND",u}var f=i[l]={exports:{}};s[l][0].call(f.exports,function(I){var E=s[l][1][I];return r(E||I)},f,f.exports,e,s,i,n)}return i[l].exports}for(var o=typeof _i=="function"&&_i,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(e,s,i){var n=e("./utils"),r=e("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(a){for(var l,h,d,u,f,I,E,m=[],C=0,g=a.length,S=g,T=n.getTypeOf(a)!=="string";C<a.length;)S=g-C,d=T?(l=a[C++],h=C<g?a[C++]:0,C<g?a[C++]:0):(l=a.charCodeAt(C++),h=C<g?a.charCodeAt(C++):0,C<g?a.charCodeAt(C++):0),u=l>>2,f=(3&l)<<4|h>>4,I=1<S?(15&h)<<2|d>>6:64,E=2<S?63&d:64,m.push(o.charAt(u)+o.charAt(f)+o.charAt(I)+o.charAt(E));return m.join("")},i.decode=function(a){var l,h,d,u,f,I,E=0,m=0,C="data:";if(a.substr(0,C.length)===C)throw new Error("Invalid base64 input, it looks like a data url.");var g,S=3*(a=a.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(a.charAt(a.length-1)===o.charAt(64)&&S--,a.charAt(a.length-2)===o.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(g=r.uint8array?new Uint8Array(0|S):new Array(0|S);E<a.length;)l=o.indexOf(a.charAt(E++))<<2|(u=o.indexOf(a.charAt(E++)))>>4,h=(15&u)<<4|(f=o.indexOf(a.charAt(E++)))>>2,d=(3&f)<<6|(I=o.indexOf(a.charAt(E++))),g[m++]=l,f!==64&&(g[m++]=h),I!==64&&(g[m++]=d);return g}},{"./support":30,"./utils":32}],2:[function(e,s,i){var n=e("./external"),r=e("./stream/DataWorker"),o=e("./stream/Crc32Probe"),a=e("./stream/DataLengthProbe");function l(h,d,u,f,I){this.compressedSize=h,this.uncompressedSize=d,this.crc32=u,this.compression=f,this.compressedContent=I}l.prototype={getContentWorker:function(){var h=new r(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),d=this;return h.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new r(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},l.createWorkerFrom=function(h,d,u){return h.pipe(new o).pipe(new a("uncompressedSize")).pipe(d.compressWorker(u)).pipe(new a("compressedSize")).withStreamInfo("compression",d)},s.exports=l},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,s,i){var n=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,s,i){var n=e("./utils"),r=function(){for(var o,a=[],l=0;l<256;l++){o=l;for(var h=0;h<8;h++)o=1&o?3988292384^o>>>1:o>>>1;a[l]=o}return a}();s.exports=function(o,a){return o!==void 0&&o.length?n.getTypeOf(o)!=="string"?function(l,h,d,u){var f=r,I=u+d;l^=-1;for(var E=u;E<I;E++)l=l>>>8^f[255&(l^h[E])];return-1^l}(0|a,o,o.length,0):function(l,h,d,u){var f=r,I=u+d;l^=-1;for(var E=u;E<I;E++)l=l>>>8^f[255&(l^h.charCodeAt(E))];return-1^l}(0|a,o,o.length,0):0}},{"./utils":32}],5:[function(e,s,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(e,s,i){var n=null;n=typeof Promise<"u"?Promise:e("lie"),s.exports={Promise:n}},{lie:37}],7:[function(e,s,i){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",r=e("pako"),o=e("./utils"),a=e("./stream/GenericWorker"),l=n?"uint8array":"array";function h(d,u){a.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=u,this.meta={}}i.magic="\b\0",o.inherits(h,a),h.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(l,d.data),!1)},h.prototype.flush=function(){a.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(u){d.push({data:u,meta:d.meta})}},i.compressWorker=function(d){return new h("Deflate",d)},i.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,s,i){function n(f,I){var E,m="";for(E=0;E<I;E++)m+=String.fromCharCode(255&f),f>>>=8;return m}function r(f,I,E,m,C,g){var S,T,F=f.file,y=f.compression,N=g!==l.utf8encode,w=o.transformTo("string",g(F.name)),P=o.transformTo("string",l.utf8encode(F.name)),M=F.comment,x=o.transformTo("string",g(M)),O=o.transformTo("string",l.utf8encode(M)),v=P.length!==F.name.length,R=O.length!==M.length,D="",X="",U="",j=F.dir,k=F.date,J={crc32:0,compressedSize:0,uncompressedSize:0};I&&!E||(J.crc32=f.crc32,J.compressedSize=f.compressedSize,J.uncompressedSize=f.uncompressedSize);var Y=0;I&&(Y|=8),N||!v&&!R||(Y|=2048);var V=0,nt=0;j&&(V|=16),C==="UNIX"?(nt=798,V|=function(tt,Ft){var Nt=tt;return tt||(Nt=Ft?16893:33204),(65535&Nt)<<16}(F.unixPermissions,j)):(nt=20,V|=function(tt){return 63&(tt||0)}(F.dosPermissions)),S=k.getUTCHours(),S<<=6,S|=k.getUTCMinutes(),S<<=5,S|=k.getUTCSeconds()/2,T=k.getUTCFullYear()-1980,T<<=4,T|=k.getUTCMonth()+1,T<<=5,T|=k.getUTCDate(),v&&(X=n(1,1)+n(h(w),4)+P,D+="up"+n(X.length,2)+X),R&&(U=n(1,1)+n(h(x),4)+O,D+="uc"+n(U.length,2)+U);var et="";return et+=`
\0`,et+=n(Y,2),et+=y.magic,et+=n(S,2),et+=n(T,2),et+=n(J.crc32,4),et+=n(J.compressedSize,4),et+=n(J.uncompressedSize,4),et+=n(w.length,2),et+=n(D.length,2),{fileRecord:d.LOCAL_FILE_HEADER+et+w+D,dirRecord:d.CENTRAL_FILE_HEADER+n(nt,2)+et+n(x.length,2)+"\0\0\0\0"+n(V,4)+n(m,4)+w+D+x}}var o=e("../utils"),a=e("../stream/GenericWorker"),l=e("../utf8"),h=e("../crc32"),d=e("../signature");function u(f,I,E,m){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=I,this.zipPlatform=E,this.encodeFileName=m,this.streamFiles=f,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(u,a),u.prototype.push=function(f){var I=f.meta.percent||0,E=this.entriesCount,m=this._sources.length;this.accumulate?this.contentBuffer.push(f):(this.bytesWritten+=f.data.length,a.prototype.push.call(this,{data:f.data,meta:{currentFile:this.currentFile,percent:E?(I+100*(E-m-1))/E:100}}))},u.prototype.openedSource=function(f){this.currentSourceOffset=this.bytesWritten,this.currentFile=f.file.name;var I=this.streamFiles&&!f.file.dir;if(I){var E=r(f,I,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:E.fileRecord,meta:{percent:0}})}else this.accumulate=!0},u.prototype.closedSource=function(f){this.accumulate=!1;var I=this.streamFiles&&!f.file.dir,E=r(f,I,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(E.dirRecord),I)this.push({data:function(m){return d.DATA_DESCRIPTOR+n(m.crc32,4)+n(m.compressedSize,4)+n(m.uncompressedSize,4)}(f),meta:{percent:100}});else for(this.push({data:E.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var f=this.bytesWritten,I=0;I<this.dirRecords.length;I++)this.push({data:this.dirRecords[I],meta:{percent:100}});var E=this.bytesWritten-f,m=function(C,g,S,T,F){var y=o.transformTo("string",F(T));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(C,2)+n(C,2)+n(g,4)+n(S,4)+n(y.length,2)+y}(this.dirRecords.length,E,f,this.zipComment,this.encodeFileName);this.push({data:m,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(f){this._sources.push(f);var I=this;return f.on("data",function(E){I.processChunk(E)}),f.on("end",function(){I.closedSource(I.previous.streamInfo),I._sources.length?I.prepareNextSource():I.end()}),f.on("error",function(E){I.error(E)}),this},u.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(f){var I=this._sources;if(!a.prototype.error.call(this,f))return!1;for(var E=0;E<I.length;E++)try{I[E].error(f)}catch{}return!0},u.prototype.lock=function(){a.prototype.lock.call(this);for(var f=this._sources,I=0;I<f.length;I++)f[I].lock()},s.exports=u},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,s,i){var n=e("../compressions"),r=e("./ZipFileWorker");i.generateWorker=function(o,a,l){var h=new r(a.streamFiles,l,a.platform,a.encodeFileName),d=0;try{o.forEach(function(u,f){d++;var I=function(g,S){var T=g||S,F=n[T];if(!F)throw new Error(T+" is not a valid compression method !");return F}(f.options.compression,a.compression),E=f.options.compressionOptions||a.compressionOptions||{},m=f.dir,C=f.date;f._compressWorker(I,E).withStreamInfo("file",{name:u,dir:m,date:C,comment:f.comment||"",unixPermissions:f.unixPermissions,dosPermissions:f.dosPermissions}).pipe(h)}),h.entriesCount=d}catch(u){h.error(u)}return h}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,s,i){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var r=new n;for(var o in this)typeof this[o]!="function"&&(r[o]=this[o]);return r}}(n.prototype=e("./object")).loadAsync=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.version="3.10.1",n.loadAsync=function(r,o){return new n().loadAsync(r,o)},n.external=e("./external"),s.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,s,i){var n=e("./utils"),r=e("./external"),o=e("./utf8"),a=e("./zipEntries"),l=e("./stream/Crc32Probe"),h=e("./nodejsUtils");function d(u){return new r.Promise(function(f,I){var E=u.decompressed.getContentWorker().pipe(new l);E.on("error",function(m){I(m)}).on("end",function(){E.streamInfo.crc32!==u.decompressed.crc32?I(new Error("Corrupted zip : CRC32 mismatch")):f()}).resume()})}s.exports=function(u,f){var I=this;return f=n.extend(f||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),h.isNode&&h.isStream(u)?r.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",u,!0,f.optimizedBinaryString,f.base64).then(function(E){var m=new a(f);return m.load(E),m}).then(function(E){var m=[r.Promise.resolve(E)],C=E.files;if(f.checkCRC32)for(var g=0;g<C.length;g++)m.push(d(C[g]));return r.Promise.all(m)}).then(function(E){for(var m=E.shift(),C=m.files,g=0;g<C.length;g++){var S=C[g],T=S.fileNameStr,F=n.resolve(S.fileNameStr);I.file(F,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:f.createFolders}),S.dir||(I.file(F).unsafeOriginalName=T)}return m.zipComment.length&&(I.comment=m.zipComment),I})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,s,i){var n=e("../utils"),r=e("../stream/GenericWorker");function o(a,l){r.call(this,"Nodejs stream input adapter for "+a),this._upstreamEnded=!1,this._bindStream(l)}n.inherits(o,r),o.prototype._bindStream=function(a){var l=this;(this._stream=a).pause(),a.on("data",function(h){l.push({data:h,meta:{percent:0}})}).on("error",function(h){l.isPaused?this.generatedError=h:l.error(h)}).on("end",function(){l.isPaused?l._upstreamEnded=!0:l.end()})},o.prototype.pause=function(){return!!r.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},s.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,s,i){var n=e("readable-stream").Readable;function r(o,a,l){n.call(this,a),this._helper=o;var h=this;o.on("data",function(d,u){h.push(d)||h._helper.pause(),l&&l(u)}).on("error",function(d){h.emit("error",d)}).on("end",function(){h.push(null)})}e("../utils").inherits(r,n),r.prototype._read=function(){this._helper.resume()},s.exports=r},{"../utils":32,"readable-stream":16}],14:[function(e,s,i){s.exports={isNode:typeof Buffer<"u",newBufferFrom:function(n,r){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,r);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,r)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var r=new Buffer(n);return r.fill(0),r},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(e,s,i){function n(F,y,N){var w,P=o.getTypeOf(y),M=o.extend(N||{},h);M.date=M.date||new Date,M.compression!==null&&(M.compression=M.compression.toUpperCase()),typeof M.unixPermissions=="string"&&(M.unixPermissions=parseInt(M.unixPermissions,8)),M.unixPermissions&&16384&M.unixPermissions&&(M.dir=!0),M.dosPermissions&&16&M.dosPermissions&&(M.dir=!0),M.dir&&(F=C(F)),M.createFolders&&(w=m(F))&&g.call(this,w,!0);var x=P==="string"&&M.binary===!1&&M.base64===!1;N&&N.binary!==void 0||(M.binary=!x),(y instanceof d&&y.uncompressedSize===0||M.dir||!y||y.length===0)&&(M.base64=!1,M.binary=!0,y="",M.compression="STORE",P="string");var O=null;O=y instanceof d||y instanceof a?y:I.isNode&&I.isStream(y)?new E(F,y):o.prepareContent(F,y,M.binary,M.optimizedBinaryString,M.base64);var v=new u(F,O,M);this.files[F]=v}var r=e("./utf8"),o=e("./utils"),a=e("./stream/GenericWorker"),l=e("./stream/StreamHelper"),h=e("./defaults"),d=e("./compressedObject"),u=e("./zipObject"),f=e("./generate"),I=e("./nodejsUtils"),E=e("./nodejs/NodejsStreamInputAdapter"),m=function(F){F.slice(-1)==="/"&&(F=F.substring(0,F.length-1));var y=F.lastIndexOf("/");return 0<y?F.substring(0,y):""},C=function(F){return F.slice(-1)!=="/"&&(F+="/"),F},g=function(F,y){return y=y!==void 0?y:h.createFolders,F=C(F),this.files[F]||n.call(this,F,null,{dir:!0,createFolders:y}),this.files[F]};function S(F){return Object.prototype.toString.call(F)==="[object RegExp]"}var T={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(F){var y,N,w;for(y in this.files)w=this.files[y],(N=y.slice(this.root.length,y.length))&&y.slice(0,this.root.length)===this.root&&F(N,w)},filter:function(F){var y=[];return this.forEach(function(N,w){F(N,w)&&y.push(w)}),y},file:function(F,y,N){if(arguments.length!==1)return F=this.root+F,n.call(this,F,y,N),this;if(S(F)){var w=F;return this.filter(function(M,x){return!x.dir&&w.test(M)})}var P=this.files[this.root+F];return P&&!P.dir?P:null},folder:function(F){if(!F)return this;if(S(F))return this.filter(function(P,M){return M.dir&&F.test(P)});var y=this.root+F,N=g.call(this,y),w=this.clone();return w.root=N.name,w},remove:function(F){F=this.root+F;var y=this.files[F];if(y||(F.slice(-1)!=="/"&&(F+="/"),y=this.files[F]),y&&!y.dir)delete this.files[F];else for(var N=this.filter(function(P,M){return M.name.slice(0,F.length)===F}),w=0;w<N.length;w++)delete this.files[N[w].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(F){var y,N={};try{if((N=o.extend(F||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=N.type.toLowerCase(),N.compression=N.compression.toUpperCase(),N.type==="binarystring"&&(N.type="string"),!N.type)throw new Error("No output type specified.");o.checkSupport(N.type),N.platform!=="darwin"&&N.platform!=="freebsd"&&N.platform!=="linux"&&N.platform!=="sunos"||(N.platform="UNIX"),N.platform==="win32"&&(N.platform="DOS");var w=N.comment||this.comment||"";y=f.generateWorker(this,N,w)}catch(P){(y=new a("error")).error(P)}return new l(y,N.type||"string",N.mimeType)},generateAsync:function(F,y){return this.generateInternalStream(F).accumulate(y)},generateNodeStream:function(F,y){return(F=F||{}).type||(F.type="nodebuffer"),this.generateInternalStream(F).toNodejsStream(y)}};s.exports=T},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,s,i){s.exports=e("stream")},{stream:void 0}],17:[function(e,s,i){var n=e("./DataReader");function r(o){n.call(this,o);for(var a=0;a<this.data.length;a++)o[a]=255&o[a]}e("../utils").inherits(r,n),r.prototype.byteAt=function(o){return this.data[this.zero+o]},r.prototype.lastIndexOfSignature=function(o){for(var a=o.charCodeAt(0),l=o.charCodeAt(1),h=o.charCodeAt(2),d=o.charCodeAt(3),u=this.length-4;0<=u;--u)if(this.data[u]===a&&this.data[u+1]===l&&this.data[u+2]===h&&this.data[u+3]===d)return u-this.zero;return-1},r.prototype.readAndCheckSignature=function(o){var a=o.charCodeAt(0),l=o.charCodeAt(1),h=o.charCodeAt(2),d=o.charCodeAt(3),u=this.readData(4);return a===u[0]&&l===u[1]&&h===u[2]&&d===u[3]},r.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var a=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,a},s.exports=r},{"../utils":32,"./DataReader":18}],18:[function(e,s,i){var n=e("../utils");function r(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var a,l=0;for(this.checkOffset(o),a=this.index+o-1;a>=this.index;a--)l=(l<<8)+this.byteAt(a);return this.index+=o,l},readString:function(o){return n.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},s.exports=r},{"../utils":32}],19:[function(e,s,i){var n=e("./Uint8ArrayReader");function r(o){n.call(this,o)}e("../utils").inherits(r,n),r.prototype.readData=function(o){this.checkOffset(o);var a=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,a},s.exports=r},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,s,i){var n=e("./DataReader");function r(o){n.call(this,o)}e("../utils").inherits(r,n),r.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},r.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},r.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},r.prototype.readData=function(o){this.checkOffset(o);var a=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,a},s.exports=r},{"../utils":32,"./DataReader":18}],21:[function(e,s,i){var n=e("./ArrayReader");function r(o){n.call(this,o)}e("../utils").inherits(r,n),r.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var a=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,a},s.exports=r},{"../utils":32,"./ArrayReader":17}],22:[function(e,s,i){var n=e("../utils"),r=e("../support"),o=e("./ArrayReader"),a=e("./StringReader"),l=e("./NodeBufferReader"),h=e("./Uint8ArrayReader");s.exports=function(d){var u=n.getTypeOf(d);return n.checkSupport(u),u!=="string"||r.uint8array?u==="nodebuffer"?new l(d):r.uint8array?new h(n.transformTo("uint8array",d)):new o(n.transformTo("array",d)):new a(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,s,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,s,i){var n=e("./GenericWorker"),r=e("../utils");function o(a){n.call(this,"ConvertWorker to "+a),this.destType=a}r.inherits(o,n),o.prototype.processChunk=function(a){this.push({data:r.transformTo(this.destType,a.data),meta:a.meta})},s.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(e,s,i){var n=e("./GenericWorker"),r=e("../crc32");function o(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(o,n),o.prototype.processChunk=function(a){this.streamInfo.crc32=r(a.data,this.streamInfo.crc32||0),this.push(a)},s.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,s,i){var n=e("../utils"),r=e("./GenericWorker");function o(a){r.call(this,"DataLengthProbe for "+a),this.propName=a,this.withStreamInfo(a,0)}n.inherits(o,r),o.prototype.processChunk=function(a){if(a){var l=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=l+a.data.length}r.prototype.processChunk.call(this,a)},s.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(e,s,i){var n=e("../utils"),r=e("./GenericWorker");function o(a){r.call(this,"DataWorker");var l=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,a.then(function(h){l.dataIsReady=!0,l.data=h,l.max=h&&h.length||0,l.type=n.getTypeOf(h),l.isPaused||l._tickAndRepeat()},function(h){l.error(h)})}n.inherits(o,r),o.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var a=null,l=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":a=this.data.substring(this.index,l);break;case"uint8array":a=this.data.subarray(this.index,l);break;case"array":case"nodebuffer":a=this.data.slice(this.index,l)}return this.index=l,this.push({data:a,meta:{percent:this.max?this.index/this.max*100:0}})},s.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(e,s,i){function n(r){this.name=r||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(r){this.emit("data",r)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(r){this.emit("error",r)}return!0},error:function(r){return!this.isFinished&&(this.isPaused?this.generatedError=r:(this.isFinished=!0,this.emit("error",r),this.previous&&this.previous.error(r),this.cleanUp()),!0)},on:function(r,o){return this._listeners[r].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(r,o){if(this._listeners[r])for(var a=0;a<this._listeners[r].length;a++)this._listeners[r][a].call(this,o)},pipe:function(r){return r.registerPrevious(this)},registerPrevious:function(r){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=r.streamInfo,this.mergeStreamInfo(),this.previous=r;var o=this;return r.on("data",function(a){o.processChunk(a)}),r.on("end",function(){o.end()}),r.on("error",function(a){o.error(a)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var r=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),r=!0),this.previous&&this.previous.resume(),!r},flush:function(){},processChunk:function(r){this.push(r)},withStreamInfo:function(r,o){return this.extraStreamInfo[r]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var r in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,r)&&(this.streamInfo[r]=this.extraStreamInfo[r])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var r="Worker "+this.name;return this.previous?this.previous+" -> "+r:r}},s.exports=n},{}],29:[function(e,s,i){var n=e("../utils"),r=e("./ConvertWorker"),o=e("./GenericWorker"),a=e("../base64"),l=e("../support"),h=e("../external"),d=null;if(l.nodestream)try{d=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function u(I,E){return new h.Promise(function(m,C){var g=[],S=I._internalType,T=I._outputType,F=I._mimeType;I.on("data",function(y,N){g.push(y),E&&E(N)}).on("error",function(y){g=[],C(y)}).on("end",function(){try{var y=function(N,w,P){switch(N){case"blob":return n.newBlob(n.transformTo("arraybuffer",w),P);case"base64":return a.encode(w);default:return n.transformTo(N,w)}}(T,function(N,w){var P,M=0,x=null,O=0;for(P=0;P<w.length;P++)O+=w[P].length;switch(N){case"string":return w.join("");case"array":return Array.prototype.concat.apply([],w);case"uint8array":for(x=new Uint8Array(O),P=0;P<w.length;P++)x.set(w[P],M),M+=w[P].length;return x;case"nodebuffer":return Buffer.concat(w);default:throw new Error("concat : unsupported type '"+N+"'")}}(S,g),F);m(y)}catch(N){C(N)}g=[]}).resume()})}function f(I,E,m){var C=E;switch(E){case"blob":case"arraybuffer":C="uint8array";break;case"base64":C="string"}try{this._internalType=C,this._outputType=E,this._mimeType=m,n.checkSupport(C),this._worker=I.pipe(new r(C)),I.lock()}catch(g){this._worker=new o("error"),this._worker.error(g)}}f.prototype={accumulate:function(I){return u(this,I)},on:function(I,E){var m=this;return I==="data"?this._worker.on(I,function(C){E.call(m,C.data,C.meta)}):this._worker.on(I,function(){n.delay(E,arguments,m)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(I){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},I)}},s.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,s,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var n=new ArrayBuffer(0);try{i.blob=new Blob([n],{type:"application/zip"}).size===0}catch{try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(n),i.blob=r.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(e,s,i){for(var n=e("./utils"),r=e("./support"),o=e("./nodejsUtils"),a=e("./stream/GenericWorker"),l=new Array(256),h=0;h<256;h++)l[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;l[254]=l[254]=1;function d(){a.call(this,"utf-8 decode"),this.leftOver=null}function u(){a.call(this,"utf-8 encode")}i.utf8encode=function(f){return r.nodebuffer?o.newBufferFrom(f,"utf-8"):function(I){var E,m,C,g,S,T=I.length,F=0;for(g=0;g<T;g++)(64512&(m=I.charCodeAt(g)))==55296&&g+1<T&&(64512&(C=I.charCodeAt(g+1)))==56320&&(m=65536+(m-55296<<10)+(C-56320),g++),F+=m<128?1:m<2048?2:m<65536?3:4;for(E=r.uint8array?new Uint8Array(F):new Array(F),g=S=0;S<F;g++)(64512&(m=I.charCodeAt(g)))==55296&&g+1<T&&(64512&(C=I.charCodeAt(g+1)))==56320&&(m=65536+(m-55296<<10)+(C-56320),g++),m<128?E[S++]=m:(m<2048?E[S++]=192|m>>>6:(m<65536?E[S++]=224|m>>>12:(E[S++]=240|m>>>18,E[S++]=128|m>>>12&63),E[S++]=128|m>>>6&63),E[S++]=128|63&m);return E}(f)},i.utf8decode=function(f){return r.nodebuffer?n.transformTo("nodebuffer",f).toString("utf-8"):function(I){var E,m,C,g,S=I.length,T=new Array(2*S);for(E=m=0;E<S;)if((C=I[E++])<128)T[m++]=C;else if(4<(g=l[C]))T[m++]=65533,E+=g-1;else{for(C&=g===2?31:g===3?15:7;1<g&&E<S;)C=C<<6|63&I[E++],g--;1<g?T[m++]=65533:C<65536?T[m++]=C:(C-=65536,T[m++]=55296|C>>10&1023,T[m++]=56320|1023&C)}return T.length!==m&&(T.subarray?T=T.subarray(0,m):T.length=m),n.applyFromCharCode(T)}(f=n.transformTo(r.uint8array?"uint8array":"array",f))},n.inherits(d,a),d.prototype.processChunk=function(f){var I=n.transformTo(r.uint8array?"uint8array":"array",f.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var E=I;(I=new Uint8Array(E.length+this.leftOver.length)).set(this.leftOver,0),I.set(E,this.leftOver.length)}else I=this.leftOver.concat(I);this.leftOver=null}var m=function(g,S){var T;for((S=S||g.length)>g.length&&(S=g.length),T=S-1;0<=T&&(192&g[T])==128;)T--;return T<0||T===0?S:T+l[g[T]]>S?T:S}(I),C=I;m!==I.length&&(r.uint8array?(C=I.subarray(0,m),this.leftOver=I.subarray(m,I.length)):(C=I.slice(0,m),this.leftOver=I.slice(m,I.length))),this.push({data:i.utf8decode(C),meta:f.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=d,n.inherits(u,a),u.prototype.processChunk=function(f){this.push({data:i.utf8encode(f.data),meta:f.meta})},i.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,s,i){var n=e("./support"),r=e("./base64"),o=e("./nodejsUtils"),a=e("./external");function l(E){return E}function h(E,m){for(var C=0;C<E.length;++C)m[C]=255&E.charCodeAt(C);return m}e("setimmediate"),i.newBlob=function(E,m){i.checkSupport("blob");try{return new Blob([E],{type:m})}catch{try{var C=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return C.append(E),C.getBlob(m)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(E,m,C){var g=[],S=0,T=E.length;if(T<=C)return String.fromCharCode.apply(null,E);for(;S<T;)m==="array"||m==="nodebuffer"?g.push(String.fromCharCode.apply(null,E.slice(S,Math.min(S+C,T)))):g.push(String.fromCharCode.apply(null,E.subarray(S,Math.min(S+C,T)))),S+=C;return g.join("")},stringifyByChar:function(E){for(var m="",C=0;C<E.length;C++)m+=String.fromCharCode(E[C]);return m},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function u(E){var m=65536,C=i.getTypeOf(E),g=!0;if(C==="uint8array"?g=d.applyCanBeUsed.uint8array:C==="nodebuffer"&&(g=d.applyCanBeUsed.nodebuffer),g)for(;1<m;)try{return d.stringifyByChunk(E,C,m)}catch{m=Math.floor(m/2)}return d.stringifyByChar(E)}function f(E,m){for(var C=0;C<E.length;C++)m[C]=E[C];return m}i.applyFromCharCode=u;var I={};I.string={string:l,array:function(E){return h(E,new Array(E.length))},arraybuffer:function(E){return I.string.uint8array(E).buffer},uint8array:function(E){return h(E,new Uint8Array(E.length))},nodebuffer:function(E){return h(E,o.allocBuffer(E.length))}},I.array={string:u,array:l,arraybuffer:function(E){return new Uint8Array(E).buffer},uint8array:function(E){return new Uint8Array(E)},nodebuffer:function(E){return o.newBufferFrom(E)}},I.arraybuffer={string:function(E){return u(new Uint8Array(E))},array:function(E){return f(new Uint8Array(E),new Array(E.byteLength))},arraybuffer:l,uint8array:function(E){return new Uint8Array(E)},nodebuffer:function(E){return o.newBufferFrom(new Uint8Array(E))}},I.uint8array={string:u,array:function(E){return f(E,new Array(E.length))},arraybuffer:function(E){return E.buffer},uint8array:l,nodebuffer:function(E){return o.newBufferFrom(E)}},I.nodebuffer={string:u,array:function(E){return f(E,new Array(E.length))},arraybuffer:function(E){return I.nodebuffer.uint8array(E).buffer},uint8array:function(E){return f(E,new Uint8Array(E.length))},nodebuffer:l},i.transformTo=function(E,m){if(m=m||"",!E)return m;i.checkSupport(E);var C=i.getTypeOf(m);return I[C][E](m)},i.resolve=function(E){for(var m=E.split("/"),C=[],g=0;g<m.length;g++){var S=m[g];S==="."||S===""&&g!==0&&g!==m.length-1||(S===".."?C.pop():C.push(S))}return C.join("/")},i.getTypeOf=function(E){return typeof E=="string"?"string":Object.prototype.toString.call(E)==="[object Array]"?"array":n.nodebuffer&&o.isBuffer(E)?"nodebuffer":n.uint8array&&E instanceof Uint8Array?"uint8array":n.arraybuffer&&E instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(E){if(!n[E.toLowerCase()])throw new Error(E+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(E){var m,C,g="";for(C=0;C<(E||"").length;C++)g+="\\x"+((m=E.charCodeAt(C))<16?"0":"")+m.toString(16).toUpperCase();return g},i.delay=function(E,m,C){setImmediate(function(){E.apply(C||null,m||[])})},i.inherits=function(E,m){function C(){}C.prototype=m.prototype,E.prototype=new C},i.extend=function(){var E,m,C={};for(E=0;E<arguments.length;E++)for(m in arguments[E])Object.prototype.hasOwnProperty.call(arguments[E],m)&&C[m]===void 0&&(C[m]=arguments[E][m]);return C},i.prepareContent=function(E,m,C,g,S){return a.Promise.resolve(m).then(function(T){return n.blob&&(T instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(T))!==-1)&&typeof FileReader<"u"?new a.Promise(function(F,y){var N=new FileReader;N.onload=function(w){F(w.target.result)},N.onerror=function(w){y(w.target.error)},N.readAsArrayBuffer(T)}):T}).then(function(T){var F=i.getTypeOf(T);return F?(F==="arraybuffer"?T=i.transformTo("uint8array",T):F==="string"&&(S?T=r.decode(T):C&&g!==!0&&(T=function(y){return h(y,n.uint8array?new Uint8Array(y.length):new Array(y.length))}(T))),T):a.Promise.reject(new Error("Can't read the data of '"+E+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,s,i){var n=e("./reader/readerFor"),r=e("./utils"),o=e("./signature"),a=e("./zipEntry"),l=e("./support");function h(d){this.files=[],this.loadOptions=d}h.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var u=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(u)+", expected "+r.pretty(d)+")")}},isSignature:function(d,u){var f=this.reader.index;this.reader.setIndex(d);var I=this.reader.readString(4)===u;return this.reader.setIndex(f),I},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),u=l.uint8array?"uint8array":"array",f=r.transformTo(u,d);this.zipComment=this.loadOptions.decodeFileName(f)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,u,f,I=this.zip64EndOfCentralSize-44;0<I;)d=this.reader.readInt(2),u=this.reader.readInt(4),f=this.reader.readData(u),this.zip64ExtensibleData[d]={id:d,length:u,value:f}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,u;for(d=0;d<this.files.length;d++)u=this.files[d],this.reader.setIndex(u.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),u.readLocalPart(this.reader),u.handleUTF8(),u.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(d=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var u=d;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var f=this.centralDirOffset+this.centralDirSize;this.zip64&&(f+=20,f+=12+this.zip64EndOfCentralSize);var I=u-f;if(0<I)this.isSignature(u,o.CENTRAL_FILE_HEADER)||(this.reader.zero=I);else if(I<0)throw new Error("Corrupted zip: missing "+Math.abs(I)+" bytes.")},prepareReader:function(d){this.reader=n(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},s.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,s,i){var n=e("./reader/readerFor"),r=e("./utils"),o=e("./compressedObject"),a=e("./crc32"),l=e("./utf8"),h=e("./compressions"),d=e("./support");function u(f,I){this.options=f,this.loadOptions=I}u.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(f){var I,E;if(f.skip(22),this.fileNameLength=f.readInt(2),E=f.readInt(2),this.fileName=f.readData(this.fileNameLength),f.skip(E),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((I=function(m){for(var C in h)if(Object.prototype.hasOwnProperty.call(h,C)&&h[C].magic===m)return h[C];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+r.pretty(this.compressionMethod)+" unknown (inner file : "+r.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,I,f.readData(this.compressedSize))},readCentralPart:function(f){this.versionMadeBy=f.readInt(2),f.skip(2),this.bitFlag=f.readInt(2),this.compressionMethod=f.readString(2),this.date=f.readDate(),this.crc32=f.readInt(4),this.compressedSize=f.readInt(4),this.uncompressedSize=f.readInt(4);var I=f.readInt(2);if(this.extraFieldsLength=f.readInt(2),this.fileCommentLength=f.readInt(2),this.diskNumberStart=f.readInt(2),this.internalFileAttributes=f.readInt(2),this.externalFileAttributes=f.readInt(4),this.localHeaderOffset=f.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");f.skip(I),this.readExtraFields(f),this.parseZIP64ExtraField(f),this.fileComment=f.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var f=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),f==0&&(this.dosPermissions=63&this.externalFileAttributes),f==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var f=n(this.extraFields[1].value);this.uncompressedSize===r.MAX_VALUE_32BITS&&(this.uncompressedSize=f.readInt(8)),this.compressedSize===r.MAX_VALUE_32BITS&&(this.compressedSize=f.readInt(8)),this.localHeaderOffset===r.MAX_VALUE_32BITS&&(this.localHeaderOffset=f.readInt(8)),this.diskNumberStart===r.MAX_VALUE_32BITS&&(this.diskNumberStart=f.readInt(4))}},readExtraFields:function(f){var I,E,m,C=f.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});f.index+4<C;)I=f.readInt(2),E=f.readInt(2),m=f.readData(E),this.extraFields[I]={id:I,length:E,value:m};f.setIndex(C)},handleUTF8:function(){var f=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=l.utf8decode(this.fileName),this.fileCommentStr=l.utf8decode(this.fileComment);else{var I=this.findExtraFieldUnicodePath();if(I!==null)this.fileNameStr=I;else{var E=r.transformTo(f,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(E)}var m=this.findExtraFieldUnicodeComment();if(m!==null)this.fileCommentStr=m;else{var C=r.transformTo(f,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(C)}}},findExtraFieldUnicodePath:function(){var f=this.extraFields[28789];if(f){var I=n(f.value);return I.readInt(1)!==1||a(this.fileName)!==I.readInt(4)?null:l.utf8decode(I.readData(f.length-5))}return null},findExtraFieldUnicodeComment:function(){var f=this.extraFields[25461];if(f){var I=n(f.value);return I.readInt(1)!==1||a(this.fileComment)!==I.readInt(4)?null:l.utf8decode(I.readData(f.length-5))}return null}},s.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,s,i){function n(I,E,m){this.name=I,this.dir=m.dir,this.date=m.date,this.comment=m.comment,this.unixPermissions=m.unixPermissions,this.dosPermissions=m.dosPermissions,this._data=E,this._dataBinary=m.binary,this.options={compression:m.compression,compressionOptions:m.compressionOptions}}var r=e("./stream/StreamHelper"),o=e("./stream/DataWorker"),a=e("./utf8"),l=e("./compressedObject"),h=e("./stream/GenericWorker");n.prototype={internalStream:function(I){var E=null,m="string";try{if(!I)throw new Error("No output type specified.");var C=(m=I.toLowerCase())==="string"||m==="text";m!=="binarystring"&&m!=="text"||(m="string"),E=this._decompressWorker();var g=!this._dataBinary;g&&!C&&(E=E.pipe(new a.Utf8EncodeWorker)),!g&&C&&(E=E.pipe(new a.Utf8DecodeWorker))}catch(S){(E=new h("error")).error(S)}return new r(E,m,"")},async:function(I,E){return this.internalStream(I).accumulate(E)},nodeStream:function(I,E){return this.internalStream(I||"nodebuffer").toNodejsStream(E)},_compressWorker:function(I,E){if(this._data instanceof l&&this._data.compression.magic===I.magic)return this._data.getCompressedWorker();var m=this._decompressWorker();return this._dataBinary||(m=m.pipe(new a.Utf8EncodeWorker)),l.createWorkerFrom(m,I,E)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof h?this._data:new o(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<d.length;f++)n.prototype[d[f]]=u;s.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,s,i){(function(n){var r,o,a=n.MutationObserver||n.WebKitMutationObserver;if(a){var l=0,h=new a(I),d=n.document.createTextNode("");h.observe(d,{characterData:!0}),r=function(){d.data=l=++l%2}}else if(n.setImmediate||n.MessageChannel===void 0)r="document"in n&&"onreadystatechange"in n.document.createElement("script")?function(){var E=n.document.createElement("script");E.onreadystatechange=function(){I(),E.onreadystatechange=null,E.parentNode.removeChild(E),E=null},n.document.documentElement.appendChild(E)}:function(){setTimeout(I,0)};else{var u=new n.MessageChannel;u.port1.onmessage=I,r=function(){u.port2.postMessage(0)}}var f=[];function I(){var E,m;o=!0;for(var C=f.length;C;){for(m=f,f=[],E=-1;++E<C;)m[E]();C=f.length}o=!1}s.exports=function(E){f.push(E)!==1||o||r()}}).call(this,typeof Ti<"u"?Ti:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,s,i){var n=e("immediate");function r(){}var o={},a=["REJECTED"],l=["FULFILLED"],h=["PENDING"];function d(C){if(typeof C!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,C!==r&&E(this,C)}function u(C,g,S){this.promise=C,typeof g=="function"&&(this.onFulfilled=g,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function f(C,g,S){n(function(){var T;try{T=g(S)}catch(F){return o.reject(C,F)}T===C?o.reject(C,new TypeError("Cannot resolve promise with itself")):o.resolve(C,T)})}function I(C){var g=C&&C.then;if(C&&(typeof C=="object"||typeof C=="function")&&typeof g=="function")return function(){g.apply(C,arguments)}}function E(C,g){var S=!1;function T(N){S||(S=!0,o.reject(C,N))}function F(N){S||(S=!0,o.resolve(C,N))}var y=m(function(){g(F,T)});y.status==="error"&&T(y.value)}function m(C,g){var S={};try{S.value=C(g),S.status="success"}catch(T){S.status="error",S.value=T}return S}(s.exports=d).prototype.finally=function(C){if(typeof C!="function")return this;var g=this.constructor;return this.then(function(S){return g.resolve(C()).then(function(){return S})},function(S){return g.resolve(C()).then(function(){throw S})})},d.prototype.catch=function(C){return this.then(null,C)},d.prototype.then=function(C,g){if(typeof C!="function"&&this.state===l||typeof g!="function"&&this.state===a)return this;var S=new this.constructor(r);return this.state!==h?f(S,this.state===l?C:g,this.outcome):this.queue.push(new u(S,C,g)),S},u.prototype.callFulfilled=function(C){o.resolve(this.promise,C)},u.prototype.otherCallFulfilled=function(C){f(this.promise,this.onFulfilled,C)},u.prototype.callRejected=function(C){o.reject(this.promise,C)},u.prototype.otherCallRejected=function(C){f(this.promise,this.onRejected,C)},o.resolve=function(C,g){var S=m(I,g);if(S.status==="error")return o.reject(C,S.value);var T=S.value;if(T)E(C,T);else{C.state=l,C.outcome=g;for(var F=-1,y=C.queue.length;++F<y;)C.queue[F].callFulfilled(g)}return C},o.reject=function(C,g){C.state=a,C.outcome=g;for(var S=-1,T=C.queue.length;++S<T;)C.queue[S].callRejected(g);return C},d.resolve=function(C){return C instanceof this?C:o.resolve(new this(r),C)},d.reject=function(C){var g=new this(r);return o.reject(g,C)},d.all=function(C){var g=this;if(Object.prototype.toString.call(C)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=C.length,T=!1;if(!S)return this.resolve([]);for(var F=new Array(S),y=0,N=-1,w=new this(r);++N<S;)P(C[N],N);return w;function P(M,x){g.resolve(M).then(function(O){F[x]=O,++y!==S||T||(T=!0,o.resolve(w,F))},function(O){T||(T=!0,o.reject(w,O))})}},d.race=function(C){var g=this;if(Object.prototype.toString.call(C)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=C.length,T=!1;if(!S)return this.resolve([]);for(var F=-1,y=new this(r);++F<S;)N=C[F],g.resolve(N).then(function(w){T||(T=!0,o.resolve(y,w))},function(w){T||(T=!0,o.reject(y,w))});var N;return y}},{immediate:36}],38:[function(e,s,i){var n={};(0,e("./lib/utils/common").assign)(n,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),s.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,s,i){var n=e("./zlib/deflate"),r=e("./utils/common"),o=e("./utils/strings"),a=e("./zlib/messages"),l=e("./zlib/zstream"),h=Object.prototype.toString,d=0,u=-1,f=0,I=8;function E(C){if(!(this instanceof E))return new E(C);this.options=r.assign({level:u,method:I,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},C||{});var g=this.options;g.raw&&0<g.windowBits?g.windowBits=-g.windowBits:g.gzip&&0<g.windowBits&&g.windowBits<16&&(g.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var S=n.deflateInit2(this.strm,g.level,g.method,g.windowBits,g.memLevel,g.strategy);if(S!==d)throw new Error(a[S]);if(g.header&&n.deflateSetHeader(this.strm,g.header),g.dictionary){var T;if(T=typeof g.dictionary=="string"?o.string2buf(g.dictionary):h.call(g.dictionary)==="[object ArrayBuffer]"?new Uint8Array(g.dictionary):g.dictionary,(S=n.deflateSetDictionary(this.strm,T))!==d)throw new Error(a[S]);this._dict_set=!0}}function m(C,g){var S=new E(g);if(S.push(C,!0),S.err)throw S.msg||a[S.err];return S.result}E.prototype.push=function(C,g){var S,T,F=this.strm,y=this.options.chunkSize;if(this.ended)return!1;T=g===~~g?g:g===!0?4:0,typeof C=="string"?F.input=o.string2buf(C):h.call(C)==="[object ArrayBuffer]"?F.input=new Uint8Array(C):F.input=C,F.next_in=0,F.avail_in=F.input.length;do{if(F.avail_out===0&&(F.output=new r.Buf8(y),F.next_out=0,F.avail_out=y),(S=n.deflate(F,T))!==1&&S!==d)return this.onEnd(S),!(this.ended=!0);F.avail_out!==0&&(F.avail_in!==0||T!==4&&T!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(r.shrinkBuf(F.output,F.next_out))):this.onData(r.shrinkBuf(F.output,F.next_out)))}while((0<F.avail_in||F.avail_out===0)&&S!==1);return T===4?(S=n.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===d):T!==2||(this.onEnd(d),!(F.avail_out=0))},E.prototype.onData=function(C){this.chunks.push(C)},E.prototype.onEnd=function(C){C===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=C,this.msg=this.strm.msg},i.Deflate=E,i.deflate=m,i.deflateRaw=function(C,g){return(g=g||{}).raw=!0,m(C,g)},i.gzip=function(C,g){return(g=g||{}).gzip=!0,m(C,g)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,s,i){var n=e("./zlib/inflate"),r=e("./utils/common"),o=e("./utils/strings"),a=e("./zlib/constants"),l=e("./zlib/messages"),h=e("./zlib/zstream"),d=e("./zlib/gzheader"),u=Object.prototype.toString;function f(E){if(!(this instanceof f))return new f(E);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},E||{});var m=this.options;m.raw&&0<=m.windowBits&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),!(0<=m.windowBits&&m.windowBits<16)||E&&E.windowBits||(m.windowBits+=32),15<m.windowBits&&m.windowBits<48&&!(15&m.windowBits)&&(m.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var C=n.inflateInit2(this.strm,m.windowBits);if(C!==a.Z_OK)throw new Error(l[C]);this.header=new d,n.inflateGetHeader(this.strm,this.header)}function I(E,m){var C=new f(m);if(C.push(E,!0),C.err)throw C.msg||l[C.err];return C.result}f.prototype.push=function(E,m){var C,g,S,T,F,y,N=this.strm,w=this.options.chunkSize,P=this.options.dictionary,M=!1;if(this.ended)return!1;g=m===~~m?m:m===!0?a.Z_FINISH:a.Z_NO_FLUSH,typeof E=="string"?N.input=o.binstring2buf(E):u.call(E)==="[object ArrayBuffer]"?N.input=new Uint8Array(E):N.input=E,N.next_in=0,N.avail_in=N.input.length;do{if(N.avail_out===0&&(N.output=new r.Buf8(w),N.next_out=0,N.avail_out=w),(C=n.inflate(N,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&P&&(y=typeof P=="string"?o.string2buf(P):u.call(P)==="[object ArrayBuffer]"?new Uint8Array(P):P,C=n.inflateSetDictionary(this.strm,y)),C===a.Z_BUF_ERROR&&M===!0&&(C=a.Z_OK,M=!1),C!==a.Z_STREAM_END&&C!==a.Z_OK)return this.onEnd(C),!(this.ended=!0);N.next_out&&(N.avail_out!==0&&C!==a.Z_STREAM_END&&(N.avail_in!==0||g!==a.Z_FINISH&&g!==a.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=o.utf8border(N.output,N.next_out),T=N.next_out-S,F=o.buf2string(N.output,S),N.next_out=T,N.avail_out=w-T,T&&r.arraySet(N.output,N.output,S,T,0),this.onData(F)):this.onData(r.shrinkBuf(N.output,N.next_out)))),N.avail_in===0&&N.avail_out===0&&(M=!0)}while((0<N.avail_in||N.avail_out===0)&&C!==a.Z_STREAM_END);return C===a.Z_STREAM_END&&(g=a.Z_FINISH),g===a.Z_FINISH?(C=n.inflateEnd(this.strm),this.onEnd(C),this.ended=!0,C===a.Z_OK):g!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),!(N.avail_out=0))},f.prototype.onData=function(E){this.chunks.push(E)},f.prototype.onEnd=function(E){E===a.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=E,this.msg=this.strm.msg},i.Inflate=f,i.inflate=I,i.inflateRaw=function(E,m){return(m=m||{}).raw=!0,I(E,m)},i.ungzip=I},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,s,i){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(a){for(var l=Array.prototype.slice.call(arguments,1);l.length;){var h=l.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var d in h)h.hasOwnProperty(d)&&(a[d]=h[d])}}return a},i.shrinkBuf=function(a,l){return a.length===l?a:a.subarray?a.subarray(0,l):(a.length=l,a)};var r={arraySet:function(a,l,h,d,u){if(l.subarray&&a.subarray)a.set(l.subarray(h,h+d),u);else for(var f=0;f<d;f++)a[u+f]=l[h+f]},flattenChunks:function(a){var l,h,d,u,f,I;for(l=d=0,h=a.length;l<h;l++)d+=a[l].length;for(I=new Uint8Array(d),l=u=0,h=a.length;l<h;l++)f=a[l],I.set(f,u),u+=f.length;return I}},o={arraySet:function(a,l,h,d,u){for(var f=0;f<d;f++)a[u+f]=l[h+f]},flattenChunks:function(a){return[].concat.apply([],a)}};i.setTyped=function(a){a?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,r)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,o))},i.setTyped(n)},{}],42:[function(e,s,i){var n=e("./common"),r=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var a=new n.Buf8(256),l=0;l<256;l++)a[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function h(d,u){if(u<65537&&(d.subarray&&o||!d.subarray&&r))return String.fromCharCode.apply(null,n.shrinkBuf(d,u));for(var f="",I=0;I<u;I++)f+=String.fromCharCode(d[I]);return f}a[254]=a[254]=1,i.string2buf=function(d){var u,f,I,E,m,C=d.length,g=0;for(E=0;E<C;E++)(64512&(f=d.charCodeAt(E)))==55296&&E+1<C&&(64512&(I=d.charCodeAt(E+1)))==56320&&(f=65536+(f-55296<<10)+(I-56320),E++),g+=f<128?1:f<2048?2:f<65536?3:4;for(u=new n.Buf8(g),E=m=0;m<g;E++)(64512&(f=d.charCodeAt(E)))==55296&&E+1<C&&(64512&(I=d.charCodeAt(E+1)))==56320&&(f=65536+(f-55296<<10)+(I-56320),E++),f<128?u[m++]=f:(f<2048?u[m++]=192|f>>>6:(f<65536?u[m++]=224|f>>>12:(u[m++]=240|f>>>18,u[m++]=128|f>>>12&63),u[m++]=128|f>>>6&63),u[m++]=128|63&f);return u},i.buf2binstring=function(d){return h(d,d.length)},i.binstring2buf=function(d){for(var u=new n.Buf8(d.length),f=0,I=u.length;f<I;f++)u[f]=d.charCodeAt(f);return u},i.buf2string=function(d,u){var f,I,E,m,C=u||d.length,g=new Array(2*C);for(f=I=0;f<C;)if((E=d[f++])<128)g[I++]=E;else if(4<(m=a[E]))g[I++]=65533,f+=m-1;else{for(E&=m===2?31:m===3?15:7;1<m&&f<C;)E=E<<6|63&d[f++],m--;1<m?g[I++]=65533:E<65536?g[I++]=E:(E-=65536,g[I++]=55296|E>>10&1023,g[I++]=56320|1023&E)}return h(g,I)},i.utf8border=function(d,u){var f;for((u=u||d.length)>d.length&&(u=d.length),f=u-1;0<=f&&(192&d[f])==128;)f--;return f<0||f===0?u:f+a[d[f]]>u?f:u}},{"./common":41}],43:[function(e,s,i){s.exports=function(n,r,o,a){for(var l=65535&n|0,h=n>>>16&65535|0,d=0;o!==0;){for(o-=d=2e3<o?2e3:o;h=h+(l=l+r[a++]|0)|0,--d;);l%=65521,h%=65521}return l|h<<16|0}},{}],44:[function(e,s,i){s.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,s,i){var n=function(){for(var r,o=[],a=0;a<256;a++){r=a;for(var l=0;l<8;l++)r=1&r?3988292384^r>>>1:r>>>1;o[a]=r}return o}();s.exports=function(r,o,a,l){var h=n,d=l+a;r^=-1;for(var u=l;u<d;u++)r=r>>>8^h[255&(r^o[u])];return-1^r}},{}],46:[function(e,s,i){var n,r=e("../utils/common"),o=e("./trees"),a=e("./adler32"),l=e("./crc32"),h=e("./messages"),d=0,u=4,f=0,I=-2,E=-1,m=4,C=2,g=8,S=9,T=286,F=30,y=19,N=2*T+1,w=15,P=3,M=258,x=M+P+1,O=42,v=113,R=1,D=2,X=3,U=4;function j(A,W){return A.msg=h[W],W}function k(A){return(A<<1)-(4<A?9:0)}function J(A){for(var W=A.length;0<=--W;)A[W]=0}function Y(A){var W=A.state,G=W.pending;G>A.avail_out&&(G=A.avail_out),G!==0&&(r.arraySet(A.output,W.pending_buf,W.pending_out,G,A.next_out),A.next_out+=G,W.pending_out+=G,A.total_out+=G,A.avail_out-=G,W.pending-=G,W.pending===0&&(W.pending_out=0))}function V(A,W){o._tr_flush_block(A,0<=A.block_start?A.block_start:-1,A.strstart-A.block_start,W),A.block_start=A.strstart,Y(A.strm)}function nt(A,W){A.pending_buf[A.pending++]=W}function et(A,W){A.pending_buf[A.pending++]=W>>>8&255,A.pending_buf[A.pending++]=255&W}function tt(A,W){var G,L,_=A.max_chain_length,b=A.strstart,Z=A.prev_length,$=A.nice_match,z=A.strstart>A.w_size-x?A.strstart-(A.w_size-x):0,Q=A.window,it=A.w_mask,K=A.prev,ot=A.strstart+M,Tt=Q[b+Z-1],dt=Q[b+Z];A.prev_length>=A.good_match&&(_>>=2),$>A.lookahead&&($=A.lookahead);do if(Q[(G=W)+Z]===dt&&Q[G+Z-1]===Tt&&Q[G]===Q[b]&&Q[++G]===Q[b+1]){b+=2,G++;do;while(Q[++b]===Q[++G]&&Q[++b]===Q[++G]&&Q[++b]===Q[++G]&&Q[++b]===Q[++G]&&Q[++b]===Q[++G]&&Q[++b]===Q[++G]&&Q[++b]===Q[++G]&&Q[++b]===Q[++G]&&b<ot);if(L=M-(ot-b),b=ot-M,Z<L){if(A.match_start=W,$<=(Z=L))break;Tt=Q[b+Z-1],dt=Q[b+Z]}}while((W=K[W&it])>z&&--_!=0);return Z<=A.lookahead?Z:A.lookahead}function Ft(A){var W,G,L,_,b,Z,$,z,Q,it,K=A.w_size;do{if(_=A.window_size-A.lookahead-A.strstart,A.strstart>=K+(K-x)){for(r.arraySet(A.window,A.window,K,K,0),A.match_start-=K,A.strstart-=K,A.block_start-=K,W=G=A.hash_size;L=A.head[--W],A.head[W]=K<=L?L-K:0,--G;);for(W=G=K;L=A.prev[--W],A.prev[W]=K<=L?L-K:0,--G;);_+=K}if(A.strm.avail_in===0)break;if(Z=A.strm,$=A.window,z=A.strstart+A.lookahead,Q=_,it=void 0,it=Z.avail_in,Q<it&&(it=Q),G=it===0?0:(Z.avail_in-=it,r.arraySet($,Z.input,Z.next_in,it,z),Z.state.wrap===1?Z.adler=a(Z.adler,$,it,z):Z.state.wrap===2&&(Z.adler=l(Z.adler,$,it,z)),Z.next_in+=it,Z.total_in+=it,it),A.lookahead+=G,A.lookahead+A.insert>=P)for(b=A.strstart-A.insert,A.ins_h=A.window[b],A.ins_h=(A.ins_h<<A.hash_shift^A.window[b+1])&A.hash_mask;A.insert&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[b+P-1])&A.hash_mask,A.prev[b&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=b,b++,A.insert--,!(A.lookahead+A.insert<P)););}while(A.lookahead<x&&A.strm.avail_in!==0)}function Nt(A,W){for(var G,L;;){if(A.lookahead<x){if(Ft(A),A.lookahead<x&&W===d)return R;if(A.lookahead===0)break}if(G=0,A.lookahead>=P&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+P-1])&A.hash_mask,G=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),G!==0&&A.strstart-G<=A.w_size-x&&(A.match_length=tt(A,G)),A.match_length>=P)if(L=o._tr_tally(A,A.strstart-A.match_start,A.match_length-P),A.lookahead-=A.match_length,A.match_length<=A.max_lazy_match&&A.lookahead>=P){for(A.match_length--;A.strstart++,A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+P-1])&A.hash_mask,G=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart,--A.match_length!=0;);A.strstart++}else A.strstart+=A.match_length,A.match_length=0,A.ins_h=A.window[A.strstart],A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+1])&A.hash_mask;else L=o._tr_tally(A,0,A.window[A.strstart]),A.lookahead--,A.strstart++;if(L&&(V(A,!1),A.strm.avail_out===0))return R}return A.insert=A.strstart<P-1?A.strstart:P-1,W===u?(V(A,!0),A.strm.avail_out===0?X:U):A.last_lit&&(V(A,!1),A.strm.avail_out===0)?R:D}function rt(A,W){for(var G,L,_;;){if(A.lookahead<x){if(Ft(A),A.lookahead<x&&W===d)return R;if(A.lookahead===0)break}if(G=0,A.lookahead>=P&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+P-1])&A.hash_mask,G=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),A.prev_length=A.match_length,A.prev_match=A.match_start,A.match_length=P-1,G!==0&&A.prev_length<A.max_lazy_match&&A.strstart-G<=A.w_size-x&&(A.match_length=tt(A,G),A.match_length<=5&&(A.strategy===1||A.match_length===P&&4096<A.strstart-A.match_start)&&(A.match_length=P-1)),A.prev_length>=P&&A.match_length<=A.prev_length){for(_=A.strstart+A.lookahead-P,L=o._tr_tally(A,A.strstart-1-A.prev_match,A.prev_length-P),A.lookahead-=A.prev_length-1,A.prev_length-=2;++A.strstart<=_&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+P-1])&A.hash_mask,G=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),--A.prev_length!=0;);if(A.match_available=0,A.match_length=P-1,A.strstart++,L&&(V(A,!1),A.strm.avail_out===0))return R}else if(A.match_available){if((L=o._tr_tally(A,0,A.window[A.strstart-1]))&&V(A,!1),A.strstart++,A.lookahead--,A.strm.avail_out===0)return R}else A.match_available=1,A.strstart++,A.lookahead--}return A.match_available&&(L=o._tr_tally(A,0,A.window[A.strstart-1]),A.match_available=0),A.insert=A.strstart<P-1?A.strstart:P-1,W===u?(V(A,!0),A.strm.avail_out===0?X:U):A.last_lit&&(V(A,!1),A.strm.avail_out===0)?R:D}function ut(A,W,G,L,_){this.good_length=A,this.max_lazy=W,this.nice_length=G,this.max_chain=L,this.func=_}function ht(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*N),this.dyn_dtree=new r.Buf16(2*(2*F+1)),this.bl_tree=new r.Buf16(2*(2*y+1)),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(w+1),this.heap=new r.Buf16(2*T+1),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*T+1),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function pt(A){var W;return A&&A.state?(A.total_in=A.total_out=0,A.data_type=C,(W=A.state).pending=0,W.pending_out=0,W.wrap<0&&(W.wrap=-W.wrap),W.status=W.wrap?O:v,A.adler=W.wrap===2?0:1,W.last_flush=d,o._tr_init(W),f):j(A,I)}function Xt(A){var W=pt(A);return W===f&&function(G){G.window_size=2*G.w_size,J(G.head),G.max_lazy_match=n[G.level].max_lazy,G.good_match=n[G.level].good_length,G.nice_match=n[G.level].nice_length,G.max_chain_length=n[G.level].max_chain,G.strstart=0,G.block_start=0,G.lookahead=0,G.insert=0,G.match_length=G.prev_length=P-1,G.match_available=0,G.ins_h=0}(A.state),W}function bt(A,W,G,L,_,b){if(!A)return I;var Z=1;if(W===E&&(W=6),L<0?(Z=0,L=-L):15<L&&(Z=2,L-=16),_<1||S<_||G!==g||L<8||15<L||W<0||9<W||b<0||m<b)return j(A,I);L===8&&(L=9);var $=new ht;return(A.state=$).strm=A,$.wrap=Z,$.gzhead=null,$.w_bits=L,$.w_size=1<<$.w_bits,$.w_mask=$.w_size-1,$.hash_bits=_+7,$.hash_size=1<<$.hash_bits,$.hash_mask=$.hash_size-1,$.hash_shift=~~(($.hash_bits+P-1)/P),$.window=new r.Buf8(2*$.w_size),$.head=new r.Buf16($.hash_size),$.prev=new r.Buf16($.w_size),$.lit_bufsize=1<<_+6,$.pending_buf_size=4*$.lit_bufsize,$.pending_buf=new r.Buf8($.pending_buf_size),$.d_buf=1*$.lit_bufsize,$.l_buf=3*$.lit_bufsize,$.level=W,$.strategy=b,$.method=G,Xt(A)}n=[new ut(0,0,0,0,function(A,W){var G=65535;for(G>A.pending_buf_size-5&&(G=A.pending_buf_size-5);;){if(A.lookahead<=1){if(Ft(A),A.lookahead===0&&W===d)return R;if(A.lookahead===0)break}A.strstart+=A.lookahead,A.lookahead=0;var L=A.block_start+G;if((A.strstart===0||A.strstart>=L)&&(A.lookahead=A.strstart-L,A.strstart=L,V(A,!1),A.strm.avail_out===0)||A.strstart-A.block_start>=A.w_size-x&&(V(A,!1),A.strm.avail_out===0))return R}return A.insert=0,W===u?(V(A,!0),A.strm.avail_out===0?X:U):(A.strstart>A.block_start&&(V(A,!1),A.strm.avail_out),R)}),new ut(4,4,8,4,Nt),new ut(4,5,16,8,Nt),new ut(4,6,32,32,Nt),new ut(4,4,16,16,rt),new ut(8,16,32,32,rt),new ut(8,16,128,128,rt),new ut(8,32,128,256,rt),new ut(32,128,258,1024,rt),new ut(32,258,258,4096,rt)],i.deflateInit=function(A,W){return bt(A,W,g,15,8,0)},i.deflateInit2=bt,i.deflateReset=Xt,i.deflateResetKeep=pt,i.deflateSetHeader=function(A,W){return A&&A.state?A.state.wrap!==2?I:(A.state.gzhead=W,f):I},i.deflate=function(A,W){var G,L,_,b;if(!A||!A.state||5<W||W<0)return A?j(A,I):I;if(L=A.state,!A.output||!A.input&&A.avail_in!==0||L.status===666&&W!==u)return j(A,A.avail_out===0?-5:I);if(L.strm=A,G=L.last_flush,L.last_flush=W,L.status===O)if(L.wrap===2)A.adler=0,nt(L,31),nt(L,139),nt(L,8),L.gzhead?(nt(L,(L.gzhead.text?1:0)+(L.gzhead.hcrc?2:0)+(L.gzhead.extra?4:0)+(L.gzhead.name?8:0)+(L.gzhead.comment?16:0)),nt(L,255&L.gzhead.time),nt(L,L.gzhead.time>>8&255),nt(L,L.gzhead.time>>16&255),nt(L,L.gzhead.time>>24&255),nt(L,L.level===9?2:2<=L.strategy||L.level<2?4:0),nt(L,255&L.gzhead.os),L.gzhead.extra&&L.gzhead.extra.length&&(nt(L,255&L.gzhead.extra.length),nt(L,L.gzhead.extra.length>>8&255)),L.gzhead.hcrc&&(A.adler=l(A.adler,L.pending_buf,L.pending,0)),L.gzindex=0,L.status=69):(nt(L,0),nt(L,0),nt(L,0),nt(L,0),nt(L,0),nt(L,L.level===9?2:2<=L.strategy||L.level<2?4:0),nt(L,3),L.status=v);else{var Z=g+(L.w_bits-8<<4)<<8;Z|=(2<=L.strategy||L.level<2?0:L.level<6?1:L.level===6?2:3)<<6,L.strstart!==0&&(Z|=32),Z+=31-Z%31,L.status=v,et(L,Z),L.strstart!==0&&(et(L,A.adler>>>16),et(L,65535&A.adler)),A.adler=1}if(L.status===69)if(L.gzhead.extra){for(_=L.pending;L.gzindex<(65535&L.gzhead.extra.length)&&(L.pending!==L.pending_buf_size||(L.gzhead.hcrc&&L.pending>_&&(A.adler=l(A.adler,L.pending_buf,L.pending-_,_)),Y(A),_=L.pending,L.pending!==L.pending_buf_size));)nt(L,255&L.gzhead.extra[L.gzindex]),L.gzindex++;L.gzhead.hcrc&&L.pending>_&&(A.adler=l(A.adler,L.pending_buf,L.pending-_,_)),L.gzindex===L.gzhead.extra.length&&(L.gzindex=0,L.status=73)}else L.status=73;if(L.status===73)if(L.gzhead.name){_=L.pending;do{if(L.pending===L.pending_buf_size&&(L.gzhead.hcrc&&L.pending>_&&(A.adler=l(A.adler,L.pending_buf,L.pending-_,_)),Y(A),_=L.pending,L.pending===L.pending_buf_size)){b=1;break}b=L.gzindex<L.gzhead.name.length?255&L.gzhead.name.charCodeAt(L.gzindex++):0,nt(L,b)}while(b!==0);L.gzhead.hcrc&&L.pending>_&&(A.adler=l(A.adler,L.pending_buf,L.pending-_,_)),b===0&&(L.gzindex=0,L.status=91)}else L.status=91;if(L.status===91)if(L.gzhead.comment){_=L.pending;do{if(L.pending===L.pending_buf_size&&(L.gzhead.hcrc&&L.pending>_&&(A.adler=l(A.adler,L.pending_buf,L.pending-_,_)),Y(A),_=L.pending,L.pending===L.pending_buf_size)){b=1;break}b=L.gzindex<L.gzhead.comment.length?255&L.gzhead.comment.charCodeAt(L.gzindex++):0,nt(L,b)}while(b!==0);L.gzhead.hcrc&&L.pending>_&&(A.adler=l(A.adler,L.pending_buf,L.pending-_,_)),b===0&&(L.status=103)}else L.status=103;if(L.status===103&&(L.gzhead.hcrc?(L.pending+2>L.pending_buf_size&&Y(A),L.pending+2<=L.pending_buf_size&&(nt(L,255&A.adler),nt(L,A.adler>>8&255),A.adler=0,L.status=v)):L.status=v),L.pending!==0){if(Y(A),A.avail_out===0)return L.last_flush=-1,f}else if(A.avail_in===0&&k(W)<=k(G)&&W!==u)return j(A,-5);if(L.status===666&&A.avail_in!==0)return j(A,-5);if(A.avail_in!==0||L.lookahead!==0||W!==d&&L.status!==666){var $=L.strategy===2?function(z,Q){for(var it;;){if(z.lookahead===0&&(Ft(z),z.lookahead===0)){if(Q===d)return R;break}if(z.match_length=0,it=o._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,it&&(V(z,!1),z.strm.avail_out===0))return R}return z.insert=0,Q===u?(V(z,!0),z.strm.avail_out===0?X:U):z.last_lit&&(V(z,!1),z.strm.avail_out===0)?R:D}(L,W):L.strategy===3?function(z,Q){for(var it,K,ot,Tt,dt=z.window;;){if(z.lookahead<=M){if(Ft(z),z.lookahead<=M&&Q===d)return R;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=P&&0<z.strstart&&(K=dt[ot=z.strstart-1])===dt[++ot]&&K===dt[++ot]&&K===dt[++ot]){Tt=z.strstart+M;do;while(K===dt[++ot]&&K===dt[++ot]&&K===dt[++ot]&&K===dt[++ot]&&K===dt[++ot]&&K===dt[++ot]&&K===dt[++ot]&&K===dt[++ot]&&ot<Tt);z.match_length=M-(Tt-ot),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=P?(it=o._tr_tally(z,1,z.match_length-P),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(it=o._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),it&&(V(z,!1),z.strm.avail_out===0))return R}return z.insert=0,Q===u?(V(z,!0),z.strm.avail_out===0?X:U):z.last_lit&&(V(z,!1),z.strm.avail_out===0)?R:D}(L,W):n[L.level].func(L,W);if($!==X&&$!==U||(L.status=666),$===R||$===X)return A.avail_out===0&&(L.last_flush=-1),f;if($===D&&(W===1?o._tr_align(L):W!==5&&(o._tr_stored_block(L,0,0,!1),W===3&&(J(L.head),L.lookahead===0&&(L.strstart=0,L.block_start=0,L.insert=0))),Y(A),A.avail_out===0))return L.last_flush=-1,f}return W!==u?f:L.wrap<=0?1:(L.wrap===2?(nt(L,255&A.adler),nt(L,A.adler>>8&255),nt(L,A.adler>>16&255),nt(L,A.adler>>24&255),nt(L,255&A.total_in),nt(L,A.total_in>>8&255),nt(L,A.total_in>>16&255),nt(L,A.total_in>>24&255)):(et(L,A.adler>>>16),et(L,65535&A.adler)),Y(A),0<L.wrap&&(L.wrap=-L.wrap),L.pending!==0?f:1)},i.deflateEnd=function(A){var W;return A&&A.state?(W=A.state.status)!==O&&W!==69&&W!==73&&W!==91&&W!==103&&W!==v&&W!==666?j(A,I):(A.state=null,W===v?j(A,-3):f):I},i.deflateSetDictionary=function(A,W){var G,L,_,b,Z,$,z,Q,it=W.length;if(!A||!A.state||(b=(G=A.state).wrap)===2||b===1&&G.status!==O||G.lookahead)return I;for(b===1&&(A.adler=a(A.adler,W,it,0)),G.wrap=0,it>=G.w_size&&(b===0&&(J(G.head),G.strstart=0,G.block_start=0,G.insert=0),Q=new r.Buf8(G.w_size),r.arraySet(Q,W,it-G.w_size,G.w_size,0),W=Q,it=G.w_size),Z=A.avail_in,$=A.next_in,z=A.input,A.avail_in=it,A.next_in=0,A.input=W,Ft(G);G.lookahead>=P;){for(L=G.strstart,_=G.lookahead-(P-1);G.ins_h=(G.ins_h<<G.hash_shift^G.window[L+P-1])&G.hash_mask,G.prev[L&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=L,L++,--_;);G.strstart=L,G.lookahead=P-1,Ft(G)}return G.strstart+=G.lookahead,G.block_start=G.strstart,G.insert=G.lookahead,G.lookahead=0,G.match_length=G.prev_length=P-1,G.match_available=0,A.next_in=$,A.input=z,A.avail_in=Z,G.wrap=b,f},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,s,i){s.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,s,i){s.exports=function(n,r){var o,a,l,h,d,u,f,I,E,m,C,g,S,T,F,y,N,w,P,M,x,O,v,R,D;o=n.state,a=n.next_in,R=n.input,l=a+(n.avail_in-5),h=n.next_out,D=n.output,d=h-(r-n.avail_out),u=h+(n.avail_out-257),f=o.dmax,I=o.wsize,E=o.whave,m=o.wnext,C=o.window,g=o.hold,S=o.bits,T=o.lencode,F=o.distcode,y=(1<<o.lenbits)-1,N=(1<<o.distbits)-1;t:do{S<15&&(g+=R[a++]<<S,S+=8,g+=R[a++]<<S,S+=8),w=T[g&y];e:for(;;){if(g>>>=P=w>>>24,S-=P,(P=w>>>16&255)===0)D[h++]=65535&w;else{if(!(16&P)){if(!(64&P)){w=T[(65535&w)+(g&(1<<P)-1)];continue e}if(32&P){o.mode=12;break t}n.msg="invalid literal/length code",o.mode=30;break t}M=65535&w,(P&=15)&&(S<P&&(g+=R[a++]<<S,S+=8),M+=g&(1<<P)-1,g>>>=P,S-=P),S<15&&(g+=R[a++]<<S,S+=8,g+=R[a++]<<S,S+=8),w=F[g&N];s:for(;;){if(g>>>=P=w>>>24,S-=P,!(16&(P=w>>>16&255))){if(!(64&P)){w=F[(65535&w)+(g&(1<<P)-1)];continue s}n.msg="invalid distance code",o.mode=30;break t}if(x=65535&w,S<(P&=15)&&(g+=R[a++]<<S,(S+=8)<P&&(g+=R[a++]<<S,S+=8)),f<(x+=g&(1<<P)-1)){n.msg="invalid distance too far back",o.mode=30;break t}if(g>>>=P,S-=P,(P=h-d)<x){if(E<(P=x-P)&&o.sane){n.msg="invalid distance too far back",o.mode=30;break t}if(v=C,(O=0)===m){if(O+=I-P,P<M){for(M-=P;D[h++]=C[O++],--P;);O=h-x,v=D}}else if(m<P){if(O+=I+m-P,(P-=m)<M){for(M-=P;D[h++]=C[O++],--P;);if(O=0,m<M){for(M-=P=m;D[h++]=C[O++],--P;);O=h-x,v=D}}}else if(O+=m-P,P<M){for(M-=P;D[h++]=C[O++],--P;);O=h-x,v=D}for(;2<M;)D[h++]=v[O++],D[h++]=v[O++],D[h++]=v[O++],M-=3;M&&(D[h++]=v[O++],1<M&&(D[h++]=v[O++]))}else{for(O=h-x;D[h++]=D[O++],D[h++]=D[O++],D[h++]=D[O++],2<(M-=3););M&&(D[h++]=D[O++],1<M&&(D[h++]=D[O++]))}break}}break}}while(a<l&&h<u);a-=M=S>>3,g&=(1<<(S-=M<<3))-1,n.next_in=a,n.next_out=h,n.avail_in=a<l?l-a+5:5-(a-l),n.avail_out=h<u?u-h+257:257-(h-u),o.hold=g,o.bits=S}},{}],49:[function(e,s,i){var n=e("../utils/common"),r=e("./adler32"),o=e("./crc32"),a=e("./inffast"),l=e("./inftrees"),h=1,d=2,u=0,f=-2,I=1,E=852,m=592;function C(O){return(O>>>24&255)+(O>>>8&65280)+((65280&O)<<8)+((255&O)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(O){var v;return O&&O.state?(v=O.state,O.total_in=O.total_out=v.total=0,O.msg="",v.wrap&&(O.adler=1&v.wrap),v.mode=I,v.last=0,v.havedict=0,v.dmax=32768,v.head=null,v.hold=0,v.bits=0,v.lencode=v.lendyn=new n.Buf32(E),v.distcode=v.distdyn=new n.Buf32(m),v.sane=1,v.back=-1,u):f}function T(O){var v;return O&&O.state?((v=O.state).wsize=0,v.whave=0,v.wnext=0,S(O)):f}function F(O,v){var R,D;return O&&O.state?(D=O.state,v<0?(R=0,v=-v):(R=1+(v>>4),v<48&&(v&=15)),v&&(v<8||15<v)?f:(D.window!==null&&D.wbits!==v&&(D.window=null),D.wrap=R,D.wbits=v,T(O))):f}function y(O,v){var R,D;return O?(D=new g,(O.state=D).window=null,(R=F(O,v))!==u&&(O.state=null),R):f}var N,w,P=!0;function M(O){if(P){var v;for(N=new n.Buf32(512),w=new n.Buf32(32),v=0;v<144;)O.lens[v++]=8;for(;v<256;)O.lens[v++]=9;for(;v<280;)O.lens[v++]=7;for(;v<288;)O.lens[v++]=8;for(l(h,O.lens,0,288,N,0,O.work,{bits:9}),v=0;v<32;)O.lens[v++]=5;l(d,O.lens,0,32,w,0,O.work,{bits:5}),P=!1}O.lencode=N,O.lenbits=9,O.distcode=w,O.distbits=5}function x(O,v,R,D){var X,U=O.state;return U.window===null&&(U.wsize=1<<U.wbits,U.wnext=0,U.whave=0,U.window=new n.Buf8(U.wsize)),D>=U.wsize?(n.arraySet(U.window,v,R-U.wsize,U.wsize,0),U.wnext=0,U.whave=U.wsize):(D<(X=U.wsize-U.wnext)&&(X=D),n.arraySet(U.window,v,R-D,X,U.wnext),(D-=X)?(n.arraySet(U.window,v,R-D,D,0),U.wnext=D,U.whave=U.wsize):(U.wnext+=X,U.wnext===U.wsize&&(U.wnext=0),U.whave<U.wsize&&(U.whave+=X))),0}i.inflateReset=T,i.inflateReset2=F,i.inflateResetKeep=S,i.inflateInit=function(O){return y(O,15)},i.inflateInit2=y,i.inflate=function(O,v){var R,D,X,U,j,k,J,Y,V,nt,et,tt,Ft,Nt,rt,ut,ht,pt,Xt,bt,A,W,G,L,_=0,b=new n.Buf8(4),Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!O||!O.state||!O.output||!O.input&&O.avail_in!==0)return f;(R=O.state).mode===12&&(R.mode=13),j=O.next_out,X=O.output,J=O.avail_out,U=O.next_in,D=O.input,k=O.avail_in,Y=R.hold,V=R.bits,nt=k,et=J,W=u;t:for(;;)switch(R.mode){case I:if(R.wrap===0){R.mode=13;break}for(;V<16;){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}if(2&R.wrap&&Y===35615){b[R.check=0]=255&Y,b[1]=Y>>>8&255,R.check=o(R.check,b,2,0),V=Y=0,R.mode=2;break}if(R.flags=0,R.head&&(R.head.done=!1),!(1&R.wrap)||(((255&Y)<<8)+(Y>>8))%31){O.msg="incorrect header check",R.mode=30;break}if((15&Y)!=8){O.msg="unknown compression method",R.mode=30;break}if(V-=4,A=8+(15&(Y>>>=4)),R.wbits===0)R.wbits=A;else if(A>R.wbits){O.msg="invalid window size",R.mode=30;break}R.dmax=1<<A,O.adler=R.check=1,R.mode=512&Y?10:12,V=Y=0;break;case 2:for(;V<16;){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}if(R.flags=Y,(255&R.flags)!=8){O.msg="unknown compression method",R.mode=30;break}if(57344&R.flags){O.msg="unknown header flags set",R.mode=30;break}R.head&&(R.head.text=Y>>8&1),512&R.flags&&(b[0]=255&Y,b[1]=Y>>>8&255,R.check=o(R.check,b,2,0)),V=Y=0,R.mode=3;case 3:for(;V<32;){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}R.head&&(R.head.time=Y),512&R.flags&&(b[0]=255&Y,b[1]=Y>>>8&255,b[2]=Y>>>16&255,b[3]=Y>>>24&255,R.check=o(R.check,b,4,0)),V=Y=0,R.mode=4;case 4:for(;V<16;){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}R.head&&(R.head.xflags=255&Y,R.head.os=Y>>8),512&R.flags&&(b[0]=255&Y,b[1]=Y>>>8&255,R.check=o(R.check,b,2,0)),V=Y=0,R.mode=5;case 5:if(1024&R.flags){for(;V<16;){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}R.length=Y,R.head&&(R.head.extra_len=Y),512&R.flags&&(b[0]=255&Y,b[1]=Y>>>8&255,R.check=o(R.check,b,2,0)),V=Y=0}else R.head&&(R.head.extra=null);R.mode=6;case 6:if(1024&R.flags&&(k<(tt=R.length)&&(tt=k),tt&&(R.head&&(A=R.head.extra_len-R.length,R.head.extra||(R.head.extra=new Array(R.head.extra_len)),n.arraySet(R.head.extra,D,U,tt,A)),512&R.flags&&(R.check=o(R.check,D,tt,U)),k-=tt,U+=tt,R.length-=tt),R.length))break t;R.length=0,R.mode=7;case 7:if(2048&R.flags){if(k===0)break t;for(tt=0;A=D[U+tt++],R.head&&A&&R.length<65536&&(R.head.name+=String.fromCharCode(A)),A&&tt<k;);if(512&R.flags&&(R.check=o(R.check,D,tt,U)),k-=tt,U+=tt,A)break t}else R.head&&(R.head.name=null);R.length=0,R.mode=8;case 8:if(4096&R.flags){if(k===0)break t;for(tt=0;A=D[U+tt++],R.head&&A&&R.length<65536&&(R.head.comment+=String.fromCharCode(A)),A&&tt<k;);if(512&R.flags&&(R.check=o(R.check,D,tt,U)),k-=tt,U+=tt,A)break t}else R.head&&(R.head.comment=null);R.mode=9;case 9:if(512&R.flags){for(;V<16;){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}if(Y!==(65535&R.check)){O.msg="header crc mismatch",R.mode=30;break}V=Y=0}R.head&&(R.head.hcrc=R.flags>>9&1,R.head.done=!0),O.adler=R.check=0,R.mode=12;break;case 10:for(;V<32;){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}O.adler=R.check=C(Y),V=Y=0,R.mode=11;case 11:if(R.havedict===0)return O.next_out=j,O.avail_out=J,O.next_in=U,O.avail_in=k,R.hold=Y,R.bits=V,2;O.adler=R.check=1,R.mode=12;case 12:if(v===5||v===6)break t;case 13:if(R.last){Y>>>=7&V,V-=7&V,R.mode=27;break}for(;V<3;){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}switch(R.last=1&Y,V-=1,3&(Y>>>=1)){case 0:R.mode=14;break;case 1:if(M(R),R.mode=20,v!==6)break;Y>>>=2,V-=2;break t;case 2:R.mode=17;break;case 3:O.msg="invalid block type",R.mode=30}Y>>>=2,V-=2;break;case 14:for(Y>>>=7&V,V-=7&V;V<32;){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}if((65535&Y)!=(Y>>>16^65535)){O.msg="invalid stored block lengths",R.mode=30;break}if(R.length=65535&Y,V=Y=0,R.mode=15,v===6)break t;case 15:R.mode=16;case 16:if(tt=R.length){if(k<tt&&(tt=k),J<tt&&(tt=J),tt===0)break t;n.arraySet(X,D,U,tt,j),k-=tt,U+=tt,J-=tt,j+=tt,R.length-=tt;break}R.mode=12;break;case 17:for(;V<14;){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}if(R.nlen=257+(31&Y),Y>>>=5,V-=5,R.ndist=1+(31&Y),Y>>>=5,V-=5,R.ncode=4+(15&Y),Y>>>=4,V-=4,286<R.nlen||30<R.ndist){O.msg="too many length or distance symbols",R.mode=30;break}R.have=0,R.mode=18;case 18:for(;R.have<R.ncode;){for(;V<3;){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}R.lens[Z[R.have++]]=7&Y,Y>>>=3,V-=3}for(;R.have<19;)R.lens[Z[R.have++]]=0;if(R.lencode=R.lendyn,R.lenbits=7,G={bits:R.lenbits},W=l(0,R.lens,0,19,R.lencode,0,R.work,G),R.lenbits=G.bits,W){O.msg="invalid code lengths set",R.mode=30;break}R.have=0,R.mode=19;case 19:for(;R.have<R.nlen+R.ndist;){for(;ut=(_=R.lencode[Y&(1<<R.lenbits)-1])>>>16&255,ht=65535&_,!((rt=_>>>24)<=V);){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}if(ht<16)Y>>>=rt,V-=rt,R.lens[R.have++]=ht;else{if(ht===16){for(L=rt+2;V<L;){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}if(Y>>>=rt,V-=rt,R.have===0){O.msg="invalid bit length repeat",R.mode=30;break}A=R.lens[R.have-1],tt=3+(3&Y),Y>>>=2,V-=2}else if(ht===17){for(L=rt+3;V<L;){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}V-=rt,A=0,tt=3+(7&(Y>>>=rt)),Y>>>=3,V-=3}else{for(L=rt+7;V<L;){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}V-=rt,A=0,tt=11+(127&(Y>>>=rt)),Y>>>=7,V-=7}if(R.have+tt>R.nlen+R.ndist){O.msg="invalid bit length repeat",R.mode=30;break}for(;tt--;)R.lens[R.have++]=A}}if(R.mode===30)break;if(R.lens[256]===0){O.msg="invalid code -- missing end-of-block",R.mode=30;break}if(R.lenbits=9,G={bits:R.lenbits},W=l(h,R.lens,0,R.nlen,R.lencode,0,R.work,G),R.lenbits=G.bits,W){O.msg="invalid literal/lengths set",R.mode=30;break}if(R.distbits=6,R.distcode=R.distdyn,G={bits:R.distbits},W=l(d,R.lens,R.nlen,R.ndist,R.distcode,0,R.work,G),R.distbits=G.bits,W){O.msg="invalid distances set",R.mode=30;break}if(R.mode=20,v===6)break t;case 20:R.mode=21;case 21:if(6<=k&&258<=J){O.next_out=j,O.avail_out=J,O.next_in=U,O.avail_in=k,R.hold=Y,R.bits=V,a(O,et),j=O.next_out,X=O.output,J=O.avail_out,U=O.next_in,D=O.input,k=O.avail_in,Y=R.hold,V=R.bits,R.mode===12&&(R.back=-1);break}for(R.back=0;ut=(_=R.lencode[Y&(1<<R.lenbits)-1])>>>16&255,ht=65535&_,!((rt=_>>>24)<=V);){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}if(ut&&!(240&ut)){for(pt=rt,Xt=ut,bt=ht;ut=(_=R.lencode[bt+((Y&(1<<pt+Xt)-1)>>pt)])>>>16&255,ht=65535&_,!(pt+(rt=_>>>24)<=V);){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}Y>>>=pt,V-=pt,R.back+=pt}if(Y>>>=rt,V-=rt,R.back+=rt,R.length=ht,ut===0){R.mode=26;break}if(32&ut){R.back=-1,R.mode=12;break}if(64&ut){O.msg="invalid literal/length code",R.mode=30;break}R.extra=15&ut,R.mode=22;case 22:if(R.extra){for(L=R.extra;V<L;){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}R.length+=Y&(1<<R.extra)-1,Y>>>=R.extra,V-=R.extra,R.back+=R.extra}R.was=R.length,R.mode=23;case 23:for(;ut=(_=R.distcode[Y&(1<<R.distbits)-1])>>>16&255,ht=65535&_,!((rt=_>>>24)<=V);){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}if(!(240&ut)){for(pt=rt,Xt=ut,bt=ht;ut=(_=R.distcode[bt+((Y&(1<<pt+Xt)-1)>>pt)])>>>16&255,ht=65535&_,!(pt+(rt=_>>>24)<=V);){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}Y>>>=pt,V-=pt,R.back+=pt}if(Y>>>=rt,V-=rt,R.back+=rt,64&ut){O.msg="invalid distance code",R.mode=30;break}R.offset=ht,R.extra=15&ut,R.mode=24;case 24:if(R.extra){for(L=R.extra;V<L;){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}R.offset+=Y&(1<<R.extra)-1,Y>>>=R.extra,V-=R.extra,R.back+=R.extra}if(R.offset>R.dmax){O.msg="invalid distance too far back",R.mode=30;break}R.mode=25;case 25:if(J===0)break t;if(tt=et-J,R.offset>tt){if((tt=R.offset-tt)>R.whave&&R.sane){O.msg="invalid distance too far back",R.mode=30;break}Ft=tt>R.wnext?(tt-=R.wnext,R.wsize-tt):R.wnext-tt,tt>R.length&&(tt=R.length),Nt=R.window}else Nt=X,Ft=j-R.offset,tt=R.length;for(J<tt&&(tt=J),J-=tt,R.length-=tt;X[j++]=Nt[Ft++],--tt;);R.length===0&&(R.mode=21);break;case 26:if(J===0)break t;X[j++]=R.length,J--,R.mode=21;break;case 27:if(R.wrap){for(;V<32;){if(k===0)break t;k--,Y|=D[U++]<<V,V+=8}if(et-=J,O.total_out+=et,R.total+=et,et&&(O.adler=R.check=R.flags?o(R.check,X,et,j-et):r(R.check,X,et,j-et)),et=J,(R.flags?Y:C(Y))!==R.check){O.msg="incorrect data check",R.mode=30;break}V=Y=0}R.mode=28;case 28:if(R.wrap&&R.flags){for(;V<32;){if(k===0)break t;k--,Y+=D[U++]<<V,V+=8}if(Y!==(4294967295&R.total)){O.msg="incorrect length check",R.mode=30;break}V=Y=0}R.mode=29;case 29:W=1;break t;case 30:W=-3;break t;case 31:return-4;case 32:default:return f}return O.next_out=j,O.avail_out=J,O.next_in=U,O.avail_in=k,R.hold=Y,R.bits=V,(R.wsize||et!==O.avail_out&&R.mode<30&&(R.mode<27||v!==4))&&x(O,O.output,O.next_out,et-O.avail_out)?(R.mode=31,-4):(nt-=O.avail_in,et-=O.avail_out,O.total_in+=nt,O.total_out+=et,R.total+=et,R.wrap&&et&&(O.adler=R.check=R.flags?o(R.check,X,et,O.next_out-et):r(R.check,X,et,O.next_out-et)),O.data_type=R.bits+(R.last?64:0)+(R.mode===12?128:0)+(R.mode===20||R.mode===15?256:0),(nt==0&&et===0||v===4)&&W===u&&(W=-5),W)},i.inflateEnd=function(O){if(!O||!O.state)return f;var v=O.state;return v.window&&(v.window=null),O.state=null,u},i.inflateGetHeader=function(O,v){var R;return O&&O.state&&2&(R=O.state).wrap?((R.head=v).done=!1,u):f},i.inflateSetDictionary=function(O,v){var R,D=v.length;return O&&O.state?(R=O.state).wrap!==0&&R.mode!==11?f:R.mode===11&&r(1,v,D,0)!==R.check?-3:x(O,v,D,D)?(R.mode=31,-4):(R.havedict=1,u):f},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,s,i){var n=e("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];s.exports=function(h,d,u,f,I,E,m,C){var g,S,T,F,y,N,w,P,M,x=C.bits,O=0,v=0,R=0,D=0,X=0,U=0,j=0,k=0,J=0,Y=0,V=null,nt=0,et=new n.Buf16(16),tt=new n.Buf16(16),Ft=null,Nt=0;for(O=0;O<=15;O++)et[O]=0;for(v=0;v<f;v++)et[d[u+v]]++;for(X=x,D=15;1<=D&&et[D]===0;D--);if(D<X&&(X=D),D===0)return I[E++]=20971520,I[E++]=20971520,C.bits=1,0;for(R=1;R<D&&et[R]===0;R++);for(X<R&&(X=R),O=k=1;O<=15;O++)if(k<<=1,(k-=et[O])<0)return-1;if(0<k&&(h===0||D!==1))return-1;for(tt[1]=0,O=1;O<15;O++)tt[O+1]=tt[O]+et[O];for(v=0;v<f;v++)d[u+v]!==0&&(m[tt[d[u+v]]++]=v);if(N=h===0?(V=Ft=m,19):h===1?(V=r,nt-=257,Ft=o,Nt-=257,256):(V=a,Ft=l,-1),O=R,y=E,j=v=Y=0,T=-1,F=(J=1<<(U=X))-1,h===1&&852<J||h===2&&592<J)return 1;for(;;){for(w=O-j,M=m[v]<N?(P=0,m[v]):m[v]>N?(P=Ft[Nt+m[v]],V[nt+m[v]]):(P=96,0),g=1<<O-j,R=S=1<<U;I[y+(Y>>j)+(S-=g)]=w<<24|P<<16|M|0,S!==0;);for(g=1<<O-1;Y&g;)g>>=1;if(g!==0?(Y&=g-1,Y+=g):Y=0,v++,--et[O]==0){if(O===D)break;O=d[u+m[v]]}if(X<O&&(Y&F)!==T){for(j===0&&(j=X),y+=R,k=1<<(U=O-j);U+j<D&&!((k-=et[U+j])<=0);)U++,k<<=1;if(J+=1<<U,h===1&&852<J||h===2&&592<J)return 1;I[T=Y&F]=X<<24|U<<16|y-E|0}}return Y!==0&&(I[y+Y]=O-j<<24|64<<16|0),C.bits=X,0}},{"../utils/common":41}],51:[function(e,s,i){s.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,s,i){var n=e("../utils/common"),r=0,o=1;function a(_){for(var b=_.length;0<=--b;)_[b]=0}var l=0,h=29,d=256,u=d+1+h,f=30,I=19,E=2*u+1,m=15,C=16,g=7,S=256,T=16,F=17,y=18,N=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],w=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],P=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],x=new Array(2*(u+2));a(x);var O=new Array(2*f);a(O);var v=new Array(512);a(v);var R=new Array(256);a(R);var D=new Array(h);a(D);var X,U,j,k=new Array(f);function J(_,b,Z,$,z){this.static_tree=_,this.extra_bits=b,this.extra_base=Z,this.elems=$,this.max_length=z,this.has_stree=_&&_.length}function Y(_,b){this.dyn_tree=_,this.max_code=0,this.stat_desc=b}function V(_){return _<256?v[_]:v[256+(_>>>7)]}function nt(_,b){_.pending_buf[_.pending++]=255&b,_.pending_buf[_.pending++]=b>>>8&255}function et(_,b,Z){_.bi_valid>C-Z?(_.bi_buf|=b<<_.bi_valid&65535,nt(_,_.bi_buf),_.bi_buf=b>>C-_.bi_valid,_.bi_valid+=Z-C):(_.bi_buf|=b<<_.bi_valid&65535,_.bi_valid+=Z)}function tt(_,b,Z){et(_,Z[2*b],Z[2*b+1])}function Ft(_,b){for(var Z=0;Z|=1&_,_>>>=1,Z<<=1,0<--b;);return Z>>>1}function Nt(_,b,Z){var $,z,Q=new Array(m+1),it=0;for($=1;$<=m;$++)Q[$]=it=it+Z[$-1]<<1;for(z=0;z<=b;z++){var K=_[2*z+1];K!==0&&(_[2*z]=Ft(Q[K]++,K))}}function rt(_){var b;for(b=0;b<u;b++)_.dyn_ltree[2*b]=0;for(b=0;b<f;b++)_.dyn_dtree[2*b]=0;for(b=0;b<I;b++)_.bl_tree[2*b]=0;_.dyn_ltree[2*S]=1,_.opt_len=_.static_len=0,_.last_lit=_.matches=0}function ut(_){8<_.bi_valid?nt(_,_.bi_buf):0<_.bi_valid&&(_.pending_buf[_.pending++]=_.bi_buf),_.bi_buf=0,_.bi_valid=0}function ht(_,b,Z,$){var z=2*b,Q=2*Z;return _[z]<_[Q]||_[z]===_[Q]&&$[b]<=$[Z]}function pt(_,b,Z){for(var $=_.heap[Z],z=Z<<1;z<=_.heap_len&&(z<_.heap_len&&ht(b,_.heap[z+1],_.heap[z],_.depth)&&z++,!ht(b,$,_.heap[z],_.depth));)_.heap[Z]=_.heap[z],Z=z,z<<=1;_.heap[Z]=$}function Xt(_,b,Z){var $,z,Q,it,K=0;if(_.last_lit!==0)for(;$=_.pending_buf[_.d_buf+2*K]<<8|_.pending_buf[_.d_buf+2*K+1],z=_.pending_buf[_.l_buf+K],K++,$===0?tt(_,z,b):(tt(_,(Q=R[z])+d+1,b),(it=N[Q])!==0&&et(_,z-=D[Q],it),tt(_,Q=V(--$),Z),(it=w[Q])!==0&&et(_,$-=k[Q],it)),K<_.last_lit;);tt(_,S,b)}function bt(_,b){var Z,$,z,Q=b.dyn_tree,it=b.stat_desc.static_tree,K=b.stat_desc.has_stree,ot=b.stat_desc.elems,Tt=-1;for(_.heap_len=0,_.heap_max=E,Z=0;Z<ot;Z++)Q[2*Z]!==0?(_.heap[++_.heap_len]=Tt=Z,_.depth[Z]=0):Q[2*Z+1]=0;for(;_.heap_len<2;)Q[2*(z=_.heap[++_.heap_len]=Tt<2?++Tt:0)]=1,_.depth[z]=0,_.opt_len--,K&&(_.static_len-=it[2*z+1]);for(b.max_code=Tt,Z=_.heap_len>>1;1<=Z;Z--)pt(_,Q,Z);for(z=ot;Z=_.heap[1],_.heap[1]=_.heap[_.heap_len--],pt(_,Q,1),$=_.heap[1],_.heap[--_.heap_max]=Z,_.heap[--_.heap_max]=$,Q[2*z]=Q[2*Z]+Q[2*$],_.depth[z]=(_.depth[Z]>=_.depth[$]?_.depth[Z]:_.depth[$])+1,Q[2*Z+1]=Q[2*$+1]=z,_.heap[1]=z++,pt(_,Q,1),2<=_.heap_len;);_.heap[--_.heap_max]=_.heap[1],function(dt,Zt){var ms,ae,gs,_t,Js,qi,de=Zt.dyn_tree,Ar=Zt.max_code,qa=Zt.stat_desc.static_tree,Qa=Zt.stat_desc.has_stree,Ka=Zt.stat_desc.extra_bits,Fr=Zt.stat_desc.extra_base,Rs=Zt.stat_desc.max_length,ti=0;for(_t=0;_t<=m;_t++)dt.bl_count[_t]=0;for(de[2*dt.heap[dt.heap_max]+1]=0,ms=dt.heap_max+1;ms<E;ms++)Rs<(_t=de[2*de[2*(ae=dt.heap[ms])+1]+1]+1)&&(_t=Rs,ti++),de[2*ae+1]=_t,Ar<ae||(dt.bl_count[_t]++,Js=0,Fr<=ae&&(Js=Ka[ae-Fr]),qi=de[2*ae],dt.opt_len+=qi*(_t+Js),Qa&&(dt.static_len+=qi*(qa[2*ae+1]+Js)));if(ti!==0){do{for(_t=Rs-1;dt.bl_count[_t]===0;)_t--;dt.bl_count[_t]--,dt.bl_count[_t+1]+=2,dt.bl_count[Rs]--,ti-=2}while(0<ti);for(_t=Rs;_t!==0;_t--)for(ae=dt.bl_count[_t];ae!==0;)Ar<(gs=dt.heap[--ms])||(de[2*gs+1]!==_t&&(dt.opt_len+=(_t-de[2*gs+1])*de[2*gs],de[2*gs+1]=_t),ae--)}}(_,b),Nt(Q,Tt,_.bl_count)}function A(_,b,Z){var $,z,Q=-1,it=b[1],K=0,ot=7,Tt=4;for(it===0&&(ot=138,Tt=3),b[2*(Z+1)+1]=65535,$=0;$<=Z;$++)z=it,it=b[2*($+1)+1],++K<ot&&z===it||(K<Tt?_.bl_tree[2*z]+=K:z!==0?(z!==Q&&_.bl_tree[2*z]++,_.bl_tree[2*T]++):K<=10?_.bl_tree[2*F]++:_.bl_tree[2*y]++,Q=z,Tt=(K=0)===it?(ot=138,3):z===it?(ot=6,3):(ot=7,4))}function W(_,b,Z){var $,z,Q=-1,it=b[1],K=0,ot=7,Tt=4;for(it===0&&(ot=138,Tt=3),$=0;$<=Z;$++)if(z=it,it=b[2*($+1)+1],!(++K<ot&&z===it)){if(K<Tt)for(;tt(_,z,_.bl_tree),--K!=0;);else z!==0?(z!==Q&&(tt(_,z,_.bl_tree),K--),tt(_,T,_.bl_tree),et(_,K-3,2)):K<=10?(tt(_,F,_.bl_tree),et(_,K-3,3)):(tt(_,y,_.bl_tree),et(_,K-11,7));Q=z,Tt=(K=0)===it?(ot=138,3):z===it?(ot=6,3):(ot=7,4)}}a(k);var G=!1;function L(_,b,Z,$){et(_,(l<<1)+($?1:0),3),function(z,Q,it,K){ut(z),nt(z,it),nt(z,~it),n.arraySet(z.pending_buf,z.window,Q,it,z.pending),z.pending+=it}(_,b,Z)}i._tr_init=function(_){G||(function(){var b,Z,$,z,Q,it=new Array(m+1);for(z=$=0;z<h-1;z++)for(D[z]=$,b=0;b<1<<N[z];b++)R[$++]=z;for(R[$-1]=z,z=Q=0;z<16;z++)for(k[z]=Q,b=0;b<1<<w[z];b++)v[Q++]=z;for(Q>>=7;z<f;z++)for(k[z]=Q<<7,b=0;b<1<<w[z]-7;b++)v[256+Q++]=z;for(Z=0;Z<=m;Z++)it[Z]=0;for(b=0;b<=143;)x[2*b+1]=8,b++,it[8]++;for(;b<=255;)x[2*b+1]=9,b++,it[9]++;for(;b<=279;)x[2*b+1]=7,b++,it[7]++;for(;b<=287;)x[2*b+1]=8,b++,it[8]++;for(Nt(x,u+1,it),b=0;b<f;b++)O[2*b+1]=5,O[2*b]=Ft(b,5);X=new J(x,N,d+1,u,m),U=new J(O,w,0,f,m),j=new J(new Array(0),P,0,I,g)}(),G=!0),_.l_desc=new Y(_.dyn_ltree,X),_.d_desc=new Y(_.dyn_dtree,U),_.bl_desc=new Y(_.bl_tree,j),_.bi_buf=0,_.bi_valid=0,rt(_)},i._tr_stored_block=L,i._tr_flush_block=function(_,b,Z,$){var z,Q,it=0;0<_.level?(_.strm.data_type===2&&(_.strm.data_type=function(K){var ot,Tt=4093624447;for(ot=0;ot<=31;ot++,Tt>>>=1)if(1&Tt&&K.dyn_ltree[2*ot]!==0)return r;if(K.dyn_ltree[18]!==0||K.dyn_ltree[20]!==0||K.dyn_ltree[26]!==0)return o;for(ot=32;ot<d;ot++)if(K.dyn_ltree[2*ot]!==0)return o;return r}(_)),bt(_,_.l_desc),bt(_,_.d_desc),it=function(K){var ot;for(A(K,K.dyn_ltree,K.l_desc.max_code),A(K,K.dyn_dtree,K.d_desc.max_code),bt(K,K.bl_desc),ot=I-1;3<=ot&&K.bl_tree[2*M[ot]+1]===0;ot--);return K.opt_len+=3*(ot+1)+5+5+4,ot}(_),z=_.opt_len+3+7>>>3,(Q=_.static_len+3+7>>>3)<=z&&(z=Q)):z=Q=Z+5,Z+4<=z&&b!==-1?L(_,b,Z,$):_.strategy===4||Q===z?(et(_,2+($?1:0),3),Xt(_,x,O)):(et(_,4+($?1:0),3),function(K,ot,Tt,dt){var Zt;for(et(K,ot-257,5),et(K,Tt-1,5),et(K,dt-4,4),Zt=0;Zt<dt;Zt++)et(K,K.bl_tree[2*M[Zt]+1],3);W(K,K.dyn_ltree,ot-1),W(K,K.dyn_dtree,Tt-1)}(_,_.l_desc.max_code+1,_.d_desc.max_code+1,it+1),Xt(_,_.dyn_ltree,_.dyn_dtree)),rt(_),$&&ut(_)},i._tr_tally=function(_,b,Z){return _.pending_buf[_.d_buf+2*_.last_lit]=b>>>8&255,_.pending_buf[_.d_buf+2*_.last_lit+1]=255&b,_.pending_buf[_.l_buf+_.last_lit]=255&Z,_.last_lit++,b===0?_.dyn_ltree[2*Z]++:(_.matches++,b--,_.dyn_ltree[2*(R[Z]+d+1)]++,_.dyn_dtree[2*V(b)]++),_.last_lit===_.lit_bufsize-1},i._tr_align=function(_){et(_,2,3),tt(_,S,x),function(b){b.bi_valid===16?(nt(b,b.bi_buf),b.bi_buf=0,b.bi_valid=0):8<=b.bi_valid&&(b.pending_buf[b.pending++]=255&b.bi_buf,b.bi_buf>>=8,b.bi_valid-=8)}(_)}},{"../utils/common":41}],53:[function(e,s,i){s.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,s,i){(function(n){(function(r,o){if(!r.setImmediate){var a,l,h,d,u=1,f={},I=!1,E=r.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(r);m=m&&m.setTimeout?m:r,a={}.toString.call(r.process)==="[object process]"?function(T){process.nextTick(function(){g(T)})}:function(){if(r.postMessage&&!r.importScripts){var T=!0,F=r.onmessage;return r.onmessage=function(){T=!1},r.postMessage("","*"),r.onmessage=F,T}}()?(d="setImmediate$"+Math.random()+"$",r.addEventListener?r.addEventListener("message",S,!1):r.attachEvent("onmessage",S),function(T){r.postMessage(d+T,"*")}):r.MessageChannel?((h=new MessageChannel).port1.onmessage=function(T){g(T.data)},function(T){h.port2.postMessage(T)}):E&&"onreadystatechange"in E.createElement("script")?(l=E.documentElement,function(T){var F=E.createElement("script");F.onreadystatechange=function(){g(T),F.onreadystatechange=null,l.removeChild(F),F=null},l.appendChild(F)}):function(T){setTimeout(g,0,T)},m.setImmediate=function(T){typeof T!="function"&&(T=new Function(""+T));for(var F=new Array(arguments.length-1),y=0;y<F.length;y++)F[y]=arguments[y+1];var N={callback:T,args:F};return f[u]=N,a(u),u++},m.clearImmediate=C}function C(T){delete f[T]}function g(T){if(I)setTimeout(g,0,T);else{var F=f[T];if(F){I=!0;try{(function(y){var N=y.callback,w=y.args;switch(w.length){case 0:N();break;case 1:N(w[0]);break;case 2:N(w[0],w[1]);break;case 3:N(w[0],w[1],w[2]);break;default:N.apply(o,w)}})(F)}finally{C(T),I=!1}}}}function S(T){T.source===r&&typeof T.data=="string"&&T.data.indexOf(d)===0&&g(+T.data.slice(d.length))}})(typeof self>"u"?n===void 0?this:n:self)}).call(this,typeof Ti<"u"?Ti:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(pa);var su=pa.exports;const po=Uo(su);var Cr={},$i={};(function(c){const t=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",e=t+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",s="["+t+"]["+e+"]*",i=new RegExp("^"+s+"$"),n=function(o,a){const l=[];let h=a.exec(o);for(;h;){const d=[];d.startIndex=a.lastIndex-h[0].length;const u=h.length;for(let f=0;f<u;f++)d.push(h[f]);l.push(d),h=a.exec(o)}return l},r=function(o){const a=i.exec(o);return!(a===null||typeof a>"u")};c.isExist=function(o){return typeof o<"u"},c.isEmptyObject=function(o){return Object.keys(o).length===0},c.merge=function(o,a,l){if(a){const h=Object.keys(a),d=h.length;for(let u=0;u<d;u++)l==="strict"?o[h[u]]=[a[h[u]]]:o[h[u]]=a[h[u]]}},c.getValue=function(o){return c.isExist(o)?o:""},c.isName=r,c.getAllMatches=n,c.nameRegexp=s})($i);const Tr=$i,iu={allowBooleanAttributes:!1,unpairedTags:[]};Cr.validate=function(c,t){t=Object.assign({},iu,t);const e=[];let s=!1,i=!1;c[0]==="\uFEFF"&&(c=c.substr(1));for(let n=0;n<c.length;n++)if(c[n]==="<"&&c[n+1]==="?"){if(n+=2,n=To(c,n),n.err)return n}else if(c[n]==="<"){let r=n;if(n++,c[n]==="!"){n=mo(c,n);continue}else{let o=!1;c[n]==="/"&&(o=!0,n++);let a="";for(;n<c.length&&c[n]!==">"&&c[n]!==" "&&c[n]!=="	"&&c[n]!==`
`&&c[n]!=="\r";n++)a+=c[n];if(a=a.trim(),a[a.length-1]==="/"&&(a=a.substring(0,a.length-1),n--),!uu(a)){let d;return a.trim().length===0?d="Invalid space after '<'.":d="Tag '"+a+"' is an invalid name.",Pt("InvalidTag",d,Vt(c,n))}const l=ou(c,n);if(l===!1)return Pt("InvalidAttr","Attributes for '"+a+"' have open quote.",Vt(c,n));let h=l.value;if(n=l.index,h[h.length-1]==="/"){const d=n-h.length;h=h.substring(0,h.length-1);const u=go(h,t);if(u===!0)s=!0;else return Pt(u.err.code,u.err.msg,Vt(c,d+u.err.line))}else if(o)if(l.tagClosed){if(h.trim().length>0)return Pt("InvalidTag","Closing tag '"+a+"' can't have attributes or invalid starting.",Vt(c,r));if(e.length===0)return Pt("InvalidTag","Closing tag '"+a+"' has not been opened.",Vt(c,r));{const d=e.pop();if(a!==d.tagName){let u=Vt(c,d.tagStartPos);return Pt("InvalidTag","Expected closing tag '"+d.tagName+"' (opened in line "+u.line+", col "+u.col+") instead of closing tag '"+a+"'.",Vt(c,r))}e.length==0&&(i=!0)}}else return Pt("InvalidTag","Closing tag '"+a+"' doesn't have proper closing.",Vt(c,n));else{const d=go(h,t);if(d!==!0)return Pt(d.err.code,d.err.msg,Vt(c,n-h.length+d.err.line));if(i===!0)return Pt("InvalidXml","Multiple possible root nodes found.",Vt(c,n));t.unpairedTags.indexOf(a)!==-1||e.push({tagName:a,tagStartPos:r}),s=!0}for(n++;n<c.length;n++)if(c[n]==="<")if(c[n+1]==="!"){n++,n=mo(c,n);continue}else if(c[n+1]==="?"){if(n=To(c,++n),n.err)return n}else break;else if(c[n]==="&"){const d=lu(c,n);if(d==-1)return Pt("InvalidChar","char '&' is not expected.",Vt(c,n));n=d}else if(i===!0&&!Co(c[n]))return Pt("InvalidXml","Extra text at the end",Vt(c,n));c[n]==="<"&&n--}}else{if(Co(c[n]))continue;return Pt("InvalidChar","char '"+c[n]+"' is not expected.",Vt(c,n))}if(s){if(e.length==1)return Pt("InvalidTag","Unclosed tag '"+e[0].tagName+"'.",Vt(c,e[0].tagStartPos));if(e.length>0)return Pt("InvalidXml","Invalid '"+JSON.stringify(e.map(n=>n.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return Pt("InvalidXml","Start tag expected.",1);return!0};function Co(c){return c===" "||c==="	"||c===`
`||c==="\r"}function To(c,t){const e=t;for(;t<c.length;t++)if(c[t]=="?"||c[t]==" "){const s=c.substr(e,t-e);if(t>5&&s==="xml")return Pt("InvalidXml","XML declaration allowed only at the start of the document.",Vt(c,t));if(c[t]=="?"&&c[t+1]==">"){t++;break}else continue}return t}function mo(c,t){if(c.length>t+5&&c[t+1]==="-"&&c[t+2]==="-"){for(t+=3;t<c.length;t++)if(c[t]==="-"&&c[t+1]==="-"&&c[t+2]===">"){t+=2;break}}else if(c.length>t+8&&c[t+1]==="D"&&c[t+2]==="O"&&c[t+3]==="C"&&c[t+4]==="T"&&c[t+5]==="Y"&&c[t+6]==="P"&&c[t+7]==="E"){let e=1;for(t+=8;t<c.length;t++)if(c[t]==="<")e++;else if(c[t]===">"&&(e--,e===0))break}else if(c.length>t+9&&c[t+1]==="["&&c[t+2]==="C"&&c[t+3]==="D"&&c[t+4]==="A"&&c[t+5]==="T"&&c[t+6]==="A"&&c[t+7]==="["){for(t+=8;t<c.length;t++)if(c[t]==="]"&&c[t+1]==="]"&&c[t+2]===">"){t+=2;break}}return t}const nu='"',ru="'";function ou(c,t){let e="",s="",i=!1;for(;t<c.length;t++){if(c[t]===nu||c[t]===ru)s===""?s=c[t]:s!==c[t]||(s="");else if(c[t]===">"&&s===""){i=!0;break}e+=c[t]}return s!==""?!1:{value:e,index:t,tagClosed:i}}const au=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function go(c,t){const e=Tr.getAllMatches(c,au),s={};for(let i=0;i<e.length;i++){if(e[i][1].length===0)return Pt("InvalidAttr","Attribute '"+e[i][2]+"' has no space in starting.",xs(e[i]));if(e[i][3]!==void 0&&e[i][4]===void 0)return Pt("InvalidAttr","Attribute '"+e[i][2]+"' is without value.",xs(e[i]));if(e[i][3]===void 0&&!t.allowBooleanAttributes)return Pt("InvalidAttr","boolean attribute '"+e[i][2]+"' is not allowed.",xs(e[i]));const n=e[i][2];if(!hu(n))return Pt("InvalidAttr","Attribute '"+n+"' is an invalid name.",xs(e[i]));if(!s.hasOwnProperty(n))s[n]=1;else return Pt("InvalidAttr","Attribute '"+n+"' is repeated.",xs(e[i]))}return!0}function cu(c,t){let e=/\d/;for(c[t]==="x"&&(t++,e=/[\da-fA-F]/);t<c.length;t++){if(c[t]===";")return t;if(!c[t].match(e))break}return-1}function lu(c,t){if(t++,c[t]===";")return-1;if(c[t]==="#")return t++,cu(c,t);let e=0;for(;t<c.length;t++,e++)if(!(c[t].match(/\w/)&&e<20)){if(c[t]===";")break;return-1}return t}function Pt(c,t,e){return{err:{code:c,msg:t,line:e.line||e,col:e.col}}}function hu(c){return Tr.isName(c)}function uu(c){return Tr.isName(c)}function Vt(c,t){const e=c.substring(0,t).split(/\r?\n/);return{line:e.length,col:e[e.length-1].length+1}}function xs(c){return c.startIndex+c[1].length}var mr={};const Ca={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(c,t){return t},attributeValueProcessor:function(c,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(c,t,e){return c}},fu=function(c){return Object.assign({},Ca,c)};mr.buildOptions=fu;mr.defaultOptions=Ca;class du{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,e){t==="__proto__"&&(t="#__proto__"),this.child.push({[t]:e})}addChild(t){t.tagname==="__proto__"&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child})}}var Iu=du;const Eu=$i;function pu(c,t){const e={};if(c[t+3]==="O"&&c[t+4]==="C"&&c[t+5]==="T"&&c[t+6]==="Y"&&c[t+7]==="P"&&c[t+8]==="E"){t=t+9;let s=1,i=!1,n=!1,r="";for(;t<c.length;t++)if(c[t]==="<"&&!n)i&&Tu(c,t)?(t+=7,[entityName,val,t]=Cu(c,t+1),val.indexOf("&")===-1&&(e[Au(entityName)]={regx:RegExp(`&${entityName};`,"g"),val})):i&&mu(c,t)||i&&gu(c,t)?t+=8:i&&Ru(c,t)?t+=9:n=!0,s++,r="";else if(c[t]===">"){if(n?c[t-1]==="-"&&c[t-2]==="-"&&(n=!1,s--):s--,s===0)break}else c[t]==="["?i=!0:r+=c[t];if(s!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:e,i:t}}function Cu(c,t){let e="";for(;t<c.length&&c[t]!=="'"&&c[t]!=='"';t++)e+=c[t];if(e=e.trim(),e.indexOf(" ")!==-1)throw new Error("External entites are not supported");const s=c[t++];let i="";for(;t<c.length&&c[t]!==s;t++)i+=c[t];return[e,i,t]}function Tu(c,t){return c[t+1]==="!"&&c[t+2]==="E"&&c[t+3]==="N"&&c[t+4]==="T"&&c[t+5]==="I"&&c[t+6]==="T"&&c[t+7]==="Y"}function mu(c,t){return c[t+1]==="!"&&c[t+2]==="E"&&c[t+3]==="L"&&c[t+4]==="E"&&c[t+5]==="M"&&c[t+6]==="E"&&c[t+7]==="N"&&c[t+8]==="T"}function gu(c,t){return c[t+1]==="!"&&c[t+2]==="A"&&c[t+3]==="T"&&c[t+4]==="T"&&c[t+5]==="L"&&c[t+6]==="I"&&c[t+7]==="S"&&c[t+8]==="T"}function Ru(c,t){return c[t+1]==="!"&&c[t+2]==="N"&&c[t+3]==="O"&&c[t+4]==="T"&&c[t+5]==="A"&&c[t+6]==="T"&&c[t+7]==="I"&&c[t+8]==="O"&&c[t+9]==="N"}function Au(c){if(Eu.isName(c))return c;throw new Error(`Invalid entity name ${c}`)}var Fu=pu;const Su=/^[-+]?0x[a-fA-F0-9]+$/,Ou=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const yu={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function Nu(c,t={}){if(t=Object.assign({},yu,t),!c||typeof c!="string")return c;let e=c.trim();if(t.skipLike!==void 0&&t.skipLike.test(e))return c;if(t.hex&&Su.test(e))return Number.parseInt(e,16);{const s=Ou.exec(e);if(s){const i=s[1],n=s[2];let r=_u(s[3]);const o=s[4]||s[6];if(!t.leadingZeros&&n.length>0&&i&&e[2]!==".")return c;if(!t.leadingZeros&&n.length>0&&!i&&e[1]!==".")return c;{const a=Number(e),l=""+a;return l.search(/[eE]/)!==-1||o?t.eNotation?a:c:e.indexOf(".")!==-1?l==="0"&&r===""||l===r||i&&l==="-"+r?a:c:n?r===l||i+r===l?a:c:e===l||e===i+l?a:c}}else return c}}function _u(c){return c&&c.indexOf(".")!==-1&&(c=c.replace(/0+$/,""),c==="."?c="0":c[0]==="."?c="0"+c:c[c.length-1]==="."&&(c=c.substr(0,c.length-1))),c}var Pu=Nu;const Ta=$i,Us=Iu,Lu=Fu,wu=Pu;let Mu=class{constructor(t){this.options=t,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:""},pound:{regex:/&(pound|#163);/g,val:""},yen:{regex:/&(yen|#165);/g,val:""},euro:{regex:/&(euro|#8364);/g,val:""},copyright:{regex:/&(copy|#169);/g,val:""},reg:{regex:/&(reg|#174);/g,val:""},inr:{regex:/&(inr|#8377);/g,val:""},num_dec:{regex:/&#([0-9]{1,7});/g,val:(e,s)=>String.fromCharCode(Number.parseInt(s,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(e,s)=>String.fromCharCode(Number.parseInt(s,16))}},this.addExternalEntities=vu,this.parseXml=Bu,this.parseTextData=Du,this.resolveNameSpace=bu,this.buildAttributesMap=Uu,this.isItStopNode=Gu,this.replaceEntitiesValue=Yu,this.readStopNodeData=Hu,this.saveTextToParentTag=zu,this.addChild=Vu}};function vu(c){const t=Object.keys(c);for(let e=0;e<t.length;e++){const s=t[e];this.lastEntities[s]={regex:new RegExp("&"+s+";","g"),val:c[s]}}}function Du(c,t,e,s,i,n,r){if(c!==void 0&&(this.options.trimValues&&!s&&(c=c.trim()),c.length>0)){r||(c=this.replaceEntitiesValue(c));const o=this.options.tagValueProcessor(t,c,e,i,n);return o==null?c:typeof o!=typeof c||o!==c?o:this.options.trimValues?Vn(c,this.options.parseTagValue,this.options.numberParseOptions):c.trim()===c?Vn(c,this.options.parseTagValue,this.options.numberParseOptions):c}}function bu(c){if(this.options.removeNSPrefix){const t=c.split(":"),e=c.charAt(0)==="/"?"/":"";if(t[0]==="xmlns")return"";t.length===2&&(c=e+t[1])}return c}const xu=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function Uu(c,t,e){if(!this.options.ignoreAttributes&&typeof c=="string"){const s=Ta.getAllMatches(c,xu),i=s.length,n={};for(let r=0;r<i;r++){const o=this.resolveNameSpace(s[r][1]);let a=s[r][4],l=this.options.attributeNamePrefix+o;if(o.length)if(this.options.transformAttributeName&&(l=this.options.transformAttributeName(l)),l==="__proto__"&&(l="#__proto__"),a!==void 0){this.options.trimValues&&(a=a.trim()),a=this.replaceEntitiesValue(a);const h=this.options.attributeValueProcessor(o,a,t);h==null?n[l]=a:typeof h!=typeof a||h!==a?n[l]=h:n[l]=Vn(a,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(n[l]=!0)}if(!Object.keys(n).length)return;if(this.options.attributesGroupName){const r={};return r[this.options.attributesGroupName]=n,r}return n}}const Bu=function(c){c=c.replace(/\r\n?/g,`
`);const t=new Us("!xml");let e=t,s="",i="";for(let n=0;n<c.length;n++)if(c[n]==="<")if(c[n+1]==="/"){const o=Ge(c,">",n,"Closing Tag is not closed.");let a=c.substring(n+2,o).trim();if(this.options.removeNSPrefix){const d=a.indexOf(":");d!==-1&&(a=a.substr(d+1))}this.options.transformTagName&&(a=this.options.transformTagName(a)),e&&(s=this.saveTextToParentTag(s,e,i));const l=i.substring(i.lastIndexOf(".")+1);if(a&&this.options.unpairedTags.indexOf(a)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${a}>`);let h=0;l&&this.options.unpairedTags.indexOf(l)!==-1?(h=i.lastIndexOf(".",i.lastIndexOf(".")-1),this.tagsNodeStack.pop()):h=i.lastIndexOf("."),i=i.substring(0,h),e=this.tagsNodeStack.pop(),s="",n=o}else if(c[n+1]==="?"){let o=Bn(c,n,!1,"?>");if(!o)throw new Error("Pi Tag is not closed.");if(s=this.saveTextToParentTag(s,e,i),!(this.options.ignoreDeclaration&&o.tagName==="?xml"||this.options.ignorePiTags)){const a=new Us(o.tagName);a.add(this.options.textNodeName,""),o.tagName!==o.tagExp&&o.attrExpPresent&&(a[":@"]=this.buildAttributesMap(o.tagExp,i,o.tagName)),this.addChild(e,a,i)}n=o.closeIndex+1}else if(c.substr(n+1,3)==="!--"){const o=Ge(c,"-->",n+4,"Comment is not closed.");if(this.options.commentPropName){const a=c.substring(n+4,o-2);s=this.saveTextToParentTag(s,e,i),e.add(this.options.commentPropName,[{[this.options.textNodeName]:a}])}n=o}else if(c.substr(n+1,2)==="!D"){const o=Lu(c,n);this.docTypeEntities=o.entities,n=o.i}else if(c.substr(n+1,2)==="!["){const o=Ge(c,"]]>",n,"CDATA is not closed.")-2,a=c.substring(n+9,o);s=this.saveTextToParentTag(s,e,i);let l=this.parseTextData(a,e.tagname,i,!0,!1,!0,!0);l==null&&(l=""),this.options.cdataPropName?e.add(this.options.cdataPropName,[{[this.options.textNodeName]:a}]):e.add(this.options.textNodeName,l),n=o+2}else{let o=Bn(c,n,this.options.removeNSPrefix),a=o.tagName;const l=o.rawTagName;let h=o.tagExp,d=o.attrExpPresent,u=o.closeIndex;this.options.transformTagName&&(a=this.options.transformTagName(a)),e&&s&&e.tagname!=="!xml"&&(s=this.saveTextToParentTag(s,e,i,!1));const f=e;if(f&&this.options.unpairedTags.indexOf(f.tagname)!==-1&&(e=this.tagsNodeStack.pop(),i=i.substring(0,i.lastIndexOf("."))),a!==t.tagname&&(i+=i?"."+a:a),this.isItStopNode(this.options.stopNodes,i,a)){let I="";if(h.length>0&&h.lastIndexOf("/")===h.length-1)a[a.length-1]==="/"?(a=a.substr(0,a.length-1),i=i.substr(0,i.length-1),h=a):h=h.substr(0,h.length-1),n=o.closeIndex;else if(this.options.unpairedTags.indexOf(a)!==-1)n=o.closeIndex;else{const m=this.readStopNodeData(c,l,u+1);if(!m)throw new Error(`Unexpected end of ${l}`);n=m.i,I=m.tagContent}const E=new Us(a);a!==h&&d&&(E[":@"]=this.buildAttributesMap(h,i,a)),I&&(I=this.parseTextData(I,a,i,!0,d,!0,!0)),i=i.substr(0,i.lastIndexOf(".")),E.add(this.options.textNodeName,I),this.addChild(e,E,i)}else{if(h.length>0&&h.lastIndexOf("/")===h.length-1){a[a.length-1]==="/"?(a=a.substr(0,a.length-1),i=i.substr(0,i.length-1),h=a):h=h.substr(0,h.length-1),this.options.transformTagName&&(a=this.options.transformTagName(a));const I=new Us(a);a!==h&&d&&(I[":@"]=this.buildAttributesMap(h,i,a)),this.addChild(e,I,i),i=i.substr(0,i.lastIndexOf("."))}else{const I=new Us(a);this.tagsNodeStack.push(e),a!==h&&d&&(I[":@"]=this.buildAttributesMap(h,i,a)),this.addChild(e,I,i),e=I}s="",n=u}}else s+=c[n];return t.child};function Vu(c,t,e){const s=this.options.updateTag(t.tagname,e,t[":@"]);s===!1||(typeof s=="string"&&(t.tagname=s),c.addChild(t))}const Yu=function(c){if(this.options.processEntities){for(let t in this.docTypeEntities){const e=this.docTypeEntities[t];c=c.replace(e.regx,e.val)}for(let t in this.lastEntities){const e=this.lastEntities[t];c=c.replace(e.regex,e.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){const e=this.htmlEntities[t];c=c.replace(e.regex,e.val)}c=c.replace(this.ampEntity.regex,this.ampEntity.val)}return c};function zu(c,t,e,s){return c&&(s===void 0&&(s=Object.keys(t.child).length===0),c=this.parseTextData(c,t.tagname,e,!1,t[":@"]?Object.keys(t[":@"]).length!==0:!1,s),c!==void 0&&c!==""&&t.add(this.options.textNodeName,c),c=""),c}function Gu(c,t,e){const s="*."+e;for(const i in c){const n=c[i];if(s===n||t===n)return!0}return!1}function ku(c,t,e=">"){let s,i="";for(let n=t;n<c.length;n++){let r=c[n];if(s)r===s&&(s="");else if(r==='"'||r==="'")s=r;else if(r===e[0])if(e[1]){if(c[n+1]===e[1])return{data:i,index:n}}else return{data:i,index:n};else r==="	"&&(r=" ");i+=r}}function Ge(c,t,e,s){const i=c.indexOf(t,e);if(i===-1)throw new Error(s);return i+t.length-1}function Bn(c,t,e,s=">"){const i=ku(c,t+1,s);if(!i)return;let n=i.data;const r=i.index,o=n.search(/\s/);let a=n,l=!0;o!==-1&&(a=n.substring(0,o),n=n.substring(o+1).trimStart());const h=a;if(e){const d=a.indexOf(":");d!==-1&&(a=a.substr(d+1),l=a!==i.data.substr(d+1))}return{tagName:a,tagExp:n,closeIndex:r,attrExpPresent:l,rawTagName:h}}function Hu(c,t,e){const s=e;let i=1;for(;e<c.length;e++)if(c[e]==="<")if(c[e+1]==="/"){const n=Ge(c,">",e,`${t} is not closed`);if(c.substring(e+2,n).trim()===t&&(i--,i===0))return{tagContent:c.substring(s,e),i:n};e=n}else if(c[e+1]==="?")e=Ge(c,"?>",e+1,"StopNode is not closed.");else if(c.substr(e+1,3)==="!--")e=Ge(c,"-->",e+3,"StopNode is not closed.");else if(c.substr(e+1,2)==="![")e=Ge(c,"]]>",e,"StopNode is not closed.")-2;else{const n=Bn(c,e,">");n&&((n&&n.tagName)===t&&n.tagExp[n.tagExp.length-1]!=="/"&&i++,e=n.closeIndex)}}function Vn(c,t,e){if(t&&typeof c=="string"){const s=c.trim();return s==="true"?!0:s==="false"?!1:wu(c,e)}else return Ta.isExist(c)?c:""}var Wu=Mu,ma={};function Xu(c,t){return ga(c,t)}function ga(c,t,e){let s;const i={};for(let n=0;n<c.length;n++){const r=c[n],o=Zu(r);let a="";if(e===void 0?a=o:a=e+"."+o,o===t.textNodeName)s===void 0?s=r[o]:s+=""+r[o];else{if(o===void 0)continue;if(r[o]){let l=ga(r[o],t,a);const h=ju(l,t);r[":@"]?$u(l,r[":@"],a,t):Object.keys(l).length===1&&l[t.textNodeName]!==void 0&&!t.alwaysCreateTextNode?l=l[t.textNodeName]:Object.keys(l).length===0&&(t.alwaysCreateTextNode?l[t.textNodeName]="":l=""),i[o]!==void 0&&i.hasOwnProperty(o)?(Array.isArray(i[o])||(i[o]=[i[o]]),i[o].push(l)):t.isArray(o,a,h)?i[o]=[l]:i[o]=l}}}return typeof s=="string"?s.length>0&&(i[t.textNodeName]=s):s!==void 0&&(i[t.textNodeName]=s),i}function Zu(c){const t=Object.keys(c);for(let e=0;e<t.length;e++){const s=t[e];if(s!==":@")return s}}function $u(c,t,e,s){if(t){const i=Object.keys(t),n=i.length;for(let r=0;r<n;r++){const o=i[r];s.isArray(o,e+"."+o,!0,!0)?c[o]=[t[o]]:c[o]=t[o]}}}function ju(c,t){const{textNodeName:e}=t,s=Object.keys(c).length;return!!(s===0||s===1&&(c[e]||typeof c[e]=="boolean"||c[e]===0))}ma.prettify=Xu;const{buildOptions:qu}=mr,Qu=Wu,{prettify:Ku}=ma,Ju=Cr;let tf=class{constructor(t){this.externalEntities={},this.options=qu(t)}parse(t,e){if(typeof t!="string")if(t.toString)t=t.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(e){e===!0&&(e={});const n=Ju.validate(t,e);if(n!==!0)throw Error(`${n.err.msg}:${n.err.line}:${n.err.col}`)}const s=new Qu(this.options);s.addExternalEntities(this.externalEntities);const i=s.parseXml(t);return this.options.preserveOrder||i===void 0?i:Ku(i,this.options)}addEntity(t,e){if(e.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(t.indexOf("&")!==-1||t.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(e==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[t]=e}};var ef=tf;const sf=`
`;function nf(c,t){let e="";return t.format&&t.indentBy.length>0&&(e=sf),Ra(c,t,"",e)}function Ra(c,t,e,s){let i="",n=!1;for(let r=0;r<c.length;r++){const o=c[r],a=rf(o);if(a===void 0)continue;let l="";if(e.length===0?l=a:l=`${e}.${a}`,a===t.textNodeName){let I=o[a];of(l,t)||(I=t.tagValueProcessor(a,I),I=Aa(I,t)),n&&(i+=s),i+=I,n=!1;continue}else if(a===t.cdataPropName){n&&(i+=s),i+=`<![CDATA[${o[a][0][t.textNodeName]}]]>`,n=!1;continue}else if(a===t.commentPropName){i+=s+`<!--${o[a][0][t.textNodeName]}-->`,n=!0;continue}else if(a[0]==="?"){const I=Ro(o[":@"],t),E=a==="?xml"?"":s;let m=o[a][0][t.textNodeName];m=m.length!==0?" "+m:"",i+=E+`<${a}${m}${I}?>`,n=!0;continue}let h=s;h!==""&&(h+=t.indentBy);const d=Ro(o[":@"],t),u=s+`<${a}${d}`,f=Ra(o[a],t,l,h);t.unpairedTags.indexOf(a)!==-1?t.suppressUnpairedNode?i+=u+">":i+=u+"/>":(!f||f.length===0)&&t.suppressEmptyNode?i+=u+"/>":f&&f.endsWith(">")?i+=u+`>${f}${s}</${a}>`:(i+=u+">",f&&s!==""&&(f.includes("/>")||f.includes("</"))?i+=s+t.indentBy+f+s:i+=f,i+=`</${a}>`),n=!0}return i}function rf(c){const t=Object.keys(c);for(let e=0;e<t.length;e++){const s=t[e];if(c.hasOwnProperty(s)&&s!==":@")return s}}function Ro(c,t){let e="";if(c&&!t.ignoreAttributes)for(let s in c){if(!c.hasOwnProperty(s))continue;let i=t.attributeValueProcessor(s,c[s]);i=Aa(i,t),i===!0&&t.suppressBooleanAttributes?e+=` ${s.substr(t.attributeNamePrefix.length)}`:e+=` ${s.substr(t.attributeNamePrefix.length)}="${i}"`}return e}function of(c,t){c=c.substr(0,c.length-t.textNodeName.length-1);let e=c.substr(c.lastIndexOf(".")+1);for(let s in t.stopNodes)if(t.stopNodes[s]===c||t.stopNodes[s]==="*."+e)return!0;return!1}function Aa(c,t){if(c&&c.length>0&&t.processEntities)for(let e=0;e<t.entities.length;e++){const s=t.entities[e];c=c.replace(s.regex,s.val)}return c}var af=nf;const cf=af,lf={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(c,t){return t},attributeValueProcessor:function(c,t){return t},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function be(c){this.options=Object.assign({},lf,c),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=ff),this.processTextOrObjNode=hf,this.options.format?(this.indentate=uf,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}be.prototype.build=function(c){return this.options.preserveOrder?cf(c,this.options):(Array.isArray(c)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(c={[this.options.arrayNodeName]:c}),this.j2x(c,0).val)};be.prototype.j2x=function(c,t){let e="",s="";for(let i in c)if(Object.prototype.hasOwnProperty.call(c,i))if(typeof c[i]>"u")this.isAttribute(i)&&(s+="");else if(c[i]===null)this.isAttribute(i)?s+="":i[0]==="?"?s+=this.indentate(t)+"<"+i+"?"+this.tagEndChar:s+=this.indentate(t)+"<"+i+"/"+this.tagEndChar;else if(c[i]instanceof Date)s+=this.buildTextValNode(c[i],i,"",t);else if(typeof c[i]!="object"){const n=this.isAttribute(i);if(n)e+=this.buildAttrPairStr(n,""+c[i]);else if(i===this.options.textNodeName){let r=this.options.tagValueProcessor(i,""+c[i]);s+=this.replaceEntitiesValue(r)}else s+=this.buildTextValNode(c[i],i,"",t)}else if(Array.isArray(c[i])){const n=c[i].length;let r="",o="";for(let a=0;a<n;a++){const l=c[i][a];if(!(typeof l>"u"))if(l===null)i[0]==="?"?s+=this.indentate(t)+"<"+i+"?"+this.tagEndChar:s+=this.indentate(t)+"<"+i+"/"+this.tagEndChar;else if(typeof l=="object")if(this.options.oneListGroup){const h=this.j2x(l,t+1);r+=h.val,this.options.attributesGroupName&&l.hasOwnProperty(this.options.attributesGroupName)&&(o+=h.attrStr)}else r+=this.processTextOrObjNode(l,i,t);else if(this.options.oneListGroup){let h=this.options.tagValueProcessor(i,l);h=this.replaceEntitiesValue(h),r+=h}else r+=this.buildTextValNode(l,i,"",t)}this.options.oneListGroup&&(r=this.buildObjectNode(r,i,o,t)),s+=r}else if(this.options.attributesGroupName&&i===this.options.attributesGroupName){const n=Object.keys(c[i]),r=n.length;for(let o=0;o<r;o++)e+=this.buildAttrPairStr(n[o],""+c[i][n[o]])}else s+=this.processTextOrObjNode(c[i],i,t);return{attrStr:e,val:s}};be.prototype.buildAttrPairStr=function(c,t){return t=this.options.attributeValueProcessor(c,""+t),t=this.replaceEntitiesValue(t),this.options.suppressBooleanAttributes&&t==="true"?" "+c:" "+c+'="'+t+'"'};function hf(c,t,e){const s=this.j2x(c,e+1);return c[this.options.textNodeName]!==void 0&&Object.keys(c).length===1?this.buildTextValNode(c[this.options.textNodeName],t,s.attrStr,e):this.buildObjectNode(s.val,t,s.attrStr,e)}be.prototype.buildObjectNode=function(c,t,e,s){if(c==="")return t[0]==="?"?this.indentate(s)+"<"+t+e+"?"+this.tagEndChar:this.indentate(s)+"<"+t+e+this.closeTag(t)+this.tagEndChar;{let i="</"+t+this.tagEndChar,n="";return t[0]==="?"&&(n="?",i=""),(e||e==="")&&c.indexOf("<")===-1?this.indentate(s)+"<"+t+e+n+">"+c+i:this.options.commentPropName!==!1&&t===this.options.commentPropName&&n.length===0?this.indentate(s)+`<!--${c}-->`+this.newLine:this.indentate(s)+"<"+t+e+n+this.tagEndChar+c+this.indentate(s)+i}};be.prototype.closeTag=function(c){let t="";return this.options.unpairedTags.indexOf(c)!==-1?this.options.suppressUnpairedNode||(t="/"):this.options.suppressEmptyNode?t="/":t=`></${c}`,t};be.prototype.buildTextValNode=function(c,t,e,s){if(this.options.cdataPropName!==!1&&t===this.options.cdataPropName)return this.indentate(s)+`<![CDATA[${c}]]>`+this.newLine;if(this.options.commentPropName!==!1&&t===this.options.commentPropName)return this.indentate(s)+`<!--${c}-->`+this.newLine;if(t[0]==="?")return this.indentate(s)+"<"+t+e+"?"+this.tagEndChar;{let i=this.options.tagValueProcessor(t,c);return i=this.replaceEntitiesValue(i),i===""?this.indentate(s)+"<"+t+e+this.closeTag(t)+this.tagEndChar:this.indentate(s)+"<"+t+e+">"+i+"</"+t+this.tagEndChar}};be.prototype.replaceEntitiesValue=function(c){if(c&&c.length>0&&this.options.processEntities)for(let t=0;t<this.options.entities.length;t++){const e=this.options.entities[t];c=c.replace(e.regex,e.val)}return c};function uf(c){return this.options.indentBy.repeat(c)}function ff(c){return c.startsWith(this.options.attributeNamePrefix)&&c!==this.options.textNodeName?c.substr(this.attrPrefixLen):!1}var df=be;const If=Cr,Ef=ef,pf=df;var Fa={XMLParser:Ef,XMLValidator:If,XMLBuilder:pf};class Yn{constructor(t,e){p(this,"date",new Date),p(this,"author"),p(this,"guid",Ae.create()),p(this,"viewpoint"),p(this,"modifiedAuthor"),p(this,"modifiedDate"),p(this,"topic"),p(this,"_components"),p(this,"_comment",""),this._components=t,this._comment=e;const s=this._components.get(Yt);this.author=s.config.author}set comment(t){var e;const s=this._components.get(Yt);this._comment=t,this.modifiedDate=new Date,this.modifiedAuthor=s.config.author,(e=this.topic)==null||e.comments.set(this.guid,this)}get comment(){return this._comment}serialize(){let t=null;this.viewpoint&&(t=`<Viewpoint Guid="${this.viewpoint.guid}"/>`);let e=null;this.modifiedDate&&(e=`<ModifiedDate>${this.modifiedDate.toISOString()}</ModifiedDate>`);let s=null;return this.modifiedAuthor&&(s=`<ModifiedAuthor>${this.modifiedAuthor}</ModifiedAuthor>`),`
      <Comment Guid="${this.guid}">
        <Date>${this.date.toISOString()}</Date>
        <Author>${this.author}</Author>
        <Comment>${this.comment}</Comment>
        ${t??""}
        ${s??""}
        ${e??""}
      </Comment>
    `}}const Sa=class Ne{constructor(t){p(this,"guid",Ae.create()),p(this,"title",Ne.default.title),p(this,"creationDate",new Date),p(this,"creationAuthor",""),p(this,"viewpoints",new ve),p(this,"relatedTopics",new ve),p(this,"comments",new oe),p(this,"customData",{}),p(this,"description"),p(this,"serverAssignedId"),p(this,"dueDate"),p(this,"modifiedAuthor"),p(this,"modifiedDate"),p(this,"index"),p(this,"_type",Ne.default.type),p(this,"_status",Ne.default.status),p(this,"_priority",Ne.default.priority),p(this,"_stage",Ne.default.stage),p(this,"_assignedTo",Ne.default.assignedTo),p(this,"_labels",Ne.default.labels??new Set),p(this,"_components"),this._components=t;const e=t.get(Yt);this.creationAuthor=e.config.author,this.relatedTopics.guard=s=>s!==this.guid}set type(t){const e=this._components.get(Yt),{strict:s,types:i}=e.config;(!s||i.has(t))&&(this._type=t)}get type(){return this._type}set status(t){const e=this._components.get(Yt),{strict:s,statuses:i}=e.config;(!s||i.has(t))&&(this._status=t)}get status(){return this._status}set priority(t){const e=this._components.get(Yt);if(t){const{strict:s,priorities:i}=e.config;if(!(s?i.has(t):!0))return;this._priority=t}else this._priority=t}get priority(){return this._priority}set stage(t){const e=this._components.get(Yt);if(t){const{strict:s,stages:i}=e.config;if(!(s?i.has(t):!0))return;this._stage=t}else this._stage=t}get stage(){return this._stage}set assignedTo(t){const e=this._components.get(Yt);if(t){const{strict:s,users:i}=e.config;if(!(s?i.has(t):!0))return;this._assignedTo=t}else this._assignedTo=t}get assignedTo(){return this._assignedTo}set labels(t){const e=this._components.get(Yt),{strict:s,labels:i}=e.config;if(s){const n=new Set;for(const r of t)(!s||i.has(r))&&n.add(r);this._labels=n}else this._labels=t}get labels(){return this._labels}get _managerVersion(){return this._components.get(Yt).config.version}set(t){const e=t,s=this;for(const n in t){if(n==="guid")continue;const r=e[n];n in this&&(s[n]=r)}return this._components.get(Yt).list.set(this.guid,this),this}createComment(t,e){const s=new Yn(this._components,t);return s.viewpoint=e,s.topic=this,this.comments.set(s.guid,s),s}createLabelTags(t=this._managerVersion){let e="Labels";t==="2.1"&&(e="Labels"),t==="3"&&(e="Label");let s=[...this.labels].map(i=>`<${e}>${i}</${e}>`).join(`
`);for(const i in this.customData){const n=this.customData[i];typeof n=="string"&&(s+=`
<${e}>${n}</${e}>`)}return t==="2.1"?s:t==="3"?s.length!==0?`<Labels>
${s}
</Labels>`:"<Labels/>":s}createCommentTags(t=this._managerVersion){const e=[...this.comments.values()].map(s=>s.serialize()).join(`
`);return t==="2.1"?e:t==="3"?e.length!==0?`<Comments>
${e}
</Comments>`:"<Comments/>":e}createViewpointTags(t=this._managerVersion){let e="Viewpoints";t==="2.1"&&(e="Viewpoints"),t==="3"&&(e="ViewPoint");const s=this._components.get(Ce),n=[...this.viewpoints].map(r=>s.list.get(r)).filter(r=>r).map(r=>`<${e} Guid="${r.guid}">
          <Viewpoint>${r.guid}.bcfv</Viewpoint>
          <Snapshot>${r.guid}.jpeg</Snapshot>
        </${e}>
      `).join(`
`);return t==="2.1"?n:t==="3"?n.length!==0?`<Viewpoints>
${n}
</Viewpoints>`:"<Viewpoints />":n}createRelatedTopicTags(t=this._managerVersion){const e=[...this.relatedTopics].map(s=>`<RelatedTopic Guid="${s}"></RelatedTopic>
      `).join(`
`);return t==="2.1"?e:t==="3"?e.length!==0?`<RelatedTopics>
${e}
</RelatedTopics>`:"<RelatedTopics />":e}serialize(){const t=this._managerVersion;let e=null;this.serverAssignedId&&(e=`ServerAssignedId="${this.serverAssignedId}"`);let s=null;this.priority&&(s=`<Priority>${this.priority}</Priority>`);let i=null;this.index&&t==="2.1"&&(i=`<Index>${this.index}</Index>`);let n=null;this.modifiedDate&&(n=`<ModifiedDate>${this.modifiedDate.toISOString()}</ModifiedDate>`);let r=null;this.modifiedAuthor&&(r=`<ModifiedAuthor>${this.modifiedAuthor}</ModifiedAuthor>`);let o=null;this.dueDate&&(o=`<DueDate>${this.dueDate.toISOString()}</DueDate>`);let a=null;this.assignedTo&&(a=`<AssignedTo>${this.assignedTo}</AssignedTo>`);let l=null;this.description&&(l=`<Description>${this.description}</Description>`);let h=null;this.stage&&(h=`<Stage>${this.stage}</Stage>`);const d=this.createCommentTags(t),u=this.createViewpointTags(t),f=this.createLabelTags(t),I=this.createRelatedTopicTags(t);return`
      <?xml version="1.0" encoding="UTF-8"?>
      <Markup>
        <Topic Guid="${this.guid}" TopicType="${this.type}" TopicStatus="${this.status}" ${e??""}>
          <Title>${this.title}</Title>
          <CreationDate>${this.creationDate.toISOString()}</CreationDate>
          <CreationAuthor>${this.creationAuthor}</CreationAuthor>
          ${s??""}
          ${i??""}
          ${n??""}
          ${r??""}
          ${o??""}
          ${a??""}
          ${l??""}
          ${h??""}
          ${f}
          ${I}
          ${t==="3"?d:""}
          ${t==="3"?u:""}
        </Topic>
        ${t==="2.1"?d:""}
        ${t==="2.1"?u:""}
      </Markup>
    `}};p(Sa,"default",{title:"BCF Topic",type:"Issue",status:"Active"});let Ao=Sa;const Cf=(c,t)=>{if(t.trim()==="")return;const e=Yt.xmlParser.parse(t).Extensions;if(!e)return;const{Priorities:s,TopicStatuses:i,TopicTypes:n,Users:r}=e;if(s&&s.Priority){const o=Array.isArray(s.Priority)?s.Priority:[s.Priority];for(const a of o)c.config.priorities.add(a)}if(i&&i.TopicStatus){const o=Array.isArray(i.TopicStatus)?i.TopicStatus:[i.TopicStatus];for(const a of o)c.config.statuses.add(a)}if(n&&n.TopicType){const o=Array.isArray(n.TopicType)?n.TopicType:[n.TopicType];for(const a of o)c.config.types.add(a)}if(r&&r.User){const o=Array.isArray(r.User)?r.User:[r.User];for(const a of o)c.config.users.add(a)}};class Tf extends Ze{constructor(){super(...arguments),p(this,"_config",{version:{type:"Select",options:new Set(["2.1","3"]),multiple:!1,value:""},author:{type:"Text",value:""},types:{type:"TextSet",value:new Set},statuses:{type:"TextSet",value:new Set},priorities:{type:"TextSet",value:new Set},labels:{type:"TextSet",value:new Set},stages:{type:"TextSet",value:new Set},users:{type:"TextSet",value:new Set},includeSelectionTag:{type:"Boolean",value:!1},updateExtensionsOnImport:{type:"Boolean",value:!1},strict:{type:"Boolean",value:!1},includeAllExtensionsOnExport:{type:"Boolean",value:!1},fallbackVersionOnImport:{type:"Select",multiple:!1,options:new Set(["2.1","3"]),value:""},ignoreIncompleteTopicsOnImport:{type:"Boolean",value:!1}})}get version(){return this._config.version.value}set version(t){this._config.version.value=t}get author(){return this._config.author.value}set author(t){this._config.author.value=t}get types(){return this._config.types.value}set types(t){this._config.types.value=t}get statuses(){return this._config.statuses.value}set statuses(t){this._config.statuses.value=t}get priorities(){return this._config.priorities.value}set priorities(t){this._config.priorities.value=t}get labels(){return this._config.labels.value}set labels(t){this._config.labels.value=t}get stages(){return this._config.stages.value}set stages(t){this._config.stages.value=t}get users(){return this._config.users.value}set users(t){this._config.users.value=t}get includeSelectionTag(){return this._config.includeSelectionTag.value}set includeSelectionTag(t){this._config.includeSelectionTag.value=t}get updateExtensionsOnImport(){return this._config.updateExtensionsOnImport.value}set updateExtensionsOnImport(t){this._config.updateExtensionsOnImport.value=t}get strict(){return this._config.strict.value}set strict(t){this._config.strict.value=t}get includeAllExtensionsOnExport(){return this._config.includeAllExtensionsOnExport.value}set includeAllExtensionsOnExport(t){this._config.includeAllExtensionsOnExport.value=t}get fallbackVersionOnImport(){return this._config.fallbackVersionOnImport.value}set fallbackVersionOnImport(t){this._config.fallbackVersionOnImport.value=t}get ignoreIncompleteTopicsOnImport(){return this._config.ignoreIncompleteTopicsOnImport.value}set ignoreIncompleteTopicsOnImport(t){this._config.ignoreIncompleteTopicsOnImport.value=t}}const gr=class Ys extends Rt{constructor(){super(...arguments),p(this,"enabled",!1),p(this,"_defaultConfig",{author:"jhon.doe@example.com",version:"2.1",types:new Set(["Clash","Failure","Fault","Inquiry","Issue","Remark","Request"]),statuses:new Set(["Active","In Progress","Done","In Review","Closed"]),priorities:new Set(["On hold","Minor","Normal","Major","Critical"]),labels:new Set,stages:new Set,users:new Set,includeSelectionTag:!1,updateExtensionsOnImport:!0,strict:!1,includeAllExtensionsOnExport:!0,fallbackVersionOnImport:"2.1",ignoreIncompleteTopicsOnImport:!1}),p(this,"config",new Tf(this,this.components,"BCF Topics",Ys.uuid)),p(this,"list",new oe),p(this,"onSetup",new q),p(this,"isSetup",!1),p(this,"onBCFImported",new q),p(this,"onDisposed",new q)}setup(t){if(this.isSetup)return;const e={...this._defaultConfig,...t};this.config.version=e.version,this.config.author=e.author,this.config.types=e.types,this.config.statuses=e.statuses,this.config.priorities=e.priorities,this.config.labels=e.labels,this.config.stages=e.stages,this.config.users=e.users,this.config.includeSelectionTag=e.includeSelectionTag,this.config.updateExtensionsOnImport=e.updateExtensionsOnImport,this.config.strict=e.strict,this.config.includeAllExtensionsOnExport=e.includeAllExtensionsOnExport,this.config.fallbackVersionOnImport=e.fallbackVersionOnImport||"",this.config.ignoreIncompleteTopicsOnImport=e.ignoreIncompleteTopicsOnImport,this.isSetup=!0,this.enabled=!0,this.onSetup.trigger()}create(t){const e=new Ao(this.components);return t?(e.guid=t.guid??e.guid,e.set(t)):this.list.set(e.guid,e),e}dispose(){this.list.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}get usedTypes(){const t=[...this.list].map(([e,s])=>s.type);return new Set(t)}get usedStatuses(){const t=[...this.list].map(([e,s])=>s.status);return new Set(t)}get usedPriorities(){const t=[...this.list].map(([e,s])=>s.priority).filter(e=>e);return new Set(t)}get usedStages(){const t=[...this.list].map(([e,s])=>s.stage).filter(e=>e);return new Set(t)}get usedUsers(){const t=[];for(const[e,s]of this.list){t.push(s.creationAuthor),s.assignedTo&&t.push(s.assignedTo),s.modifiedAuthor&&t.push(s.modifiedAuthor);for(const[i,n]of s.comments)t.push(n.author),n.modifiedAuthor&&t.push(n.modifiedAuthor)}return new Set(t)}get usedLabels(){const t=[];for(const[e,s]of this.list)t.push(...s.labels);return new Set(t)}updateExtensions(){for(const[t,e]of this.list){for(const s of e.labels)this.config.labels.add(s);this.config.types.add(e.type),e.priority&&this.config.priorities.add(e.priority),e.stage&&this.config.stages.add(e.stage),this.config.statuses.add(e.status),this.config.users.add(e.creationAuthor),e.assignedTo&&this.config.users.add(e.assignedTo),e.modifiedAuthor&&this.config.users.add(e.modifiedAuthor);for(const[s,i]of e.comments)this.config.users.add(i.author),i.modifiedAuthor&&this.config.users.add(i.modifiedAuthor)}}updateViewpointReferences(){const t=this.components.get(Ce);for(const[e,s]of this.list)for(const i of s.viewpoints)t.list.has(i)||s.viewpoints.delete(i)}async export(t=this.list.values()){const e=new po;e.file("bcf.version",`<?xml version="1.0" encoding="UTF-8"?>
    <Version VersionId="${this.config.version}" xsi:noNamespaceSchemaLocation="https://raw.githubusercontent.com/buildingSMART/BCF-XML/release_3_0/Schemas/version.xsd"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    </Version>`),e.file("bcf.extensions",this.serializeExtensions());const i=await(await fetch("https://thatopen.github.io/engine_components/resources/favicon.ico")).arrayBuffer(),n=this.components.get(Ce);for(const o of t){const a=e.folder(o.guid);a.file("markup.bcf",o.serialize());for(const l of o.viewpoints){const h=n.list.get(l);h&&(a.file(`${l}.jpeg`,i,{binary:!0}),a.file(`${l}.bcfv`,await h.serialize()))}}return await e.generateAsync({type:"blob"})}serializeExtensions(){const t=[...this.config.types].map(o=>`<TopicType>${o}</TopicType>`).join(`
`),e=[...this.config.statuses].map(o=>`<TopicStatus>${o}</TopicStatus>`).join(`
`),s=[...this.config.priorities].map(o=>`<Priority>${o}</Priority>`).join(`
`),i=[...this.config.labels].map(o=>`<TopicLabel>${o}</TopicLabel>`).join(`
`),n=[...this.config.stages].map(o=>`<Stage>${o}</Stage>`).join(`
`),r=[...this.config.users].map(o=>`<User>${o}</User>`).join(`
`);return`
      <?xml version="1.0" encoding="UTF-8"?>
      <Extensions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="your-schema-location.xsd">
        ${t.length!==0?`<TopicTypes>
${t}
</TopicTypes>`:""}
        ${e.length!==0?`<TopicStatuses>
${e}
</TopicStatuses>`:""}
        ${s.length!==0?`<Priorities>
${s}
</Priorities>`:""}
        ${i.length!==0?`<TopicLabels>
${i}
</TopicLabels>`:""}
        ${n.length!==0?`<Stages>
${n}
</Stages>`:""}
        ${r.length!==0?`<Users>
${r}
</Users>`:""}
      </Extensions>
    `}processMarkupComment(t){const{Guid:e,Date:s,Author:i,Comment:n,Viewpoint:r}=t;if(!(e&&s&&i&&Yn))return null;const o=this.components.get(Ce),a=new Yn(this.components,n??"");return a.guid=e,a.date=new Date(s),a.author=i,a.viewpoint=r!=null&&r.Guid?o.list.get(r.Guid):void 0,a.modifiedAuthor=t.ModifiedAuthor,a.modifiedDate=t.ModifiedDate?new Date(t.ModifiedDate):void 0,a}getMarkupComments(t,e){var s;let i;if(e==="2.1"&&(i=t.Comment),e==="3"&&(i=(s=t.Topic.Comments)==null?void 0:s.Comment),!i)return[];i=Array.isArray(i)?i:[i];const n=i.map(o=>this.processMarkupComment(o)).filter(o=>o);return Array.isArray(n)?n:[n]}getMarkupLabels(t,e){var s;let i;return e==="2.1"&&(i=t.Topic.Labels),e==="3"&&(i=(s=t.Topic.Labels)==null?void 0:s.Label),i?Array.isArray(i)?i:[i]:[]}getMarkupViewpoints(t,e){var s;let i;return e==="2.1"&&(i=t.Viewpoints),e==="3"&&(i=(s=t.Topic.Viewpoints)==null?void 0:s.ViewPoint),i?(i=Array.isArray(i)?i:[i],i):[]}getMarkupRelatedTopics(t,e){var s;let i;return e==="2.1"&&(i=t.Topic.RelatedTopic),e==="3"&&(i=(s=t.Topic.RelatedTopics)==null?void 0:s.RelatedTopic),i?(Array.isArray(i)?i:[i]).map(r=>r.Guid):[]}async load(t,e){var s;const{fallbackVersionOnImport:i,ignoreIncompleteTopicsOnImport:n,updateExtensionsOnImport:r}=this.config,o=new po;await o.loadAsync(t);const a=Object.values(o.files);let l=i;const h=a.find(g=>g.name.endsWith(".version"));if(h){const g=await h.async("string"),S=Ys.xmlParser.parse(g).Version.VersionId;l=String(S)}if(!(l&&(l==="2.1"||l==="3")))throw new Error(`BCFTopics: ${l} is not supported.`);const d=a.find(g=>g.name.endsWith(".extensions"));if(r&&d){const g=await d.async("string");Cf(this,g)}const u=[],f=this.components.get(Ce),I=a.filter(g=>g.name.endsWith(".bcfv"));for(const g of I){const S=await g.async("string"),T=Ys.xmlParser.parse(S).VisualizationInfo;if(!T){console.warn("Missing VisualizationInfo in Viewpoint");continue}const F={},{Guid:y,ClippingPlanes:N,Components:w,OrthogonalCamera:P,PerspectiveCamera:M}=T;if(y&&(F.guid=y),w){const{Selection:O,Visibility:v}=w;if(O&&O.Component){const D=Array.isArray(O.Component)?O.Component:[O.Component];F.selectionComponents=D.map(X=>X.IfcGuid).filter(X=>X)}if(v&&"DefaultVisibility"in v&&(F.defaultVisibility=v.DefaultVisibility),v&&v.Exceptions&&"Component"in v.Exceptions){const{Component:D}=v.Exceptions,X=Array.isArray(D)?D:[D];F.exceptionComponents=X.map(U=>U.IfcGuid).filter(U=>U)}let R;l==="2.1"&&(R=w.ViewSetupHints),l==="3"&&(R=(s=w.Visibility)==null?void 0:s.ViewSetupHints),R&&("OpeningsVisible"in R&&(F.openingsVisible=R.OpeningsVisible),"SpacesVisible"in R&&(F.spacesVisible=R.SpacesVisible),"SpaceBoundariesVisible"in R&&(F.spaceBoundariesVisible=R.SpaceBoundariesVisible))}if(P||M){const O=T.PerspectiveCamera??T.OrthogonalCamera,{CameraViewPoint:v,CameraDirection:R}=O,D=new B(Number(v.X),Number(v.Z),Number(-v.Y)),X=new B(Number(R.X),Number(R.Z),Number(-R.Y)),U={position:{x:D.x,y:D.y,z:D.z},direction:{x:X.x,y:X.y,z:X.z},aspectRatio:"AspectRatio"in O?O.AspectRatio:1};"ViewToWorldScale"in O&&(F.camera={...U,viewToWorldScale:O.ViewToWorldScale}),"FieldOfView"in O&&(F.camera={...U,fov:O.FieldOfView})}const x=new Ha(this.components,e,{data:F,setCamera:!1});if(w){const{Coloring:O}=w;if(O&&O.Color){const v=Array.isArray(O.Color)?O.Color:[O.Color];for(const R of v){const{Color:D,Component:X}=R,j=(Array.isArray(X)?X:[X]).map(k=>k.IfcGuid);x.componentColors.set(D,j)}}}if(u.push(x),N){const O=this.components.get(kh),v=Array.isArray(N.ClippingPlane)?N.ClippingPlane:[N.ClippingPlane];for(const R of v){const{Location:D,Direction:X}=R;if(!(D&&X))continue;const U=new B(D.X,D.Z,-D.Y),j=new B(X.X,-X.Z,X.Y),k=O.createFromNormalAndCoplanarPoint(e,j,U);k.visible=!1,k.enabled=!1,x.clippingPlanes.add(k)}}}const E={},m=[],C=a.filter(g=>g.name.endsWith(".bcf"));for(const g of C){const S=await g.async("string"),T=Ys.xmlParser.parse(S).Markup,F=T.Topic,{Guid:y,TopicType:N,TopicStatus:w,Title:P,CreationDate:M,CreationAuthor:x}=F;if(n&&!(y&&N&&w&&P&&M&&x))continue;const O=new Ao(this.components);O.guid=y??O.guid;const v=this.getMarkupRelatedTopics(T,l);E[O.guid]=new Set(v),O.type=N??O.type,O.status=w??O.status,O.title=P??O.title,O.creationDate=M?new Date(M):O.creationDate,O.creationAuthor=x??O.creationAuthor,O.serverAssignedId=F.ServerAssignedId,O.priority=F.Priority,O.index=F.Index,O.modifiedDate=F.ModifiedDate?new Date(F.ModifiedDate):void 0,O.modifiedAuthor=F.ModifiedAuthor,O.dueDate=F.DueDate?new Date(F.DueDate):void 0,O.assignedTo=F.AssignedTo,O.description=F.Description,O.stage=F.Stage;const R=this.getMarkupLabels(T,l);for(const U of R)O.labels.add(U);const D=this.getMarkupComments(T,l);for(const U of D)O.comments.set(U.guid,U);const X=this.getMarkupViewpoints(T,l);for(const U of X){if(!(U&&U.Guid))continue;const j=f.list.get(U.Guid);j&&O.viewpoints.add(j.guid)}this.list.set(O.guid,O),m.push(O)}for(const g in E){const S=this.list.get(g);if(!S)continue;const T=E[g];for(const F of T)S.relatedTopics.add(F)}return this.onBCFImported.trigger(m),{viewpoints:u,topics:m}}};p(gr,"uuid","de977976-e4f6-4e4f-a01a-204727839802");p(gr,"xmlParser",new Fa.XMLParser({allowBooleanAttributes:!0,attributeNamePrefix:"",ignoreAttributes:!1,ignoreDeclaration:!0,ignorePiTags:!0,numberParseOptions:{leadingZeros:!0,hex:!0},parseAttributeValue:!0,preserveOrder:!1,processEntities:!1,removeNSPrefix:!0,trimValues:!0}));let Yt=gr;const Oa=class pe extends Rt{constructor(t){super(t),p(this,"enabled",!0),p(this,"onDisposed",new q),p(this,"_absoluteMin"),p(this,"_absoluteMax"),p(this,"_meshes",[]),this.components.add(pe.uuid,this),this._absoluteMin=pe.newBound(!0),this._absoluteMax=pe.newBound(!1)}static getDimensions(t){const{min:e,max:s}=t,i=Math.abs(s.x-e.x),n=Math.abs(s.y-e.y),r=Math.abs(s.z-e.z),o=new B;return o.subVectors(s,e).divideScalar(2).add(e),{width:i,height:n,depth:r,center:o}}static newBound(t){const e=t?1:-1;return new B(e*Number.MAX_VALUE,e*Number.MAX_VALUE,e*Number.MAX_VALUE)}static getBounds(t,e,s){const i=s||this.newBound(!1),n=e||this.newBound(!0);for(const r of t)r.x<n.x&&(n.x=r.x),r.y<n.y&&(n.y=r.y),r.z<n.z&&(n.z=r.z),r.x>i.x&&(i.x=r.x),r.y>i.y&&(i.y=r.y),r.z>i.z&&(i.z=r.z);return new vt(e,s)}dispose(){const t=this.components.get(Cs);for(const e of this._meshes)t.destroy(e);this._meshes=[],this.onDisposed.trigger(pe.uuid),this.onDisposed.reset()}get(){const t=this._absoluteMin.clone(),e=this._absoluteMax.clone();return new vt(t,e)}getSphere(){const t=this._absoluteMin.clone(),e=this._absoluteMax.clone(),s=Math.abs((e.x-t.x)/2),i=Math.abs((e.y-t.y)/2),n=Math.abs((e.z-t.z)/2),r=new B(t.x+s,t.y+i,t.z+n),o=r.distanceTo(t);return new Vi(r,o)}getMesh(){const t=new vt(this._absoluteMin,this._absoluteMax),e=pe.getDimensions(t),{width:s,height:i,depth:n,center:r}=e,o=new xt(s,i,n),a=new st(o);return this._meshes.push(a),a.position.copy(r),a}reset(){this._absoluteMin=pe.newBound(!0),this._absoluteMax=pe.newBound(!1)}add(t){for(const e of t.items)this.addMesh(e.mesh)}addMesh(t,e){if(!t.geometry.index)return;const s=pe.getFragmentBounds(t);t.updateMatrixWorld();const i=t.matrixWorld,n=new ft,r=t instanceof Me,o=new Set;if(t instanceof lc){e||(e=t.fragment.ids);for(const a of e){const l=t.fragment.getInstancesIDs(a);if(l)for(const h of l)o.add(h)}}else o.add(0);for(const a of o){const l=s.min.clone(),h=s.max.clone();r&&(t.getMatrixAt(a,n),l.applyMatrix4(n),h.applyMatrix4(n)),l.applyMatrix4(i),h.applyMatrix4(i),l.x<this._absoluteMin.x&&(this._absoluteMin.x=l.x),l.y<this._absoluteMin.y&&(this._absoluteMin.y=l.y),l.z<this._absoluteMin.z&&(this._absoluteMin.z=l.z),l.x>this._absoluteMax.x&&(this._absoluteMax.x=l.x),l.y>this._absoluteMax.y&&(this._absoluteMax.y=l.y),l.z>this._absoluteMax.z&&(this._absoluteMax.z=l.z),h.x>this._absoluteMax.x&&(this._absoluteMax.x=h.x),h.y>this._absoluteMax.y&&(this._absoluteMax.y=h.y),h.z>this._absoluteMax.z&&(this._absoluteMax.z=h.z),h.x<this._absoluteMin.x&&(this._absoluteMin.x=h.x),h.y<this._absoluteMin.y&&(this._absoluteMin.y=h.y),h.z<this._absoluteMin.z&&(this._absoluteMin.z=h.z)}}addFragmentIdMap(t){const e=this.components.get(gt);for(const s in t){const i=e.list.get(s);if(!i)continue;const n=t[s];this.addMesh(i.mesh,n)}}static getFragmentBounds(t){const e=t.geometry.attributes.position,s=Number.MAX_VALUE,i=-s,n=new B(s,s,s),r=new B(i,i,i);if(!t.geometry.index)throw new Error("Geometry must be indexed!");const o=Array.from(t.geometry.index.array);for(let a=0;a<o.length;a++){if(a%3===0&&o[a]===0&&o[a+1]===0&&o[a+2]===0){a+=2;continue}const l=o[a],h=e.getX(l),d=e.getY(l),u=e.getZ(l);h<n.x&&(n.x=h),d<n.y&&(n.y=d),u<n.z&&(n.z=u),h>r.x&&(r.x=h),d>r.y&&(r.y=d),u>r.z&&(r.z=u)}return new vt(n,r)}};p(Oa,"uuid","d1444724-dba6-4cdd-a0c7-68ee1450d166");let mf=Oa;const ya=class Na extends Rt{constructor(t){super(t),p(this,"enabled",!0),t.add(Na.uuid,this)}async getIsolatedElements(t,e,s){const i=new Set;function n(a){if(i.has(a))return;const l=t.GetLine(e,a);if(l){i.add(a);for(const h in l){const d=l[h];d&&d.constructor.name==="Handle"&&d.value>0?n(d.value):Array.isArray(d)&&d.forEach(u=>{u&&u.constructor.name==="Handle"&&u.value>0&&n(u.value)})}}}for(const a of s)n(a);const r=[];for(const a of i)r.push(a);r.sort((a,l)=>a-l);const o=[];return r.forEach(a=>{const l=t.GetLine(e,a);o.push(l)}),o}async export(t,e,s){return s.forEach(n=>{t.WriteLine(e,n)}),t.SaveModel(e)}async splitIfc(t,e,s){const i=new Uint8Array(e),n=t.OpenModel(i),r=await this.getIsolatedElements(t,n,s),o=t.CreateModel({schema:hc.IFC2X3});return await this.export(t,o,r)}};p(ya,"uuid","6eb0ba2f-71c0-464e-bcec-2d7c335186b2");let Gf=ya;const _a=class Pa{constructor(t){p(this,"onProgress",new q),p(this,"inclusive",!1),p(this,"rules",[]),p(this,"ids",{}),p(this,"needsUpdate",new Map),p(this,"components"),this.components=t}static import(t,e){const s=Pa.importers.get(e.type);return s?s(t,e):(console.warn("Invalid query data:.",e),null)}static importRules(t){const e=[];for(const s of t){const i={};for(const n in s){const r=s[n];r.regexp?i[n]=new RegExp(r.value):i[n]=r}e.push(i)}return e}static importIds(t){const e={};for(const s in t.ids)e[s]=new Set(t.ids[s]);return e}clear(t){if(t===void 0){this.ids={},this.needsUpdate.clear();return}delete this.ids[t],this.needsUpdate.delete(t)}addID(t,e){this.ids[t]||(this.ids[t]=new Set),this.ids[t].add(e)}getData(){const t={};for(const s in this.ids)t[s]=Array.from(this.ids[s]);const e=this.exportRules();return{name:this.name,inclusive:this.inclusive,type:"IfcFinderQuery",ids:t,rules:e}}exportRules(){const t=[];for(const e of this.rules){const s={};for(const i in e){const n=e[i];n instanceof RegExp?s[i]={regexp:!0,value:n.source}:s[i]=n}t.push(s)}return t}findInFile(t,e){return new Promise(s=>{const i=new FileReader,n=new TextDecoder("utf-8"),r=1e4*1024,o=1e3;let a=0;const l=/;/,h=()=>{if(a>=e.size){s();return}const d=Math.min(a+r+o,e.size),u=e.slice(a,d);i.readAsArrayBuffer(u)};i.onload=()=>{if(!(i.result instanceof ArrayBuffer))return;const d=new Uint8Array(i.result),f=n.decode(d).split(l);f.shift(),this.findInLines(t,f),this.onProgress.trigger(a/e.size),a+=r,h()},h()})}getIdFromLine(t){const e=t.slice(t.indexOf("#")+1,t.indexOf("="));return parseInt(e,10)}testRules(t){let e=null,s=null,i=null,n=!1;for(const r of this.rules){if(r.type==="category"){if(e===null&&(e=this.getCategoryFromLine(t),e===null)){if(this.inclusive)continue;break}if(!r.value.test(e)){if(this.inclusive)continue;n=!1;break}n=!0;continue}if(s===null&&(s=this.getAttributesFromLine(t),s===null)){if(this.inclusive)continue;n=!1;break}if(e===null&&(e=this.getCategoryFromLine(t),e===null)){if(this.inclusive)continue;n=!1;break}if(i===null&&(i=Object.keys(new uc[e]),i=i.slice(2),i===null)){if(this.inclusive)continue;n=!1;break}if(r.type==="property"){const{name:o,value:a}=r;if(!a.test(t)){if(this.inclusive)continue;n=!1;break}let l=!1;for(let h=0;h<s.length;h++){const d=s[h],u=i[h];if(a.test(d)&&o.test(u)){l=!0;break}}if(l)n=!0;else if(!this.inclusive){n=!1;break}}if(r.type==="operator"){const{name:o,value:a,operator:l}=r;let h=!1;for(let d=0;d<s.length;d++){const u=i[d],f=s[d].replace(/IFCLENGTHMEASURE\(|IFCVOLUMEMEASURE\(|\)/g,"");if(o.test(u)){if(l==="="&&parseFloat(f)===a){h=!0;break}else if(l==="<"&&parseFloat(f)<a){h=!0;break}else if(l===">"&&parseFloat(f)>a){h=!0;break}else if(l===">="&&parseFloat(f)>=a){h=!0;break}else if(l==="<="&&parseFloat(f)<=a){h=!0;break}}}if(h)n=!0;else if(!this.inclusive){n=!1;break}}}return n}getCategoryFromLine(t){const e=t.indexOf("=")+1,s=t.indexOf("("),i=t.slice(e,s).trim(),n=jh[i];return n||null}getAttributesFromLine(t){const e=/\((.*)\)/,s=t.match(e);if(!(s&&s[1]))return null;const i=/,(?![^()]*\))/g;return s[1].split(i).map(r=>r.trim())}};p(_a,"importers",new Map);let Te=_a;class Fo{constructor(t){p(this,"list",new Map),p(this,"id",Di.generateUUID()),p(this,"mode","intersect"),p(this,"_components"),this._components=t}get queries(){return new Set(this.list.values())}get items(){const t=[];for(const e of this.queries)t.push(e.items);return this.mode==="combine"?ps.combine(t):ps.intersect(t)}add(t){if(this.list.has(t.name))throw new Error(`This group already has a query with the name ${t.name}.`);this.list.set(t.name,t)}clear(t){for(const e of this.queries)e.clear(t)}import(t){this.mode=t.mode,this.id=t.id;for(const e in t.queries){const s=Te.import(this._components,t.queries[e]);s&&this.list.set(e,s)}}export(){const t={};for(const[e,s]of this.list)t[e]=s.export();return{mode:this.mode,id:this.id,queries:t}}async update(t,e){for(const s of this.queries){const i=s.needsUpdate.get(t);(i===void 0||i)&&await s.update(t,e)}}}const La=class wa extends Te{constructor(t,e){super(t),p(this,"name"),this.name=e.name,this.rules=e.rules,this.inclusive=e.inclusive}get items(){const t=this.components.get(gt),e=[];for(const s in this.ids){const i=this.ids[s],n=t.groups.get(s);if(!n){console.warn(`Model ${s} not found!`);continue}const r=n.getFragmentMap(i);e.push(r)}return ps.combine(e)}export(){const t=this.getData();return t.type=wa.type,t}async update(t,e){this.ids[t]=new Set,await this.findInFile(t,e),this.needsUpdate.set(t,!1)}findInLines(t,e){for(const s of e)if(this.testRules(s)){const n=this.getIdFromLine(s);this.addID(t,n)}}};p(La,"type","IfcBasicQuery");let So=La;Te.importers.set(So.type,(c,t)=>{const e=new So(c,{name:t.name,rules:Te.importRules(t.rules),inclusive:t.inclusive});return e.ids=Te.importIds(t),e});const Ma=class va extends Te{constructor(t,e){super(t),p(this,"name"),p(this,"psets",[]),this.name=e.name,this.rules=e.rules,this.inclusive=e.inclusive}get items(){const t=this.components.get(te),e=this.components.get(gt),s=[];for(const i in this.ids){const n=e.groups.get(i);if(!n){console.log(`Model not found: ${i}.`);continue}const r=this.ids[i];for(const o of r){const a=t.getEntityRelations(i,o,"DefinesOcurrence");if(a){const l=n.getFragmentMap(a);s.push(l)}}}return ps.combine(s)}export(){const t=this.getData();return t.type=va.type,t}async update(t,e){await this.findInFile(t,e);const s=new Set;for(const i of this.psets){const n=this.getAttributesFromLine(i);if(n===null)continue;const r=n[4].replace("(","[").replace(")","]").replace(/#/g,""),o=JSON.parse(r);for(const a of o){const l=this.ids[t];if(l&&l.has(a)){const h=this.getIdFromLine(i);s.add(h);break}}}this.ids[t]=s,this.psets=[],this.needsUpdate.set(t,!1)}findInLines(t,e){for(const s of e){const i=this.getCategoryFromLine(s);if(i==="IfcPropertySet"){this.psets.push(s);continue}if(i!=="IfcPropertySingleValue")continue;if(this.testRules(s)){const r=this.getIdFromLine(s);this.addID(t,r)}}}};p(Ma,"type","IfcPropertyQuery");let Oo=Ma;Te.importers.set(Oo.type,(c,t)=>{const e=new Oo(c,{name:t.name,inclusive:t.inclusive,rules:Te.importRules(t.rules)});return e.ids=Te.importIds(t),e});const Da=class ba extends Rt{constructor(t){super(t),p(this,"enabled",!0),p(this,"list",new Map),t.add(ba.uuid,this)}get queries(){const t=new Set;for(const[,e]of this.list)for(const s of e.queries)t.add(s);return t}import(t){for(const e in t){const s=new Fo(this.components);s.import(t[e]),this.list.set(e,s)}}export(){const t={};for(const[e,s]of this.list)t[e]=s.export();return t}create(){const t=new Fo(this.components);return this.list.set(t.id,t),t}delete(t){this.list.delete(t)}clear(){this.list.clear()}};p(Da,"uuid","0da7ad77-f734-42ca-942f-a074adfd1e3a");let kf=Da;const xa=class Ua extends Rt{constructor(t){super(t),p(this,"enabled",!0),p(this,"list",{}),p(this,"onDisposed",new q),p(this,"onFragmentsDisposed",s=>{const{groupID:i,fragmentIDs:n}=s;for(const r in this.list){const o=this.list[r],a=Object.keys(o);if(a.includes(i))delete o[i],Object.values(o).length===0&&delete this.list[r];else for(const l of a){const h=o[l];for(const d of n)delete h.map[d];Object.values(h).length===0&&delete o[l]}}}),t.add(Ua.uuid,this),t.get(gt).onFragmentsDisposed.add(this.onFragmentsDisposed)}dispose(){this.list={},this.components.get(gt).onFragmentsDisposed.remove(this.onFragmentsDisposed),this.onDisposed.trigger(),this.onDisposed.reset()}remove(t){for(const e in this.list){const s=this.list[e];for(const i in s){const n=s[i];delete n.map[t]}}}find(t){const e=this.components.get(gt);if(!t){const r={};for(const[o,a]of e.list)r[o]=new Set(a.ids);return r}const s=Object.keys(t).length,i={};for(const r in t){const o=t[r];if(!this.list[r]){console.warn(`Classification ${r} does not exist.`);continue}for(const a of o){const l=this.list[r][a];if(l)for(const h in l.map){i[h]||(i[h]=new Map);for(const d of l.map[h]){const u=i[h].get(d);u===void 0?i[h].set(d,1):i[h].set(d,u+1)}}}}const n={};for(const r in i){const o=i[r];for(const[a,l]of o){if(l===void 0)throw new Error("Malformed fragments map!");l===s&&(n[r]||(n[r]=new Set),n[r].add(a))}}return n}byModel(t,e){this.list.models||(this.list.models={});const s=this.list.models;s[t]||(s[t]={map:{},id:null,name:t});const i=s[t];for(const[n,r]of e.data){const o=r[0];for(const a of o){const l=e.keyFragments.get(a);l&&(i.map[l]||(i.map[l]=new Set),i.map[l].add(n))}}}async byPredefinedType(t){var e;this.list.predefinedTypes||(this.list.predefinedTypes={});const s=this.list.predefinedTypes,i=t.getAllPropertiesIDs();for(const n of i){const r=await t.getProperties(n);if(!r)continue;const o=String((e=r.PredefinedType)==null?void 0:e.value).toUpperCase();s[o]||(s[o]={map:{},id:null,name:o});const a=s[o];for(const[l,h]of t.data){const d=h[0];for(const u of d){const f=t.keyFragments.get(u);if(!f)throw new Error("Fragment ID not found!");a.map[f]||(a.map[f]=new Set),a.map[f].add(r.expressID)}}}}byEntity(t){this.list.entities||(this.list.entities={});for(const[e,s]of t.data){const n=s[1][1],r=Bi[n];this.saveItem(t,"entities",r,e)}}async byIfcRel(t,e,s){ds.isRel(e)&&await ds.getRelationMap(t,e,async(i,n)=>{const{name:r}=await ds.getEntityName(t,i);for(const o of n)this.saveItem(t,s,r??"NO REL NAME",o)})}async bySpatialStructure(t,e={}){var s,i;const n=this.components.get(te),r=n.relationMaps[t.uuid];if(!r)throw new Error(`Classifier: model relations of ${t.name||t.uuid} have to exists to group by spatial structure.`);const o=e.systemName??"spatialStructures",l=e.useProperties===void 0||e.useProperties;for(const[h]of r){if(e.isolate){const I=t.data.get(h);if(!I)continue;const E=I[1][1];if(E===void 0||!e.isolate.has(E))continue}const d=n.getEntityRelations(t,h,"Decomposes");if(d)for(const I of d){let E=I.toString();if(l){const m=await t.getProperties(I);if(!m)continue;E=(s=m.Name)==null?void 0:s.value}this.saveItem(t,o,E,h,I)}const u=n.getEntityRelations(t,h,"ContainsElements");if(!u)continue;let f=h.toString();if(l){const I=await t.getProperties(h);if(!I)continue;f=(i=I.Name)==null?void 0:i.value}for(const I of u){this.saveItem(t,o,f,I,h);const E=n.getEntityRelations(t,Number(I),"IsDecomposedBy");if(E)for(const m of E)this.saveItem(t,o,f,m,h)}}}setColor(t,e,s=!1){const i=this.components.get(gt);for(const n in t){const r=i.list.get(n);if(!r)continue;const o=t[n];r.setColor(e,o,s)}}resetColor(t){const e=this.components.get(gt);for(const s in t){const i=e.list.get(s);if(!i)continue;const n=t[s];i.resetColor(n)}}export(){const t={};for(const e in this.list){t[e]={};const s=this.list[e];for(const i in s){const n=s[i];t[e][i]={map:ps.export(n.map),name:n.name,id:n.id}}}return t}import(t){for(const e in t){this.list[e]||(this.list[e]={});const s=t[e];for(const i in s){const n=s[i];this.list[e][i]={map:ps.import(n.map),name:n.name,id:n.id}}}}saveItem(t,e,s,i,n=null){this.list[e]||(this.list[e]={});const r=t.data.get(i);if(r)for(const o of r[0]){const a=t.keyFragments.get(o);if(a){const l=this.list[e];l[s]||(l[s]={map:{},id:n,name:s}),l[s].map[a]||(l[s].map[a]=new Set),l[s].map[a].add(i)}}}};p(xa,"uuid","e25a7f3c-46c4-4a14-9d3d-5115f24ebeb7");let zn=xa;const Ba=class Va extends Rt{constructor(t){super(t),p(this,"onDisposed",new q),p(this,"enabled",!0),p(this,"height",10),p(this,"groupName","spatialStructures"),p(this,"list",new Set),t.add(Va.uuid,this)}dispose(){this.list.clear(),this.onDisposed.trigger(),this.onDisposed.reset()}set(t){if(!this.enabled)return;const e=this.components.get(zn),s=this.components.get(gt),i=t?1:-1;let n=0;const r=e.list[this.groupName],o=new ft;for(const a in r){o.elements[13]=n*i*this.height;for(const l in r[a].map){const h=s.list.get(l),d=a+l,u=this.list.has(d);if(!h||t&&u||!t&&!u)continue;t?this.list.add(d):this.list.delete(d);const f=r[a].map[l];h.applyTransform(f,o),h.mesh.computeBoundingSphere(),h.mesh.computeBoundingBox()}n++}}};p(Ba,"uuid","d260618b-ce88-4c7d-826c-6debb91de3e2");let Hf=Ba;const Ya=class za extends Rt{constructor(t){super(t),p(this,"enabled",!0),this.components.add(za.uuid,this)}set(t,e){const s=this.components.get(gt);if(!e){for(const[i,n]of s.list)n&&(n.setVisibility(t),this.updateCulledVisibility(n));return}for(const i in e){const n=e[i],r=s.list.get(i);r&&(r.setVisibility(t,n),this.updateCulledVisibility(r))}}isolate(t){this.set(!1),this.set(!0,t)}updateCulledVisibility(t){const e=this.components.get(_h);for(const[s,i]of e.list){const n=i.colorMeshes.get(t.id);n&&(n.count=t.mesh.count)}}};p(Ya,"uuid","dd9ccf2d-8a21-4821-b7f6-2949add16a29");let gf=Ya;class Rf extends pr{constructor(){super(...arguments),p(this,"minGeometrySize",10),p(this,"minAssetsSize",1e3),p(this,"maxTriangles",null)}}const Ga=class ka extends Rt{constructor(t){super(t),p(this,"onGeometryStreamed",new we),p(this,"onAssetStreamed",new we),p(this,"onProgress",new we),p(this,"onIfcLoaded",new we),p(this,"onDisposed",new q),p(this,"settings",new Rf),p(this,"enabled",!0),p(this,"webIfc",new Is),p(this,"_nextAvailableID",0),p(this,"_splittedGeometries",new Map),p(this,"_spatialTree",new na),p(this,"_metaData",new oa),p(this,"_visitedGeometries",new Map),p(this,"_streamSerializer",new fc),p(this,"_geometries",new Map),p(this,"_geometryCount",0),p(this,"_civil",new ra),p(this,"_groupSerializer",new Lo),p(this,"_assets",[]),p(this,"_meshesWithHoles",new Set),this.components.add(ka.uuid,this),this.settings.excludedCategories.add(Po)}dispose(){this.onIfcLoaded.reset(),this.onGeometryStreamed.reset(),this.onAssetStreamed.reset(),this.webIfc=null,this.onDisposed.trigger(),this.onDisposed.reset()}async streamFromBuffer(t){await this.readIfcFile(t),await this.streamAllGeometries(),this.cleanUp()}async streamFromCallBack(t){await this.streamIfcFile(t),await this.streamAllGeometries(),this.cleanUp()}async readIfcFile(t){const{path:e,absolute:s,logLevel:i}=this.settings.wasm;this.webIfc.SetWasmPath(e,s),await this.webIfc.Init(),i&&this.webIfc.SetLogLevel(i),this.webIfc.OpenModel(t,this.settings.webIfc),this._nextAvailableID=this.webIfc.GetMaxExpressID(0)}async streamIfcFile(t){const{path:e,absolute:s,logLevel:i}=this.settings.wasm;this.webIfc.SetWasmPath(e,s),await this.webIfc.Init(),i&&this.webIfc.SetLogLevel(i),this.webIfc.OpenModelFromCallback(t,this.settings.webIfc),this._nextAvailableID=this.webIfc.GetMaxExpressID(0)}async streamAllGeometries(){console.log("Converting geometries to tiles...");const{minGeometrySize:t,minAssetsSize:e}=this.settings;this._spatialTree.setUp(this.webIfc);const s=this.webIfc.GetIfcEntityList(0),i=[[]],n=new zs;n.ifcMetadata={name:"",description:"",...this._metaData.getNameInfo(this.webIfc),...this._metaData.getDescriptionInfo(this.webIfc),schema:this.webIfc.GetModelSchema(0)||"IFC2X3",maxExpressID:this.webIfc.GetMaxExpressID(0)};let r=0,o=0;for(const I of s){if(!this.webIfc.IsIfcElement(I)&&I!==Xe||this.settings.excludedCategories.has(I))continue;const E=this.webIfc.GetLineIDsWithType(0,I),m=E.size();for(let C=0;C<m;C++){r>t&&(r=0,o++,i.push([]));const g=E.get(C);i[o].push(g);const S=this.webIfc.GetLine(0,g);if(S.GlobalId){const F=(S==null?void 0:S.GlobalId.value)||(S==null?void 0:S.GlobalId);n.globalToExpressIDs.set(F,g)}const T=this._spatialTree.itemsByFloor[g]||0;n.data.set(g,[[],[T,I]]),r++}}this._spatialTree.cleanUp();let a=.01,l=0;for(const I of i){l++,this.webIfc.StreamMeshes(0,I,m=>{this.getMesh(this.webIfc,m,n)}),this._geometryCount>this.settings.minGeometrySize&&await this.streamGeometries(),this._assets.length>e&&await this.streamAssets();const E=l/i.length;E>a&&(a+=.01,a=Math.max(a,E),await this.onProgress.trigger(Math.round(a*100)/100))}this._geometryCount&&await this.streamGeometries(),this._assets.length&&await this.streamAssets();const{opaque:h,transparent:d}=n.geometryIDs;for(const[I,{index:E,uuid:m}]of this._visitedGeometries)n.keyFragments.set(E,m),(I>1?h:d).set(I,E);aa.get(n,this.webIfc);const u=this.webIfc.GetCoordinationMatrix(0);n.coordinationMatrix.fromArray(u),n.civilData=this._civil.read(this.webIfc);const f=this._groupSerializer.export(n);await this.onIfcLoaded.trigger(f),n.dispose(!0)}cleanUp(){try{this.webIfc.Dispose()}catch{}this.webIfc=null,this.webIfc=new Is,this._visitedGeometries.clear(),this._geometries.clear(),this._assets=[],this._meshesWithHoles.clear()}getMesh(t,e,s){const i=e.geometries.size(),n=e.expressID,r={id:n,geometries:[]};for(let o=0;o<i;o++){const a=e.geometries.get(o),l=a.geometryExpressID,h=a.color.w===1,u=l*(h?1:-1);this._visitedGeometries.has(u)||this.getGeometry(t,l,h),this.registerGeometryData(s,n,a,r,l,u);const f=this._splittedGeometries.get(l);if(f)for(const I of f)this.registerGeometryData(s,n,a,r,I,I)}this._assets.push(r)}getGeometry(t,e,s){const i=t.GetGeometry(0,e),n=t.GetIndexArray(i.GetIndexData(),i.GetIndexDataSize()),r=t.GetVertexArray(i.GetVertexData(),i.GetVertexDataSize()),o=new Float32Array(r.length/2),a=new Float32Array(r.length/2);for(let f=0;f<r.length;f+=6)o[f/2]=r[f],o[f/2+1]=r[f+1],o[f/2+2]=r[f+2],a[f/2]=r[f+3],a[f/2+1]=r[f+4],a[f/2+2]=r[f+5];const l=s?1:-1;if(n.length===0){const f=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1]);this._geometries.set(e,{position:o,normal:a,index:n,boundingBox:f,hasHoles:!1});const I=this._visitedGeometries.size,E=Di.generateUUID(),m=e*l;this._visitedGeometries.set(m,{uuid:E,index:I}),this._geometryCount++,i.delete();return}const d=(this.settings.maxTriangles||n.length/3)*3;let u=!0;for(let f=0;f<n.length;f+=d){const I=n.length-f,E=Math.min(I,d),m=f+E,C=[],g=[],S=[];let T=0;for(let D=f;D<m;D++){C.push(T++);const X=n[D];g.push(o[X*3]),g.push(o[X*3+1]),g.push(o[X*3+2]),S.push(a[X*3]),S.push(a[X*3+1]),S.push(a[X*3+2])}const F=new Uint32Array(C),y=new Float32Array(g),N=new Float32Array(S),w=jl(y),P=new Float32Array(w.transformation.elements),M=!1,x=u?e:this._nextAvailableID++;this._geometries.set(x,{position:y,normal:N,index:F,boundingBox:P,hasHoles:M}),u||(this._splittedGeometries.has(e)||this._splittedGeometries.set(e,new Set),this._splittedGeometries.get(e).add(x));const O=this._visitedGeometries.size,v=Di.generateUUID(),R=x*l;this._visitedGeometries.set(R,{uuid:v,index:O}),this._geometryCount++,u=!1}i.delete()}async streamAssets(){await this.onAssetStreamed.trigger(this._assets),this._assets=null,this._assets=[]}async streamGeometries(){const t=new Map;for(const[e,s]of this._geometries)t.set(e,s),t.size>this.settings.minGeometrySize&&await this.outputGeometries(t);await this.outputGeometries(t),this._geometries.clear(),this._geometryCount=0}async outputGeometries(t){let e=this._streamSerializer.export(t),s={};for(const[i,{boundingBox:n,hasHoles:r}]of t)s[i]={boundingBox:n,hasHoles:r};await this.onGeometryStreamed.trigger({data:s,buffer:e}),s=null,e=null,t.clear()}registerGeometryData(t,e,s,i,n,r){const o=this._visitedGeometries.get(r);if(o===void 0)throw new Error("Error getting geometry data for streaming!");const a=t.data.get(e);if(!a)throw new Error("Data not found!");a[0].push(o.index);const{x:l,y:h,z:d,w:u}=s.color,f=[l,h,d,u],I=s.flatTransformation;i.geometries.push({color:f,geometryID:n,transformation:I})}};p(Ga,"uuid","d9999a00-e1f5-4d3f-8cfe-c56e08609764");let Wf=Ga;class Af extends pr{constructor(){super(...arguments),p(this,"propertiesSize",100)}}class Ff extends Rt{constructor(){super(...arguments),p(this,"onPropertiesStreamed",new we),p(this,"onProgress",new we),p(this,"onIndicesStreamed",new we),p(this,"onDisposed",new q),p(this,"enabled",!0),p(this,"settings",new Af),p(this,"webIfc",new Is)}async dispose(){this.onIndicesStreamed.reset(),this.onPropertiesStreamed.reset(),this.webIfc=null,this.onDisposed.reset()}async streamFromBuffer(t){await this.readIfcFile(t),await this.streamAllProperties(),this.cleanUp()}async streamFromCallBack(t){await this.streamIfcFile(t),await this.streamAllProperties(),this.cleanUp()}async readIfcFile(t){const{path:e,absolute:s,logLevel:i}=this.settings.wasm;this.webIfc.SetWasmPath(e,s),await this.webIfc.Init(),i&&this.webIfc.SetLogLevel(i),this.webIfc.OpenModel(t,this.settings.webIfc)}async streamIfcFile(t){const{path:e,absolute:s,logLevel:i}=this.settings.wasm;this.webIfc.SetWasmPath(e,s),await this.webIfc.Init(),i&&this.webIfc.SetLogLevel(i),this.webIfc.OpenModelFromCallback(t,this.settings.webIfc)}async streamAllProperties(){const{propertiesSize:t}=this.settings,e=new Set(this.webIfc.GetIfcEntityList(0)),s=new Set([nr,rr,or,ar,Xe]);for(const a of s)e.add(a);let i=.01,n=0;for(const a of e){if(n++,ca.has(a))continue;const l=s.has(a),h=this.webIfc.GetLineIDsWithType(0,a),d=h.size();let u=0;for(let I=0;I<d-t;I+=t){const E={};for(let m=0;m<t;m++){u++;const C=h.get(I+m);try{const g=this.webIfc.GetLine(0,C,l);E[g.expressID]=g}catch{console.log(`Could not get property: ${C}`)}}await this.onPropertiesStreamed.trigger({type:a,data:E})}if(u!==d){const I={};for(let E=u;E<d;E++){const m=h.get(E);try{const C=this.webIfc.GetLine(0,m,l);I[C.expressID]=C}catch{console.log(`Could not get property: ${m}`)}}await this.onPropertiesStreamed.trigger({type:a,data:I})}n/e.size>i&&(i=Math.round(i*100)/100,await this.onProgress.trigger(i),i+=.01)}await this.onProgress.trigger(1);const o=await this.components.get(te).processFromWebIfc(this.webIfc,0);await this.onIndicesStreamed.trigger(o)}cleanUp(){this.webIfc.Dispose(),this.webIfc=null,this.webIfc=new Is}}p(Ff,"uuid","88d2c89c-ce32-47d7-8cb6-d51e4b311a0b");class Ha{constructor(t,e,s){p(this,"title"),p(this,"guid",Ae.create()),p(this,"clippingPlanes",new ve),p(this,"camera",{aspectRatio:1,fov:60,direction:{x:0,y:0,z:0},position:{x:0,y:0,z:0}}),p(this,"exceptionComponents",new ve),p(this,"selectionComponents",new ve),p(this,"componentColors",new oe),p(this,"spacesVisible",!1),p(this,"spaceBoundariesVisible",!1),p(this,"openingsVisible",!1),p(this,"defaultVisibility",!0),p(this,"_components"),p(this,"world");const i={setCamera:!0,...s},{data:n,setCamera:r}=i;this._components=t,this.world=e,n&&(this.guid=n.guid??this.guid,this.set(n)),r&&this.updateCamera()}get _selectionModelIdMap(){const t=this._components.get(gt),e={};for(const[s,i]of t.groups){s in e||(e[s]=new Set);for(const n of this.selectionComponents){const r=i.globalToExpressIDs.get(n);r&&e[s].add(r)}}return e}get _exceptionModelIdMap(){const t=this._components.get(gt),e={};for(const[s,i]of t.groups){s in e||(e[s]=new Set);for(const n of this.exceptionComponents){const r=i.globalToExpressIDs.get(n);r&&e[s].add(r)}}return e}get selection(){return this._components.get(gt).modelIdToFragmentIdMap(this._selectionModelIdMap)}get exception(){return this._components.get(gt).modelIdToFragmentIdMap(this._exceptionModelIdMap)}get projection(){return"fov"in this.camera?"Perspective":"Orthographic"}get position(){const t=this._components.get(gt),{position:e}=this.camera,{x:s,y:i,z:n}=e,r=new B(s,i,n);return t.applyBaseCoordinateSystem(r,new ft),r}get direction(){const{direction:t}=this.camera,{x:e,y:s,z:i}=t;return new B(e,s,i)}get _managerVersion(){return this._components.get(Yt).config.version}get topics(){return[...this._components.get(Yt).list.values()].filter(i=>i.viewpoints.has(this.guid))}addComponentsFromMap(t){const s=this._components.get(gt).fragmentIdMapToGuids(t);this.selectionComponents.add(...s),this._components.get(Ce).list.set(this.guid,this)}set(t){const e=t,s=this;for(const n in t){if(n==="guid")continue;const r=e[n];if(n==="selectionComponents"){this.selectionComponents.clear(),this.selectionComponents.add(...r);continue}if(n==="exceptionComponents"){this.exceptionComponents.clear(),this.exceptionComponents.add(...r);continue}n in this&&(s[n]=r)}return this._components.get(Ce).list.set(this.guid,this),this}async go(t,e=!0){const{camera:s}=t??this.world;if(!s.hasCameraControls())throw new Error("Viewpoint: the world's camera need controls to set the viewpoint.");s instanceof $h&&s.projection.set(this.projection);const i=new B(this.camera.position.x,this.camera.position.y,this.camera.position.z),n=new B(this.camera.direction.x,this.camera.direction.y,this.camera.direction.z);if(i.equals(new B)&&n.equals(new B))return;const r=this.position,o=this.direction;let a={x:r.x+o.x*80,y:r.y+o.y*80,z:r.z+o.z*80};const l=this.selection;if(Object.keys(l).length===0){const u=this._components.get(bn).get(this.world).castRayFromVector(r,this.direction);u&&(a=u.point)}else{const h=this._components.get(mf);h.reset(),h.addFragmentIdMap(l),a=h.getSphere().center,h.reset()}await s.controls.setLookAt(r.x,r.y,r.z,a.x,a.y,a.z,e)}updateCamera(t){const{camera:e,renderer:s}=t??this.world;if(!s)throw new Error("Viewpoint: the world needs to have a renderer!");if(!e.hasCameraControls())throw new Error("Viewpoint: world's camera need camera controls!");const i=new B;e.controls.getPosition(i);const n=e.three,r=new B(0,0,-1).applyEuler(n.rotation),{width:o,height:a}=s.getSize();let l=o/a;Number.isNaN(l)&&(l=1);const h=this._components.get(gt);i.applyMatrix4(h.baseCoordinationMatrix.clone().invert());const d={aspectRatio:l,position:{x:i.x,y:i.y,z:i.z},direction:{x:r.x,y:r.y,z:r.z}};n instanceof Hn?this.camera={...d,fov:n.fov}:n instanceof ke&&(this.camera={...d,viewToWorldScale:n.top-n.bottom}),this._components.get(Ce).list.set(this.guid,this)}applyVisibility(){const t=this._components.get(gf);t.set(this.defaultVisibility),t.set(!this.defaultVisibility,this.exception),t.set(!0,this.selection)}applyColors(){const t=this._components.get(Ce),e=this._components.get(gt),s=this._components.get(zn);for(const[i,n]of this.componentColors){const r=e.guidToFragmentIdMap(n);s.setColor(r,i,t.config.overwriteColors)}}resetColors(){const t=this._components.get(gt),e=this._components.get(zn);for(const[s,i]of this.componentColors){const n=t.guidToFragmentIdMap(i);e.resetColor(n)}}async createComponentTags(t){var e,s;const i=this._components.get(gt),n=this._components.get(Yt);let r="";if(n.config.includeSelectionTag){const o=t==="selection"?this._selectionModelIdMap:this._exceptionModelIdMap;for(const a in o){const l=i.groups.get(a);if(!l)continue;const h=o[a];for(const d of h){const u=await l.getProperties(d);if(!u)continue;const f=(e=u.GlobalId)==null?void 0:e.value;if(!f)continue;const I=(s=u.Tag)==null?void 0:s.value;let E=null;I&&(E=`AuthoringToolId="${I}"`),r+=`
<Component IfcGuid="${f}" ${E??""} />`}}}else r=[...this.selectionComponents].map(o=>`<Component IfcGuid="${o}" />`).join(`
`);return r}createColorTags(){let t="";for(const[e,s]of this.componentColors.entries()){const i=`#${e.getHexString()}`,n=s.map(r=>`
<Component IfcGuid="${r}" />`).join(`
`);t+=`<Color Color="${i}">
${n}
</Color>`}return t.length!==0?`<Coloring>
${t}
</Coloring>`:"<Coloring />"}async serialize(t=this._managerVersion){const e=this._components.get(gt),s=this.position;s.applyMatrix4(e.baseCoordinationMatrix.clone().invert());const i=this.direction;i.normalize();const n=new ft().makeRotationX(Math.PI/2),r=i.clone().applyMatrix4(n);r.normalize();const o=`<CameraViewPoint>
      <X>${s.x}</X>
      <Y>${-s.z}</Y>
      <Z>${s.y}</Z>
    </CameraViewPoint>`,a=`<CameraDirection>
      <X>${i.x}</X>
      <Y>${-i.z}</Y>
      <Z>${i.y}</Z>
    </CameraDirection>`,l=`<CameraUpVector>
      <X>${r.x}</X>
      <Y>${-r.z}</Y>
      <Z>${r.y}</Z>
    </CameraUpVector>`,h=`<AspectRatio>${this.camera.aspectRatio}</AspectRatio>`;let d="";"viewToWorld"in this.camera?d=`<OrthogonalCamera>
        ${o}
        ${a}
        ${l}
        ${h}
        <ViewToWorldScale>${this.camera.viewToWorld}</ViewToWorldScale>
      </OrthogonalCamera>`:"fov"in this.camera&&(d=`<PerspectiveCamera>
        ${o}
        ${a}
        ${l}
        ${h}
        <FieldOfView>${this.camera.fov}</FieldOfView>
      </PerspectiveCamera>`);const u=`<ViewSetupHints SpacesVisible="${this.spacesVisible??!1}" SpaceBoundariesVisible="${this.spaceBoundariesVisible??!1}" OpeningsVisible="${this.openingsVisible??!1}" />`,f=(await this.createComponentTags("selection")).trim(),I=(await this.createComponentTags("exception")).trim(),E=this.createColorTags();return`<?xml version="1.0" encoding="UTF-8"?>
    <VisualizationInfo Guid="${this.guid}">
      <Components>
        ${t==="2.1"?u:""}
        ${f.length!==0?`<Selection>${f}</Selection>`:""}
        <Visibility DefaultVisibility="${this.defaultVisibility}">
          ${t==="3"?u:""}
          ${I.length!==0?`<Exceptions>${I}</Exceptions>`:""}
        </Visibility>
        ${E}
      </Components>
      ${d}
    </VisualizationInfo>`}}class Sf extends Ze{constructor(){super(...arguments),p(this,"_config",{overwriteColors:{value:!1,type:"Boolean"}})}get overwriteColors(){return this._config.overwriteColors.value}set overwriteColors(t){this._config.overwriteColors.value=t}}const Wa=class Gn extends Rt{constructor(t){super(t),p(this,"enabled",!0),p(this,"list",new oe),p(this,"isSetup",!1),p(this,"onSetup",new q),p(this,"config",new Sf(this,this.components,"Viewpoints",Gn.uuid)),p(this,"onDisposed",new q),t.add(Gn.uuid,this)}create(t,e){const s=new Ha(this.components,t,{data:e});return e||this.list.set(s.guid,s),s}setup(){}dispose(){this.list.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}};p(Wa,"uuid","ee867824-a796-408d-8aa0-4e5962a83c66");let Ce=Wa;class Of extends Ze{constructor(){super(...arguments),p(this,"_config",{visible:{value:!0,type:"Boolean"},lockRotation:{value:!0,type:"Boolean"},zoom:{type:"Number",interpolable:!0,value:.05,min:.001,max:5},frontOffset:{type:"Number",interpolable:!0,value:0,min:0,max:100},sizeX:{type:"Number",interpolable:!0,value:320,min:20,max:5e3},sizeY:{type:"Number",interpolable:!0,value:160,min:20,max:5e3},backgroundColor:{value:new Dt,type:"Color"}})}get visible(){return this._config.visible.value}set visible(t){this._config.visible.value=t;const e=this._component.renderer.domElement.style;e.display=t?"block":"none"}get lockRotation(){return this._config.lockRotation.value}set lockRotation(t){this._config.lockRotation.value=t,this._component.lockRotation=t}get zoom(){return this._config.zoom.value}set zoom(t){this._config.zoom.value=t,this._component.zoom=t}get frontOffset(){return this._config.frontOffset.value}set frontOffset(t){this._config.frontOffset.value=t,this._component.frontOffset=t}get sizeX(){return this._config.sizeX.value}set sizeX(t){this._config.sizeX.value=t;const{sizeX:e,sizeY:s}=this._config,i=new Wt(e.value,s.value);this._component.resize(i)}get sizeY(){return this._config.sizeY.value}set sizeY(t){this._config.sizeY.value=t;const{sizeX:e,sizeY:s}=this._config,i=new Wt(e.value,s.value);this._component.resize(i)}get backgroundColor(){return this._config.backgroundColor.value}set backgroundColor(t){this._config.backgroundColor.value=t,this._component.backgroundColor=t}}class yf{constructor(t,e){if(p(this,"onDisposed",new q),p(this,"onAfterUpdate",new q),p(this,"onBeforeUpdate",new q),p(this,"onResize",new q),p(this,"onSetup",new q),p(this,"frontOffset",0),p(this,"overrideMaterial",new mc),p(this,"backgroundColor",new Dt(395274)),p(this,"renderer"),p(this,"enabled",!0),p(this,"world"),p(this,"config"),p(this,"isSetup",!1),p(this,"_defaultConfig",{visible:!0,lockRotation:!1,zoom:.05,frontOffset:0,sizeX:320,sizeY:160,backgroundColor:new Dt(395274)}),p(this,"_lockRotation",!0),p(this,"_size",new Wt(320,160)),p(this,"_camera"),p(this,"_plane"),p(this,"_tempVector1",new B),p(this,"_tempVector2",new B),p(this,"_tempTarget",new B),p(this,"down",new B(0,-1,0)),p(this,"updatePlanes",()=>{if(!this.world.renderer)throw new Error("The given world must have a renderer!");const n=[],r=this.world.renderer.three;for(const o of r.clippingPlanes)n.push(o);n.push(this._plane),this.renderer.clippingPlanes=n}),this.world=t,!this.world.renderer)throw new Error("The given world must have a renderer!");this.renderer=new ks,this.renderer.setSize(this._size.x,this._size.y);const s=1,i=this._size.x/this._size.y;this._camera=new ke(s*i/-2,s*i/2,s/2,s/-2),this.world.renderer.onClippingPlanesUpdated.add(this.updatePlanes),this._camera.position.set(0,200,0),this._camera.zoom=.1,this._camera.rotation.x=-Math.PI/2,this._plane=new We(this.down,200),this.updatePlanes(),this.config=new Of(this,e,"MiniMap")}get lockRotation(){return this._lockRotation}set lockRotation(t){this._lockRotation=t,t&&(this._camera.rotation.z=0)}get zoom(){return this._camera.zoom}set zoom(t){this._camera.zoom=t,this._camera.updateProjectionMatrix()}dispose(){this.enabled=!1,this.onBeforeUpdate.reset(),this.onAfterUpdate.reset(),this.onResize.reset(),this.overrideMaterial.dispose(),this.renderer.forceContextLoss(),this.renderer.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}get(){return this._camera}update(){if(!this.enabled)return;this.onBeforeUpdate.trigger();const t=this.world.scene.three,e=this.world.camera;if(!e.hasCameraControls())throw new Error("The given world must use camera controls!");if(!(t instanceof Yi))throw new Error("The given world must have a THREE.Scene as a root!");const s=e.controls;if(s.getPosition(this._tempVector1),this._camera.position.x=this._tempVector1.x,this._camera.position.z=this._tempVector1.z,this.frontOffset!==0&&(s.getTarget(this._tempVector2),this._tempVector2.sub(this._tempVector1),this._tempVector2.normalize().multiplyScalar(this.frontOffset),this._camera.position.x+=this._tempVector2.x,this._camera.position.z+=this._tempVector2.z),!this._lockRotation){s.getTarget(this._tempTarget);const n=Math.atan2(this._tempTarget.x-this._tempVector1.x,this._tempTarget.z-this._tempVector1.z);this._camera.rotation.z=n+Math.PI}this._plane.set(this.down,this._tempVector1.y);const i=t.background;t.background=this.backgroundColor,this.renderer.render(t,this._camera),t.background=i,this.onAfterUpdate.trigger()}getSize(){return this._size}resize(t=this._size){this._size.copy(t),this.renderer.setSize(t.x,t.y);const e=t.x/t.y,s=1;this._camera.left=s*e/-2,this._camera.right=s*e/2,this._camera.top=s/2,this._camera.bottom=-s/2,this._camera.updateProjectionMatrix(),this.onResize.trigger(t)}setup(t){const e={...this._defaultConfig,...t};this.config.visible=!0,this.config.lockRotation=e.lockRotation,this.config.zoom=e.zoom,this.config.frontOffset=e.frontOffset,this.config.sizeX=e.sizeX,this.config.sizeY=e.sizeY,this.config.backgroundColor=e.backgroundColor,this.isSetup=!0,this.onSetup.trigger()}}const Xa=class Za extends Rt{constructor(t){super(t),p(this,"onAfterUpdate",new q),p(this,"onBeforeUpdate",new q),p(this,"onDisposed",new q),p(this,"onSetup",new q),p(this,"enabled",!0),p(this,"list",new Map),this.components.add(Za.uuid,this)}create(t){if(this.list.has(t.uuid))throw new Error("This world already has a minimap!");const e=new yf(t,this.components);return this.list.set(t.uuid,e),e}delete(t){const e=this.list.get(t);e&&e.dispose(),this.list.delete(t)}dispose(){for(const[t,e]of this.list)e.dispose();this.list.clear(),this.onDisposed.trigger()}update(){for(const[t,e]of this.list)e.update()}};p(Xa,"uuid","39ad6aad-84c8-4adf-a1e0-7f25313a9e7f");let Xf=Xa;const $a=class ja extends Rt{constructor(t){super(t),p(this,"enabled",!0),t.add(ja.uuid,this)}static distanceFromPointToLine(t,e,s,i=!1){const n=new Jt,r=new B;return n.set(e,s),n.closestPointToPoint(t,i,r),r.distanceTo(t)}getFace(t,e,s){if(!t.geometry.index)throw new Error("Geometry must be indexed!");const i=new Map,n=t.geometry.index.array,{plane:r}=this.getFaceData(e,s,t),o=[];for(let d=0;d<n.length/3;d++){const{plane:u,edges:f}=this.getFaceData(d,s,t);if(u.equals(r)){o.push({index:d,edges:f});for(const{id:I,points:E,distance:m}of f)i.set(I,{points:E,distance:m})}}let a=0;const l=new Map,h=new Map;for(const{index:d,edges:u}of o){const f=new Map;for(const{id:T}of u)if(l.has(T)){const F=l.get(T);f.set(T,F)}const I=u.map(T=>T.id);if(!f.size){const T=a++;for(const{id:F}of u)l.set(F,T);h.set(T,{edges:new Set(I),indices:new Set([d])});continue}let E=null;const m=new Set,C=new Set(I);for(const[T,F]of f){E===null?E=F:F!==E&&m.add(F),l.delete(T);const{edges:y}=h.get(F);y.delete(T),C.delete(T)}if(E===null)throw new Error("Error computing face!");const g=h.get(E),{indices:S}=g;S.add(d);for(const T of C){l.set(T,E);const{edges:F}=g;F.add(T)}for(const T of m){const F=h.get(T),{edges:y,indices:N}=F,w=h.get(E),{edges:P,indices:M}=w;for(const x of y)P.add(x),l.set(x,E);for(const x of N)M.add(x);h.delete(T)}}for(const[d,{indices:u,edges:f}]of h)if(u.has(e)){const I=[];for(const E of f){const m=i.get(E);I.push(m)}return{edges:I,indices:u}}return null}getVerticesAndNormal(t,e,s){if(!t.geometry.index)throw new Error("Geometry must be indexed!");const i=t.geometry.index.array,n=t.geometry.attributes.position.array,r=t.geometry.attributes.normal.array,o=i[e*3]*3,a=i[e*3+1]*3,l=i[e*3+2]*3,h=new B(n[o],n[o+1],n[o+2]),d=new B(n[a],n[a+1],n[a+2]),u=new B(n[l],n[l+1],n[l+2]),f=new B(r[o],r[o+1],r[o+2]),I=new B(r[a],r[a+1],r[a+2]),E=new B(r[l],r[l+1],r[l+2]),m=(f.x+I.x+E.x)/3,C=(f.y+I.y+E.y)/3,g=(f.z+I.z+E.z)/3,S=new B(m,C,g);if(s!==void 0&&t instanceof Me){const T=new ft;t.getMatrixAt(s,T);const F=new ft;F.extractRotation(T),S.applyMatrix4(F),h.applyMatrix4(T),d.applyMatrix4(T),u.applyMatrix4(T)}return{p1:h,p2:d,p3:u,faceNormal:S}}round(t){t.x=Math.trunc(t.x*1e3)/1e3,t.y=Math.trunc(t.y*1e3)/1e3,t.z=Math.trunc(t.z*1e3)/1e3}getVolumeFromFragments(t){const e=this.components.get(gt),s=new ft,i=[];for(const r in t){const o=e.list.get(r);if(!o)continue;const a=t[r];let l=0;for(const u of a){const f=o.getInstancesIDs(u);f&&(l+=f.size)}const h=new Me(o.mesh.geometry,void 0,l);let d=0;for(const u of a){const f=o.getInstancesIDs(u);if(f)for(const I of f)o.mesh.getMatrixAt(I,s),h.setMatrixAt(d++,s)}i.push(h)}const n=this.getVolumeFromMeshes(i);for(const r of i)r.geometry=null,r.material=[],r.dispose();return n}getVolumeFromMeshes(t){let e=0;for(const s of t)e+=this.getVolumeOfMesh(s);return e}getFaceData(t,e,s){const i=this.getVerticesAndNormal(s,t,e),{p1:n,p2:r,p3:o,faceNormal:a}=i;this.round(n),this.round(r),this.round(o),this.round(a);const l=[{id:`${n.x}|${n.y}|${n.z}`,value:n},{id:`${r.x}|${r.y}|${r.z}`,value:r},{id:`${o.x}|${o.y}|${o.z}`,value:o}];l.sort((g,S)=>g.id<S.id?-1:g.id>S.id?1:0);const[{id:h,value:d},{id:u,value:f},{id:I,value:E}]=l,m=[{id:`${h}|${u}`,distance:d.distanceTo(f),points:[d,f]},{id:`${u}|${I}`,distance:f.distanceTo(E),points:[f,E]},{id:`${h}|${I}`,distance:d.distanceTo(E),points:[d,E]}],C=new We;return C.setFromNormalAndCoplanarPoint(a,n),C.constant=Math.round(C.constant*10)/10,{plane:C,edges:m}}getVolumeOfMesh(t){let e=0;const s=new B,i=new B,n=new B,{index:r}=t.geometry,o=t.geometry.attributes.position.array;if(!r)return console.warn("Geometry must be indexed to compute its volume!"),0;const a=[];if(t instanceof Me)for(let h=0;h<t.count;h++){const d=new ft;t.getMatrixAt(h,d),a.push(d)}else a.push(new ft().identity());const{matrixWorld:l}=t;for(let h=0;h<r.array.length-2;h+=3)for(const d of a){const u=d.multiply(l),f=r.array[h]*3,I=r.array[h+1]*3,E=r.array[h+2]*3;s.set(o[f],o[f+1],o[f+2]).applyMatrix4(u),i.set(o[I],o[I+1],o[I+2]).applyMatrix4(u),n.set(o[E],o[E+1],o[E+2]).applyMatrix4(u),e+=this.getSignedVolumeOfTriangle(s,i,n)}return Math.abs(e)}getSignedVolumeOfTriangle(t,e,s){const i=s.x*e.y*t.z,n=e.x*s.y*t.z,r=s.x*t.y*e.z,o=t.x*s.y*e.z,a=e.x*t.y*s.z,l=t.x*e.y*s.z;return 1/6*(-i+n+r-o-a+l)}};p($a,"uuid","267ca032-672f-4cb0-afa9-d24e904f39d6");let Zf=$a;class ji{constructor(t){p(this,"cardinality","required"),p(this,"instructions"),p(this,"evalRequirement",(e,s,i,n)=>{const r={parameter:i,currentValue:e,requiredValue:s.parameter,pass:!1};n&&this.addCheckResult(r,n);let o=!1;if(s.type==="simple"&&(o=e===s.parameter),s.type==="enumeration"&&(o=s.parameter.includes(e)),s.type==="pattern"&&(o=new RegExp(s.parameter).test(String(e))),s.type==="length"){const{min:a,length:l,max:h}=s.parameter;l!==void 0&&(o=String(e).length===l),a!==void 0&&(o=String(e).length>=a),h!==void 0&&(o=String(e).length<=h)}if(s.type==="bounds"&&typeof e=="number"){const{min:a,minInclusive:l,max:h,maxInclusive:d}=s.parameter;let u=!0,f=!0;a!==void 0&&(u=l?e>=a:e>a),h!==void 0&&(f=d?e<=h:e<h),o=u&&f}return this.cardinality==="prohibited"&&(o=!o),this.cardinality==="optional"&&(o=!0),r.pass=o,r.pass}),p(this,"testResult",[]),this.components=t}addCheckResult(t,e){const s=e.findIndex(({parameter:i})=>i===t.parameter);s!==-1?e[s]=t:e.push(t)}saveResult(t,e){const{GlobalId:s}=t;if(!s)return;const{value:i}=s,n={expressID:i,pass:e,checks:[],cardinality:this.cardinality};this.testResult.push(n)}}const me=(c,t)=>{let e="";return t?(t.type==="simple"&&(e=`<ids:simpleValue>${t.parameter}</ids:simpleValue>`),t.type==="enumeration"&&(e=`<xs:restriction base="xs:string">
    ${t.parameter.map(n=>`<xs:enumeration value="${n}" />`).join(`\r
`)}
    </xs:restriction>`),t.type==="pattern"&&(e=`<xs:restriction base="xs:string">
      <xs:pattern value="${t.parameter}" />
    </xs:restriction>`),`<ids:${c[0].toLowerCase()+c.slice(1)}>
    ${e}
  </ids:${c[0].toLowerCase()+c.slice(1)}>`):e};class Nf extends ji{constructor(t,e){super(t),p(this,"facetType","Attribute"),p(this,"name"),p(this,"value"),this.name=e}serialize(t){const e=me("Name",this.name),s=me("Value",this.value);let i="";return t==="requirement"&&(i+=`cardinality="${this.cardinality}"`,i+=this.instructions?`instructions="${this.instructions}"`:""),`<ids:attribute ${i}>
  ${e}
  ${s}
</ids:attribute>`}async getEntities(){return[]}async test(t){var e;this.testResult=[];for(const i in t){const n=Number(i),r=t[n],o=[],a={guid:(e=r.GlobalId)==null?void 0:e.value,expressID:n,pass:!1,checks:o,cardinality:this.cardinality};this.testResult.push(a);const h=Object.keys(r).filter(u=>{const f=this.evalRequirement(u,this.name,"Name"),I=r[u];return f&&I===null?this.cardinality==="optional"||this.cardinality==="prohibited":f&&(I==null?void 0:I.type)===3&&I.value===2||f&&Array.isArray(I)&&I.length===0||f&&(I==null?void 0:I.type)===1&&I.value.trim()===""?!1:f}),d=h.length>0;if(o.push({parameter:"Name",currentValue:d?h[0]:null,requiredValue:this.name.parameter,pass:this.cardinality==="prohibited"?!d:d}),this.value)if(h[0]){const u=r[h[0]];(u==null?void 0:u.type)===5?o.push({parameter:"Value",currentValue:null,requiredValue:this.value.parameter,pass:this.cardinality==="prohibited"}):this.evalRequirement(u?u.value:null,this.value,"Value",o)}else o.push({parameter:"Value",currentValue:null,requiredValue:this.value.parameter,pass:this.cardinality==="prohibited"});a.pass=o.every(({pass:u})=>u)}const s=[...this.testResult];return this.testResult=[],s}}class _f extends ji{constructor(t,e){super(t),p(this,"facetType","Classification"),p(this,"system"),p(this,"value"),p(this,"uri"),this.system=e}serialize(t){const e=me("System",this.system),s=me("Value",this.value);let i="";return t==="requirement"&&(i+=`cardinality="${this.cardinality}"`,i+=this.uri?`uri=${this.uri}`:"",i+=this.instructions?`instructions="${this.instructions}"`:""),`<ids:classification ${i}>
  ${e}
  ${s}
</ids:classification>`}async getEntities(t,e={}){var s;const i=[],n=await t.getAllPropertiesOfType(Ie),r=await t.getAllPropertiesOfType($e),o={...n,...r},a=[];for(const h in o){const d=Number(h),u=await t.getProperties(d);if(!u)continue;const f=(s=u.ReferencedSource)==null?void 0:s.value;if(!f)continue;const I=await t.getProperties(f);!I||!this.evalSystem(I)||!this.evalValue(u)||!this.evalURI(u)||a.push(d)}const l=this.components.get(te);for(const h of a){const d=l.getEntitiesWithRelation(t,"HasAssociations",h);for(const u of d){if(u in e)continue;const f=await t.getProperties(u);f&&(e[u]=f,i.push(u))}}return i}async test(t,e){var s;this.testResult=[];for(const n in t){const r=Number(n),o=t[r],a=[],l={guid:(s=o.GlobalId)==null?void 0:s.value,expressID:r,pass:!1,checks:a,cardinality:this.cardinality};this.testResult.push(l);let h=!0;const d=await this.getSystems(e,r),u=d.map(f=>this.getSystemName(f)).filter(f=>f);for(const f of d){if(!this.evalSystem(f,a))continue;if(h=!1,!(this.value&&this.system))break;if(f.type!==Ie)continue;const E=!this.value||this.evalValue(f,a),m=!this.uri||this.evalURI(f,a);if(E&&m)break}h&&this.addCheckResult({parameter:"System",currentValue:u,requiredValue:this.system,pass:this.cardinality==="optional"},a),l.pass=a.every(({pass:f})=>f)}const i=[...this.testResult];return this.testResult=[],i}async processReferencedSource(t,e){var s;const i=(s=e.ReferencedSource)==null?void 0:s.value;if(!i)return null;const n=await t.getProperties(i);return n?(n.type===Ie&&(n.ReferencedSource=await this.processReferencedSource(t,n)),n):null}async getSystems(t,e){var s;const i=[],n=this.components.get(te),r=n.getEntityRelations(t,e,"HasAssociations");if(r)for(const d of r){const u=await t.getProperties(d);u&&(u.type===$e&&i.push(u),u.type===Ie&&(u.ReferencedSource=await this.processReferencedSource(t,u),u.ReferencedSource&&i.push(u)))}const o=i.map(d=>{var u,f,I;return d.type===$e?(u=d.Name)==null?void 0:u.value:d.type===Ie?(I=(f=d.ReferencedSource)==null?void 0:f.Name)==null?void 0:I.value:null}).filter(d=>d),a=n.getEntityRelations(t,e,"IsTypedBy");if(!(a&&a[0]))return i;const l=a[0],h=n.getEntityRelations(t,l,"HasAssociations");if(h)for(const d of h){const u=await t.getProperties(d);if(u){if(u.type===$e){if(o.includes((s=u.Name)==null?void 0:s.value))continue;i.push(u)}u.type===Ie&&(u.ReferencedSource=await this.processReferencedSource(t,u),u.ReferencedSource&&i.push(u))}}return i}getSystemName(t){var e,s,i,n;if(t.type===$e)return(e=t.Name)==null?void 0:e.value;if(t.type===Ie){if(((s=t.ReferencedSource)==null?void 0:s.type)===Ie)return this.getSystemName(t.ReferencedSource);if(((i=t.ReferencedSource)==null?void 0:i.type)===$e)return(n=t.ReferencedSource.Name)==null?void 0:n.value}return null}getAllReferenceIdentifications(t){if(t.type!==Ie)return null;const e=[];if(t.Identification&&e.push(t.Identification.value),t.ReferencedSource){const s=this.getAllReferenceIdentifications(t.ReferencedSource);s&&e.push(...s)}return e}evalSystem(t,e){const s=this.getSystemName(t);return this.evalRequirement(s,this.system,"System",e)}evalValue(t,e){if(!this.value)return!0;const s=this.getAllReferenceIdentifications(t);if(!s)return!1;const i=s.find(n=>this.value?this.evalRequirement(n,this.value,"Value"):!1);return e&&this.addCheckResult({parameter:"Value",currentValue:i??null,requiredValue:this.value,pass:!!i},e),!!i}evalURI(t,e){var s;return this.uri?this.evalRequirement((s=t.Location)==null?void 0:s.value,{type:"simple",parameter:this.uri},"URI",e):!0}}class Pf extends ji{constructor(t,e){super(t),p(this,"facetType","Entity"),p(this,"name"),p(this,"predefinedType"),this.name=e}serialize(t){const e=me("Name",this.name),s=me("Name",this.predefinedType);let i="";return t==="requirement"&&(i+=`cardinality="${this.cardinality}"`,i+=this.instructions?`instructions="${this.instructions}"`:""),`<ids:entity ${i}>
  ${e}
  ${s}
</ids:entity>`}async getEntities(t,e={}){const s=Object.entries(Bi),i=[];for(const[o]of s)await this.evalName({type:o})&&i.push(Number(o));let n={};for(const o of i){const a=await t.getAllPropertiesOfType(o);a&&(n={...n,...a})}if(!this.predefinedType){for(const o in n)o in e||(e[o]=n[o]);return Object.keys(n).map(Number)}const r=[];for(const o in n){const a=Number(o);if(a in e)continue;const l=n[a];await this.evalPredefinedType(t,l)&&(e[a]=l,r.push(a))}return r}async test(t,e){var s;this.testResult=[];for(const i in t){const n=Number(i),r=t[n],o=[],a={guid:(s=r.GlobalId)==null?void 0:s.value,expressID:n,pass:!1,checks:o,cardinality:this.cardinality};this.testResult.push(a),await this.evalName(r,o),await this.evalPredefinedType(e,r,o),a.pass=o.every(({pass:l})=>l)}return this.testResult}async evalName(t,e){const s=Bi[t.type];return this.evalRequirement(s,this.name,"Name",e)}async evalPredefinedType(t,e,s){var i,n,r,o;if(!this.predefinedType)return null;const a=this.components.get(te),l=typeof this.predefinedType.parameter=="string"&&this.predefinedType.parameter==="USERDEFINED";let h=(i=e.PredefinedType)==null?void 0:i.value;if(h==="USERDEFINED"&&!l){const f=Object.keys(e).find(I=>/^((?!Predefined).)*Type$/.test(I));h=f?(n=e[f])==null?void 0:n.value:"USERDEFINED"}if(!h){const u=a.getEntityRelations(t,e.expressID,"IsTypedBy");if(u&&u[0]){const f=await t.getProperties(u[0]);if(f&&(h=(r=f.PredefinedType)==null?void 0:r.value,h==="USERDEFINED"&&!l)){const E=Object.keys(f).find(m=>/^((?!Predefined).)*Type$/.test(m));h=E?(o=f[E])==null?void 0:o.value:"USERDEFINED"}}}return this.evalRequirement(h,this.predefinedType,"PredefinedType",s)}}class Lf extends ji{constructor(t,e,s){super(t),p(this,"facetType","Property"),p(this,"propertySet"),p(this,"baseName"),p(this,"value"),p(this,"dataType"),p(this,"uri"),p(this,"_unsupportedTypes",[gc,Rc]),this.propertySet=e,this.baseName=s}serialize(t){const e=me("PropertySet",this.propertySet),s=me("BaseName",this.baseName),i=me("Value",this.value),n=this.dataType?`dataType=${this.dataType}`:"";let r="";return t==="requirement"&&(r+=`cardinality="${this.cardinality}"`,r+=this.uri?`uri=${this.uri}`:"",r+=this.instructions?`instructions="${this.instructions}"`:""),`<ids:property ${n} ${r}>
  ${e}
  ${s}
  ${i}
</ids:property>`}async getEntities(t,e={}){var s,i;let n={};const r=await t.getAllPropertiesOfType(fs);n={...n,...r};const o=await t.getAllPropertiesOfType(Pi);if(n={...n,...o},Object.keys(n).length===0)return[];const a=[];for(const h in n){const d=Number(h),u=await t.getProperties(d);if(!u||!(((s=u.Name)==null?void 0:s.value)===this.propertySet.parameter))continue;let I;if(u.type===fs&&(I="HasProperties"),u.type===Pi&&(I="Quantities"),!!I)for(const E of u[I]){const m=await t.getProperties(E.value);if(!(!m||!(((i=m.Name)==null?void 0:i.value)===this.baseName.parameter))){if(this.value){const g=Object.keys(m).find(T=>T.endsWith("Value"));if(!g||!(m[g].value===this.value.parameter))continue}a.push(d)}}}const l=this.components.get(te);for(const h of a){const d=l.getEntitiesWithRelation(t,"IsDefinedBy",h);for(const u of d){if(u in e)continue;const f=await t.getProperties(u);f&&(e[u]=f)}}return[]}async test(t,e){var s;this.testResult=[];for(const n in t){const r=Number(n),o=t[r],a=[],l={guid:(s=o.GlobalId)==null?void 0:s.value,expressID:r,pass:!1,checks:a,cardinality:this.cardinality};this.testResult.push(l);const d=(await this.getPsets(e,r)).filter(u=>this.evalRequirement(u.Name??null,this.propertySet,"PropertySet")?(a.push({currentValue:u.Name,parameter:"PropertySet",pass:!0,requiredValue:this.propertySet.parameter}),!0):!1);if(d.length===0){a.push({currentValue:null,parameter:"PropertySet",pass:!1,requiredValue:this.propertySet.parameter});continue}for(const u of d){if(!("Properties"in u)){a.push({currentValue:null,parameter:"BaseName",pass:!1,requiredValue:this.baseName.parameter});continue}const I=u.Properties.filter(E=>{var m;return this._unsupportedTypes.includes(E.type)||!this.evalRequirement(((m=E.Name)==null?void 0:m.value)??null,this.baseName,"BaseName")?!1:(a.push({currentValue:E.Name.value,parameter:"BaseName",pass:!0,requiredValue:this.baseName.parameter}),!0)});if(I.length===0){a.push({currentValue:null,parameter:"BaseName",pass:!1,requiredValue:this.baseName.parameter});continue}for(const E of I)this.evalValue(E,a),this.evalDataType(E,a),this.evalURI()}l.pass=a.every(({pass:u})=>u)}const i=[...this.testResult];return this.testResult=[],i}getItemsAttrName(t){let e;return t===fs&&(e="HasProperties"),t===Pi&&(e="Quantities"),e}getValueKey(t){return Object.keys(t).find(e=>e.endsWith("Value")||e.endsWith("Values"))}async simplifyPset(t,e,s){var i;const n=[],r=e[s];if(!r)return e;for(const{value:a}of r){const l=await t.getProperties(a);l&&n.push(l)}return{Name:(i=e.Name)==null?void 0:i.value,Properties:n,type:e.type}}async getTypePsets(t,e){const s=[],n=this.components.get(te).getEntityRelations(t,e,"IsTypedBy");if(!(n&&n[0]))return s;const r=await t.getProperties(n[0]);if(!(r&&"HasPropertySets"in r&&Array.isArray(r.HasPropertySets)))return s;for(const{value:o}of r.HasPropertySets){const a=await t.getProperties(o);if(!(a&&"HasProperties"in a&&Array.isArray(a.HasProperties)))continue;const l=await this.simplifyPset(t,a,"HasProperties");s.push(l)}return s}async getPsets(t,e){var s;const i=await this.getTypePsets(t,e),r=this.components.get(te).getEntityRelations(t,e,"IsDefinedBy");if(!r)return i;const o=[];for(const a of r){const l=await t.getProperties(a);if(!l)continue;const h=this.getItemsAttrName(l.type);if(!h)continue;const d=await this.simplifyPset(t,l,h),u=i.find(({Name:f})=>f===d.Name);if(u)for(const f of u.Properties){const I=(s=f.Name)==null?void 0:s.value;d.Properties.find(({Name:m})=>m.value===I)||d.Properties.push(f)}o.push(d)}return o}evalValue(t,e){const s=this.getValueKey(t),i=t[s];if(this.value){if(!i)return e==null||e.push({parameter:"Value",currentValue:null,pass:!1,requiredValue:this.value.parameter}),!1;const n=structuredClone(this.value);if(i.name==="IFCLABEL"&&n.type==="simple"&&(n.parameter=String(n.parameter)),(t.type===yr||t.type===Nr)&&Array.isArray(i)){const o=i.map(l=>l.value),a=i.find(l=>n?this.evalRequirement(l.value,n,"Value"):!1);return e==null||e.push({currentValue:o,pass:!!a,parameter:"Value",requiredValue:n.parameter}),!!a}return this.evalRequirement(i.value,n,"Value",e)}return s?i.type===3&&i.value===2?(e==null||e.push({parameter:"Value",currentValue:null,pass:!1,requiredValue:null}),!1):i.type===1&&i.value.trim()===""?(e==null||e.push({parameter:"Value",currentValue:"",pass:!1,requiredValue:null}),!1):!0:!0}evalDataType(t,e){if(!this.dataType)return!0;const s=this.getValueKey(t),i=t[s];if(!i)return e==null||e.push({parameter:"DataType",currentValue:null,pass:!1,requiredValue:this.dataType}),!1;if((t.type===yr||t.type===Nr)&&Array.isArray(i)&&i[0]){const r=i[0].name;return this.evalRequirement(r,{type:"simple",parameter:this.dataType},"DataType",e)}return this.evalRequirement(i.name,{type:"simple",parameter:this.dataType},"DataType",e)}evalURI(){return!0}}class wf{constructor(t,e,s){p(this,"name"),p(this,"ifcVersion",new Set),p(this,"identifier",Ae.create()),p(this,"description"),p(this,"instructions"),p(this,"requirementsDescription"),p(this,"applicability",new ve),p(this,"requirements",new ve),p(this,"components"),this.components=t,this.name=e;for(const i of s)this.ifcVersion.add(i)}set(t){const e=t,s=this;for(const n in t){if(n==="identifier")continue;const r=e[n];n in this&&(s[n]=r)}return this.components.get(bf).list.set(this.identifier,this),this}async test(t){let e=[];if(this.requirements.size===0)return e;const s={};for(const n of this.applicability)await n.getEntities(t,s);return e=await[...this.requirements][0].test(s,t),e}serialize(){const t=`name="${this.name}"`,e=this.identifier?`identifier="${this.identifier}"`:"",s=this.description?`description="${this.description}"`:"",i=this.instructions?`instructions="${this.instructions}"`:"";return`<ids:specification ifcVersion="${[...this.ifcVersion].join(" ")}" ${t} ${e} ${s} ${i}>
      <ids:applicability minOccurs="1" maxOccurs="unbounded">
        ${[...this.applicability].map(r=>r.serialize("applicability"))}
      </ids:applicability>
      <ids:requirements>
        ${[...this.requirements].map(r=>r.serialize("requirement"))}
      </ids:requirements>
    </ids:specification>`}}const ge=c=>{if(!c)return;const t={};if("simpleValue"in c&&(t.type="simple",t.parameter=c.simpleValue),"restriction"in c){const e=c.restriction;if("pattern"in e&&(t.type="pattern",t.parameter=e.pattern.value),"enumeration"in e){t.type="enumeration";const s=e.enumeration.map(({value:i})=>i);t.parameter=s}}if(t.parameter!==void 0)return t},yo=(c,t)=>{const e=[];for(const s of t){const i=s.name,n=ge(i);if(!n)continue;const r=new Pf(c,n);s.cardinality&&(r.cardinality=s.cardinality),r.predefinedType=ge(s.predefinedType),r.instructions=s.instructions,e.push(r)}return e},Mf=(c,t)=>{const e=[];for(const s of t){const i=s.name,n=ge(i);if(!n)continue;const r=new Nf(c,n);s.cardinality&&(r.cardinality=s.cardinality),r.value=ge(s.value),r.instructions=s.instructions,e.push(r)}return e},vf=(c,t)=>{const e=[];for(const s of t){const i=s.system,n=ge(i);if(!n)continue;const r=new _f(c,n);s.cardinality&&(r.cardinality=s.cardinality);const o=ge(s.value);(o==null?void 0:o.type)==="simple"&&(o.parameter=String(o.parameter)),(o==null?void 0:o.type)==="enumeration"&&Array.isArray(o.parameter)&&(o.parameter=o.parameter.map(String)),r.value=o,r.uri=s.uri,r.instructions=s.instructions,e.push(r)}return e},Df=(c,t)=>{const e=[];for(const s of t){const i=s.propertySet,n=s.baseName,r=ge(i),o=ge(n);if(!(o&&r))continue;const a=new Lf(c,r,o);s.cardinality&&(a.cardinality=s.cardinality);const l=ge(s.value);(l==null?void 0:l.type)==="enumeration"&&Array.isArray(l.parameter)&&(l.parameter=l.parameter.map(String)),a.value=l,a.dataType=s.dataType,a.uri=s.uri,a.instructions=s.instructions,e.push(a)}return e},Rr=class kn extends Rt{constructor(t){super(t),p(this,"enabled",!0),p(this,"list",new oe),t.add(kn.uuid,this)}getFragmentIdMap(t,e){const i=e.filter(l=>l.pass).map(l=>l.expressID),n=t.getFragmentMap(i),o=e.filter(l=>!l.pass).map(l=>l.expressID),a=t.getFragmentMap(o);return{pass:n,fail:a}}create(t,e,s){const i=new wf(this.components,t,e);return s&&(i.identifier=s),this.list.set(i.identifier,i),i}load(t){const e=[],s=kn.xmlParser.parse(t).ids,{specifications:i}=s;if(i&&i.specification){const n=Array.isArray(i.specification)?i.specification:[i.specification];for(const r of n){const{name:o,ifcVersion:a,description:l,instructions:h,identifier:d}=r;if(!(o&&a))continue;const u=[],f=[],{applicability:I,requirements:E}=r;if(I){const{maxOccurs:C,...g}=I,S=Array.isArray(g)?g:[g];for(const T of S)for(const F in T){const y=Array.isArray(T[F])?T[F]:[T[F]];if(F==="entity"){const N=yo(this.components,y);u.push(...N)}}}let m;if(E){const{maxOccurs:C,...g}=E;m=E.description;const S=Array.isArray(g)?g:[g];for(const T of S)for(const F in T){const y=Array.isArray(T[F])?T[F]:[T[F]];if(F==="entity"){const N=yo(this.components,y);f.push(...N)}if(F==="attribute"){const N=Mf(this.components,y);f.push(...N)}if(F==="classification"){const N=vf(this.components,y);f.push(...N)}if(F==="property"){const N=Df(this.components,y);f.push(...N)}}}if(u.length>0&&f.length>0){const C=this.create(o,a.split(/\s+/),d);C.description=l,C.instructions=h,C.requirementsDescription=m,C.applicability.add(...u),C.requirements.add(...f),e.push(C)}}}return e}export(t,e=this.list.values()){const s=e??this.list;return`<ids:ids xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://standards.buildingsmart.org/IDS http://standards.buildingsmart.org/IDS/1.0/ids.xsd" xmlns:ids="http://standards.buildingsmart.org/IDS">
  <!-- Made with That Open Engine ${ko.release} (https://github.com/thatopen/engine_components) -->
  <ids:info>
    <ids:title>${t.title}</ids:title>
    ${t.copyright?`<ids:copyright>${t.copyright}</ids:copyright>`:""}
    ${t.version?`<ids:version>${t.version}</ids:version>`:""}
    ${t.description?`<ids:description>${t.description}</ids:description>`:""}
    ${t.author?`<ids:author>${t.author}</ids:author>`:""}
    ${t.date?`<ids:date>${t.date.toISOString().split("T")[0]}</ids:date>`:""}
    ${t.purpose?`<ids:purpose>${t.purpose}</ids:purpose>`:""}
    ${t.milestone?`<ids:milestone>${t.milestone}</ids:milestone>`:""}
  </ids:info>
  <ids:specifications>
    ${[...s].map(n=>n.serialize()).join(`
`)}
  </ids:specifications>
</ids:ids>`}};p(Rr,"uuid","9f0b9f78-9b2e-481a-b766-2fbfd01f342c");p(Rr,"xmlParser",new Fa.XMLParser({allowBooleanAttributes:!0,attributeNamePrefix:"",ignoreAttributes:!1,ignoreDeclaration:!0,ignorePiTags:!0,numberParseOptions:{leadingZeros:!0,hex:!0},parseAttributeValue:!0,preserveOrder:!1,processEntities:!1,removeNSPrefix:!0,trimValues:!0}));let bf=Rr;export{Yt as B,ko as C,Hf as E,gt as F,Vf as G,gf as H,te as I,Zf as M,$h as O,bn as R,Th as S,Ao as T,Ae as U,Ce as V,qo as W,js as a,_h as b,zn as c,Uf as d,kh as e,Kh as f,eu as g,Ih as h,Bi as i,Qh as j,Gf as k,kf as l,So as m,Oo as n,Ff as o,Wf as p,mf as q,Bf as r,Xf as s};
