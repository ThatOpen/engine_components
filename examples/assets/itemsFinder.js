import{l as h,c as b,a as m,b as y,t as w}from"./index-BET5fVdQ.js";import{C as L,W as C,S as v,a as I,O as k,F as S,H as f}from"./index-B31d80Z1.js";import{I as F}from"./index-B13xoQwy.js";const s=new L,U=s.get(C),n=U.create();n.scene=new v(s);n.scene.setup();n.scene.three.background=null;const A=document.getElementById("container");n.renderer=new I(s,A);n.camera=new k(s);await n.camera.controls.setLookAt(78,20,-2.2,26,-4,25);s.init();const M="https://thatopen.github.io/engine_fragment/resources/worker.mjs",O=await fetch(M),R=await O.blob(),N=new File([R],"worker.mjs",{type:"text/javascript"}),q=URL.createObjectURL(N),a=s.get(S);a.init(q);n.camera.controls.addEventListener("update",()=>a.core.update());n.onCameraChanged.add(e=>{for(const[,t]of a.list)t.useCamera(e.three);a.core.update(!0)});a.list.onItemSet.add(({value:e})=>{e.useCamera(n.camera.three),n.scene.three.add(e.object),a.core.update(!0)});a.core.models.materials.list.onItemSet.add(({value:e})=>{"isLodMaterial"in e&&e.isLodMaterial||(e.polygonOffset=!0,e.polygonOffsetUnits=1,e.polygonOffsetFactor=Math.random())});const B=["https://thatopen.github.io/engine_components/resources/frags/school_arq.frag","https://thatopen.github.io/engine_components/resources/frags/school_str.frag"];await Promise.all(B.map(async e=>{var l;const t=(l=e.split("/").pop())==null?void 0:l.split(".").shift();if(!t)return null;const r=await(await fetch(e)).arrayBuffer();return a.core.load(r,{modelId:t})}));const d=s.get(F);d.create("Walls & Slabs",[{categories:[/WALL/,/SLAB/]}]);d.create("Masonry Walls",[{categories:[/WALL/],attributes:{queries:[{name:/Name/,value:/Masonry/}]}}]);const W={categories:[/BUILDINGSTOREY/],attributes:{queries:[{name:/Name/,value:/Entry/}]}};d.create("First Level Columns",[{categories:[/COLUMN/],relation:{name:"ContainedInStructure",query:W}}]);const j=async e=>{const t=d.list.get(e);return t?await t.test():{}};h.init();const _=()=>m`
    <bim-table ${w(t=>{if(!t)return;const o=t;o.loadFunction=async()=>{const r=[];for(const[l]of d.list)r.push({data:{Name:l,Actions:""}});return r},o.loadData(!0)})}></bim-table>
  `,i=b.create(_);i.style.maxHeight="25rem";i.columns=["Name",{name:"Actions",width:"auto"}];i.noIndentation=!0;i.headersHidden=!0;i.dataTransform={Actions:(e,t)=>{const{Name:o}=t;if(!o)return e;const r=s.get(f);return m`<bim-button icon="solar:cursor-bold" @click=${async({target:p})=>{p.loading=!0;const g=await j(o);await r.isolate(g),p.loading=!1}}></bim-button>`}};const u=b.create(()=>m`
    <bim-panel active label="Items Finder Tutorial" class="options-menu">
      <bim-panel-section style="min-width: 14rem" label="General">
        <bim-button label="Reset Visibility" @click=${async({target:t})=>{t.loading=!0,await s.get(f).set(!0),t.loading=!1}}></bim-button>
      </bim-panel-section>
      <bim-panel-section label="Queries">
        ${i}
      </bim-panel-section>
    </bim-panel>
  `);document.body.append(u);const $=b.create(()=>m`
      <bim-button class="phone-menu-toggler" icon="solar:settings-bold"
        @click="${()=>{u.classList.contains("options-menu-visible")?u.classList.remove("options-menu-visible"):u.classList.add("options-menu-visible")}}">
      </bim-button>
    `);document.body.append($);const c=new y;c.showPanel(2);document.body.append(c.dom);c.dom.style.left="0px";c.dom.style.zIndex="unset";n.renderer.onBeforeUpdate.add(()=>c.begin());n.renderer.onAfterUpdate.add(()=>c.end());
