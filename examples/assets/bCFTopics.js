import{a as f}from"./index-lvtjgYNN.js";import{a as w,R as u,m as b}from"./index-bERBRksd.js";import{C as h,W as g,S as y,a as C,O as v,F as T,B as k,V as U,T as I}from"./index-BPZgAaC0.js";const a=new h,L=a.get(g),o=L.create();o.scene=new y(a);o.scene.setup();o.scene.three.background=null;const S=document.getElementById("container");o.renderer=new C(a,S);o.camera=new v(a);await o.camera.controls.setLookAt(68,23,-8.5,21.5,-5.5,23);a.init();const B="https://thatopen.github.io/engine_fragment/resources/worker.mjs",F=await fetch(B),j=await F.blob(),R=new File([j],"worker.mjs",{type:"text/javascript"}),x=URL.createObjectURL(R),s=a.get(T);s.init(x);o.camera.controls.addEventListener("rest",()=>s.core.update(!0));o.onCameraChanged.add(e=>{for(const[,t]of s.list)t.useCamera(e.three);s.core.update(!0)});s.list.onItemSet.add(({value:e})=>{e.useCamera(o.camera.three),o.scene.three.add(e.object),s.core.update(!0)});const D=["https://thatopen.github.io/engine_components/resources/frags/school_arq.frag"];await Promise.all(D.map(async e=>{var l;const t=(l=e.split("/").pop())==null?void 0:l.split(".").shift();if(!t)return null;const d=await(await fetch(e)).arrayBuffer();return s.core.load(d,{modelId:t})}));const i=a.get(k);i.setup({author:"signed.user@mail.com",types:new Set([...i.config.types,"Information","Coordination"]),statuses:new Set(["Active","In Progress","Done","In Review","Closed"]),users:new Set(["juan.hoyos4@gmail.com"]),version:"3"});const E=a.get(U);i.list.onItemSet.add(async({value:e})=>{const t=E.create();t.world=o,e.viewpoints.add(t.guid),e.comments.onItemSet.add(({value:n})=>{n.viewpoint=t.guid})});const c=i.create({title:"Missing information",description:"It seems these elements are badly defined.",dueDate:new Date("08-01-2020"),type:"Clash",priority:"Major",stage:"Design",labels:new Set(["Architecture","Cost Estimation"]),assignedTo:"juan.hoyos@thatopen.com"});I.default={title:"Custom Default Title",type:"Custom Default Topic Type",status:"Custom Default Topic Status",priority:"Custom Default Priority"};const P=c.createComment("What if we talk about this next meeting?"),A=c.createComment("Hi there! I agree.");i.list.onItemUpdated.add(({value:e})=>{console.log(`Topic ${e.title} was updated!`)});c.title="Updated Title";c.set({title:"New Title"});c.comments.onItemUpdated.add(({value:e})=>{console.log("The following comment has been updated:",e)});P.comment="What if we talk about this next meeting with all partners?";A.comment="Will tell you tomorrow when is more convenient!";const O=async()=>{const e=await i.export(),t=new File([e],"topics.bcf"),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download=t.name,n.click(),URL.revokeObjectURL(n.href)},W=()=>{const e=document.createElement("input");e.multiple=!1,e.accept=".bcf",e.type="file",e.addEventListener("change",async()=>{var p;const t=(p=e.files)==null?void 0:p[0];if(!t)return;const n=await t.arrayBuffer(),{topics:d,viewpoints:l}=await i.load(new Uint8Array(n));console.log(d,l)}),e.click()};w.init();const m=u.create(()=>b`
    <bim-panel active label="BCFTopics Tutorial" class="options-menu">
      <bim-panel-section label="Info">
        <bim-label style="width: 14rem; white-space: normal;">ðŸ’¡ To fully experience this tutorial, open your browser console!</bim-label> 
      </bim-panel-section>
      <bim-panel-section label="Controls">
        <bim-button @click=${O} label="Export BCF"></bim-button> 
        <bim-button @click=${W} label="Load BCF"></bim-button>
      </bim-panel-section>
    </bim-panel>
  `);document.body.append(m);const $=u.create(()=>b`
      <bim-button class="phone-menu-toggler" icon="solar:settings-bold"
        @click="${()=>{m.classList.contains("options-menu-visible")?m.classList.remove("options-menu-visible"):m.classList.add("options-menu-visible")}}">
      </bim-button>
    `);document.body.append($);const r=new f;r.showPanel(2);document.body.append(r.dom);r.dom.style.left="0px";r.dom.style.zIndex="unset";o.renderer.onBeforeUpdate.add(()=>r.begin());o.renderer.onAfterUpdate.add(()=>r.end());
