import{T as f,L as p,m as b,a as w}from"./index-BR15nMAM.js";import{C as g,W as h,S as y,a as C,O as v,F as T,B as I,V as k,T as L}from"./index-DQoMA9YT.js";const a=new g,S=a.get(h),o=S.create();o.scene=new y(a);o.scene.setup();o.scene.three.background=null;const B=document.getElementById("container");o.renderer=new C(a,B);o.camera=new v(a);await o.camera.controls.setLookAt(68,23,-8.5,21.5,-5.5,23);a.init();const U="/node_modules/@thatopen/fragments/dist/Worker/worker.mjs",s=a.get(T);s.init(U);o.camera.controls.addEventListener("rest",()=>s.core.update(!0));o.onCameraChanged.add(e=>{for(const[,t]of s.list)t.useCamera(e.three);s.core.update(!0)});s.list.onItemSet.add(({value:e})=>{e.useCamera(o.camera.three),o.scene.three.add(e.object),s.core.update(!0)});const F=["/resources/frags/school_arq.frag"];await Promise.all(F.map(async e=>{var l;const t=(l=e.split("/").pop())==null?void 0:l.split(".").shift();if(!t)return null;const d=await(await fetch(e)).arrayBuffer();return s.core.load(d,{modelId:t})}));const i=a.get(I);i.setup({author:"signed.user@mail.com",types:new Set([...i.config.types,"Information","Coordination"]),statuses:new Set(["Active","In Progress","Done","In Review","Closed"]),users:new Set(["juan.hoyos4@gmail.com"]),version:"3"});const x=a.get(k);i.list.onItemSet.add(async({value:e})=>{const t=x.create();t.world=o,e.viewpoints.add(t.guid),e.comments.onItemSet.add(({value:n})=>{n.viewpoint=t.guid})});const c=i.create({title:"Missing information",description:"It seems these elements are badly defined.",dueDate:new Date("08-01-2020"),type:"Clash",priority:"Major",stage:"Design",labels:new Set(["Architecture","Cost Estimation"]),assignedTo:"juan.hoyos@thatopen.com"});L.default={title:"Custom Default Title",type:"Custom Default Topic Type",status:"Custom Default Topic Status",priority:"Custom Default Priority"};const D=c.createComment("What if we talk about this next meeting?"),j=c.createComment("Hi there! I agree.");i.list.onItemUpdated.add(({value:e})=>{console.log(`Topic ${e.title} was updated!`)});c.title="Updated Title";c.set({title:"New Title"});c.comments.onItemUpdated.add(({value:e})=>{console.log("The following comment has been updated:",e)});D.comment="What if we talk about this next meeting with all partners?";j.comment="Will tell you tomorrow when is more convenient!";const E=async()=>{const e=await i.export(),t=new File([e],"topics.bcf"),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download=t.name,n.click(),URL.revokeObjectURL(n.href)},P=()=>{const e=document.createElement("input");e.multiple=!1,e.accept=".bcf",e.type="file",e.addEventListener("change",async()=>{var u;const t=(u=e.files)==null?void 0:u[0];if(!t)return;const n=await t.arrayBuffer(),{topics:d,viewpoints:l}=await i.load(new Uint8Array(n));console.log(d,l)}),e.click()};f.init();const m=p.create(()=>b`
    <bim-panel active label="BCFTopics Tutorial" class="options-menu">
      <bim-panel-section label="Info">
        <bim-label style="width: 14rem; white-space: normal;">ðŸ’¡ To fully experience this tutorial, open your browser console!</bim-label> 
      </bim-panel-section>
      <bim-panel-section label="Controls">
        <bim-button @click=${E} label="Export BCF"></bim-button> 
        <bim-button @click=${P} label="Load BCF"></bim-button>
      </bim-panel-section>
    </bim-panel>
  `);document.body.append(m);const R=p.create(()=>b`
      <bim-button class="phone-menu-toggler" icon="solar:settings-bold"
        @click="${()=>{m.classList.contains("options-menu-visible")?m.classList.remove("options-menu-visible"):m.classList.add("options-menu-visible")}}">
      </bim-button>
    `);document.body.append(R);const r=new w;r.showPanel(2);document.body.append(r.dom);r.dom.style.left="0px";r.dom.style.zIndex="unset";o.renderer.onBeforeUpdate.add(()=>r.begin());o.renderer.onAfterUpdate.add(()=>r.end());
